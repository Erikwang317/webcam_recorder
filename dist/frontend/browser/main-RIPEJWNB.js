var LD=Object.create;var Ep=Object.defineProperty,kD=Object.defineProperties,FD=Object.getOwnPropertyDescriptor,UD=Object.getOwnPropertyDescriptors,VD=Object.getOwnPropertyNames,Rw=Object.getOwnPropertySymbols,Nw=Object.getPrototypeOf,Ow=Object.prototype.hasOwnProperty,BD=Object.prototype.propertyIsEnumerable,zD=Reflect.get;var Pw=(t,e,n)=>e in t?Ep(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ve=(t,e)=>{for(var n in e||={})Ow.call(e,n)&&Pw(t,n,e[n]);if(Rw)for(var n of Rw(e))BD.call(e,n)&&Pw(t,n,e[n]);return t},Ct=(t,e)=>kD(t,UD(e));var HD=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var GD=(t,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of VD(e))!Ow.call(t,r)&&r!==n&&Ep(t,r,{get:()=>e[r],enumerable:!(i=FD(e,r))||i.enumerable});return t};var WD=(t,e,n)=>(n=t!=null?LD(Nw(t)):{},GD(e||!t||!t.__esModule?Ep(n,"default",{value:t,enumerable:!0}):n,t));var kr=(t,e,n)=>zD(Nw(t),n,e);var U=(t,e,n)=>new Promise((i,r)=>{var s=c=>{try{a(n.next(c))}catch(u){r(u)}},o=c=>{try{a(n.throw(c))}catch(u){r(u)}},a=c=>c.done?i(c.value):Promise.resolve(c.value).then(s,o);a((n=n.apply(t,e)).next())});var tD=HD((qJ,pl)=>{"use strict";function xe(t,e){if(!t)throw"First parameter is required.";e=e||{type:"video"},e=new KC(t,e);var n=this;function i(f){return e.disableLogs||console.log("RecordRTC version: ",n.version),f&&(e=new KC(t,f)),e.disableLogs||console.log("started recording "+e.type+" stream."),g?(g.clearRecordedData(),g.record(),d("recording"),n.recordingDuration&&l(),n):(r(function(){n.recordingDuration&&l()}),n)}function r(f){f&&(e.initCallback=function(){f(),f=e.initCallback=null});var b=new r$(t,e);g=new b(t,e),g.record(),d("recording"),e.disableLogs||console.log("Initialized recorderType:",g.constructor.name,"for output-type:",e.type)}function s(f){if(f=f||function(){},!g){p();return}if(n.state==="paused"){n.resumeRecording(),setTimeout(function(){s(f)},1);return}n.state!=="recording"&&!e.disableLogs&&console.warn('Recording state should be: "recording", however current state is: ',n.state),e.disableLogs||console.log("Stopped recording "+e.type+" stream."),e.type!=="gif"?g.stop(b):(g.stop(),b()),d("stopped");function b(_){if(!g){typeof f.call=="function"?f.call(n,""):f("");return}Object.keys(g).forEach(function(A){typeof g[A]!="function"&&(n[A]=g[A])});var v=g.blob;if(!v)if(_)g.blob=v=_;else throw"Recording failed.";if(v&&!e.disableLogs&&console.log(v.type,"->",hw(v.size)),f){var x;try{x=Jt.createObjectURL(v)}catch{}typeof f.call=="function"?f.call(n,x):f(x)}e.autoWriteToDisk&&u(function(A){var I={};I[e.type+"Blob"]=A,tr.Store(I)})}}function o(){if(!g){p();return}if(n.state!=="recording"){e.disableLogs||console.warn("Unable to pause the recording. Recording state: ",n.state);return}d("paused"),g.pause(),e.disableLogs||console.log("Paused recording.")}function a(){if(!g){p();return}if(n.state!=="paused"){e.disableLogs||console.warn("Unable to resume the recording. Recording state: ",n.state);return}d("recording"),g.resume(),e.disableLogs||console.log("Resumed recording.")}function c(f){postMessage(new FileReaderSync().readAsDataURL(f))}function u(f,b){if(!f)throw"Pass a callback function over getDataURL.";var _=b?b.blob:(g||{}).blob;if(!_){e.disableLogs||console.warn("Blob encoder did not finish its job yet."),setTimeout(function(){u(f,b)},1e3);return}if(typeof Worker<"u"&&!navigator.mozGetUserMedia){var v=A(c);v.onmessage=function(I){f(I.data)},v.postMessage(_)}else{var x=new FileReader;x.readAsDataURL(_),x.onload=function(I){f(I.target.result)}}function A(I){try{var V=Jt.createObjectURL(new Blob([I.toString(),"this.onmessage =  function (eee) {"+I.name+"(eee.data);}"],{type:"application/javascript"})),G=new Worker(V);return Jt.revokeObjectURL(V),G}catch{}}}function l(f){if(f=f||0,n.state==="paused"){setTimeout(function(){l(f)},1e3);return}if(n.state!=="stopped"){if(f>=n.recordingDuration){s(n.onRecordingStopped);return}f+=1e3,setTimeout(function(){l(f)},1e3)}}function d(f){n&&(n.state=f,typeof n.onStateChanged.call=="function"?n.onStateChanged.call(n,f):n.onStateChanged(f))}var h='It seems that recorder is destroyed or "startRecording" is not invoked for '+e.type+" recorder.";function p(){e.disableLogs!==!0&&console.warn(h)}var g,y={startRecording:i,stopRecording:s,pauseRecording:o,resumeRecording:a,initRecorder:r,setRecordingDuration:function(f,b){if(typeof f>"u")throw"recordingDuration is required.";if(typeof f!="number")throw"recordingDuration must be a number.";return n.recordingDuration=f,n.onRecordingStopped=b||function(){},{onRecordingStopped:function(_){n.onRecordingStopped=_}}},clearRecordedData:function(){if(!g){p();return}g.clearRecordedData(),e.disableLogs||console.log("Cleared old recorded data.")},getBlob:function(){if(!g){p();return}return g.blob},getDataURL:u,toURL:function(){if(!g){p();return}return Jt.createObjectURL(g.blob)},getInternalRecorder:function(){return g},save:function(f){if(!g){p();return}QC(g.blob,f)},getFromDisk:function(f){if(!g){p();return}xe.getFromDisk(e.type,f)},setAdvertisementArray:function(f){e.advertisement=[];for(var b=f.length,_=0;_<b;_++)e.advertisement.push({duration:_,image:f[_]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){n.state==="recording"&&!e.disableLogs&&console.warn("Stop an active recorder."),g&&typeof g.clearRecordedData=="function"&&g.clearRecordedData(),g=null,d("inactive"),n.blob=null},onStateChanged:function(f){e.disableLogs||console.log("Recorder state changed:",f)},state:"inactive",getState:function(){return n.state},destroy:function(){var f=e.disableLogs;e={disableLogs:!0},n.reset(),d("destroyed"),y=n=null,gc.AudioContextConstructor&&(gc.AudioContextConstructor.close(),gc.AudioContextConstructor=null),e.disableLogs=f,e.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.6.2"};if(!this)return n=y,y;for(var m in y)this[m]=y[m];return n=this,y}xe.version="5.6.2";typeof pl<"u"&&(pl.exports=xe);typeof define=="function"&&define.amd&&define("RecordRTC",[],function(){return xe});xe.getFromDisk=function(t,e){if(!e)throw"callback is mandatory.";console.log("Getting recorded "+(t==="all"?"blobs":t+" blob ")+" from disk!"),tr.Fetch(function(n,i){t!=="all"&&i===t+"Blob"&&e&&e(n),t==="all"&&e&&e(n,i.replace("Blob",""))})};xe.writeToDisk=function(t){console.log("Writing recorded blob(s) to disk!"),t=t||{},t.audio&&t.video&&t.gif?t.audio.getDataURL(function(e){t.video.getDataURL(function(n){t.gif.getDataURL(function(i){tr.Store({audioBlob:e,videoBlob:n,gifBlob:i})})})}):t.audio&&t.video?t.audio.getDataURL(function(e){t.video.getDataURL(function(n){tr.Store({audioBlob:e,videoBlob:n})})}):t.audio&&t.gif?t.audio.getDataURL(function(e){t.gif.getDataURL(function(n){tr.Store({audioBlob:e,gifBlob:n})})}):t.video&&t.gif?t.video.getDataURL(function(e){t.gif.getDataURL(function(n){tr.Store({videoBlob:e,gifBlob:n})})}):t.audio?t.audio.getDataURL(function(e){tr.Store({audioBlob:e})}):t.video?t.video.getDataURL(function(e){tr.Store({videoBlob:e})}):t.gif&&t.gif.getDataURL(function(e){tr.Store({gifBlob:e})})};function KC(t,e){return!e.recorderType&&!e.type&&(e.audio&&e.video?e.type="video":e.audio&&!e.video&&(e.type="audio")),e.recorderType&&!e.type&&(e.recorderType===hp||e.recorderType===up||typeof fl<"u"&&e.recorderType===fl?e.type="video":e.recorderType===lp?e.type="gif":e.recorderType===dp?e.type="audio":e.recorderType===oi&&(Vt(t,"audio").length&&Vt(t,"video").length||!Vt(t,"audio").length&&Vt(t,"video").length?e.type="video":Vt(t,"audio").length&&!Vt(t,"video").length&&(e.type="audio"))),typeof oi<"u"&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(e.mimeType||(e.mimeType="video/webm"),e.type||(e.type=e.mimeType.split("/")[0]),e.bitsPerSecond),e.type||(e.mimeType&&(e.type=e.mimeType.split("/")[0]),e.type||(e.type="audio")),e}function r$(t,e){var n;return(Ms||dw||ap)&&(n=dp),typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&!Ms&&(n=oi),e.type==="video"&&(Ms||ap)&&(n=hp,typeof fl<"u"&&typeof ReadableStream<"u"&&(n=fl)),e.type==="gif"&&(n=lp),e.type==="canvas"&&(n=up),Oo()&&n!==up&&n!==lp&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(Vt(t,"video").length||Vt(t,"audio").length)&&(e.type==="audio"?typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("audio/webm")&&(n=oi):typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("video/webm")&&(n=oi)),t instanceof Array&&t.length&&(n=eD),e.recorderType&&(n=e.recorderType),!e.disableLogs&&n&&n.name&&console.log("Using recorderType:",n.name||n.constructor.name),!n&&cp&&(n=oi),n}function lw(t){this.addStream=function(e){e&&(t=e)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var e=this.mediaType,n,i=this.mimeType||{audio:null,video:null,gif:null};if(typeof e.audio!="function"&&Oo()&&!Vt(t,"audio").length&&(e.audio=!1),typeof e.video!="function"&&Oo()&&!Vt(t,"video").length&&(e.video=!1),typeof e.gif!="function"&&Oo()&&!Vt(t,"video").length&&(e.gif=!1),!e.audio&&!e.video&&!e.gif)throw"MediaStream must have either audio or video tracks.";if(e.audio&&(n=null,typeof e.audio=="function"&&(n=e.audio),this.audioRecorder=new xe(t,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:n,mimeType:i.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),e.video||this.audioRecorder.startRecording()),e.video){n=null,typeof e.video=="function"&&(n=e.video);var r=t;if(Oo()&&e.audio&&typeof e.audio=="function"){var s=Vt(t,"video")[0];YC?(r=new nr,r.addTrack(s),n&&n===hp&&(n=oi)):(r=new nr,r.addTrack(s))}this.videoRecorder=new xe(r,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:n,mimeType:i.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),e.audio||this.videoRecorder.startRecording()}if(e.audio&&e.video){var o=this,a=Oo()===!0;(e.audio instanceof dp&&e.video||e.audio!==!0&&e.video!==!0&&e.audio!==e.video)&&(a=!1),a===!0?(o.audioRecorder=null,o.videoRecorder.startRecording()):o.videoRecorder.initRecorder(function(){o.audioRecorder.initRecorder(function(){o.videoRecorder.startRecording(),o.audioRecorder.startRecording()})})}e.gif&&(n=null,typeof e.gif=="function"&&(n=e.gif),this.gifRecorder=new xe(t,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:n,mimeType:i.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(e){e=e||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(n){e(n,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(n){e(n,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(n){e(n,"gif")})},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(e){var n={};return this.audioRecorder&&(n.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(n.video=this.videoRecorder.getBlob()),this.gifRecorder&&(n.gif=this.gifRecorder.getBlob()),e&&e(n),n},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(e){this.getBlob(function(r){r.audio&&r.video?n(r.audio,function(s){n(r.video,function(o){e({audio:s,video:o})})}):r.audio?n(r.audio,function(s){e({audio:s})}):r.video&&n(r.video,function(s){e({video:s})})});function n(r,s){if(typeof Worker<"u"){var o=i(function(u){postMessage(new FileReaderSync().readAsDataURL(u))});o.onmessage=function(c){s(c.data)},o.postMessage(r)}else{var a=new FileReader;a.readAsDataURL(r),a.onload=function(c){s(c.target.result)}}}function i(r){var s=Jt.createObjectURL(new Blob([r.toString(),"this.onmessage =  function (eee) {"+r.name+"(eee.data);}"],{type:"application/javascript"})),o=new Worker(s),a;if(typeof Jt<"u")a=Jt;else if(typeof webkitURL<"u")a=webkitURL;else throw"Neither URL nor webkitURL detected.";return a.revokeObjectURL(s),o}},this.writeToDisk=function(){xe.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(e){e=e||{audio:!0,video:!0,gif:!0},e.audio&&this.audioRecorder&&this.audioRecorder.save(typeof e.audio=="string"?e.audio:""),e.video&&this.videoRecorder&&this.videoRecorder.save(typeof e.video=="string"?e.video:""),e.gif&&this.gifRecorder&&this.gifRecorder.save(typeof e.gif=="string"?e.gif:"")}}lw.getFromDisk=xe.getFromDisk;lw.writeToDisk=xe.writeToDisk;typeof xe<"u"&&(xe.MRecordRTC=lw);var s$="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(t){t&&(typeof window<"u"||typeof global>"u"||(global.navigator={userAgent:s$,getUserMedia:function(){}},global.console||(global.console={}),(typeof global.console.log>"u"||typeof global.console.error>"u")&&(global.console.error=global.console.log=global.console.log||function(){console.log(arguments)}),typeof document>"u"&&(t.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return e},t.HTMLVideoElement=function(){}),typeof location>"u"&&(t.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(t.screen={width:0,height:0}),typeof Jt>"u"&&(t.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),t.window=global))})(typeof global<"u"?global:null);var As=window.requestAnimationFrame;typeof As>"u"&&(typeof webkitRequestAnimationFrame<"u"?As=webkitRequestAnimationFrame:typeof mozRequestAnimationFrame<"u"?As=mozRequestAnimationFrame:typeof msRequestAnimationFrame<"u"?As=msRequestAnimationFrame:typeof As>"u"&&(cw=0,As=function(t,e){var n=new Date().getTime(),i=Math.max(0,16-(n-cw)),r=setTimeout(function(){t(n+i)},i);return cw=n+i,r}));var cw,No=window.cancelAnimationFrame;typeof No>"u"&&(typeof webkitCancelAnimationFrame<"u"?No=webkitCancelAnimationFrame:typeof mozCancelAnimationFrame<"u"?No=mozCancelAnimationFrame:typeof msCancelAnimationFrame<"u"?No=msCancelAnimationFrame:typeof No>"u"&&(No=function(t){clearTimeout(t)}));var hl=window.AudioContext;typeof hl>"u"&&(typeof webkitAudioContext<"u"&&(hl=webkitAudioContext),typeof mozAudioContext<"u"&&(hl=mozAudioContext));var Jt=window.URL;typeof Jt>"u"&&typeof webkitURL<"u"&&(Jt=webkitURL);typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var dw=navigator.userAgent.indexOf("Edge")!==-1&&(!!navigator.msSaveBlob||!!navigator.msSaveOrOpenBlob),ap=!!window.opera||navigator.userAgent.indexOf("OPR/")!==-1,YC=navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(navigator.userAgent),Ms=!ap&&!dw&&!!navigator.webkitGetUserMedia||ZC()||navigator.userAgent.toLowerCase().indexOf("chrome/")!==-1,cp=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);cp&&!Ms&&navigator.userAgent.indexOf("CriOS")!==-1&&(cp=!1,Ms=!0);var nr=window.MediaStream;typeof nr>"u"&&typeof webkitMediaStream<"u"&&(nr=webkitMediaStream);typeof nr<"u"&&typeof nr.prototype.stop>"u"&&(nr.prototype.stop=function(){this.getTracks().forEach(function(t){t.stop()})});function hw(t){var e=1e3,n=["Bytes","KB","MB","GB","TB"];if(t===0)return"0 Bytes";var i=parseInt(Math.floor(Math.log(t)/Math.log(e)),10);return(t/Math.pow(e,i)).toPrecision(3)+" "+n[i]}function QC(t,e){if(!t)throw"Blob object is required.";if(!t.type)try{t.type="video/webm"}catch{}var n=(t.type||"video/webm").split("/")[1];if(n.indexOf(";")!==-1&&(n=n.split(";")[0]),e&&e.indexOf(".")!==-1){var i=e.split(".");e=i[0],n=i[1]}var r=(e||Math.round(Math.random()*9999999999)+888888888)+"."+n;if(typeof navigator.msSaveOrOpenBlob<"u")return navigator.msSaveOrOpenBlob(t,r);if(typeof navigator.msSaveBlob<"u")return navigator.msSaveBlob(t,r);var s=document.createElement("a");s.href=Jt.createObjectURL(t),s.download=r,s.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(s),typeof s.click=="function"?s.click():(s.target="_blank",s.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),Jt.revokeObjectURL(s.href)}function ZC(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}function Vt(t,e){return!t||!t.getTracks?[]:t.getTracks().filter(function(n){return n.kind===(e||"audio")})}function JC(t,e){"srcObject"in e?e.srcObject=t:"mozSrcObject"in e?e.mozSrcObject=t:e.srcObject=t}function o$(t,e){if(typeof EBML>"u")throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var n=new EBML.Reader,i=new EBML.Decoder,r=EBML.tools,s=new FileReader;s.onload=function(o){var a=i.decode(this.result);a.forEach(function(d){n.read(d)}),n.stop();var c=r.makeMetadataSeekable(n.metadatas,n.duration,n.cues),u=this.result.slice(n.metadataSize),l=new Blob([c,u],{type:"video/webm"});e(l)},s.readAsArrayBuffer(t)}typeof xe<"u"&&(xe.invokeSaveAsDialog=QC,xe.getTracks=Vt,xe.getSeekableBlob=o$,xe.bytesToSize=hw,xe.isElectron=ZC);var gc={};typeof hl<"u"?gc.AudioContext=hl:typeof webkitAudioContext<"u"&&(gc.AudioContext=webkitAudioContext);typeof xe<"u"&&(xe.Storage=gc);function Oo(){if(YC||cp||dw)return!0;var t=navigator.appVersion,e=navigator.userAgent,n=""+parseFloat(navigator.appVersion),i=parseInt(navigator.appVersion,10),r,s,o;return(Ms||ap)&&(s=e.indexOf("Chrome"),n=e.substring(s+7)),(o=n.indexOf(";"))!==-1&&(n=n.substring(0,o)),(o=n.indexOf(" "))!==-1&&(n=n.substring(0,o)),i=parseInt(""+n,10),isNaN(i)&&(n=""+parseFloat(navigator.appVersion),i=parseInt(navigator.appVersion,10)),i>=49}function oi(t,e){var l=this;if(typeof t>"u")throw'First argument "MediaStream" is required.';if(typeof MediaRecorder>"u")throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";if(e=e||{mimeType:"video/webm"},e.type==="audio"){if(Vt(t,"video").length&&Vt(t,"audio").length){var n;navigator.mozGetUserMedia?(n=new nr,n.addTrack(Vt(t,"audio")[0])):n=new nr(Vt(t,"audio")),t=n}(!e.mimeType||e.mimeType.toString().toLowerCase().indexOf("audio")===-1)&&(e.mimeType=Ms?"audio/webm":"audio/ogg"),e.mimeType&&e.mimeType.toString().toLowerCase()!=="audio/ogg"&&navigator.mozGetUserMedia&&(e.mimeType="audio/ogg")}var i=[];this.getArrayOfBlobs=function(){return i},this.record=function(){l.blob=null,l.clearRecordedData(),l.timestamps=[],u=[],i=[];var d=e;e.disableLogs||console.log("Passing following config over MediaRecorder API.",d),a&&(a=null),Ms&&!Oo()&&(d="video/vp8"),typeof MediaRecorder.isTypeSupported=="function"&&d.mimeType&&(MediaRecorder.isTypeSupported(d.mimeType)||(e.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",d.mimeType),d.mimeType=e.type==="audio"?"audio/webm":"video/webm"));try{a=new MediaRecorder(t,d),e.mimeType=d.mimeType}catch{a=new MediaRecorder(t)}d.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in a&&a.canRecordMimeType(d.mimeType)===!1&&(e.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",d.mimeType)),a.ondataavailable=function(h){if(h.data&&u.push("ondataavailable: "+hw(h.data.size)),typeof e.timeSlice=="number"){if(h.data&&h.data.size&&(i.push(h.data),r(),typeof e.ondataavailable=="function")){var p=e.getNativeBlob?h.data:new Blob([h.data],{type:s(d)});e.ondataavailable(p)}return}if(!h.data||!h.data.size||h.data.size<100||l.blob){l.recordingCallback&&(l.recordingCallback(new Blob([],{type:s(d)})),l.recordingCallback=null);return}l.blob=e.getNativeBlob?h.data:new Blob([h.data],{type:s(d)}),l.recordingCallback&&(l.recordingCallback(l.blob),l.recordingCallback=null)},a.onstart=function(){u.push("started")},a.onpause=function(){u.push("paused")},a.onresume=function(){u.push("resumed")},a.onstop=function(){u.push("stopped")},a.onerror=function(h){h&&(h.name||(h.name="UnknownError"),u.push("error: "+h),e.disableLogs||(h.name.toString().toLowerCase().indexOf("invalidstate")!==-1?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",h):h.name.toString().toLowerCase().indexOf("notsupported")!==-1?console.error("MIME type (",d.mimeType,") is not supported.",h):h.name.toString().toLowerCase().indexOf("security")!==-1?console.error("MediaRecorder security error",h):h.name==="OutOfMemory"?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",h):h.name==="IllegalStreamModification"?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",h):h.name==="OtherRecordingError"?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",h):h.name==="GenericError"?console.error("The UA cannot provide the codec or recording option that has been requested.",h):console.error("MediaRecorder Error",h)),function(p){if(!l.manuallyStopped&&a&&a.state==="inactive"){delete e.timeslice,a.start(10*60*1e3);return}setTimeout(p,1e3)}(),a.state!=="inactive"&&a.state!=="stopped"&&a.stop())},typeof e.timeSlice=="number"?(r(),a.start(e.timeSlice)):a.start(36e5),e.initCallback&&e.initCallback()},this.timestamps=[];function r(){l.timestamps.push(new Date().getTime()),typeof e.onTimeStamp=="function"&&e.onTimeStamp(l.timestamps[l.timestamps.length-1],l.timestamps)}function s(d){return a&&a.mimeType?a.mimeType:d.mimeType||"video/webm"}this.stop=function(d){d=d||function(){},l.manuallyStopped=!0,a&&(this.recordingCallback=d,a.state==="recording"&&a.stop(),typeof e.timeSlice=="number"&&setTimeout(function(){l.blob=new Blob(i,{type:s(e)}),l.recordingCallback(l.blob)},100))},this.pause=function(){a&&a.state==="recording"&&a.pause()},this.resume=function(){a&&a.state==="paused"&&a.resume()},this.clearRecordedData=function(){a&&a.state==="recording"&&l.stop(o),o()};function o(){i=[],a=null,l.timestamps=[]}var a;this.getInternalRecorder=function(){return a};function c(){if("active"in t){if(!t.active)return!1}else if("ended"in t&&t.ended)return!1;return!0}this.blob=null,this.getState=function(){return a&&a.state||"inactive"};var u=[];this.getAllStates=function(){return u},typeof e.checkForInactiveTracks>"u"&&(e.checkForInactiveTracks=!1);var l=this;(function d(){if(!(!a||e.checkForInactiveTracks===!1)){if(c()===!1){e.disableLogs||console.log("MediaStream seems stopped."),l.stop();return}setTimeout(d,1e3)}})(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}typeof xe<"u"&&(xe.MediaStreamRecorder=oi);function dp(t,e){if(!Vt(t,"audio").length)throw"Your stream has no audio tracks.";e=e||{};var n=this,i=[],r=[],s=!1,o=0,a,c=2,u=e.desiredSampRate;e.leftChannel===!0&&(c=1),e.numberOfAudioChannels===1&&(c=1),(!c||c<1)&&(c=2),e.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+c),typeof e.checkForInactiveTracks>"u"&&(e.checkForInactiveTracks=!0);function l(){if(e.checkForInactiveTracks===!1)return!0;if("active"in t){if(!t.active)return!1}else if("ended"in t&&t.ended)return!1;return!0}this.record=function(){if(l()===!1)throw"Please make sure MediaStream is active.";_(),x=b=!1,s=!0,typeof e.timeSlice<"u"&&V()};function d(G,w){function M(X,D){var z=X.numberOfAudioChannels,O=X.leftBuffers.slice(0),K=X.rightBuffers.slice(0),W=X.sampleRate,q=X.internalInterleavedLength,$=X.desiredSampRate;z===2&&(O=Me(O,q),K=Me(K,q),$&&(O=ee(O,$,W),K=ee(K,$,W))),z===1&&(O=Me(O,q),$&&(O=ee(O,$,W))),$&&(W=$);function ee(de,le,tt){var be=Math.round(de.length*(le/tt)),T=[],E=Number((de.length-1)/(be-1));T[0]=de[0];for(var N=1;N<be-1;N++){var J=N*E,Y=Number(Math.floor(J)).toFixed(),te=Number(Math.ceil(J)).toFixed(),me=J-Y;T[N]=se(de[Y],de[te],me)}return T[be-1]=de[de.length-1],T}function se(de,le,tt){return de+(le-de)*tt}function Me(de,le){for(var tt=new Float64Array(le),be=0,T=de.length,E=0;E<T;E++){var N=de[E];tt.set(N,be),be+=N.length}return tt}function H(de,le){for(var tt=de.length+le.length,be=new Float64Array(tt),T=0,E=0;E<tt;)be[E++]=de[T],be[E++]=le[T],T++;return be}function Q(de,le,tt){for(var be=tt.length,T=0;T<be;T++)de.setUint8(le+T,tt.charCodeAt(T))}var ce;z===2&&(ce=H(O,K)),z===1&&(ce=O);var we=ce.length,Te=44+we*2,he=new ArrayBuffer(Te),Ce=new DataView(he);Q(Ce,0,"RIFF"),Ce.setUint32(4,36+we*2,!0),Q(Ce,8,"WAVE"),Q(Ce,12,"fmt "),Ce.setUint32(16,16,!0),Ce.setUint16(20,1,!0),Ce.setUint16(22,z,!0),Ce.setUint32(24,W,!0),Ce.setUint32(28,W*z*2,!0),Ce.setUint16(32,z*2,!0),Ce.setUint16(34,16,!0),Q(Ce,36,"data"),Ce.setUint32(40,we*2,!0);for(var ke=we,P=44,Bt=1,Ee=0;Ee<ke;Ee++)Ce.setInt16(P,ce[Ee]*(32767*Bt),!0),P+=2;if(D)return D({buffer:he,view:Ce});postMessage({buffer:he,view:Ce})}if(G.noWorker){M(G,function(X){w(X.buffer,X.view)});return}var j=h(M);j.onmessage=function(X){w(X.data.buffer,X.data.view),Jt.revokeObjectURL(j.workerURL),j.terminate()},j.postMessage(G)}function h(G){var w=Jt.createObjectURL(new Blob([G.toString(),";this.onmessage =  function (eee) {"+G.name+"(eee.data);}"],{type:"application/javascript"})),M=new Worker(w);return M.workerURL=w,M}this.stop=function(G){G=G||function(){},s=!1,d({desiredSampRate:u,sampleRate:f,numberOfAudioChannels:c,internalInterleavedLength:o,leftBuffers:i,rightBuffers:c===1?[]:r,noWorker:e.noWorker},function(w,M){n.blob=new Blob([M],{type:"audio/wav"}),n.buffer=new ArrayBuffer(M.buffer.byteLength),n.view=M,n.sampleRate=u||f,n.bufferSize=m,n.length=o,x=!1,G&&G(n.blob)})},typeof xe.Storage>"u"&&(xe.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),(!xe.Storage.AudioContextConstructor||xe.Storage.AudioContextConstructor.state==="closed")&&(xe.Storage.AudioContextConstructor=new xe.Storage.AudioContext);var p=xe.Storage.AudioContextConstructor,g=p.createMediaStreamSource(t),y=[0,256,512,1024,2048,4096,8192,16384],m=typeof e.bufferSize>"u"?4096:e.bufferSize;if(y.indexOf(m)===-1&&(e.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(y,null,"	"))),p.createJavaScriptNode)a=p.createJavaScriptNode(m,c,c);else if(p.createScriptProcessor)a=p.createScriptProcessor(m,c,c);else throw"WebAudio API has no support on this browser.";g.connect(a),e.bufferSize||(m=a.bufferSize);var f=typeof e.sampleRate<"u"?e.sampleRate:p.sampleRate||44100;(f<22050||f>96e3)&&(e.disableLogs||console.log("sample-rate must be under range 22050 and 96000.")),e.disableLogs||e.desiredSampRate&&console.log("Desired sample-rate: "+e.desiredSampRate);var b=!1;this.pause=function(){b=!0},this.resume=function(){if(l()===!1)throw"Please make sure MediaStream is active.";if(!s){e.disableLogs||console.log("Seems recording has been restarted."),this.record();return}b=!1},this.clearRecordedData=function(){e.checkForInactiveTracks=!1,s&&this.stop(v),v()};function _(){i=[],r=[],o=0,x=!1,s=!1,b=!1,p=null,n.leftchannel=i,n.rightchannel=r,n.numberOfAudioChannels=c,n.desiredSampRate=u,n.sampleRate=f,n.recordingLength=o,I={left:[],right:[],recordingLength:0}}function v(){a&&(a.onaudioprocess=null,a.disconnect(),a=null),g&&(g.disconnect(),g=null),_()}this.name="StereoAudioRecorder",this.toString=function(){return this.name};var x=!1;function A(G){if(!b){if(l()===!1&&(e.disableLogs||console.log("MediaStream seems stopped."),a.disconnect(),s=!1),!s){g&&(g.disconnect(),g=null);return}x||(x=!0,e.onAudioProcessStarted&&e.onAudioProcessStarted(),e.initCallback&&e.initCallback());var w=G.inputBuffer.getChannelData(0),M=new Float32Array(w);if(i.push(M),c===2){var j=G.inputBuffer.getChannelData(1),X=new Float32Array(j);r.push(X)}o+=m,n.recordingLength=o,typeof e.timeSlice<"u"&&(I.recordingLength+=m,I.left.push(M),c===2&&I.right.push(X))}}a.onaudioprocess=A,p.createMediaStreamDestination?a.connect(p.createMediaStreamDestination()):a.connect(p.destination),this.leftchannel=i,this.rightchannel=r,this.numberOfAudioChannels=c,this.desiredSampRate=u,this.sampleRate=f,n.recordingLength=o;var I={left:[],right:[],recordingLength:0};function V(){!s||typeof e.ondataavailable!="function"||typeof e.timeSlice>"u"||(I.left.length?(d({desiredSampRate:u,sampleRate:f,numberOfAudioChannels:c,internalInterleavedLength:I.recordingLength,leftBuffers:I.left,rightBuffers:c===1?[]:I.right},function(G,w){var M=new Blob([w],{type:"audio/wav"});e.ondataavailable(M),setTimeout(V,e.timeSlice)}),I={left:[],right:[],recordingLength:0}):setTimeout(V,e.timeSlice))}}typeof xe<"u"&&(xe.StereoAudioRecorder=dp);function up(t,e){if(typeof html2canvas>"u")throw"Please link: https://www.webrtc-experiment.com/screenshot.js";e=e||{},e.frameInterval||(e.frameInterval=10);var n=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(y){y in document.createElement("canvas")&&(n=!0)});var i=(!!window.webkitRTCPeerConnection||!!window.webkitGetUserMedia)&&!!window.chrome,r=50,s=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);i&&s&&s[2]&&(r=parseInt(s[2],10)),i&&r<52&&(n=!1),e.useWhammyRecorder&&(n=!1);var o,a;if(n)if(e.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),t instanceof HTMLCanvasElement)o=t;else if(t instanceof CanvasRenderingContext2D)o=t.canvas;else throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";else navigator.mozGetUserMedia&&(e.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));var c;this.record=function(){if(c=!0,n&&!e.useWhammyRecorder){var y;"captureStream"in o?y=o.captureStream(25):"mozCaptureStream"in o?y=o.mozCaptureStream(25):"webkitCaptureStream"in o&&(y=o.webkitCaptureStream(25));try{var m=new nr;m.addTrack(Vt(y,"video")[0]),y=m}catch{}if(!y)throw"captureStream API are NOT available.";a=new oi(y,{mimeType:e.mimeType||"video/webm"}),a.record()}else g.frames=[],p=new Date().getTime(),h();e.initCallback&&e.initCallback()},this.getWebPImages=function(y){if(t.nodeName.toLowerCase()!=="canvas"){y();return}var m=g.frames.length;g.frames.forEach(function(f,b){var _=m-b;e.disableLogs||console.log(_+"/"+m+" frames remaining"),e.onEncodingCallback&&e.onEncodingCallback(_,m);var v=f.image.toDataURL("image/webp",1);g.frames[b].image=v}),e.disableLogs||console.log("Generating WebM"),y()},this.stop=function(y){c=!1;var m=this;if(n&&a){a.stop(y);return}this.getWebPImages(function(){g.compile(function(f){e.disableLogs||console.log("Recording finished!"),m.blob=f,m.blob.forEach&&(m.blob=new Blob([],{type:"video/webm"})),y&&y(m.blob),g.frames=[]})})};var u=!1;this.pause=function(){if(u=!0,a instanceof oi){a.pause();return}},this.resume=function(){if(u=!1,a instanceof oi){a.resume();return}c||this.record()},this.clearRecordedData=function(){c&&this.stop(l),l()};function l(){g.frames=[],c=!1,u=!1}this.name="CanvasRecorder",this.toString=function(){return this.name};function d(){var y=document.createElement("canvas"),m=y.getContext("2d");return y.width=t.width,y.height=t.height,m.drawImage(t,0,0),y}function h(){if(u)return p=new Date().getTime(),setTimeout(h,500);if(t.nodeName.toLowerCase()==="canvas"){var y=new Date().getTime()-p;p=new Date().getTime(),g.frames.push({image:d(),duration:y}),c&&setTimeout(h,e.frameInterval);return}html2canvas(t,{grabMouse:typeof e.showMousePointer>"u"||e.showMousePointer,onrendered:function(m){var f=new Date().getTime()-p;if(!f)return setTimeout(h,e.frameInterval);p=new Date().getTime(),g.frames.push({image:m.toDataURL("image/webp",1),duration:f}),c&&setTimeout(h,e.frameInterval)}})}var p=new Date().getTime(),g=new fw.Video(100)}typeof xe<"u"&&(xe.CanvasRecorder=up);function hp(t,e){e=e||{},e.frameInterval||(e.frameInterval=10),e.disableLogs||console.log("Using frames-interval:",e.frameInterval),this.record=function(){e.width||(e.width=320),e.height||(e.height=240),e.video||(e.video={width:e.width,height:e.height}),e.canvas||(e.canvas={width:e.width,height:e.height}),c.width=e.canvas.width||320,c.height=e.canvas.height||240,u=c.getContext("2d"),e.video&&e.video instanceof HTMLVideoElement?(l=e.video.cloneNode(),e.initCallback&&e.initCallback()):(l=document.createElement("video"),JC(t,l),l.onloadedmetadata=function(){e.initCallback&&e.initCallback()},l.width=e.video.width,l.height=e.video.height),l.muted=!0,l.play(),d=new Date().getTime(),h=new fw.Video,e.disableLogs||(console.log("canvas resolutions",c.width,"*",c.height),console.log("video width/height",l.width||c.width,"*",l.height||c.height)),n(e.frameInterval)};function n(p){p=typeof p<"u"?p:10;var g=new Date().getTime()-d;if(!g)return setTimeout(n,p,p);if(o)return d=new Date().getTime(),setTimeout(n,100);d=new Date().getTime(),l.paused&&l.play(),u.drawImage(l,0,0,c.width,c.height),h.frames.push({duration:g,image:c.toDataURL("image/webp")}),s||setTimeout(n,p,p)}function i(p){var g=-1,y=p.length;(function m(){if(g++,g===y){p.callback();return}setTimeout(function(){p.functionToLoop(m,g)},1)})()}function r(p,g,y,m,f){var b=document.createElement("canvas");b.width=c.width,b.height=c.height;var _=b.getContext("2d"),v=[],x=g===-1,A=g&&g>0&&g<=p.length?g:p.length,I={r:0,g:0,b:0},V=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),G=y&&y>=0&&y<=1?y:0,w=m&&m>=0&&m<=1?m:0,M=!1;i({length:A,functionToLoop:function(j,X){var D,z,O,K=function(){!M&&O-D<=O*w||(x&&(M=!0),v.push(p[X])),j()};if(M)K();else{var W=new Image;W.onload=function(){_.drawImage(W,0,0,c.width,c.height);var q=_.getImageData(0,0,c.width,c.height);D=0,z=q.data.length,O=q.data.length/4;for(var $=0;$<z;$+=4){var ee={r:q.data[$],g:q.data[$+1],b:q.data[$+2]},se=Math.sqrt(Math.pow(ee.r-I.r,2)+Math.pow(ee.g-I.g,2)+Math.pow(ee.b-I.b,2));se<=V*G&&D++}K()},W.src=p[X].image}},callback:function(){v=v.concat(p.slice(A)),v.length<=0&&v.push(p[p.length-1]),f(v)}})}var s=!1;this.stop=function(p){p=p||function(){},s=!0;var g=this;setTimeout(function(){r(h.frames,-1,null,null,function(y){h.frames=y,e.advertisement&&e.advertisement.length&&(h.frames=e.advertisement.concat(h.frames)),h.compile(function(m){g.blob=m,g.blob.forEach&&(g.blob=new Blob([],{type:"video/webm"})),p&&p(g.blob)})})},10)};var o=!1;this.pause=function(){o=!0},this.resume=function(){o=!1,s&&this.record()},this.clearRecordedData=function(){s||this.stop(a),a()};function a(){h.frames=[],s=!0,o=!1}this.name="WhammyRecorder",this.toString=function(){return this.name};var c=document.createElement("canvas"),u=c.getContext("2d"),l,d,h}typeof xe<"u"&&(xe.WhammyRecorder=hp);var fw=function(){function t(i){this.frames=[],this.duration=i||1,this.quality=.8}t.prototype.add=function(i,r){if("canvas"in i&&(i=i.canvas),"toDataURL"in i&&(i=i.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/ig.test(i))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:i,duration:r||this.duration})};function e(i){var r=Jt.createObjectURL(new Blob([i.toString(),"this.onmessage =  function (eee) {"+i.name+"(eee.data);}"],{type:"application/javascript"})),s=new Worker(r);return Jt.revokeObjectURL(r),s}function n(i){function r(b){var _=o(b);if(!_)return[];for(var v=3e4,x=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:m(_.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:_.width,id:176},{data:_.height,id:186}]}]}]}]}],A=0,I=0;A<b.length;){var V=[],G=0;do V.push(b[A]),G+=b[A].duration,A++;while(A<b.length&&G<v);var w=0,M={id:524531317,data:s(I,w,V)};x[1].data.push(M),I+=G}return l(x)}function s(b,_,v){return[{data:b,id:231}].concat(v.map(function(x){var A=h({discardable:0,frame:x.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(_)});return _+=x.duration,{data:A,id:163}}))}function o(b){if(!b[0]){postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});return}for(var _=b[0].width,v=b[0].height,x=b[0].duration,A=1;A<b.length;A++)x+=b[A].duration;return{duration:x,width:_,height:v}}function a(b){for(var _=[];b>0;)_.push(b&255),b=b>>8;return new Uint8Array(_.reverse())}function c(b){return new Uint8Array(b.split("").map(function(_){return _.charCodeAt(0)}))}function u(b){var _=[],v=b.length%8?new Array(9-b.length%8).join("0"):"";b=v+b;for(var x=0;x<b.length;x+=8)_.push(parseInt(b.substr(x,8),2));return new Uint8Array(_)}function l(b){for(var _=[],v=0;v<b.length;v++){var x=b[v].data;typeof x=="object"&&(x=l(x)),typeof x=="number"&&(x=u(x.toString(2))),typeof x=="string"&&(x=c(x));var A=x.size||x.byteLength||x.length,I=Math.ceil(Math.ceil(Math.log(A)/Math.log(2))/8),V=A.toString(2),G=new Array(I*7+7+1-V.length).join("0")+V,w=new Array(I).join("0")+"1"+G;_.push(a(b[v].id)),_.push(u(w)),_.push(x)}return new Blob(_,{type:"video/webm"})}function d(b){var _="",v=b.length%8?new Array(9-b.length%8).join("0"):"";b=v+b;for(var x=0;x<b.length;x+=8)_+=String.fromCharCode(parseInt(b.substr(x,8),2));return _}function h(b){var _=0;if(b.keyframe&&(_|=128),b.invisible&&(_|=8),b.lacing&&(_|=b.lacing<<1),b.discardable&&(_|=1),b.trackNum>127)throw"TrackNumber > 127 not supported";var v=[b.trackNum|128,b.timecode>>8,b.timecode&255,_].map(function(x){return String.fromCharCode(x)}).join("")+b.frame;return v}function p(b){for(var _=b.RIFF[0].WEBP[0],v=_.indexOf("\x9D*"),x=0,A=[];x<4;x++)A[x]=_.charCodeAt(v+3+x);var I,V,G;return G=A[1]<<8|A[0],I=G&16383,G=A[3]<<8|A[2],V=G&16383,{width:I,height:V,data:_,riff:b}}function g(b,_){return parseInt(b.substr(_+4,4).split("").map(function(v){var x=v.charCodeAt(0).toString(2);return new Array(8-x.length+1).join("0")+x}).join(""),2)}function y(b){for(var _=0,v={};_<b.length;){var x=b.substr(_,4),A=g(b,_),I=b.substr(_+4+4,A);_+=8+A,v[x]=v[x]||[],x==="RIFF"||x==="LIST"?v[x].push(y(I)):v[x].push(I)}return v}function m(b){return[].slice.call(new Uint8Array(new Float64Array([b]).buffer),0).map(function(_){return String.fromCharCode(_)}).reverse().join("")}var f=new r(i.map(function(b){var _=p(y(atob(b.image.slice(23))));return _.duration=b.duration,_}));postMessage(f)}return t.prototype.compile=function(i){var r=e(n);r.onmessage=function(s){if(s.data.error){console.error(s.data.error);return}i(s.data)},r.postMessage(this.frames)},{Video:t}}();typeof xe<"u"&&(xe.Whammy=fw);var tr={init:function(){var t=this;if(typeof indexedDB>"u"||typeof indexedDB.open>"u"){console.error("IndexedDB API are not available in this browser.");return}var e=1,n=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),i,r=indexedDB.open(n,e);function s(a){a.createObjectStore(t.dataStoreName)}function o(){var a=i.transaction([t.dataStoreName],"readwrite");t.videoBlob&&a.objectStore(t.dataStoreName).put(t.videoBlob,"videoBlob"),t.gifBlob&&a.objectStore(t.dataStoreName).put(t.gifBlob,"gifBlob"),t.audioBlob&&a.objectStore(t.dataStoreName).put(t.audioBlob,"audioBlob");function c(u){a.objectStore(t.dataStoreName).get(u).onsuccess=function(l){t.callback&&t.callback(l.target.result,u)}}c("audioBlob"),c("videoBlob"),c("gifBlob")}r.onerror=t.onError,r.onsuccess=function(){if(i=r.result,i.onerror=t.onError,i.setVersion)if(i.version!==e){var a=i.setVersion(e);a.onsuccess=function(){s(i),o()}}else o();else o()},r.onupgradeneeded=function(a){s(a.target.result)}},Fetch:function(t){return this.callback=t,this.init(),this},Store:function(t){return this.audioBlob=t.audioBlob,this.videoBlob=t.videoBlob,this.gifBlob=t.gifBlob,this.init(),this},onError:function(t){console.error(JSON.stringify(t,null,"	"))},dataStoreName:"recordRTC",dbName:null};typeof xe<"u"&&(xe.DiskStorage=tr);function lp(t,e){if(typeof GIFEncoder>"u"){var n=document.createElement("script");n.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(n)}e=e||{};var i=t instanceof CanvasRenderingContext2D||t instanceof HTMLCanvasElement;this.record=function(){if(typeof GIFEncoder>"u"){setTimeout(y.record,1e3);return}if(!c){setTimeout(y.record,1e3);return}i||(e.width||(e.width=u.offsetWidth||320),e.height||(e.height=u.offsetHeight||240),e.video||(e.video={width:e.width,height:e.height}),e.canvas||(e.canvas={width:e.width,height:e.height}),o.width=e.canvas.width||320,o.height=e.canvas.height||240,u.width=e.video.width||320,u.height=e.video.height||240),g=new GIFEncoder,g.setRepeat(0),g.setDelay(e.frameRate||200),g.setQuality(e.quality||10),g.start(),typeof e.onGifRecordingStarted=="function"&&e.onGifRecordingStarted(),d=Date.now();function m(f){if(y.clearedRecordedData!==!0){if(r)return setTimeout(function(){m(f)},100);l=As(m),typeof p===void 0&&(p=f),!(f-p<90)&&(!i&&u.paused&&u.play(),i||a.drawImage(u,0,0,o.width,o.height),e.onGifPreview&&e.onGifPreview(o.toDataURL("image/png")),g.addFrame(a),p=f)}}l=As(m),e.initCallback&&e.initCallback()},this.stop=function(m){m=m||function(){},l&&No(l),h=Date.now(),this.blob=new Blob([new Uint8Array(g.stream().bin)],{type:"image/gif"}),m(this.blob),g.stream().bin=[]};var r=!1;this.pause=function(){r=!0},this.resume=function(){r=!1},this.clearRecordedData=function(){y.clearedRecordedData=!0,s()};function s(){g&&(g.stream().bin=[])}this.name="GifRecorder",this.toString=function(){return this.name};var o=document.createElement("canvas"),a=o.getContext("2d");i&&(t instanceof CanvasRenderingContext2D?(a=t,o=a.canvas):t instanceof HTMLCanvasElement&&(a=t.getContext("2d"),o=t));var c=!0;if(!i){var u=document.createElement("video");u.muted=!0,u.autoplay=!0,u.playsInline=!0,c=!1,u.onloadedmetadata=function(){c=!0},JC(t,u),u.play()}var l=null,d,h,p,g,y=this}typeof xe<"u"&&(xe.GifRecorder=lp);function uw(t,e){var n="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(v){typeof xe<"u"||v&&(typeof window<"u"||typeof global>"u"||(global.navigator={userAgent:n,getUserMedia:function(){}},global.console||(global.console={}),(typeof global.console.log>"u"||typeof global.console.error>"u")&&(global.console.error=global.console.log=global.console.log||function(){console.log(arguments)}),typeof document>"u"&&(v.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var x={getContext:function(){return x},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return x},v.HTMLVideoElement=function(){}),typeof location>"u"&&(v.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(v.screen={width:0,height:0}),typeof u>"u"&&(v.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),v.window=global))})(typeof global<"u"?global:null),e=e||"multi-streams-mixer";var i=[],r=!1,s=document.createElement("canvas"),o=s.getContext("2d");s.style.opacity=0,s.style.position="absolute",s.style.zIndex=-1,s.style.top="-1000em",s.style.left="-1000em",s.className=e,(document.body||document.documentElement).appendChild(s),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var a=this,c=window.AudioContext;typeof c>"u"&&(typeof webkitAudioContext<"u"&&(c=webkitAudioContext),typeof mozAudioContext<"u"&&(c=mozAudioContext));var u=window.URL;typeof u>"u"&&typeof webkitURL<"u"&&(u=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var l=window.MediaStream;typeof l>"u"&&typeof webkitMediaStream<"u"&&(l=webkitMediaStream),typeof l<"u"&&typeof l.prototype.stop>"u"&&(l.prototype.stop=function(){this.getTracks().forEach(function(v){v.stop()})});var d={};typeof c<"u"?d.AudioContext=c:typeof webkitAudioContext<"u"&&(d.AudioContext=webkitAudioContext);function h(v,x){"srcObject"in x?x.srcObject=v:"mozSrcObject"in x?x.mozSrcObject=v:x.srcObject=v}this.startDrawingFrames=function(){p()};function p(){if(!r){var v=i.length,x=!1,A=[];if(i.forEach(function(V){V.stream||(V.stream={}),V.stream.fullcanvas?x=V:A.push(V)}),x)s.width=x.stream.width,s.height=x.stream.height;else if(A.length){s.width=v>1?A[0].width*2:A[0].width;var I=1;(v===3||v===4)&&(I=2),(v===5||v===6)&&(I=3),(v===7||v===8)&&(I=4),(v===9||v===10)&&(I=5),s.height=A[0].height*I}else s.width=a.width||360,s.height=a.height||240;x&&x instanceof HTMLVideoElement&&g(x),A.forEach(function(V,G){g(V,G)}),setTimeout(p,a.frameInterval)}}function g(v,x){if(!r){var A=0,I=0,V=v.width,G=v.height;x===1&&(A=v.width),x===2&&(I=v.height),x===3&&(A=v.width,I=v.height),x===4&&(I=v.height*2),x===5&&(A=v.width,I=v.height*2),x===6&&(I=v.height*3),x===7&&(A=v.width,I=v.height*3),typeof v.stream.left<"u"&&(A=v.stream.left),typeof v.stream.top<"u"&&(I=v.stream.top),typeof v.stream.width<"u"&&(V=v.stream.width),typeof v.stream.height<"u"&&(G=v.stream.height),o.drawImage(v,A,I,V,G),typeof v.stream.onRender=="function"&&v.stream.onRender(o,A,I,V,G,x)}}function y(){r=!1;var v=m(),x=f();x&&x.getTracks().filter(function(I){return I.kind==="audio"}).forEach(function(I){v.addTrack(I)});var A;return t.forEach(function(I){I.fullcanvas&&(A=!0)}),v}function m(){_();var v;"captureStream"in s?v=s.captureStream():"mozCaptureStream"in s?v=s.mozCaptureStream():a.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var x=new l;return v.getTracks().filter(function(A){return A.kind==="video"}).forEach(function(A){x.addTrack(A)}),s.stream=x,x}function f(){d.AudioContextConstructor||(d.AudioContextConstructor=new d.AudioContext),a.audioContext=d.AudioContextConstructor,a.audioSources=[],a.useGainNode===!0&&(a.gainNode=a.audioContext.createGain(),a.gainNode.connect(a.audioContext.destination),a.gainNode.gain.value=0);var v=0;if(t.forEach(function(x){if(x.getTracks().filter(function(I){return I.kind==="audio"}).length){v++;var A=a.audioContext.createMediaStreamSource(x);a.useGainNode===!0&&A.connect(a.gainNode),a.audioSources.push(A)}}),!!v)return a.audioDestination=a.audioContext.createMediaStreamDestination(),a.audioSources.forEach(function(x){x.connect(a.audioDestination)}),a.audioDestination.stream}function b(v){var x=document.createElement("video");return h(v,x),x.className=e,x.muted=!0,x.volume=0,x.width=v.width||a.width||360,x.height=v.height||a.height||240,x.play(),x}this.appendStreams=function(v){if(!v)throw"First parameter is required.";v instanceof Array||(v=[v]),v.forEach(function(x){var A=new l;if(x.getTracks().filter(function(G){return G.kind==="video"}).length){var I=b(x);I.stream=x,i.push(I),A.addTrack(x.getTracks().filter(function(G){return G.kind==="video"})[0])}if(x.getTracks().filter(function(G){return G.kind==="audio"}).length){var V=a.audioContext.createMediaStreamSource(x);a.audioDestination=a.audioContext.createMediaStreamDestination(),V.connect(a.audioDestination),A.addTrack(a.audioDestination.stream.getTracks().filter(function(G){return G.kind==="audio"})[0])}t.push(A)})},this.releaseStreams=function(){i=[],r=!0,a.gainNode&&(a.gainNode.disconnect(),a.gainNode=null),a.audioSources.length&&(a.audioSources.forEach(function(v){v.disconnect()}),a.audioSources=[]),a.audioDestination&&(a.audioDestination.disconnect(),a.audioDestination=null),a.audioContext&&a.audioContext.close(),a.audioContext=null,o.clearRect(0,0,s.width,s.height),s.stream&&(s.stream.stop(),s.stream=null)},this.resetVideoStreams=function(v){v&&!(v instanceof Array)&&(v=[v]),_(v)};function _(v){i=[],v=v||t,v.forEach(function(x){if(x.getTracks().filter(function(I){return I.kind==="video"}).length){var A=b(x);A.stream=x,i.push(A)}})}this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=y}typeof xe>"u"&&(typeof pl<"u"&&(pl.exports=uw),typeof define=="function"&&define.amd&&define("MultiStreamsMixer",[],function(){return uw}));function eD(t,e){t=t||[];var n=this,i,r;e=e||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}},e.frameInterval||(e.frameInterval=10),e.video||(e.video={}),e.video.width||(e.video.width=360),e.video.height||(e.video.height=240),this.record=function(){i=new uw(t,e.elementClass||"multi-streams-mixer"),s().length&&(i.frameInterval=e.frameInterval||10,i.width=e.video.width||360,i.height=e.video.height||240,i.startDrawingFrames()),e.previewStream&&typeof e.previewStream=="function"&&e.previewStream(i.getMixedStream()),r=new oi(i.getMixedStream(),e),r.record()};function s(){var o=[];return t.forEach(function(a){Vt(a,"video").forEach(function(c){o.push(c)})}),o}this.stop=function(o){r&&r.stop(function(a){n.blob=a,o(a),n.clearRecordedData()})},this.pause=function(){r&&r.pause()},this.resume=function(){r&&r.resume()},this.clearRecordedData=function(){r&&(r.clearRecordedData(),r=null),i&&(i.releaseStreams(),i=null)},this.addStreams=function(o){if(!o)throw"First parameter is required.";o instanceof Array||(o=[o]),t.concat(o),!(!r||!i)&&(i.appendStreams(o),e.previewStream&&typeof e.previewStream=="function"&&e.previewStream(i.getMixedStream()))},this.resetVideoStreams=function(o){i&&(o&&!(o instanceof Array)&&(o=[o]),i.resetVideoStreams(o))},this.getMixer=function(){return i},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}typeof xe<"u"&&(xe.MultiStreamRecorder=eD);function a$(t,e){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if(typeof t>"u")throw'First argument "MediaStream" is required.';var n=this;n.recordRTC=new xe(t,e),this.startRecording=function(){return new Promise(function(i,r){try{n.recordRTC.startRecording(),i()}catch(s){r(s)}})},this.stopRecording=function(){return new Promise(function(i,r){try{n.recordRTC.stopRecording(function(s){if(n.blob=n.recordRTC.getBlob(),!n.blob||!n.blob.size){r("Empty blob.",n.blob);return}i(s)})}catch(s){r(s)}})},this.pauseRecording=function(){return new Promise(function(i,r){try{n.recordRTC.pauseRecording(),i()}catch(s){r(s)}})},this.resumeRecording=function(){return new Promise(function(i,r){try{n.recordRTC.resumeRecording(),i()}catch(s){r(s)}})},this.getDataURL=function(i){return new Promise(function(r,s){try{n.recordRTC.getDataURL(function(o){r(o)})}catch(o){s(o)}})},this.getBlob=function(){return new Promise(function(i,r){try{i(n.recordRTC.getBlob())}catch(s){r(s)}})},this.getInternalRecorder=function(){return new Promise(function(i,r){try{i(n.recordRTC.getInternalRecorder())}catch(s){r(s)}})},this.reset=function(){return new Promise(function(i,r){try{i(n.recordRTC.reset())}catch(s){r(s)}})},this.destroy=function(){return new Promise(function(i,r){try{i(n.recordRTC.destroy())}catch(s){r(s)}})},this.getState=function(){return new Promise(function(i,r){try{i(n.recordRTC.getState())}catch(s){r(s)}})},this.blob=null,this.version="5.6.2"}typeof xe<"u"&&(xe.RecordRTCPromisesHandler=a$);function fl(t,e){(typeof ReadableStream>"u"||typeof WritableStream>"u")&&console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),e=e||{},e.width=e.width||640,e.height=e.height||480,e.frameRate=e.frameRate||30,e.bitrate=e.bitrate||1200,e.realtime=e.realtime||!0;function n(l,d){return Jt.createObjectURL(new Blob([l],{type:d||""}))}var i;function r(){return new ReadableStream({start:function(l){var d=document.createElement("canvas"),h=document.createElement("video"),p=!0;h.srcObject=t,h.muted=!0,h.height=e.height,h.width=e.width,h.volume=0,h.onplaying=function(){d.width=e.width,d.height=e.height;var g=d.getContext("2d"),y=1e3/e.frameRate,m=setInterval(function(){if(i&&(clearInterval(m),l.close()),p&&(p=!1,e.onVideoProcessStarted&&e.onVideoProcessStarted()),g.drawImage(h,0,0),l._controlledReadableStream.state!=="closed")try{l.enqueue(g.getImageData(0,0,e.width,e.height))}catch{}},y)},h.play()}})}var s;function o(l,d){if(!e.workerPath&&!d){i=!1,fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then(function(p){p.arrayBuffer().then(function(g){o(l,g)})});return}if(!e.workerPath&&d instanceof ArrayBuffer){var h=new Blob([d],{type:"text/javascript"});e.workerPath=Jt.createObjectURL(h)}e.workerPath||console.error("workerPath parameter is missing."),s=new Worker(e.workerPath),s.postMessage(e.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),s.addEventListener("message",function(p){p.data==="READY"?(s.postMessage({width:e.width,height:e.height,bitrate:e.bitrate||1200,timebaseDen:e.frameRate||30,realtime:e.realtime}),r().pipeTo(new WritableStream({write:function(g){if(i){console.error("Got image, but recorder is finished!");return}s.postMessage(g.data.buffer,[g.data.buffer])}}))):p.data&&(a||u.push(p.data))})}this.record=function(){u=[],a=!1,this.blob=null,o(t),typeof e.initCallback=="function"&&e.initCallback()};var a;this.pause=function(){a=!0},this.resume=function(){a=!1};function c(l){if(!s){l&&l();return}s.addEventListener("message",function(d){d.data===null&&(s.terminate(),s=null,l&&l())}),s.postMessage(null)}var u=[];this.stop=function(l){i=!0;var d=this;c(function(){d.blob=new Blob(u,{type:"video/webm"}),l(d.blob)})},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){u=[],a=!1,this.blob=null},this.blob=null}typeof xe<"u"&&(xe.WebAssemblyRecorder=fl)});var Lw=null;var bp=1,kw=Symbol("SIGNAL");function On(t){let e=Lw;return Lw=t,e}var Fw={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function jD(t){if(!(Tp(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===bp)){if(!t.producerMustRecompute(t)&&!xp(t)){t.dirty=!1,t.lastCleanEpoch=bp;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=bp}}function Uw(t){return t&&(t.nextProducerIndex=0),On(t)}function Vw(t,e){if(On(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(Tp(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)Sp(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function xp(t){El(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],i=t.producerLastReadVersion[e];if(i!==n.version||(jD(n),i!==n.version))return!0}return!1}function Bw(t){if(El(t),Tp(t))for(let e=0;e<t.producerNode.length;e++)Sp(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function Sp(t,e){if($D(t),El(t),t.liveConsumerNode.length===1)for(let i=0;i<t.producerNode.length;i++)Sp(t.producerNode[i],t.producerIndexOfThis[i]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let i=t.liveConsumerIndexOfThis[e],r=t.liveConsumerNode[e];El(r),r.producerIndexOfThis[i]=e}}function Tp(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function El(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function $D(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function qD(){throw new Error}var XD=qD;function zw(t){XD=t}function Ue(t){return typeof t=="function"}function ko(t){let n=t(i=>{Error.call(i),i.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var bl=ko(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((i,r)=>`${r+1}) ${i.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function Rs(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var At=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:i}=this;if(Ue(i))try{i()}catch(s){e=s instanceof bl?s.errors:[s]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let s of r)try{Hw(s)}catch(o){e=e??[],o instanceof bl?e=[...e,...o.errors]:e.push(o)}}if(e)throw new bl(e)}}add(e){var n;if(e&&e!==this)if(this.closed)Hw(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&Rs(n,e)}remove(e){let{_finalizers:n}=this;n&&Rs(n,e),e instanceof t&&e._removeParent(this)}};At.EMPTY=(()=>{let t=new At;return t.closed=!0,t})();var Ip=At.EMPTY;function xl(t){return t instanceof At||t&&"closed"in t&&Ue(t.remove)&&Ue(t.add)&&Ue(t.unsubscribe)}function Hw(t){Ue(t)?t():t.unsubscribe()}var ai={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Fo={setTimeout(t,e,...n){let{delegate:i}=Fo;return i?.setTimeout?i.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=Fo;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Sl(t){Fo.setTimeout(()=>{let{onUnhandledError:e}=ai;if(e)e(t);else throw t})}function Ec(){}var Gw=Ap("C",void 0,void 0);function Ww(t){return Ap("E",void 0,t)}function jw(t){return Ap("N",t,void 0)}function Ap(t,e,n){return{kind:t,value:e,error:n}}var Ps=null;function Uo(t){if(ai.useDeprecatedSynchronousErrorHandling){let e=!Ps;if(e&&(Ps={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:i}=Ps;if(Ps=null,n)throw i}}else t()}function $w(t){ai.useDeprecatedSynchronousErrorHandling&&Ps&&(Ps.errorThrown=!0,Ps.error=t)}var Ns=class extends At{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,xl(e)&&e.add(this)):this.destination=QD}static create(e,n,i){return new Vo(e,n,i)}next(e){this.isStopped?Cp(jw(e),this):this._next(e)}error(e){this.isStopped?Cp(Ww(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Cp(Gw,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},KD=Function.prototype.bind;function Mp(t,e){return KD.call(t,e)}var Dp=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(i){Tl(i)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(i){Tl(i)}else Tl(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){Tl(n)}}},Vo=class extends Ns{constructor(e,n,i){super();let r;if(Ue(e)||!e)r={next:e??void 0,error:n??void 0,complete:i??void 0};else{let s;this&&ai.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&Mp(e.next,s),error:e.error&&Mp(e.error,s),complete:e.complete&&Mp(e.complete,s)}):r=e}this.destination=new Dp(r)}};function Tl(t){ai.useDeprecatedSynchronousErrorHandling?$w(t):Sl(t)}function YD(t){throw t}function Cp(t,e){let{onStoppedNotification:n}=ai;n&&Fo.setTimeout(()=>n(t,e))}var QD={closed:!0,next:Ec,error:YD,complete:Ec};var Bo=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Ln(t){return t}function Rp(...t){return Pp(t)}function Pp(t){return t.length===0?Ln:t.length===1?t[0]:function(n){return t.reduce((i,r)=>r(i),n)}}var ct=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let i=new t;return i.source=this,i.operator=n,i}subscribe(n,i,r){let s=JD(n)?n:new Vo(n,i,r);return Uo(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(i){n.error(i)}}forEach(n,i){return i=qw(i),new i((r,s)=>{let o=new Vo({next:a=>{try{n(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(n){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(n)}[Bo](){return this}pipe(...n){return Pp(n)(this)}toPromise(n){return n=qw(n),new n((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return t.create=e=>new t(e),t})();function qw(t){var e;return(e=t??ai.Promise)!==null&&e!==void 0?e:Promise}function ZD(t){return t&&Ue(t.next)&&Ue(t.error)&&Ue(t.complete)}function JD(t){return t&&t instanceof Ns||ZD(t)&&xl(t)}function Np(t){return Ue(t?.lift)}function rt(t){return e=>{if(Np(e))return e.lift(function(n){try{return t(n,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function st(t,e,n,i,r){return new Op(t,e,n,i,r)}var Op=class extends Ns{constructor(e,n,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(c){e.error(c)}}:super._next,this._error=r?function(a){try{r(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function zo(){return rt((t,e)=>{let n=null;t._refCount++;let i=st(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let r=t._connection,s=n;n=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});t.subscribe(i),i.closed||(n=t.connect())})}var Ho=class extends ct{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Np(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new At;let n=this.getSubject();e.add(this.source.subscribe(st(n,void 0,()=>{this._teardown(),n.complete()},i=>{this._teardown(),n.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=At.EMPTY)}return e}refCount(){return zo()(this)}};var Xw=ko(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var fn=(()=>{class t extends ct{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let i=new Il(this,this);return i.operator=n,i}_throwIfClosed(){if(this.closed)throw new Xw}next(n){Uo(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let i of this.currentObservers)i.next(n)}})}error(n){Uo(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:i}=this;for(;i.length;)i.shift().error(n)}})}complete(){Uo(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:i,isStopped:r,observers:s}=this;return i||r?Ip:(this.currentObservers=null,s.push(n),new At(()=>{this.currentObservers=null,Rs(s,n)}))}_checkFinalizedStatuses(n){let{hasError:i,thrownError:r,isStopped:s}=this;i?n.error(r):s&&n.complete()}asObservable(){let n=new ct;return n.source=this,n}}return t.create=(e,n)=>new Il(e,n),t})(),Il=class extends fn{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.next)===null||i===void 0||i.call(n,e)}error(e){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.error)===null||i===void 0||i.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,i;return(i=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&i!==void 0?i:Ip}};var tn=class extends fn{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:i}=this;if(e)throw n;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}};var Lp={now(){return(Lp.delegate||Date).now()},delegate:void 0};var Al=class extends At{constructor(e,n){super()}schedule(e,n=0){return this}};var bc={setInterval(t,e,...n){let{delegate:i}=bc;return i?.setInterval?i.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=bc;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var Go=class extends Al{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var i;if(this.closed)return this;this.state=e;let r=this.id,s=this.scheduler;return r!=null&&(this.id=this.recycleAsyncId(s,r,n)),this.pending=!0,this.delay=n,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,i=0){return bc.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,n,i=0){if(i!=null&&this.delay===i&&this.pending===!1)return n;n!=null&&bc.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let i=this._execute(e,n);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let i=!1,r;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:i}=n;this.work=this.state=this.scheduler=null,this.pending=!1,Rs(i,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var Wo=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,i){return new this.schedulerActionCtor(this,e).schedule(i,n)}};Wo.now=Lp.now;var jo=class extends Wo{constructor(e,n=Wo.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let i;this._active=!0;do if(i=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,i){for(;e=n.shift();)e.unsubscribe();throw i}}};var kp=new jo(Go);var Ml=class extends Go{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,i=0){return i!=null&&i>0||i==null&&this.delay>0?super.requestAsyncId(e,n,i):(e.flush(this),0)}};var Cl=class extends jo{};var Fp=new Cl(Ml);var qn=new ct(t=>t.complete());function Kw(t){return t&&Ue(t.schedule)}function Yw(t){return t[t.length-1]}function Qw(t){return Ue(Yw(t))?t.pop():void 0}function Fr(t){return Kw(Yw(t))?t.pop():void 0}function Up(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n}function Jw(t,e,n,i){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(l){try{u(i.next(l))}catch(d){o(d)}}function c(l){try{u(i.throw(l))}catch(d){o(d)}}function u(l){l.done?s(l.value):r(l.value).then(a,c)}u((i=i.apply(t,e||[])).next())})}function Zw(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Os(t){return this instanceof Os?(this.v=t,this):new Os(t)}function eE(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(t,e||[]),r,s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(h){i[h]&&(r[h]=function(p){return new Promise(function(g,y){s.push([h,p,g,y])>1||a(h,p)})})}function a(h,p){try{c(i[h](p))}catch(g){d(s[0][3],g)}}function c(h){h.value instanceof Os?Promise.resolve(h.value.v).then(u,l):d(s[0][2],h)}function u(h){a("next",h)}function l(h){a("throw",h)}function d(h,p){h(p),s.shift(),s.length&&a(s[0][0],s[0][1])}}function tE(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Zw=="function"?Zw(t):t[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(s){n[s]=t[s]&&function(o){return new Promise(function(a,c){o=t[s](o),r(a,c,o.done,o.value)})}}function r(s,o,a,c){Promise.resolve(c).then(function(u){s({value:u,done:a})},o)}}var Dl=t=>t&&typeof t.length=="number"&&typeof t!="function";function Rl(t){return Ue(t?.then)}function Pl(t){return Ue(t[Bo])}function Nl(t){return Symbol.asyncIterator&&Ue(t?.[Symbol.asyncIterator])}function Ol(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function eR(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Ll=eR();function kl(t){return Ue(t?.[Ll])}function Fl(t){return eE(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:i,done:r}=yield Os(n.read());if(r)return yield Os(void 0);yield yield Os(i)}}finally{n.releaseLock()}})}function Ul(t){return Ue(t?.getReader)}function qt(t){if(t instanceof ct)return t;if(t!=null){if(Pl(t))return tR(t);if(Dl(t))return nR(t);if(Rl(t))return iR(t);if(Nl(t))return nE(t);if(kl(t))return rR(t);if(Ul(t))return sR(t)}throw Ol(t)}function tR(t){return new ct(e=>{let n=t[Bo]();if(Ue(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function nR(t){return new ct(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function iR(t){return new ct(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,Sl)})}function rR(t){return new ct(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function nE(t){return new ct(e=>{oR(t,e).catch(n=>e.error(n))})}function sR(t){return nE(Fl(t))}function oR(t,e){var n,i,r,s;return Jw(this,void 0,void 0,function*(){try{for(n=tE(t);i=yield n.next(),!i.done;){let o=i.value;if(e.next(o),e.closed)return}}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=n.return)&&(yield s.call(n))}finally{if(r)throw r.error}}e.complete()})}function In(t,e,n,i=0,r=!1){let s=e.schedule(function(){n(),r?t.add(this.schedule(null,i)):this.unsubscribe()},i);if(t.add(s),!r)return s}function Ur(t,e=0){return rt((n,i)=>{n.subscribe(st(i,r=>In(i,t,()=>i.next(r),e),()=>In(i,t,()=>i.complete(),e),r=>In(i,t,()=>i.error(r),e)))})}function Vr(t,e=0){return rt((n,i)=>{i.add(t.schedule(()=>n.subscribe(i),e))})}function iE(t,e){return qt(t).pipe(Vr(e),Ur(e))}function rE(t,e){return qt(t).pipe(Vr(e),Ur(e))}function sE(t,e){return new ct(n=>{let i=0;return e.schedule(function(){i===t.length?n.complete():(n.next(t[i++]),n.closed||this.schedule())})})}function oE(t,e){return new ct(n=>{let i;return In(n,e,()=>{i=t[Ll](),In(n,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){n.error(o);return}s?n.complete():n.next(r)},0,!0)}),()=>Ue(i?.return)&&i.return()})}function Vl(t,e){if(!t)throw new Error("Iterable cannot be null");return new ct(n=>{In(n,e,()=>{let i=t[Symbol.asyncIterator]();In(n,e,()=>{i.next().then(r=>{r.done?n.complete():n.next(r.value)})},0,!0)})})}function aE(t,e){return Vl(Fl(t),e)}function cE(t,e){if(t!=null){if(Pl(t))return iE(t,e);if(Dl(t))return sE(t,e);if(Rl(t))return rE(t,e);if(Nl(t))return Vl(t,e);if(kl(t))return oE(t,e);if(Ul(t))return aE(t,e)}throw Ol(t)}function zt(t,e){return e?cE(t,e):qt(t)}function ze(...t){let e=Fr(t);return zt(t,e)}function $o(t,e){let n=Ue(t)?t:()=>t,i=r=>r.error(n());return new ct(e?r=>e.schedule(i,0,r):i)}function Vp(t){return!!t&&(t instanceof ct||Ue(t.lift)&&Ue(t.subscribe))}var sr=ko(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function ot(t,e){return rt((n,i)=>{let r=0;n.subscribe(st(i,s=>{i.next(t.call(e,s,r++))}))})}var{isArray:aR}=Array;function cR(t,e){return aR(e)?t(...e):t(e)}function uE(t){return ot(e=>cR(t,e))}var{isArray:uR}=Array,{getPrototypeOf:lR,prototype:dR,keys:hR}=Object;function lE(t){if(t.length===1){let e=t[0];if(uR(e))return{args:e,keys:null};if(fR(e)){let n=hR(e);return{args:n.map(i=>e[i]),keys:n}}}return{args:t,keys:null}}function fR(t){return t&&typeof t=="object"&&lR(t)===dR}function dE(t,e){return t.reduce((n,i,r)=>(n[i]=e[r],n),{})}function Bl(...t){let e=Fr(t),n=Qw(t),{args:i,keys:r}=lE(t);if(i.length===0)return zt([],e);let s=new ct(pR(i,e,r?o=>dE(r,o):Ln));return n?s.pipe(uE(n)):s}function pR(t,e,n=Ln){return i=>{hE(e,()=>{let{length:r}=t,s=new Array(r),o=r,a=r;for(let c=0;c<r;c++)hE(e,()=>{let u=zt(t[c],e),l=!1;u.subscribe(st(i,d=>{s[c]=d,l||(l=!0,a--),a||i.next(n(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}function hE(t,e,n){t?In(n,t,e):e()}function fE(t,e,n,i,r,s,o,a){let c=[],u=0,l=0,d=!1,h=()=>{d&&!c.length&&!u&&e.complete()},p=y=>u<i?g(y):c.push(y),g=y=>{s&&e.next(y),u++;let m=!1;qt(n(y,l++)).subscribe(st(e,f=>{r?.(f),s?p(f):e.next(f)},()=>{m=!0},void 0,()=>{if(m)try{for(u--;c.length&&u<i;){let f=c.shift();o?In(e,o,()=>g(f)):g(f)}h()}catch(f){e.error(f)}}))};return t.subscribe(st(e,p,()=>{d=!0,h()})),()=>{a?.()}}function Ht(t,e,n=1/0){return Ue(e)?Ht((i,r)=>ot((s,o)=>e(i,s,r,o))(qt(t(i,r))),n):(typeof e=="number"&&(n=e),rt((i,r)=>fE(i,r,t,n)))}function Bp(t=1/0){return Ht(Ln,t)}function pE(){return Bp(1)}function qo(...t){return pE()(zt(t,Fr(t)))}function zl(t){return new ct(e=>{qt(t()).subscribe(e)})}function ci(t,e){return rt((n,i)=>{let r=0;n.subscribe(st(i,s=>t.call(e,s,r++)&&i.next(s)))})}function Br(t){return rt((e,n)=>{let i=null,r=!1,s;i=e.subscribe(st(n,void 0,void 0,o=>{s=qt(t(o,Br(t)(e))),i?(i.unsubscribe(),i=null,s.subscribe(n)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(n))})}function mE(t,e,n,i,r){return(s,o)=>{let a=n,c=e,u=0;s.subscribe(st(o,l=>{let d=u++;c=a?t(c,l,d):(a=!0,l),i&&o.next(c)},r&&(()=>{a&&o.next(c),o.complete()})))}}function Xo(t,e){return Ue(e)?Ht(t,e,1):Ht(t,1)}function zr(t){return rt((e,n)=>{let i=!1;e.subscribe(st(n,r=>{i=!0,n.next(r)},()=>{i||n.next(t),n.complete()}))})}function or(t){return t<=0?()=>qn:rt((e,n)=>{let i=0;e.subscribe(st(n,r=>{++i<=t&&(n.next(r),t<=i&&n.complete())}))})}function zp(t){return ot(()=>t)}function Hl(t=mR){return rt((e,n)=>{let i=!1;e.subscribe(st(n,r=>{i=!0,n.next(r)},()=>i?n.complete():n.error(t())))})}function mR(){return new sr}function xc(t){return rt((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function Ci(t,e){let n=arguments.length>=2;return i=>i.pipe(t?ci((r,s)=>t(r,s,i)):Ln,or(1),n?zr(e):Hl(()=>new sr))}function Ko(t){return t<=0?()=>qn:rt((e,n)=>{let i=[];e.subscribe(st(n,r=>{i.push(r),t<i.length&&i.shift()},()=>{for(let r of i)n.next(r);n.complete()},void 0,()=>{i=null}))})}function Hp(t,e){let n=arguments.length>=2;return i=>i.pipe(t?ci((r,s)=>t(r,s,i)):Ln,Ko(1),n?zr(e):Hl(()=>new sr))}function Gp(t,e){return rt(mE(t,e,arguments.length>=2,!0))}function Wp(...t){let e=Fr(t);return rt((n,i)=>{(e?qo(t,n,e):qo(t,n)).subscribe(i)})}function ui(t,e){return rt((n,i)=>{let r=null,s=0,o=!1,a=()=>o&&!r&&i.complete();n.subscribe(st(i,c=>{r?.unsubscribe();let u=0,l=s++;qt(t(c,l)).subscribe(r=st(i,d=>i.next(e?e(c,d,l,u++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function jp(t){return rt((e,n)=>{qt(t).subscribe(st(n,()=>n.complete(),Ec)),!n.closed&&e.subscribe(n)})}function kt(t,e,n){let i=Ue(t)||e||n?{next:t,error:e,complete:n}:t;return i?rt((r,s)=>{var o;(o=i.subscribe)===null||o===void 0||o.call(i);let a=!0;r.subscribe(st(s,c=>{var u;(u=i.next)===null||u===void 0||u.call(i,c),s.next(c)},()=>{var c;a=!1,(c=i.complete)===null||c===void 0||c.call(i),s.complete()},c=>{var u;a=!1,(u=i.error)===null||u===void 0||u.call(i,c),s.error(c)},()=>{var c,u;a&&((c=i.unsubscribe)===null||c===void 0||c.call(i)),(u=i.finalize)===null||u===void 0||u.call(i)}))}):Ln}var ZE="https://g.co/ng/security#xss",Pe=class extends Error{constructor(e,n){super(qm(e,n)),this.code=e}};function qm(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}function wt(t){for(let e in t)if(t[e]===wt)return e;throw Error("Could not find renamed property on target object.")}function An(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(An).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function gE(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var gR=wt({__forward_ref__:wt});function JE(t){return t.__forward_ref__=JE,t.toString=function(){return An(this())},t}function Kn(t){return eb(t)?t():t}function eb(t){return typeof t=="function"&&t.hasOwnProperty(gR)&&t.__forward_ref__===JE}function tb(t){return t&&!!t.\u0275providers}var yR=wt({\u0275cmp:wt}),vR=wt({\u0275dir:wt}),_R=wt({\u0275pipe:wt}),wR=wt({\u0275mod:wt}),Zl=wt({\u0275fac:wt}),Sc=wt({__NG_ELEMENT_ID__:wt}),yE=wt({__NG_ENV_ID__:wt});function nb(t){return typeof t=="string"?t:t==null?"":String(t)}function ER(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():nb(t)}function bR(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new Pe(-200,`Circular dependency in DI detected for ${t}${n}`)}function Xm(t,e){throw new Pe(-201,!1)}function xR(t,e){t==null&&SR(e,t,null,"!=")}function SR(t,e,n,i){throw new Error(`ASSERTION ERROR: ${t}`+(i==null?"":` [Expected=> ${n} ${i} ${e} <=Actual]`))}function Ae(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function ki(t){return{providers:t.providers||[],imports:t.imports||[]}}function fd(t){return vE(t,rb)||vE(t,sb)}function ib(t){return fd(t)!==null}function vE(t,e){return t.hasOwnProperty(e)?t[e]:null}function TR(t){let e=t&&(t[rb]||t[sb]);return e||null}function _E(t){return t&&(t.hasOwnProperty(wE)||t.hasOwnProperty(IR))?t[wE]:null}var rb=wt({\u0275prov:wt}),wE=wt({\u0275inj:wt}),sb=wt({ngInjectableDef:wt}),IR=wt({ngInjectorDef:wt}),Qe=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(Qe||{}),nm;function AR(){return nm}function Xn(t){let e=nm;return nm=t,e}function ob(t,e,n){let i=fd(t);if(i&&i.providedIn=="root")return i.value===void 0?i.value=i.factory():i.value;if(n&Qe.Optional)return null;if(e!==void 0)return e;Xm(t,"Injector")}var Ls=globalThis;var $e=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=Ae({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};var MR={},Ac=MR,im="__NG_DI_FLAG__",Jl="ngTempTokenPath",CR="ngTokenPath",DR=/\n/gm,RR="\u0275",EE="__source",Tc;function Hr(t){let e=Tc;return Tc=t,e}function PR(t,e=Qe.Default){if(Tc===void 0)throw new Pe(-203,!1);return Tc===null?ob(t,void 0,e):Tc.get(t,e&Qe.Optional?null:void 0,e)}function He(t,e=Qe.Default){return(AR()||PR)(Kn(t),e)}function ge(t,e=Qe.Default){return He(t,pd(e))}function pd(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function rm(t){let e=[];for(let n=0;n<t.length;n++){let i=Kn(t[n]);if(Array.isArray(i)){if(i.length===0)throw new Pe(900,!1);let r,s=Qe.Default;for(let o=0;o<i.length;o++){let a=i[o],c=OR(a);typeof c=="number"?c===-1?r=a.token:s|=c:r=a}e.push(He(r,s))}else e.push(He(i))}return e}function NR(t,e){return t[im]=e,t.prototype[im]=e,t}function OR(t){return t[im]}function LR(t,e,n,i){let r=t[Jl];throw e[EE]&&r.unshift(e[EE]),t.message=kR(`
`+t.message,r,n,i),t[CR]=r,t[Jl]=null,t}function kR(t,e,n,i=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==RR?t.slice(2):t;let r=An(e);if(Array.isArray(e))r=e.map(An).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):An(a)))}r=`{${s.join(", ")}}`}return`${n}${i?"("+i+")":""}[${r}]: ${t.replace(DR,`
  `)}`}function Uc(t){return{toString:t}.toString()}var ab=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(ab||{}),Oi=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(Oi||{}),Mc={},Di=[],Gr=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(Gr||{});function cb(t,e,n){let i=t.length;for(;;){let r=t.indexOf(e,n);if(r===-1)return r;if(r===0||t.charCodeAt(r-1)<=32){let s=e.length;if(r+s===i||t.charCodeAt(r+s)<=32)return r}n=r+1}}function sm(t,e,n){let i=0;for(;i<n.length;){let r=n[i];if(typeof r=="number"){if(r!==0)break;i++;let s=n[i++],o=n[i++],a=n[i++];t.setAttribute(e,o,a,s)}else{let s=r,o=n[++i];UR(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),i++}}return i}function FR(t){return t===3||t===4||t===6}function UR(t){return t.charCodeAt(0)===64}function Km(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let i=0;i<e.length;i++){let r=e[i];typeof r=="number"?n=r:n===0||(n===-1||n===2?bE(t,n,r,null,e[++i]):bE(t,n,r,null,null))}}return t}function bE(t,e,n,i,r){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(i===null){r!==null&&(t[s+1]=r);return}else if(i===t[s+1]){t[s+2]=r;return}}s++,i!==null&&s++,r!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),i!==null&&t.splice(s++,0,i),r!==null&&t.splice(s++,0,r)}var ub="ng-template";function VR(t,e,n){let i=0,r=!0;for(;i<t.length;){let s=t[i++];if(typeof s=="string"&&r){let o=t[i++];if(n&&s==="class"&&cb(o.toLowerCase(),e,0)!==-1)return!0}else if(s===1){for(;i<t.length&&typeof(s=t[i++])=="string";)if(s.toLowerCase()===e)return!0;return!1}else typeof s=="number"&&(r=!1)}return!1}function lb(t){return t.type===4&&t.value!==ub}function BR(t,e,n){let i=t.type===4&&!n?ub:t.value;return e===i}function zR(t,e,n){let i=4,r=t.attrs||[],s=WR(r),o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!li(i)&&!li(c))return!1;if(o&&li(c))continue;o=!1,i=c|i&1;continue}if(!o)if(i&4){if(i=2|i&1,c!==""&&!BR(t,c,n)||c===""&&e.length===1){if(li(i))return!1;o=!0}}else{let u=i&8?c:e[++a];if(i&8&&t.attrs!==null){if(!VR(t.attrs,u,n)){if(li(i))return!1;o=!0}continue}let l=i&8?"class":c,d=HR(l,r,lb(t),n);if(d===-1){if(li(i))return!1;o=!0;continue}if(u!==""){let h;d>s?h="":h=r[d+1].toLowerCase();let p=i&8?h:null;if(p&&cb(p,u,0)!==-1||i&2&&u!==h){if(li(i))return!1;o=!0}}}}return li(i)||o}function li(t){return(t&1)===0}function HR(t,e,n,i){if(e===null)return-1;let r=0;if(i||!n){let s=!1;for(;r<e.length;){let o=e[r];if(o===t)return r;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++r];for(;typeof a=="string";)a=e[++r];continue}else{if(o===4)break;if(o===0){r+=4;continue}}r+=s?1:2}return-1}else return jR(e,t)}function GR(t,e,n=!1){for(let i=0;i<e.length;i++)if(zR(t,e[i],n))return!0;return!1}function WR(t){for(let e=0;e<t.length;e++){let n=t[e];if(FR(n))return e}return t.length}function jR(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let i=t[n];if(typeof i=="number")return-1;if(i===e)return n;n++}return-1}function xE(t,e){return t?":not("+e.trim()+")":e}function $R(t){let e=t[0],n=1,i=2,r="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(i&2){let a=t[++n];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else i&8?r+="."+o:i&4&&(r+=" "+o);else r!==""&&!li(o)&&(e+=xE(s,r),r=""),i=o,s=s||!li(i);n++}return r!==""&&(e+=xE(s,r)),e}function qR(t){return t.map($R).join(",")}function XR(t){let e=[],n=[],i=1,r=2;for(;i<t.length;){let s=t[i];if(typeof s=="string")r===2?s!==""&&e.push(s,t[++i]):r===8&&n.push(s);else{if(!li(r))break;r=s}i++}return{attrs:e,classes:n}}function aa(t){return Uc(()=>{let e=mb(t),n=Ct(ve({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===ab.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||Oi.Emulated,styles:t.styles||Di,_:null,schemas:t.schemas||null,tView:null,id:""});gb(n);let i=t.dependencies;return n.directiveDefs=TE(i,!1),n.pipeDefs=TE(i,!0),n.id=QR(n),n})}function KR(t){return Fs(t)||db(t)}function YR(t){return t!==null}function Fi(t){return Uc(()=>({type:t.type,bootstrap:t.bootstrap||Di,declarations:t.declarations||Di,imports:t.imports||Di,exports:t.exports||Di,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function SE(t,e){if(t==null)return Mc;let n={};for(let i in t)if(t.hasOwnProperty(i)){let r=t[i],s,o,a=Gr.None;Array.isArray(r)?(a=r[0],s=r[1],o=r[2]??s):(s=r,o=r),e?(n[s]=a!==Gr.None?[i,a]:i,e[s]=o):n[s]=i}return n}function md(t){return Uc(()=>{let e=mb(t);return gb(e),e})}function Fs(t){return t[yR]||null}function db(t){return t[vR]||null}function hb(t){return t[_R]||null}function fb(t){let e=Fs(t)||db(t)||hb(t);return e!==null?e.standalone:!1}function pb(t,e){let n=t[wR]||null;if(!n&&e===!0)throw new Error(`Type ${An(t)} does not have '\u0275mod' property.`);return n}function mb(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||Mc,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||Di,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:SE(t.inputs,e),outputs:SE(t.outputs),debugInfo:null}}function gb(t){t.features?.forEach(e=>e(t))}function TE(t,e){if(!t)return null;let n=e?hb:KR;return()=>(typeof t=="function"?t():t).map(i=>n(i)).filter(YR)}function QR(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let r of n)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}var dr=0,et=1,Oe=2,nn=3,di=4,fi=5,ed=6,Cc=7,hi=8,ta=9,ar=10,Fn=11,Dc=12,IE=13,ca=14,Li=15,Vc=16,Yo=17,Ni=18,gd=19,yb=20,Ic=21,$p=22,Us=23,Wr=25,vb=1;var Vs=7,td=8,na=9,kn=10,Ym=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(Ym||{});function Jo(t){return Array.isArray(t)&&typeof t[vb]=="object"}function hr(t){return Array.isArray(t)&&t[vb]===!0}function _b(t){return(t.flags&4)!==0}function yd(t){return t.componentOffset>-1}function Qm(t){return(t.flags&1)===1}function Bc(t){return!!t.template}function ZR(t){return(t[Oe]&512)!==0}function ia(t,e){let n=t.hasOwnProperty(Zl);return n?t[Zl]:null}var om=class{constructor(e,n,i){this.previousValue=e,this.currentValue=n,this.firstChange=i}isFirstChange(){return this.firstChange}};function wb(t,e,n,i){e!==null?e.applyValueToInputSignal(e,i):t[n]=i}function vd(){return Eb}function Eb(t){return t.type.prototype.ngOnChanges&&(t.setInput=e1),JR}vd.ngInherit=!0;function JR(){let t=xb(this),e=t?.current;if(e){let n=t.previous;if(n===Mc)t.previous=e;else for(let i in e)n[i]=e[i];t.current=null,this.ngOnChanges(e)}}function e1(t,e,n,i,r){let s=this.declaredInputs[i],o=xb(t)||t1(t,{previous:Mc,current:null}),a=o.current||(o.current={}),c=o.previous,u=c[s];a[s]=new om(u&&u.currentValue,n,c===Mc),wb(t,e,r,n)}var bb="__ngSimpleChanges__";function xb(t){return t[bb]||null}function t1(t,e){return t[bb]=e}var AE=null;var Ri=function(t,e,n){AE?.(t,e,n)},n1="svg",i1="math",r1=!1;function s1(){return r1}function cr(t){for(;Array.isArray(t);)t=t[dr];return t}function pi(t,e){return cr(e[t.index])}function Sb(t,e){return t.data[e]}function Gs(t,e){let n=e[t];return Jo(n)?n:n[dr]}function o1(t){return(t[Oe]&4)===4}function Zm(t){return(t[Oe]&128)===128}function a1(t){return hr(t[nn])}function nd(t,e){return e==null?null:t[e]}function Tb(t){t[Yo]=0}function c1(t){t[Oe]&1024||(t[Oe]|=1024,Zm(t)&&Rc(t))}function u1(t,e){for(;t>0;)e=e[ca],t--;return e}function Ib(t){return t[Oe]&9216||t[Us]?.dirty}function am(t){Ib(t)?Rc(t):t[Oe]&64&&(s1()?(t[Oe]|=1024,Rc(t)):t[ar].changeDetectionScheduler?.notify())}function Rc(t){t[ar].changeDetectionScheduler?.notify();let e=Pc(t);for(;e!==null&&!(e[Oe]&8192||(e[Oe]|=8192,!Zm(e)));)e=Pc(e)}function l1(t,e){if((t[Oe]&256)===256)throw new Pe(911,!1);t[Ic]===null&&(t[Ic]=[]),t[Ic].push(e)}function Pc(t){let e=t[nn];return hr(e)?e[nn]:e}var it={lFrame:Nb(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function d1(){return it.lFrame.elementDepthCount}function h1(){it.lFrame.elementDepthCount++}function f1(){it.lFrame.elementDepthCount--}function Ab(){return it.bindingsEnabled}function p1(){return it.skipHydrationRootTNode!==null}function m1(t){return it.skipHydrationRootTNode===t}function g1(){it.skipHydrationRootTNode=null}function Ft(){return it.lFrame.lView}function fr(){return it.lFrame.tView}function qr(t){return it.lFrame.contextLView=t,t[hi]}function Xr(t){return it.lFrame.contextLView=null,t}function Ui(){let t=Mb();for(;t!==null&&t.type===64;)t=t.parent;return t}function Mb(){return it.lFrame.currentTNode}function y1(){let t=it.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function zc(t,e){let n=it.lFrame;n.currentTNode=t,n.isParent=e}function Cb(){return it.lFrame.isParent}function v1(){it.lFrame.isParent=!1}function _1(t){return it.lFrame.bindingIndex=t}function w1(){return it.lFrame.bindingIndex++}function E1(){return it.lFrame.inI18n}function b1(t,e){let n=it.lFrame;n.bindingIndex=n.bindingRootIndex=t,cm(e)}function x1(){return it.lFrame.currentDirectiveIndex}function cm(t){it.lFrame.currentDirectiveIndex=t}function Db(){return it.lFrame.currentQueryIndex}function Jm(t){it.lFrame.currentQueryIndex=t}function S1(t){let e=t[et];return e.type===2?e.declTNode:e.type===1?t[fi]:null}function Rb(t,e,n){if(n&Qe.SkipSelf){let r=e,s=t;for(;r=r.parent,r===null&&!(n&Qe.Host);)if(r=S1(s),r===null||(s=s[ca],r.type&10))break;if(r===null)return!1;e=r,t=s}let i=it.lFrame=Pb();return i.currentTNode=e,i.lView=t,!0}function eg(t){let e=Pb(),n=t[et];it.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function Pb(){let t=it.lFrame,e=t===null?null:t.child;return e===null?Nb(t):e}function Nb(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function Ob(){let t=it.lFrame;return it.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var Lb=Ob;function tg(){let t=Ob();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function T1(t){return(it.lFrame.contextLView=u1(t,it.lFrame.contextLView))[hi]}function kb(){return it.lFrame.selectedIndex}function Bs(t){it.lFrame.selectedIndex=t}function I1(){let t=it.lFrame;return Sb(t.tView,t.selectedIndex)}function A1(){return it.lFrame.currentNamespace}var Fb=!0;function ng(){return Fb}function ig(t){Fb=t}function M1(t,e,n){let{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){let o=Eb(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}r&&(n.preOrderHooks??=[]).push(0-t,r),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function rg(t,e){for(let n=e.directiveStart,i=e.directiveEnd;n<i;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:u,ngOnDestroy:l}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),c&&(t.viewHooks??=[]).push(-n,c),u&&((t.viewHooks??=[]).push(n,u),(t.viewCheckHooks??=[]).push(n,u)),l!=null&&(t.destroyHooks??=[]).push(n,l)}}function $l(t,e,n){Ub(t,e,3,n)}function ql(t,e,n,i){(t[Oe]&3)===n&&Ub(t,e,n,i)}function qp(t,e){let n=t[Oe];(n&3)===e&&(n&=16383,n+=1,t[Oe]=n)}function Ub(t,e,n,i){let r=i!==void 0?t[Yo]&65535:0,s=i??-1,o=e.length-1,a=0;for(let c=r;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],i!=null&&a>=i)break}else e[c]<0&&(t[Yo]+=65536),(a<s||s==-1)&&(C1(t,n,e,c),t[Yo]=(t[Yo]&4294901760)+c+2),c++}function ME(t,e){Ri(4,t,e);let n=On(null);try{e.call(t)}finally{On(n),Ri(5,t,e)}}function C1(t,e,n,i){let r=n[i]<0,s=n[i+1],o=r?-n[i]:n[i],a=t[o];r?t[Oe]>>14<t[Yo]>>16&&(t[Oe]&3)===e&&(t[Oe]+=16384,ME(a,s)):ME(a,s)}var ea=-1,Nc=class{constructor(e,n,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=i}};function D1(t){return t instanceof Nc}function R1(t){return(t.flags&8)!==0}function P1(t){return(t.flags&16)!==0}function Vb(t){return t!==ea}function id(t){return t&32767}function N1(t){return t>>16}function rd(t,e){let n=N1(t),i=e;for(;n>0;)i=i[ca],n--;return i}var um=!0;function CE(t){let e=um;return um=t,e}var O1=256,Bb=O1-1,zb=5,L1=0,Pi={};function k1(t,e,n){let i;typeof n=="string"?i=n.charCodeAt(0)||0:n.hasOwnProperty(Sc)&&(i=n[Sc]),i==null&&(i=n[Sc]=L1++);let r=i&Bb,s=1<<r;e.data[t+(r>>zb)]|=s}function Hb(t,e){let n=Gb(t,e);if(n!==-1)return n;let i=e[et];i.firstCreatePass&&(t.injectorIndex=e.length,Xp(i.data,t),Xp(e,null),Xp(i.blueprint,null));let r=sg(t,e),s=t.injectorIndex;if(Vb(r)){let o=id(r),a=rd(r,e),c=a[et].data;for(let u=0;u<8;u++)e[s+u]=a[o+u]|c[o+u]}return e[s+8]=r,s}function Xp(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Gb(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function sg(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,i=null,r=e;for(;r!==null;){if(i=Xb(r),i===null)return ea;if(n++,r=r[ca],i.injectorIndex!==-1)return i.injectorIndex|n<<16}return ea}function F1(t,e,n){k1(t,e,n)}function Wb(t,e,n){if(n&Qe.Optional||t!==void 0)return t;Xm(e,"NodeInjector")}function jb(t,e,n,i){if(n&Qe.Optional&&i===void 0&&(i=null),!(n&(Qe.Self|Qe.Host))){let r=t[ta],s=Xn(void 0);try{return r?r.get(e,i,n&Qe.Optional):ob(e,i,n&Qe.Optional)}finally{Xn(s)}}return Wb(i,e,n)}function $b(t,e,n,i=Qe.Default,r){if(t!==null){if(e[Oe]&2048&&!(i&Qe.Self)){let o=z1(t,e,n,i,Pi);if(o!==Pi)return o}let s=qb(t,e,n,i,Pi);if(s!==Pi)return s}return jb(e,n,i,r)}function qb(t,e,n,i,r){let s=V1(n);if(typeof s=="function"){if(!Rb(e,t,i))return i&Qe.Host?Wb(r,n,i):jb(e,n,i,r);try{let o;if(o=s(i),o==null&&!(i&Qe.Optional))Xm(n);else return o}finally{Lb()}}else if(typeof s=="number"){let o=null,a=Gb(t,e),c=ea,u=i&Qe.Host?e[Li][fi]:null;for((a===-1||i&Qe.SkipSelf)&&(c=a===-1?sg(t,e):e[a+8],c===ea||!RE(i,!1)?a=-1:(o=e[et],a=id(c),e=rd(c,e)));a!==-1;){let l=e[et];if(DE(s,a,l.data)){let d=U1(a,e,n,o,i,u);if(d!==Pi)return d}c=e[a+8],c!==ea&&RE(i,e[et].data[a+8]===u)&&DE(s,a,e)?(o=l,a=id(c),e=rd(c,e)):a=-1}}return r}function U1(t,e,n,i,r,s){let o=e[et],a=o.data[t+8],c=i==null?yd(a)&&um:i!=o&&(a.type&3)!==0,u=r&Qe.Host&&s===a,l=Xl(a,o,n,c,u);return l!==null?ra(e,o,l,a):Pi}function Xl(t,e,n,i,r){let s=t.providerIndexes,o=e.data,a=s&1048575,c=t.directiveStart,u=t.directiveEnd,l=s>>20,d=i?a:a+l,h=r?a+l:u;for(let p=d;p<h;p++){let g=o[p];if(p<c&&n===g||p>=c&&g.type===n)return p}if(r){let p=o[c];if(p&&Bc(p)&&p.type===n)return c}return null}function ra(t,e,n,i){let r=t[n],s=e.data;if(D1(r)){let o=r;o.resolving&&bR(ER(s[n]));let a=CE(o.canSeeViewProviders);o.resolving=!0;let c,u=o.injectImpl?Xn(o.injectImpl):null,l=Rb(t,i,Qe.Default);try{r=t[n]=o.factory(void 0,s,t,i),e.firstCreatePass&&n>=i.directiveStart&&M1(n,s[n],e)}finally{u!==null&&Xn(u),CE(a),o.resolving=!1,Lb()}}return r}function V1(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(Sc)?t[Sc]:void 0;return typeof e=="number"?e>=0?e&Bb:B1:e}function DE(t,e,n){let i=1<<t;return!!(n[e+(t>>zb)]&i)}function RE(t,e){return!(t&Qe.Self)&&!(t&Qe.Host&&e)}var ks=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,i){return $b(this._tNode,this._lView,e,pd(i),n)}};function B1(){return new ks(Ui(),Ft())}function og(t){return Uc(()=>{let e=t.prototype.constructor,n=e[Zl]||lm(e),i=Object.prototype,r=Object.getPrototypeOf(t.prototype).constructor;for(;r&&r!==i;){let s=r[Zl]||lm(r);if(s&&s!==n)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function lm(t){return eb(t)?()=>{let e=lm(Kn(t));return e&&e()}:ia(t)}function z1(t,e,n,i,r){let s=t,o=e;for(;s!==null&&o!==null&&o[Oe]&2048&&!(o[Oe]&512);){let a=qb(s,o,n,i|Qe.Self,Pi);if(a!==Pi)return a;let c=s.parent;if(!c){let u=o[yb];if(u){let l=u.get(n,Pi,i);if(l!==Pi)return l}c=Xb(o),o=o[ca]}s=c}return r}function Xb(t){let e=t[et],n=e.type;return n===2?e.declTNode:n===1?t[fi]:null}var Gl="__parameters__";function H1(t){return function(...n){if(t){let i=t(...n);for(let r in i)this[r]=i[r]}}}function G1(t,e,n){return Uc(()=>{let i=H1(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;let o=new r(...s);return a.annotation=o,a;function a(c,u,l){let d=c.hasOwnProperty(Gl)?c[Gl]:Object.defineProperty(c,Gl,{value:[]})[Gl];for(;d.length<=l;)d.push(null);return(d[l]=d[l]||[]).push(o),c}}return n&&(r.prototype=Object.create(n.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}function W1(t){return typeof t=="function"}function j1(t,e,n){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++){let r=t[i],s=e[i];if(n&&(r=n(r),s=n(s)),s!==r)return!1}return!0}function $1(t){return t.flat(Number.POSITIVE_INFINITY)}function ag(t,e){t.forEach(n=>Array.isArray(n)?ag(n,e):e(n))}function Kb(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function sd(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}var Mn=NR(G1("Optional"),8);var sa=new $e(""),Yb=new $e("",-1),Qb=new $e(""),od=class{get(e,n=Ac){if(n===Ac){let i=new Error(`NullInjectorError: No provider for ${An(e)}!`);throw i.name="NullInjectorError",i}return n}};function _d(t){return{\u0275providers:t}}function Hc(...t){return{\u0275providers:Zb(!0,t),\u0275fromNgModule:!0}}function Zb(t,...e){let n=[],i=new Set,r,s=o=>{n.push(o)};return ag(e,o=>{let a=o;dm(a,s,[],i)&&(r||=[],r.push(a))}),r!==void 0&&Jb(r,s),n}function Jb(t,e){for(let n=0;n<t.length;n++){let{ngModule:i,providers:r}=t[n];cg(r,s=>{e(s,i)})}}function dm(t,e,n,i){if(t=Kn(t),!t)return!1;let r=null,s=_E(t),o=!s&&Fs(t);if(!s&&!o){let c=t.ngModule;if(s=_E(c),s)r=c;else return!1}else{if(o&&!o.standalone)return!1;r=t}let a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let u of c)dm(u,e,n,i)}}else if(s){if(s.imports!=null&&!a){i.add(r);let u;try{ag(s.imports,l=>{dm(l,e,n,i)&&(u||=[],u.push(l))})}finally{}u!==void 0&&Jb(u,e)}if(!a){let u=ia(r)||(()=>new r);e({provide:r,useFactory:u,deps:Di},r),e({provide:Qb,useValue:r,multi:!0},r),e({provide:sa,useValue:()=>He(r),multi:!0},r)}let c=s.providers;if(c!=null&&!a){let u=t;cg(c,l=>{e(l,u)})}}else return!1;return r!==t&&t.providers!==void 0}function cg(t,e){for(let n of t)tb(n)&&(n=n.\u0275providers),Array.isArray(n)?cg(n,e):e(n)}var q1=wt({provide:String,useValue:wt});function ex(t){return t!==null&&typeof t=="object"&&q1 in t}function X1(t){return!!(t&&t.useExisting)}function K1(t){return!!(t&&t.useFactory)}function hm(t){return typeof t=="function"}var wd=new $e(""),Kl={},Y1={},Kp;function ug(){return Kp===void 0&&(Kp=new od),Kp}var Qn=class{},Oc=class extends Qn{get destroyed(){return this._destroyed}constructor(e,n,i,r){super(),this.parent=n,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,pm(e,o=>this.processProvider(o)),this.records.set(Yb,Qo(void 0,this)),r.has("environment")&&this.records.set(Qn,Qo(void 0,this));let s=this.records.get(wd);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Qb,Di,Qe.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(let n of this._ngOnDestroyHooks)n.ngOnDestroy();let e=this._onDestroyHooks;this._onDestroyHooks=[];for(let n of e)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=Hr(this),i=Xn(void 0),r;try{return e()}finally{Hr(n),Xn(i)}}get(e,n=Ac,i=Qe.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(yE))return e[yE](this);i=pd(i);let r,s=Hr(this),o=Xn(void 0);try{if(!(i&Qe.SkipSelf)){let c=this.records.get(e);if(c===void 0){let u=nP(e)&&fd(e);u&&this.injectableDefInScope(u)?c=Qo(fm(e),Kl):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=i&Qe.Self?ug():this.parent;return n=i&Qe.Optional&&n===Ac?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[Jl]=a[Jl]||[]).unshift(An(e)),s)throw a;return LR(a,e,"R3InjectorError",this.source)}else throw a}finally{Xn(o),Hr(s)}}resolveInjectorInitializers(){let e=Hr(this),n=Xn(void 0),i;try{let r=this.get(sa,Di,Qe.Self);for(let s of r)s()}finally{Hr(e),Xn(n)}}toString(){let e=[],n=this.records;for(let i of n.keys())e.push(An(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Pe(205,!1)}processProvider(e){e=Kn(e);let n=hm(e)?e:Kn(e&&e.provide),i=Z1(e);if(!hm(e)&&e.multi===!0){let r=this.records.get(n);r||(r=Qo(void 0,Kl,!0),r.factory=()=>rm(r.multi),this.records.set(n,r)),n=e,r.multi.push(e)}this.records.set(n,i)}hydrate(e,n){return n.value===Kl&&(n.value=Y1,n.value=n.factory()),typeof n.value=="object"&&n.value&&tP(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;let n=Kn(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function fm(t){let e=fd(t),n=e!==null?e.factory:ia(t);if(n!==null)return n;if(t instanceof $e)throw new Pe(204,!1);if(t instanceof Function)return Q1(t);throw new Pe(204,!1)}function Q1(t){if(t.length>0)throw new Pe(204,!1);let n=TR(t);return n!==null?()=>n.factory(t):()=>new t}function Z1(t){if(ex(t))return Qo(void 0,t.useValue);{let e=J1(t);return Qo(e,Kl)}}function J1(t,e,n){let i;if(hm(t)){let r=Kn(t);return ia(r)||fm(r)}else if(ex(t))i=()=>Kn(t.useValue);else if(K1(t))i=()=>t.useFactory(...rm(t.deps||[]));else if(X1(t))i=()=>He(Kn(t.useExisting));else{let r=Kn(t&&(t.useClass||t.provide));if(eP(t))i=()=>new r(...rm(t.deps));else return ia(r)||fm(r)}return i}function Qo(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function eP(t){return!!t.deps}function tP(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function nP(t){return typeof t=="function"||typeof t=="object"&&t instanceof $e}function pm(t,e){for(let n of t)Array.isArray(n)?pm(n,e):n&&tb(n)?pm(n.\u0275providers,e):e(n)}function Ws(t,e){t instanceof Oc&&t.assertNotDestroyed();let n,i=Hr(t),r=Xn(void 0);try{return e()}finally{Hr(i),Xn(r)}}function PE(t,e=null,n=null,i){let r=tx(t,e,n,i);return r.resolveInjectorInitializers(),r}function tx(t,e=null,n=null,i,r=new Set){let s=[n||Di,Hc(t)];return i=i||(typeof t=="object"?void 0:An(t)),new Oc(s,e||ug(),i||null,r)}var mi=(()=>{let e=class e{static create(i,r){if(Array.isArray(i))return PE({name:""},r,i,"");{let s=i.name??"";return PE({name:s},i.parent,i.providers,s)}}};e.THROW_IF_NOT_FOUND=Ac,e.NULL=new od,e.\u0275prov=Ae({token:e,providedIn:"any",factory:()=>He(Yb)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})();var mm;function nx(t){mm=t}function iP(){if(mm!==void 0)return mm;if(typeof document<"u")return document;throw new Pe(210,!1)}var lg=new $e("",{providedIn:"root",factory:()=>rP}),rP="ng",dg=new $e(""),Kr=new $e("",{providedIn:"platform",factory:()=>"unknown"});var hg=new $e("",{providedIn:"root",factory:()=>iP().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function ix(t){return t instanceof Function?t():t}function rx(t){return(t.flags&128)===128}var js=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(js||{});var sx=new Map,sP=0;function oP(){return sP++}function aP(t){sx.set(t[gd],t)}function cP(t){sx.delete(t[gd])}var NE="__ngContext__";function zs(t,e){Jo(e)?(t[NE]=e[gd],aP(e)):t[NE]=e}var uP;function fg(t,e){return uP(t,e)}function Zo(t,e,n,i,r){if(i!=null){let s,o=!1;hr(i)?s=i:Jo(i)&&(o=!0,i=i[dr]);let a=cr(i);t===0&&n!==null?r==null?lx(e,n,a):ad(e,n,a,r||null,!0):t===1&&n!==null?ad(e,n,a,r||null,!0):t===2?TP(e,a,o):t===3&&e.destroyNode(a),s!=null&&AP(e,t,s,n,r)}}function lP(t,e){return t.createText(e)}function ox(t,e,n){return t.createElement(e,n)}function dP(t,e){ax(t,e),e[dr]=null,e[fi]=null}function hP(t,e,n,i,r,s){i[dr]=r,i[fi]=e,Ed(t,i,n,1,r,s)}function ax(t,e){Ed(t,e,e[Fn],2,null,null)}function fP(t){let e=t[Dc];if(!e)return Yp(t[et],t);for(;e;){let n=null;if(Jo(e))n=e[Dc];else{let i=e[kn];i&&(n=i)}if(!n){for(;e&&!e[di]&&e!==t;)Jo(e)&&Yp(e[et],e),e=e[nn];e===null&&(e=t),Jo(e)&&Yp(e[et],e),n=e&&e[di]}e=n}}function pP(t,e,n,i){let r=kn+i,s=n.length;i>0&&(n[r-1][di]=e),i<s-kn?(e[di]=n[r],Kb(n,kn+i,e)):(n.push(e),e[di]=null),e[nn]=n;let o=e[Vc];o!==null&&n!==o&&mP(o,e);let a=e[Ni];a!==null&&a.insertView(t),am(e),e[Oe]|=128}function mP(t,e){let n=t[na],r=e[nn][nn][Li];e[Li]!==r&&(t[Oe]|=Ym.HasTransplantedViews),n===null?t[na]=[e]:n.push(e)}function cx(t,e){let n=t[na],i=n.indexOf(e);n.splice(i,1)}function gm(t,e){if(t.length<=kn)return;let n=kn+e,i=t[n];if(i){let r=i[Vc];r!==null&&r!==t&&cx(r,i),e>0&&(t[n-1][di]=i[di]);let s=sd(t,kn+e);dP(i[et],i);let o=s[Ni];o!==null&&o.detachView(s[et]),i[nn]=null,i[di]=null,i[Oe]&=-129}return i}function ux(t,e){if(!(e[Oe]&256)){let n=e[Fn];n.destroyNode&&Ed(t,e,n,3,null,null),fP(e)}}function Yp(t,e){if(!(e[Oe]&256)){e[Oe]&=-129,e[Oe]|=256,e[Us]&&Bw(e[Us]),yP(t,e),gP(t,e),e[et].type===1&&e[Fn].destroy();let n=e[Vc];if(n!==null&&hr(e[nn])){n!==e[nn]&&cx(n,e);let i=e[Ni];i!==null&&i.detachView(t)}cP(e)}}function gP(t,e){let n=t.cleanup,i=e[Cc];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?i[o]():i[-o].unsubscribe(),s+=2}else{let o=i[n[s+1]];n[s].call(o)}i!==null&&(e[Cc]=null);let r=e[Ic];if(r!==null){e[Ic]=null;for(let s=0;s<r.length;s++){let o=r[s];o()}}}function yP(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let i=0;i<n.length;i+=2){let r=e[n[i]];if(!(r instanceof Nc)){let s=n[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=r[s[o]],c=s[o+1];Ri(4,a,c);try{c.call(a)}finally{Ri(5,a,c)}}else{Ri(4,r,s);try{s.call(r)}finally{Ri(5,r,s)}}}}}function vP(t,e,n){return _P(t,e.parent,n)}function _P(t,e,n){let i=e;for(;i!==null&&i.type&40;)e=i,i=e.parent;if(i===null)return n[dr];{let{componentOffset:r}=i;if(r>-1){let{encapsulation:s}=t.data[i.directiveStart+r];if(s===Oi.None||s===Oi.Emulated)return null}return pi(i,n)}}function ad(t,e,n,i,r){t.insertBefore(e,n,i,r)}function lx(t,e,n){t.appendChild(e,n)}function OE(t,e,n,i,r){i!==null?ad(t,e,n,i,r):lx(t,e,n)}function wP(t,e,n,i){t.removeChild(e,n,i)}function pg(t,e){return t.parentNode(e)}function EP(t,e){return t.nextSibling(e)}function bP(t,e,n){return SP(t,e,n)}function xP(t,e,n){return t.type&40?pi(t,n):null}var SP=xP,LE;function mg(t,e,n,i){let r=vP(t,i,e),s=e[Fn],o=i.parent||e[fi],a=bP(o,i,e);if(r!=null)if(Array.isArray(n))for(let c=0;c<n.length;c++)OE(s,r,n[c],a,!1);else OE(s,r,n,a,!1);LE!==void 0&&LE(s,i,e,n,r)}function Yl(t,e){if(e!==null){let n=e.type;if(n&3)return pi(e,t);if(n&4)return ym(-1,t[e.index]);if(n&8){let i=e.child;if(i!==null)return Yl(t,i);{let r=t[e.index];return hr(r)?ym(-1,r):cr(r)}}else{if(n&32)return fg(e,t)()||cr(t[e.index]);{let i=dx(t,e);if(i!==null){if(Array.isArray(i))return i[0];let r=Pc(t[Li]);return Yl(r,i)}else return Yl(t,e.next)}}}return null}function dx(t,e){if(e!==null){let i=t[Li][fi],r=e.projection;return i.projection[r]}return null}function ym(t,e){let n=kn+t+1;if(n<e.length){let i=e[n],r=i[et].firstChild;if(r!==null)return Yl(i,r)}return e[Vs]}function TP(t,e,n){let i=pg(t,e);i&&wP(t,i,e,n)}function gg(t,e,n,i,r,s,o){for(;n!=null;){let a=i[n.index],c=n.type;if(o&&e===0&&(a&&zs(cr(a),i),n.flags|=2),(n.flags&32)!==32)if(c&8)gg(t,e,n.child,i,r,s,!1),Zo(e,t,r,a,s);else if(c&32){let u=fg(n,i),l;for(;l=u();)Zo(e,t,r,l,s);Zo(e,t,r,a,s)}else c&16?IP(t,e,i,n,r,s):Zo(e,t,r,a,s);n=o?n.projectionNext:n.next}}function Ed(t,e,n,i,r,s){gg(n,i,t.firstChild,e,r,s,!1)}function IP(t,e,n,i,r,s){let o=n[Li],c=o[fi].projection[i.projection];if(Array.isArray(c))for(let u=0;u<c.length;u++){let l=c[u];Zo(e,t,r,l,s)}else{let u=c,l=o[nn];rx(i)&&(u.flags|=128),gg(t,e,u,l,r,s,!0)}}function AP(t,e,n,i,r){let s=n[Vs],o=cr(n);s!==o&&Zo(e,t,i,s,r);for(let a=kn;a<n.length;a++){let c=n[a];Ed(c[et],c,t,e,i,s)}}function MP(t,e,n){t.setAttribute(e,"style",n)}function hx(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function fx(t,e,n){let{mergedAttrs:i,classes:r,styles:s}=n;i!==null&&sm(t,e,i),r!==null&&hx(t,e,r),s!==null&&MP(t,e,s)}var Wl;function CP(){if(Wl===void 0&&(Wl=null,Ls.trustedTypes))try{Wl=Ls.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Wl}function bd(t){return CP()?.createHTML(t)||t}var ur=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${ZE})`}},vm=class extends ur{getTypeName(){return"HTML"}},_m=class extends ur{getTypeName(){return"Style"}},wm=class extends ur{getTypeName(){return"Script"}},Em=class extends ur{getTypeName(){return"URL"}},bm=class extends ur{getTypeName(){return"ResourceURL"}};function Yr(t){return t instanceof ur?t.changingThisBreaksApplicationSecurity:t}function $s(t,e){let n=DP(t);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${ZE})`)}return n===e}function DP(t){return t instanceof ur&&t.getTypeName()||null}function px(t){return new vm(t)}function mx(t){return new _m(t)}function gx(t){return new wm(t)}function yx(t){return new Em(t)}function vx(t){return new bm(t)}function RP(t){let e=new Sm(t);return PP()?new xm(e):e}var xm=class{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{let n=new window.DOMParser().parseFromString(bd(e),"text/html").body;return n===null?this.inertDocumentHelper.getInertBodyElement(e):(n.removeChild(n.firstChild),n)}catch{return null}}},Sm=class{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){let n=this.inertDocument.createElement("template");return n.innerHTML=bd(e),n}};function PP(){try{return!!new window.DOMParser().parseFromString(bd(""),"text/html")}catch{return!1}}var NP=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function xd(t){return t=String(t),t.match(NP)?t:"unsafe:"+t}function pr(t){let e={};for(let n of t.split(","))e[n]=!0;return e}function Gc(...t){let e={};for(let n of t)for(let i in n)n.hasOwnProperty(i)&&(e[i]=!0);return e}var _x=pr("area,br,col,hr,img,wbr"),wx=pr("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Ex=pr("rp,rt"),OP=Gc(Ex,wx),LP=Gc(wx,pr("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),kP=Gc(Ex,pr("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),kE=Gc(_x,LP,kP,OP),bx=pr("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),FP=pr("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),UP=pr("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext"),VP=Gc(bx,FP,UP),BP=pr("script,style,template"),Tm=class{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let n=e.firstChild,i=!0;for(;n;){if(n.nodeType===Node.ELEMENT_NODE?i=this.startElement(n):n.nodeType===Node.TEXT_NODE?this.chars(n.nodeValue):this.sanitizedSomething=!0,i&&n.firstChild){n=n.firstChild;continue}for(;n;){n.nodeType===Node.ELEMENT_NODE&&this.endElement(n);let r=this.checkClobberedElement(n,n.nextSibling);if(r){n=r;break}n=this.checkClobberedElement(n,n.parentNode)}}return this.buf.join("")}startElement(e){let n=e.nodeName.toLowerCase();if(!kE.hasOwnProperty(n))return this.sanitizedSomething=!0,!BP.hasOwnProperty(n);this.buf.push("<"),this.buf.push(n);let i=e.attributes;for(let r=0;r<i.length;r++){let s=i.item(r),o=s.name,a=o.toLowerCase();if(!VP.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let c=s.value;bx[a]&&(c=xd(c)),this.buf.push(" ",o,'="',FE(c),'"')}return this.buf.push(">"),!0}endElement(e){let n=e.nodeName.toLowerCase();kE.hasOwnProperty(n)&&!_x.hasOwnProperty(n)&&(this.buf.push("</"),this.buf.push(n),this.buf.push(">"))}chars(e){this.buf.push(FE(e))}checkClobberedElement(e,n){if(n&&(e.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return n}},zP=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,HP=/([^\#-~ |!])/g;function FE(t){return t.replace(/&/g,"&amp;").replace(zP,function(e){let n=e.charCodeAt(0),i=e.charCodeAt(1);return"&#"+((n-55296)*1024+(i-56320)+65536)+";"}).replace(HP,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var jl;function xx(t,e){let n=null;try{jl=jl||RP(t);let i=e?String(e):"";n=jl.getInertBodyElement(i);let r=5,s=i;do{if(r===0)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=n.innerHTML,n=jl.getInertBodyElement(i)}while(i!==s);let a=new Tm().sanitizeChildren(UE(n)||n);return bd(a)}finally{if(n){let i=UE(n)||n;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function UE(t){return"content"in t&&GP(t)?t.content:null}function GP(t){return t.nodeType===Node.ELEMENT_NODE&&t.nodeName==="TEMPLATE"}var mr=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(mr||{});function Sx(t){let e=WP();return e?e.sanitize(mr.URL,t)||"":$s(t,"URL")?Yr(t):xd(nb(t))}function WP(){let t=Ft();return t&&t[ar].sanitizer}var Im=class{};var jP="h",$P="b";var qP=()=>null;function yg(t,e,n=!1){return qP(t,e,n)}var Am=class{},cd=class{};function XP(t){let e=Error(`No component factory found for ${An(t)}.`);return e[KP]=t,e}var KP="ngComponent";var Mm=class{resolveComponentFactory(e){throw XP(e)}},Sd=(()=>{let e=class e{};e.NULL=new Mm;let t=e;return t})();function YP(){return ua(Ui(),Ft())}function ua(t,e){return new qs(pi(t,e))}var qs=(()=>{let e=class e{constructor(i){this.nativeElement=i}};e.__NG_ELEMENT_ID__=YP;let t=e;return t})();function QP(t){return t instanceof qs?t.nativeElement:t}var Lc=class{};var ZP=(()=>{let e=class e{};e.\u0275prov=Ae({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),Qp={};function ud(t,e,n,i,r=!1){for(;n!==null;){let s=e[n.index];s!==null&&i.push(cr(s)),hr(s)&&JP(s,i);let o=n.type;if(o&8)ud(t,e,n.child,i);else if(o&32){let a=fg(n,e),c;for(;c=a();)i.push(c)}else if(o&16){let a=dx(e,n);if(Array.isArray(a))i.push(...a);else{let c=Pc(e[Li]);ud(c[et],c,a,i,!0)}}n=r?n.projectionNext:n.next}return i}function JP(t,e){for(let n=kn;n<t.length;n++){let i=t[n],r=i[et].firstChild;r!==null&&ud(i[et],i,r,e)}t[Vs]!==t[dr]&&e.push(t[Vs])}var Tx=[];function eN(t){return t[Us]??tN(t)}function tN(t){let e=Tx.pop()??Object.create(iN);return e.lView=t,e}function nN(t){t.lView[Us]!==t&&(t.lView=null,Tx.push(t))}var iN=Ct(ve({},Fw),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{Rc(t.lView)},consumerOnSignalRead(){this.lView[Us]=this}});function Ix(t){return Mx(t[Dc])}function Ax(t){return Mx(t[di])}function Mx(t){for(;t!==null&&!hr(t);)t=t[di];return t}var rN="ngOriginalError";function Zp(t){return t[rN]}var lr=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&Zp(e);for(;n&&Zp(n);)n=Zp(n);return n||null}},Cx=new $e("",{providedIn:"root",factory:()=>ge(lr).handleError.bind(void 0)});var Dx=!1,sN=new $e("",{providedIn:"root",factory:()=>Dx});var Rx={};function gr(t=1){Px(fr(),Ft(),kb()+t,!1)}function Px(t,e,n,i){if(!i)if((e[Oe]&3)===3){let s=t.preOrderCheckHooks;s!==null&&$l(e,s,n)}else{let s=t.preOrderHooks;s!==null&&ql(e,s,0,n)}Bs(n)}function yr(t,e=Qe.Default){let n=Ft();if(n===null)return He(t,e);let i=Ui();return $b(i,n,Kn(t),e)}function Nx(t,e,n,i,r,s){let o=On(null);try{let a=null;r&Gr.SignalBased&&(a=e[i][kw]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),r&Gr.HasDecoratorInputTransform&&(s=t.inputTransforms[i].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,i):wb(e,a,i,s)}finally{On(o)}}function oN(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let i=0;i<n.length;i++){let r=n[i];if(r<0)Bs(~r);else{let s=r,o=n[++i],a=n[++i];b1(o,s);let c=e[s];a(2,c)}}}finally{Bs(-1)}}function Td(t,e,n,i,r,s,o,a,c,u,l){let d=e.blueprint.slice();return d[dr]=r,d[Oe]=i|4|128|8|64,(u!==null||t&&t[Oe]&2048)&&(d[Oe]|=2048),Tb(d),d[nn]=d[ca]=t,d[hi]=n,d[ar]=o||t&&t[ar],d[Fn]=a||t&&t[Fn],d[ta]=c||t&&t[ta]||null,d[fi]=s,d[gd]=oP(),d[ed]=l,d[yb]=u,d[Li]=e.type==2?t[Li]:d,d}function Id(t,e,n,i,r){let s=t.data[e];if(s===null)s=aN(t,e,n,i,r),E1()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=i,s.attrs=r;let o=y1();s.injectorIndex=o===null?-1:o.injectorIndex}return zc(s,!0),s}function aN(t,e,n,i,r){let s=Mb(),o=Cb(),a=o?s:s&&s.parent,c=t.data[e]=fN(t,a,n,e,i,r);return t.firstChild===null&&(t.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function Ox(t,e,n,i){if(n===0)return-1;let r=e.length;for(let s=0;s<n;s++)e.push(i),t.blueprint.push(i),t.data.push(null);return r}function Lx(t,e,n,i,r){let s=kb(),o=i&2;try{Bs(-1),o&&e.length>Wr&&Px(t,e,Wr,!1),Ri(o?2:0,r),n(i,r)}finally{Bs(s),Ri(o?3:1,r)}}function kx(t,e,n){if(_b(e)){let i=On(null);try{let r=e.directiveStart,s=e.directiveEnd;for(let o=r;o<s;o++){let a=t.data[o];a.contentQueries&&a.contentQueries(1,n[o],o)}}finally{On(i)}}}function Fx(t,e,n){Ab()&&(wN(t,e,n,pi(n,e)),(n.flags&64)===64&&Hx(t,e,n))}function Ux(t,e,n=pi){let i=e.localNames;if(i!==null){let r=e.index+1;for(let s=0;s<i.length;s+=2){let o=i[s+1],a=o===-1?n(e,t):t[o];t[r++]=a}}}function Vx(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=vg(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function vg(t,e,n,i,r,s,o,a,c,u,l){let d=Wr+i,h=d+r,p=cN(d,h),g=typeof u=="function"?u():u;return p[et]={type:t,blueprint:p,template:n,queries:null,viewQuery:a,declTNode:e,data:p.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:g,incompleteFirstPass:!1,ssrId:l}}function cN(t,e){let n=[];for(let i=0;i<e;i++)n.push(i<t?null:Rx);return n}function uN(t,e,n,i){let s=i.get(sN,Dx)||n===Oi.ShadowDom,o=t.selectRootElement(e,s);return lN(o),o}function lN(t){dN(t)}var dN=()=>null;function hN(t,e,n,i){let r=jx(e);r.push(n),t.firstCreatePass&&$x(t).push(i,r.length-1)}function fN(t,e,n,i,r,s){let o=e?e.injectorIndex:-1,a=0;return p1()&&(a|=128),{type:n,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function VE(t,e,n,i,r){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;i??={};let a,c=Gr.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let u=s;if(r!==null){if(!r.hasOwnProperty(s))continue;u=r[s]}t===0?BE(i,n,u,a,c):BE(i,n,u,a)}return i}function BE(t,e,n,i,r){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,i):s=t[n]=[e,i],r!==void 0&&s.push(r)}function pN(t,e,n){let i=e.directiveStart,r=e.directiveEnd,s=t.data,o=e.attrs,a=[],c=null,u=null;for(let l=i;l<r;l++){let d=s[l],h=n?n.get(d):null,p=h?h.inputs:null,g=h?h.outputs:null;c=VE(0,d.inputs,l,c,p),u=VE(1,d.outputs,l,u,g);let y=c!==null&&o!==null&&!lb(e)?CN(c,l,o):null;a.push(y)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=u}function mN(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function gN(t,e,n,i,r,s,o,a){let c=pi(e,n),u=e.inputs,l;!a&&u!=null&&(l=u[i])?(_g(t,n,l,i,r),yd(e)&&yN(n,e.index)):e.type&3?(i=mN(i),r=o!=null?o(r,e.value||"",i):r,s.setProperty(c,i,r)):e.type&12}function yN(t,e){let n=Gs(e,t);n[Oe]&16||(n[Oe]|=64)}function Bx(t,e,n,i){if(Ab()){let r=i===null?null:{"":-1},s=bN(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&zx(t,e,n,o,r,a),r&&xN(n,i,r)}n.mergedAttrs=Km(n.mergedAttrs,n.attrs)}function zx(t,e,n,i,r,s){for(let u=0;u<i.length;u++)F1(Hb(n,e),t,i[u].type);TN(n,t.data.length,i.length);for(let u=0;u<i.length;u++){let l=i[u];l.providersResolver&&l.providersResolver(l)}let o=!1,a=!1,c=Ox(t,e,i.length,null);for(let u=0;u<i.length;u++){let l=i[u];n.mergedAttrs=Km(n.mergedAttrs,l.hostAttrs),IN(t,n,e,c,l),SN(c,l,r),l.contentQueries!==null&&(n.flags|=4),(l.hostBindings!==null||l.hostAttrs!==null||l.hostVars!==0)&&(n.flags|=64);let d=l.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),c++}pN(t,n,s)}function vN(t,e,n,i,r){let s=r.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;_N(o)!=a&&o.push(a),o.push(n,i,s)}}function _N(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function wN(t,e,n,i){let r=n.directiveStart,s=n.directiveEnd;yd(n)&&AN(e,n,t.data[r+n.componentOffset]),t.firstCreatePass||Hb(n,e),zs(i,e);let o=n.initialInputs;for(let a=r;a<s;a++){let c=t.data[a],u=ra(e,t,a,n);if(zs(u,e),o!==null&&MN(e,a-r,u,c,n,o),Bc(c)){let l=Gs(n.index,e);l[hi]=ra(e,t,a,n)}}}function Hx(t,e,n){let i=n.directiveStart,r=n.directiveEnd,s=n.index,o=x1();try{Bs(s);for(let a=i;a<r;a++){let c=t.data[a],u=e[a];cm(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&EN(c,u)}}finally{Bs(-1),cm(o)}}function EN(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function bN(t,e){let n=t.directiveRegistry,i=null,r=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(GR(e,o.selectors,!1))if(i||(i=[]),Bc(o))if(o.findHostDirectiveDefs!==null){let a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o);let c=a.length;Cm(t,e,c)}else i.unshift(o),Cm(t,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return i===null?null:[i,r]}function Cm(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function xN(t,e,n){if(e){let i=t.localNames=[];for(let r=0;r<e.length;r+=2){let s=n[e[r+1]];if(s==null)throw new Pe(-301,!1);i.push(e[r],s)}}}function SN(t,e,n){if(n){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)n[e.exportAs[i]]=t;Bc(e)&&(n[""]=t)}}function TN(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function IN(t,e,n,i,r){t.data[i]=r;let s=r.factory||(r.factory=ia(r.type,!0)),o=new Nc(s,Bc(r),yr);t.blueprint[i]=o,n[i]=o,vN(t,e,i,Ox(t,n,r.hostVars,Rx),r)}function AN(t,e,n){let i=pi(e,t),r=Vx(n),s=t[ar].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=Ad(t,Td(t,r,null,o,i,e,null,s.createRenderer(i,n),null,null,null));t[e.index]=a}function MN(t,e,n,i,r,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],u=o[a++],l=o[a++],d=o[a++];Nx(i,n,c,u,l,d)}}function CN(t,e,n){let i=null,r=0;for(;r<n.length;){let s=n[r];if(s===0){r+=4;continue}else if(s===5){r+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){i===null&&(i=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){i.push(s,o[a+1],o[a+2],n[r+1]);break}}r+=2}return i}function Gx(t,e,n,i){return[t,!0,0,e,null,i,null,n,null,null]}function Wx(t,e){let n=t.contentQueries;if(n!==null){let i=On(null);try{for(let r=0;r<n.length;r+=2){let s=n[r],o=n[r+1];if(o!==-1){let a=t.data[o];Jm(s),a.contentQueries(2,e[o],o)}}}finally{On(i)}}}function Ad(t,e){return t[Dc]?t[IE][di]=e:t[Dc]=e,t[IE]=e,e}function Dm(t,e,n){Jm(0);let i=On(null);try{e(t,n)}finally{On(i)}}function jx(t){return t[Cc]||(t[Cc]=[])}function $x(t){return t.cleanup||(t.cleanup=[])}function qx(t,e){let n=t[ta],i=n?n.get(lr,null):null;i&&i.handleError(e)}function _g(t,e,n,i,r){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],c=n[s++],u=e[o],l=t.data[o];Nx(l,u,i,a,c,r)}}var DN=100;function RN(t,e=!0){let n=t[ar],i=n.rendererFactory,r=!1;r||i.begin?.();try{PN(t)}catch(s){throw e&&qx(t,s),s}finally{r||(i.end?.(),n.inlineEffectRunner?.flush())}}function PN(t){Rm(t,0);let e=0;for(;Ib(t);){if(e===DN)throw new Pe(103,!1);e++,Rm(t,1)}}function NN(t,e,n,i){let r=e[Oe];if((r&256)===256)return;let s=!1;!s&&e[ar].inlineEffectRunner?.flush(),eg(e);let o=null,a=null;!s&&ON(t)&&(a=eN(e),o=Uw(a));try{Tb(e),_1(t.bindingStartIndex),n!==null&&Lx(t,e,n,2,i);let c=(r&3)===3;if(!s)if(c){let d=t.preOrderCheckHooks;d!==null&&$l(e,d,null)}else{let d=t.preOrderHooks;d!==null&&ql(e,d,0,null),qp(e,0)}if(LN(e),Xx(e,0),t.contentQueries!==null&&Wx(t,e),!s)if(c){let d=t.contentCheckHooks;d!==null&&$l(e,d)}else{let d=t.contentHooks;d!==null&&ql(e,d,1),qp(e,1)}oN(t,e);let u=t.components;u!==null&&Yx(e,u,0);let l=t.viewQuery;if(l!==null&&Dm(2,l,i),!s)if(c){let d=t.viewCheckHooks;d!==null&&$l(e,d)}else{let d=t.viewHooks;d!==null&&ql(e,d,2),qp(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[$p]){for(let d of e[$p])d();e[$p]=null}s||(e[Oe]&=-73)}catch(c){throw Rc(e),c}finally{a!==null&&(Vw(a,o),nN(a)),tg()}}function ON(t){return t.type!==2}function Xx(t,e){for(let n=Ix(t);n!==null;n=Ax(n))for(let i=kn;i<n.length;i++){let r=n[i];Kx(r,e)}}function LN(t){for(let e=Ix(t);e!==null;e=Ax(e)){if(!(e[Oe]&Ym.HasTransplantedViews))continue;let n=e[na];for(let i=0;i<n.length;i++){let r=n[i],s=r[nn];c1(r)}}}function kN(t,e,n){let i=Gs(e,t);Kx(i,n)}function Kx(t,e){Zm(t)&&Rm(t,e)}function Rm(t,e){let i=t[et],r=t[Oe],s=t[Us],o=!!(e===0&&r&16);if(o||=!!(r&64&&e===0),o||=!!(r&1024),o||=!!(s?.dirty&&xp(s)),s&&(s.dirty=!1),t[Oe]&=-9217,o)NN(i,t,i.template,t[hi]);else if(r&8192){Xx(t,1);let a=i.components;a!==null&&Yx(t,a,1)}}function Yx(t,e,n){for(let i=0;i<e.length;i++)kN(t,e[i],n)}function wg(t){for(t[ar].changeDetectionScheduler?.notify();t;){t[Oe]|=64;let e=Pc(t);if(ZR(t)&&!e)return t;t=e}return null}var Hs=class{get rootNodes(){let e=this._lView,n=e[et];return ud(n,e,n.firstChild,[])}constructor(e,n,i=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=i,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[hi]}set context(e){this._lView[hi]=e}get destroyed(){return(this._lView[Oe]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[nn];if(hr(e)){let n=e[td],i=n?n.indexOf(this):-1;i>-1&&(gm(e,i),sd(n,i))}this._attachedToViewContainer=!1}ux(this._lView[et],this._lView)}onDestroy(e){l1(this._lView,e)}markForCheck(){wg(this._cdRefInjectingView||this._lView)}detach(){this._lView[Oe]&=-129}reattach(){am(this._lView),this._lView[Oe]|=128}detectChanges(){this._lView[Oe]|=1024,RN(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Pe(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,ax(this._lView[et],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Pe(902,!1);this._appRef=e,am(this._lView)}},la=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=FN;let t=e;return t})();function FN(t){return UN(Ui(),Ft(),(t&16)===16)}function UN(t,e,n){if(yd(t)&&!n){let i=Gs(t.index,e);return new Hs(i,i)}else if(t.type&47){let i=e[Li];return new Hs(i,e)}return null}var zE=new Set;function Qx(t){zE.has(t)||(zE.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}var Pm=class extends fn{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,i){let r=e,s=n||(()=>null),o=i;if(e&&typeof e=="object"){let c=e;r=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=Jp(s),r&&(r=Jp(r)),o&&(o=Jp(o)));let a=super.subscribe({next:r,error:s,complete:o});return e instanceof At&&e.add(a),a}};function Jp(t){return e=>{setTimeout(t,void 0,e)}}var Yn=Pm;function HE(...t){}function VN(){let t=typeof Ls.requestAnimationFrame=="function",e=Ls[t?"requestAnimationFrame":"setTimeout"],n=Ls[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);let r=n[Zone.__symbol__("OriginalDelegate")];r&&(n=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var yt=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Yn(!1),this.onMicrotaskEmpty=new Yn(!1),this.onStable=new Yn(!1),this.onError=new Yn(!1),typeof Zone>"u")throw new Pe(908,!1);Zone.assertZonePatched();let r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&n,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=VN().nativeRequestAnimationFrame,HN(r)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new Pe(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new Pe(909,!1)}run(e,n,i){return this._inner.run(e,n,i)}runTask(e,n,i,r){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,BN,HE,HE);try{return s.runTask(o,n,i)}finally{s.cancelTask(o)}}runGuarded(e,n,i){return this._inner.runGuarded(e,n,i)}runOutsideAngular(e){return this._outer.run(e)}},BN={};function Eg(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function zN(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Ls,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Nm(t),t.isCheckStableRunning=!0,Eg(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Nm(t))}function HN(t){let e=()=>{zN(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,i,r,s,o,a)=>{if(GN(a))return n.invokeTask(r,s,o,a);try{return GE(t),n.invokeTask(r,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),WE(t)}},onInvoke:(n,i,r,s,o,a,c)=>{try{return GE(t),n.invoke(r,s,o,a,c)}finally{t.shouldCoalesceRunChangeDetection&&e(),WE(t)}},onHasTask:(n,i,r,s)=>{n.hasTask(r,s),i===r&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,Nm(t),Eg(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,i,r,s)=>(n.handleError(r,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function Nm(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function GE(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function WE(t){t._nesting--,Eg(t)}function GN(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}var Zx=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){let i=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let s of i)s();return!!this.handler?.execute()||i.length>0}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=Ae({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function WN(t,e){let n=Gs(e,t),i=n[et];jN(i,n);let r=n[dr];r!==null&&n[ed]===null&&(n[ed]=yg(r,n[ta])),bg(i,n,n[hi])}function jN(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function bg(t,e,n){eg(e);try{let i=t.viewQuery;i!==null&&Dm(1,i,n);let r=t.template;r!==null&&Lx(t,e,r,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&Wx(t,e),t.staticViewQueries&&Dm(2,t.viewQuery,n);let s=t.components;s!==null&&$N(e,s)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),i}finally{e[Oe]&=-5,tg()}}function $N(t,e){for(let n=0;n<e.length;n++)WN(t,e[n])}function Om(t,e,n){let i=n?t.styles:null,r=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)r=gE(r,a);else if(s==2){let c=a,u=e[++o];i=gE(i,c+": "+u+";")}}n?t.styles=i:t.stylesWithoutHost=i,n?t.classes=r:t.classesWithoutHost=r}var ld=class extends Sd{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=Fs(e);return new kc(n,this.ngModule)}};function jE(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let i=t[n];i!==void 0&&e.push({propName:Array.isArray(i)?i[0]:i,templateName:n})}return e}function qN(t){let e=t.toLowerCase();return e==="svg"?n1:e==="math"?i1:null}var Lm=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,i){i=pd(i);let r=this.injector.get(e,Qp,i);return r!==Qp||n===Qp?r:this.parentInjector.get(e,n,i)}},kc=class extends cd{get inputs(){let e=this.componentDef,n=e.inputTransforms,i=jE(e.inputs);if(n!==null)for(let r of i)n.hasOwnProperty(r.propName)&&(r.transform=n[r.propName]);return i}get outputs(){return jE(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=qR(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,i,r){r=r||this.ngModule;let s=r instanceof Qn?r:r?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let o=s?new Lm(e,s):e,a=o.get(Lc,null);if(a===null)throw new Pe(407,!1);let c=o.get(ZP,null),u=o.get(Zx,null),l=o.get(Im,null),d={rendererFactory:a,sanitizer:c,inlineEffectRunner:null,afterRenderEventManager:u,changeDetectionScheduler:l},h=a.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",g=i?uN(h,i,this.componentDef.encapsulation,o):ox(h,p,qN(p)),y=512;this.componentDef.signals?y|=4096:this.componentDef.onPush||(y|=16);let m=null;g!==null&&(m=yg(g,o,!0));let f=vg(0,null,null,1,0,null,null,null,null,null,null),b=Td(null,f,null,y,null,null,d,h,o,null,m);eg(b);let _,v;try{let x=this.componentDef,A,I=null;x.findHostDirectiveDefs?(A=[],I=new Map,x.findHostDirectiveDefs(x,A,I),A.push(x)):A=[x];let V=XN(b,g),G=KN(V,g,x,A,b,d,h);v=Sb(f,Wr),g&&ZN(h,x,g,i),n!==void 0&&JN(v,this.ngContentSelectors,n),_=QN(G,x,A,I,b,[eO]),bg(f,b,null)}finally{tg()}return new km(this.componentType,_,ua(v,b),b,v)}},km=class extends Am{constructor(e,n,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new Hs(r,void 0,!1),this.componentType=e}setInput(e,n){let i=this._tNode.inputs,r;if(i!==null&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;_g(s[et],s,r,e,n),this.previousInputValues.set(e,n);let o=Gs(this._tNode.index,s);wg(o)}}get injector(){return new ks(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function XN(t,e){let n=t[et],i=Wr;return t[i]=e,Id(n,i,2,"#host",null)}function KN(t,e,n,i,r,s,o){let a=r[et];YN(i,t,e,o);let c=null;e!==null&&(c=yg(e,r[ta]));let u=s.rendererFactory.createRenderer(e,n),l=16;n.signals?l=4096:n.onPush&&(l=64);let d=Td(r,Vx(n),null,l,r[t.index],t,s,u,null,null,c);return a.firstCreatePass&&Cm(a,t,i.length-1),Ad(r,d),r[t.index]=d}function YN(t,e,n,i){for(let r of t)e.mergedAttrs=Km(e.mergedAttrs,r.hostAttrs);e.mergedAttrs!==null&&(Om(e,e.mergedAttrs,!0),n!==null&&fx(i,n,e))}function QN(t,e,n,i,r,s){let o=Ui(),a=r[et],c=pi(o,r);zx(a,r,o,n,null,i);for(let l=0;l<n.length;l++){let d=o.directiveStart+l,h=ra(r,a,d,o);zs(h,r)}Hx(a,r,o),c&&zs(c,r);let u=ra(r,a,o.directiveStart+o.componentOffset,o);if(t[hi]=r[hi]=u,s!==null)for(let l of s)l(u,e);return kx(a,o,t),u}function ZN(t,e,n,i){if(i)sm(t,n,["ng-version","17.1.2"]);else{let{attrs:r,classes:s}=XR(e.selectors[0]);r&&sm(t,n,r),s&&s.length>0&&hx(t,n,s.join(" "))}}function JN(t,e,n){let i=t.projection=[];for(let r=0;r<e.length;r++){let s=n[r];i.push(s!=null?Array.from(s):null)}}function eO(){let t=Ui();rg(Ft()[et],t)}var UX=new RegExp(`^(\\d+)*(${$P}|${jP})*(.*)`);var tO=()=>null;function $E(t,e){return tO(t,e)}function nO(t,e,n,i){let r=e.tView,o=t[Oe]&4096?4096:16,a=Td(t,r,n,o,null,e,null,null,null,i?.injector??null,i?.dehydratedView??null),c=t[e.index];a[Vc]=c;let u=t[Ni];return u!==null&&(a[Ni]=u.createEmbeddedView(r)),bg(r,a,n),a}function qE(t,e){return!e||e.firstChild===null||rx(t)}function iO(t,e,n,i=!0){let r=e[et];if(pP(r,e,t,n),i){let o=ym(n,t),a=e[Fn],c=pg(a,t[Vs]);c!==null&&hP(r,t[fi],a,e,c,o)}let s=e[ed];s!==null&&s.firstChild!==null&&(s.firstChild=null)}var Xs=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=rO;let t=e;return t})();function rO(){let t=Ui();return eS(t,Ft())}var sO=Xs,Jx=class extends sO{constructor(e,n,i){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=i}get element(){return ua(this._hostTNode,this._hostLView)}get injector(){return new ks(this._hostTNode,this._hostLView)}get parentInjector(){let e=sg(this._hostTNode,this._hostLView);if(Vb(e)){let n=rd(e,this._hostLView),i=id(e),r=n[et].data[i+8];return new ks(r,n)}else return new ks(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=XE(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-kn}createEmbeddedView(e,n,i){let r,s;typeof i=="number"?r=i:i!=null&&(r=i.index,s=i.injector);let o=$E(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,r,qE(this._hostTNode,o)),a}createComponent(e,n,i,r,s){let o=e&&!W1(e),a;if(o)a=n;else{let g=n||{};a=g.index,i=g.injector,r=g.projectableNodes,s=g.environmentInjector||g.ngModuleRef}let c=o?e:new kc(Fs(e)),u=i||this.parentInjector;if(!s&&c.ngModule==null){let y=(o?u:this.parentInjector).get(Qn,null);y&&(s=y)}let l=Fs(c.componentType??{}),d=$E(this._lContainer,l?.id??null),h=d?.firstChild??null,p=c.create(u,r,h,s);return this.insertImpl(p.hostView,a,qE(this._hostTNode,d)),p}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,i){let r=e._lView;if(a1(r)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=r[nn],u=new Jx(c,c[fi],c[nn]);u.detach(u.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return iO(o,r,s,i),e.attachToViewContainerRef(),Kb(em(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=XE(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),i=gm(this._lContainer,n);i&&(sd(em(this._lContainer),n),ux(i[et],i))}detach(e){let n=this._adjustIndex(e,-1),i=gm(this._lContainer,n);return i&&sd(em(this._lContainer),n)!=null?new Hs(i):null}_adjustIndex(e,n=0){return e??this.length+n}};function XE(t){return t[td]}function em(t){return t[td]||(t[td]=[])}function eS(t,e){let n,i=e[t.index];return hr(i)?n=i:(n=Gx(i,e,null,t),e[t.index]=n,Ad(e,n)),aO(n,e,t,i),new Jx(n,t,e)}function oO(t,e){let n=t[Fn],i=n.createComment(""),r=pi(e,t),s=pg(n,r);return ad(n,s,i,EP(n,r),!1),i}var aO=lO,cO=()=>!1;function uO(t,e,n){return cO(t,e,n)}function lO(t,e,n,i){if(t[Vs])return;let r;n.type&8?r=cr(i):r=oO(e,n),t[Vs]=r}function dO(t,e,n){let i=t[e];return Object.is(i,n)?!1:(t[e]=n,!0)}function hO(t,e,n,i,r,s,o,a,c){let u=e.consts,l=Id(e,t,4,o||null,nd(u,a));Bx(e,n,l,nd(u,c)),rg(e,l);let d=l.tView=vg(2,l,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u,null);return e.queries!==null&&(e.queries.template(e,l),d.queries=e.queries.embeddedTView(l)),l}function xg(t,e,n,i,r,s,o,a){let c=Ft(),u=fr(),l=t+Wr,d=u.firstCreatePass?hO(l,u,c,e,n,i,r,s,o):u.data[l];zc(d,!1);let h=fO(u,c,d,t);ng()&&mg(u,c,h,d),zs(h,c);let p=Gx(h,c,h,d);return c[l]=p,Ad(c,p),uO(p,d,c),Qm(d)&&Fx(u,c,d),o!=null&&Ux(c,d,a),xg}var fO=pO;function pO(t,e,n,i){return ig(!0),e[Fn].createComment("")}function Vi(t,e,n){let i=Ft(),r=w1();if(dO(i,r,e)){let s=fr(),o=I1();gN(s,o,i,t,e,i[Fn],n,!1)}return Vi}function KE(t,e,n,i,r){let s=e.inputs,o=r?"class":"style";_g(t,n,s[o],o,i)}function mO(t,e,n,i,r,s){let o=e.consts,a=nd(o,r),c=Id(e,t,2,i,a);return Bx(e,n,c,nd(o,s)),c.attrs!==null&&Om(c,c.attrs,!1),c.mergedAttrs!==null&&Om(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function Zn(t,e,n,i){let r=Ft(),s=fr(),o=Wr+t,a=r[Fn],c=s.firstCreatePass?mO(o,s,r,e,n,i):s.data[o],u=gO(s,r,c,a,e,t);r[o]=u;let l=Qm(c);return zc(c,!0),fx(a,u,c),(c.flags&32)!==32&&ng()&&mg(s,r,u,c),d1()===0&&zs(u,r),h1(),l&&(Fx(s,r,c),kx(s,c,r)),i!==null&&Ux(r,c),Zn}function Jn(){let t=Ui();Cb()?v1():(t=t.parent,zc(t,!1));let e=t;m1(e)&&g1(),f1();let n=fr();return n.firstCreatePass&&(rg(n,t),_b(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&R1(e)&&KE(n,e,Ft(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&P1(e)&&KE(n,e,Ft(),e.stylesWithoutHost,!1),Jn}function Qr(t,e,n,i){return Zn(t,e,n,i),Jn(),Qr}var gO=(t,e,n,i,r,s)=>(ig(!0),ox(i,r,A1()));function Zr(){return Ft()}var dd="en-US";var yO=dd;function vO(t){xR(t,"Expected localeId to be defined"),typeof t=="string"&&(yO=t.toLowerCase().replace(/_/g,"-"))}function Wc(t){return!!t&&typeof t.then=="function"}function tS(t){return!!t&&typeof t.subscribe=="function"}function Bi(t,e,n,i){let r=Ft(),s=fr(),o=Ui();return wO(s,r,r[Fn],o,t,e,i),Bi}function _O(t,e,n,i){let r=t.cleanup;if(r!=null)for(let s=0;s<r.length-1;s+=2){let o=r[s];if(o===n&&r[s+1]===i){let a=e[Cc],c=r[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function wO(t,e,n,i,r,s,o){let a=Qm(i),u=t.firstCreatePass&&$x(t),l=e[hi],d=jx(e),h=!0;if(i.type&3||o){let y=pi(i,e),m=o?o(y):y,f=d.length,b=o?v=>o(cr(v[i.index])):i.index,_=null;if(!o&&a&&(_=_O(t,e,r,i.index)),_!==null){let v=_.__ngLastListenerFn__||_;v.__ngNextListenerFn__=s,_.__ngLastListenerFn__=s,h=!1}else{s=QE(i,e,l,s,!1);let v=n.listen(m,r,s);d.push(s,v),u&&u.push(r,b,f,f+1)}}else s=QE(i,e,l,s,!1);let p=i.outputs,g;if(h&&p!==null&&(g=p[r])){let y=g.length;if(y)for(let m=0;m<y;m+=2){let f=g[m],b=g[m+1],x=e[f][b].subscribe(s),A=d.length;d.push(s,x),u&&u.push(r,i.index,A,-(A+1))}}}function YE(t,e,n,i){try{return Ri(6,e,n),n(i)!==!1}catch(r){return qx(t,r),!1}finally{Ri(7,e,n)}}function QE(t,e,n,i,r){return function s(o){if(o===Function)return i;let a=t.componentOffset>-1?Gs(t.index,e):e;wg(a);let c=YE(e,n,i,o),u=s.__ngNextListenerFn__;for(;u;)c=YE(e,n,u,o)&&c,u=u.__ngNextListenerFn__;return r&&c===!1&&o.preventDefault(),c}}function Jr(t=1){return T1(t)}function EO(){return this._results[Symbol.iterator]()}var Fm=class t{get changes(){return this._changes??=new Yn}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;let n=t.prototype;n[Symbol.iterator]||(n[Symbol.iterator]=EO)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,n){return this._results.reduce(e,n)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,n){this.dirty=!1;let i=$1(e);(this._changesDetected=!j1(this._results,i,n))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}},oa=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=SO;let t=e;return t})(),bO=oa,xO=class extends bO{constructor(e,n,i){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,i){let r=nO(this._declarationLView,this._declarationTContainer,e,{injector:n,dehydratedView:i});return new Hs(r)}};function SO(){return Sg(Ui(),Ft())}function Sg(t,e){return t.type&4?new xO(e,t,ua(t,e)):null}var Um=class t{constructor(e){this.queryList=e,this.matches=null}clone(){return new t(this.queryList)}setDirty(){this.queryList.setDirty()}},Vm=class t{constructor(e=[]){this.queries=e}createEmbeddedView(e){let n=e.queries;if(n!==null){let i=e.contentQueries!==null?e.contentQueries[0]:n.length,r=[];for(let s=0;s<i;s++){let o=n.getByIndex(s),a=this.queries[o.indexInDeclarationView];r.push(a.clone())}return new t(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let n=0;n<this.queries.length;n++)iS(e,n).matches!==null&&this.queries[n].setDirty()}},Bm=class{constructor(e,n,i=null){this.predicate=e,this.flags=n,this.read=i}},zm=class t{constructor(e=[]){this.queries=e}elementStart(e,n){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,n)}elementEnd(e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(e)}embeddedTView(e){let n=null;for(let i=0;i<this.length;i++){let r=n!==null?n.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,n!==null?n.push(s):n=[s])}return n!==null?new t(n):null}template(e,n){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,n)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},Hm=class t{constructor(e,n=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(e,n){this.isApplyingToNode(n)&&this.matchTNode(e,n)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,n){this.elementStart(e,n)}embeddedTView(e,n){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,n),new t(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let n=this._declarationNodeIndex,i=e.parent;for(;i!==null&&i.type&8&&i.index!==n;)i=i.parent;return n===(i!==null?i.index:-1)}return this._appliesToNextNode}matchTNode(e,n){let i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){let s=i[r];this.matchTNodeWithReadOption(e,n,TO(n,s)),this.matchTNodeWithReadOption(e,n,Xl(n,e,s,!1,!1))}else i===oa?n.type&4&&this.matchTNodeWithReadOption(e,n,-1):this.matchTNodeWithReadOption(e,n,Xl(n,e,i,!1,!1))}matchTNodeWithReadOption(e,n,i){if(i!==null){let r=this.metadata.read;if(r!==null)if(r===qs||r===Xs||r===oa&&n.type&4)this.addMatch(n.index,-2);else{let s=Xl(n,e,r,!1,!1);s!==null&&this.addMatch(n.index,s)}else this.addMatch(n.index,i)}}addMatch(e,n){this.matches===null?this.matches=[e,n]:this.matches.push(e,n)}};function TO(t,e){let n=t.localNames;if(n!==null){for(let i=0;i<n.length;i+=2)if(n[i]===e)return n[i+1]}return null}function IO(t,e){return t.type&11?ua(t,e):t.type&4?Sg(t,e):null}function AO(t,e,n,i){return n===-1?IO(e,t):n===-2?MO(t,e,i):ra(t,t[et],n,e)}function MO(t,e,n){if(n===qs)return ua(e,t);if(n===oa)return Sg(e,t);if(n===Xs)return eS(e,t)}function nS(t,e,n,i){let r=e[Ni].queries[i];if(r.matches===null){let s=t.data,o=n.matches,a=[];for(let c=0;c<o.length;c+=2){let u=o[c];if(u<0)a.push(null);else{let l=s[u];a.push(AO(e,l,o[c+1],n.metadata.read))}}r.matches=a}return r.matches}function Gm(t,e,n,i){let r=t.queries.getByIndex(n),s=r.matches;if(s!==null){let o=nS(t,e,r,n);for(let a=0;a<s.length;a+=2){let c=s[a];if(c>0)i.push(o[a/2]);else{let u=s[a+1],l=e[-c];for(let d=kn;d<l.length;d++){let h=l[d];h[Vc]===h[nn]&&Gm(h[et],h,u,i)}if(l[na]!==null){let d=l[na];for(let h=0;h<d.length;h++){let p=d[h];Gm(p[et],p,u,i)}}}}}return i}function CO(t,e){return t[Ni].queries[e].queryList}function DO(t,e,n){let i=new Fm((n&4)===4);hN(t,e,i,i.destroy),e[Ni]===null&&(e[Ni]=new Vm),e[Ni].queries.push(new Um(i))}function RO(t,e,n){t.queries===null&&(t.queries=new zm),t.queries.track(new Hm(e,n))}function iS(t,e){return t.queries.getByIndex(e)}function Md(t,e,n){let i=fr();i.firstCreatePass&&(RO(i,new Bm(t,e,n),-1),(e&2)===2&&(i.staticViewQueries=!0)),DO(i,Ft(),e)}function jc(t){let e=Ft(),n=fr(),i=Db();Jm(i+1);let r=iS(n,i);if(t.dirty&&o1(e)===((r.metadata.flags&2)===2)){if(r.matches===null)t.reset([]);else{let s=r.crossesNgTemplate?Gm(n,e,i,[]):nS(n,e,r,i);t.reset(s,QP),t.notifyOnChanges()}return!0}return!1}function $c(){return CO(Ft(),Db())}function es(t,e=""){let n=Ft(),i=fr(),r=t+Wr,s=i.firstCreatePass?Id(i,r,1,e,null):i.data[r],o=PO(i,n,s,e,t);n[r]=o,ng()&&mg(i,n,o,s),zc(s,!1)}var PO=(t,e,n,i,r)=>(ig(!0),lP(e[Fn],i));var jr=class{},Fc=class{};var Wm=class extends jr{constructor(e,n,i){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new ld(this);let r=pb(e);this._bootstrapComponents=ix(r.bootstrap),this._r3Injector=tx(e,n,[{provide:jr,useValue:this},{provide:Sd,useValue:this.componentFactoryResolver},...i],An(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},jm=class extends Fc{constructor(e){super(),this.moduleType=e}create(e){return new Wm(this.moduleType,e,[])}};var hd=class extends jr{constructor(e){super(),this.componentFactoryResolver=new ld(this),this.instance=null;let n=new Oc([...e.providers,{provide:jr,useValue:this},{provide:Sd,useValue:this.componentFactoryResolver}],e.parent||ug(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Tg(t,e,n=null){return new hd({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var NO=(()=>{let e=class e{constructor(i){this._injector=i,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(i){if(!i.standalone)return null;if(!this.cachedInjectors.has(i)){let r=Zb(!1,i.type),s=r.length>0?Tg([r],this._injector,`Standalone[${i.type.name}]`):null;this.cachedInjectors.set(i,s)}return this.cachedInjectors.get(i)}ngOnDestroy(){try{for(let i of this.cachedInjectors.values())i!==null&&i.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=Ae({token:e,providedIn:"environment",factory:()=>new e(He(Qn))});let t=e;return t})();function da(t){Qx("NgStandalone"),t.getStandaloneInjector=e=>e.get(NO).getOrCreateStandaloneInjector(t)}var $r=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},rS=new $r("17.1.2");var Cd=(()=>{let e=class e{log(i){console.log(i)}warn(i){console.warn(i)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),$m=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},Ig=(()=>{let e=class e{compileModuleSync(i){return new jm(i)}compileModuleAsync(i){return Promise.resolve(this.compileModuleSync(i))}compileModuleAndAllComponentsSync(i){let r=this.compileModuleSync(i),s=pb(i),o=ix(s.declarations).reduce((a,c)=>{let u=Fs(c);return u&&a.push(new kc(u)),a},[]);return new $m(r,o)}compileModuleAndAllComponentsAsync(i){return Promise.resolve(this.compileModuleAndAllComponentsSync(i))}clearCache(){}clearCacheFor(i){}getModuleId(i){}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Dd=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new tn(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let i=this.taskId++;return this.pendingTasks.add(i),i}remove(i){this.pendingTasks.delete(i),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var sS=new $e("");var oS=new $e(""),aS=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r}),this.appInits=ge(oS,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let i=[];for(let s of this.appInits){let o=s();if(Wc(o))i.push(o);else if(tS(o)){let a=new Promise((c,u)=>{o.subscribe({complete:c,error:u})});i.push(a)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(i).then(()=>{r()}).catch(s=>{this.reject(s)}),i.length===0&&r(),this.initialized=!0}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Ag=new $e("");function OO(){zw(()=>{throw new Pe(600,!1)})}function LO(t){return t.isBoundToModule}function kO(t,e,n){try{let i=n();return Wc(i)?i.catch(r=>{throw e.runOutsideAngular(()=>t.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>t.handleError(i)),i}}var qc=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=ge(Cx),this.afterRenderEffectManager=ge(Zx),this.componentTypes=[],this.components=[],this.isStable=ge(Dd).hasPendingTasks.pipe(ot(i=>!i)),this._injector=ge(Qn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(i,r){let s=i instanceof cd;if(!this._injector.get(aS).done){let p=!s&&fb(i),g=!1;throw new Pe(405,g)}let a;s?a=i:a=this._injector.get(Sd).resolveComponentFactory(i),this.componentTypes.push(a.componentType);let c=LO(a)?void 0:this._injector.get(jr),u=r||a.selector,l=a.create(mi.NULL,[],u,c),d=l.location.nativeElement,h=l.injector.get(sS,null);return h?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),tm(this.components,l),h?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new Pe(101,!1);try{this._runningTick=!0;for(let i of this._views)i.detectChanges()}catch(i){this.internalErrorHandler(i)}finally{try{let i=this.afterRenderEffectManager.execute()}catch(i){this.internalErrorHandler(i)}this._runningTick=!1}}attachView(i){let r=i;this._views.push(r),r.attachToAppRef(this)}detachView(i){let r=i;tm(this._views,r),r.detachFromAppRef()}_loadComponent(i){this.attachView(i.hostView),this.tick(),this.components.push(i);let r=this._injector.get(Ag,[]);[...this._bootstrapListeners,...r].forEach(s=>s(i))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(i=>i()),this._views.slice().forEach(i=>i.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(i){return this._destroyListeners.push(i),()=>tm(this._destroyListeners,i)}destroy(){if(this._destroyed)throw new Pe(406,!1);let i=this._injector;i.destroy&&!i.destroyed&&i.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function tm(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}var FO=(()=>{let e=class e{constructor(){this.zone=ge(yt),this.applicationRef=ge(qc)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function UO(t){return[{provide:yt,useFactory:t},{provide:sa,multi:!0,useFactory:()=>{let e=ge(FO,{optional:!0});return()=>e.initialize()}},{provide:sa,multi:!0,useFactory:()=>{let e=ge(HO);return()=>{e.initialize()}}},{provide:Cx,useFactory:VO}]}function VO(){let t=ge(yt),e=ge(lr);return n=>t.runOutsideAngular(()=>e.handleError(n))}function BO(t){let e=UO(()=>new yt(zO(t)));return _d([[],e])}function zO(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var HO=(()=>{let e=class e{constructor(){this.subscription=new At,this.initialized=!1,this.zone=ge(yt),this.pendingTasks=ge(Dd)}initialize(){if(this.initialized)return;this.initialized=!0;let i=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(i=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{yt.assertNotInAngularZone(),queueMicrotask(()=>{i!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(i),i=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{yt.assertInAngularZone(),i??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function GO(){return typeof $localize<"u"&&$localize.locale||dd}var Mg=new $e("",{providedIn:"root",factory:()=>ge(Mg,Qe.Optional|Qe.SkipSelf)||GO()});var cS=new $e("");var Ql=null;function WO(t=[],e){return mi.create({name:e,providers:[{provide:wd,useValue:"platform"},{provide:cS,useValue:new Set([()=>Ql=null])},...t]})}function jO(t=[]){if(Ql)return Ql;let e=WO(t);return Ql=e,OO(),$O(e),e}function $O(t){t.get(dg,null)?.forEach(n=>n())}function uS(t){try{let{rootComponent:e,appProviders:n,platformProviders:i}=t,r=jO(i),s=[BO(),...n||[]],a=new hd({providers:s,parent:r,debugName:"",runEnvironmentInitializers:!1}).injector,c=a.get(yt);return c.run(()=>{a.resolveInjectorInitializers();let u=a.get(lr,null),l;c.runOutsideAngular(()=>{l=c.onError.subscribe({next:p=>{u.handleError(p)}})});let d=()=>a.destroy(),h=r.get(cS);return h.add(d),a.onDestroy(()=>{l.unsubscribe(),h.delete(d)}),kO(u,c,()=>{let p=a.get(aS);return p.runInitializers(),p.donePromise.then(()=>{let g=a.get(Mg,dd);vO(g||dd);let y=a.get(qc);return e!==void 0&&y.bootstrap(e),y})})})}catch(e){return Promise.reject(e)}}var pS=null;function ha(){return pS}function mS(t){pS??=t}var Rd=class{},Un=new $e(""),gS=(()=>{let e=class e{historyGo(i){throw new Error("")}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:()=>ge(YO),providedIn:"platform"});let t=e;return t})();var YO=(()=>{let e=class e extends gS{constructor(){super(),this._doc=ge(Un),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ha().getBaseHref(this._doc)}onPopState(i){let r=ha().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",i,!1),()=>r.removeEventListener("popstate",i)}onHashChange(i){let r=ha().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",i,!1),()=>r.removeEventListener("hashchange",i)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(i){this._location.pathname=i}pushState(i,r,s){this._history.pushState(i,r,s)}replaceState(i,r,s){this._history.replaceState(i,r,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(i=0){this._history.go(i)}getState(){return this._history.state}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:()=>new e,providedIn:"platform"});let t=e;return t})();function yS(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function lS(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,i=n-(t[n-1]==="/"?1:0);return t.slice(0,i)+t.slice(n)}function Ks(t){return t&&t[0]!=="?"?"?"+t:t}var Nd=(()=>{let e=class e{historyGo(i){throw new Error("")}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:()=>ge(vS),providedIn:"root"});let t=e;return t})(),QO=new $e(""),vS=(()=>{let e=class e extends Nd{constructor(i,r){super(),this._platformLocation=i,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??ge(Un).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(i){this._removeListenerFns.push(this._platformLocation.onPopState(i),this._platformLocation.onHashChange(i))}getBaseHref(){return this._baseHref}prepareExternalUrl(i){return yS(this._baseHref,i)}path(i=!1){let r=this._platformLocation.pathname+Ks(this._platformLocation.search),s=this._platformLocation.hash;return s&&i?`${r}${s}`:r}pushState(i,r,s,o){let a=this.prepareExternalUrl(s+Ks(o));this._platformLocation.pushState(i,r,a)}replaceState(i,r,s,o){let a=this.prepareExternalUrl(s+Ks(o));this._platformLocation.replaceState(i,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(i=0){this._platformLocation.historyGo?.(i)}};e.\u0275fac=function(r){return new(r||e)(He(gS),He(QO,8))},e.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Xc=(()=>{let e=class e{constructor(i){this._subject=new Yn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=i;let r=this._locationStrategy.getBaseHref();this._basePath=eL(lS(dS(r))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(i=!1){return this.normalize(this._locationStrategy.path(i))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(i,r=""){return this.path()==this.normalize(i+Ks(r))}normalize(i){return e.stripTrailingSlash(JO(this._basePath,dS(i)))}prepareExternalUrl(i){return i&&i[0]!=="/"&&(i="/"+i),this._locationStrategy.prepareExternalUrl(i)}go(i,r="",s=null){this._locationStrategy.pushState(s,"",i,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(i+Ks(r)),s)}replaceState(i,r="",s=null){this._locationStrategy.replaceState(s,"",i,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(i+Ks(r)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(i=0){this._locationStrategy.historyGo?.(i)}onUrlChange(i){return this._urlChangeListeners.push(i),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(i);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(i="",r){this._urlChangeListeners.forEach(s=>s(i,r))}subscribe(i,r,s){return this._subject.subscribe({next:i,error:r,complete:s})}};e.normalizeQueryParams=Ks,e.joinWithSlash=yS,e.stripTrailingSlash=lS,e.\u0275fac=function(r){return new(r||e)(He(Nd))},e.\u0275prov=Ae({token:e,factory:()=>ZO(),providedIn:"root"});let t=e;return t})();function ZO(){return new Xc(He(Nd))}function JO(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function dS(t){return t.replace(/\/index.html$/,"")}function eL(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function _S(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let i=n.indexOf("="),[r,s]=i==-1?[n,""]:[n.slice(0,i),n.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}var wS=(()=>{let e=class e{constructor(i,r){this._viewContainer=i,this._context=new Cg,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(i){this._context.$implicit=this._context.ngIf=i,this._updateView()}set ngIfThen(i){hS("ngIfThen",i),this._thenTemplateRef=i,this._thenViewRef=null,this._updateView()}set ngIfElse(i){hS("ngIfElse",i),this._elseTemplateRef=i,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(i,r){return!0}};e.\u0275fac=function(r){return new(r||e)(yr(Xs),yr(oa))},e.\u0275dir=md({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let t=e;return t})(),Cg=class{constructor(){this.$implicit=null,this.ngIf=null}};function hS(t,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${t} must be a TemplateRef, but received '${An(e)}'.`)}var Dg=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Fi({type:e}),e.\u0275inj=ki({});let t=e;return t})(),ES="browser",tL="server";function Rg(t){return t===tL}var Pd=class{};var Og=class extends Rd{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Lg=class t extends Og{static makeCurrent(){mS(new t)}onAndCancel(e,n,i){return e.addEventListener(n,i),()=>{e.removeEventListener(n,i)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=iL();return n==null?null:rL(n)}resetBaseElement(){Kc=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return _S(document.cookie,e)}},Kc=null;function iL(){return Kc=Kc||document.querySelector("base"),Kc?Kc.getAttribute("href"):null}function rL(t){return new URL(t,document.baseURI).pathname}var sL=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:e.\u0275fac});let t=e;return t})(),kg=new $e(""),TS=(()=>{let e=class e{constructor(i,r){this._zone=r,this._eventNameToPlugin=new Map,i.forEach(s=>{s.manager=this}),this._plugins=i.slice().reverse()}addEventListener(i,r,s){return this._findPluginFor(r).addEventListener(i,r,s)}getZone(){return this._zone}_findPluginFor(i){let r=this._eventNameToPlugin.get(i);if(r)return r;if(r=this._plugins.find(o=>o.supports(i)),!r)throw new Pe(5101,!1);return this._eventNameToPlugin.set(i,r),r}};e.\u0275fac=function(r){return new(r||e)(He(kg),He(yt))},e.\u0275prov=Ae({token:e,factory:e.\u0275fac});let t=e;return t})(),Od=class{constructor(e){this._doc=e}},Pg="ng-app-id",IS=(()=>{let e=class e{constructor(i,r,s,o={}){this.doc=i,this.appId=r,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Rg(o),this.resetHostNodes()}addStyles(i){for(let r of i)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(i){for(let r of i)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let i=this.styleNodesInDOM;i&&(i.forEach(r=>r.remove()),i.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(i){this.hostNodes.add(i);for(let r of this.getAllStyles())this.addStyleToHost(i,r)}removeHost(i){this.hostNodes.delete(i)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(i){for(let r of this.hostNodes)this.addStyleToHost(r,i)}onStyleRemoved(i){let r=this.styleRef;r.get(i)?.elements?.forEach(s=>s.remove()),r.delete(i)}collectServerRenderedStyles(){let i=this.doc.head?.querySelectorAll(`style[${Pg}="${this.appId}"]`);if(i?.length){let r=new Map;return i.forEach(s=>{s.textContent!=null&&r.set(s.textContent,s)}),r}return null}changeUsageCount(i,r){let s=this.styleRef;if(s.has(i)){let o=s.get(i);return o.usage+=r,o.usage}return s.set(i,{usage:r,elements:[]}),r}getStyleElement(i,r){let s=this.styleNodesInDOM,o=s?.get(r);if(o?.parentNode===i)return s.delete(r),o.removeAttribute(Pg),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=r,this.platformIsServer&&a.setAttribute(Pg,this.appId),i.appendChild(a),a}}addStyleToHost(i,r){let s=this.getStyleElement(i,r),o=this.styleRef,a=o.get(r)?.elements;a?a.push(s):o.set(r,{elements:[s],usage:1})}resetHostNodes(){let i=this.hostNodes;i.clear(),i.add(this.doc.head)}};e.\u0275fac=function(r){return new(r||e)(He(Un),He(lg),He(hg,8),He(Kr))},e.\u0275prov=Ae({token:e,factory:e.\u0275fac});let t=e;return t})(),Ng={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Ug=/%COMP%/g,AS="%COMP%",oL=`_nghost-${AS}`,aL=`_ngcontent-${AS}`,cL=!0,uL=new $e("",{providedIn:"root",factory:()=>cL});function lL(t){return aL.replace(Ug,t)}function dL(t){return oL.replace(Ug,t)}function MS(t,e){return e.map(n=>n.replace(Ug,t))}var bS=(()=>{let e=class e{constructor(i,r,s,o,a,c,u,l=null){this.eventManager=i,this.sharedStylesHost=r,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=u,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=Rg(c),this.defaultRenderer=new Yc(i,a,u,this.platformIsServer)}createRenderer(i,r){if(!i||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Oi.ShadowDom&&(r=Ct(ve({},r),{encapsulation:Oi.Emulated}));let s=this.getOrCreateRenderer(i,r);return s instanceof Ld?s.applyToHost(i):s instanceof Qc&&s.applyStyles(),s}getOrCreateRenderer(i,r){let s=this.rendererByCompId,o=s.get(r.id);if(!o){let a=this.doc,c=this.ngZone,u=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(r.encapsulation){case Oi.Emulated:o=new Ld(u,l,r,this.appId,d,a,c,h);break;case Oi.ShadowDom:return new Fg(u,l,i,r,a,c,this.nonce,h);default:o=new Qc(u,l,r,d,a,c,h);break}s.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(r){return new(r||e)(He(TS),He(IS),He(lg),He(uL),He(Un),He(Kr),He(yt),He(hg))},e.\u0275prov=Ae({token:e,factory:e.\u0275fac});let t=e;return t})(),Yc=class{constructor(e,n,i,r){this.eventManager=e,this.doc=n,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(Ng[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(xS(e)?e.content:e).appendChild(n)}insertBefore(e,n,i){e&&(xS(e)?e.content:e).insertBefore(n,i)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new Pe(-5104,!1);return n||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,i,r){if(r){n=r+":"+n;let s=Ng[r];s?e.setAttributeNS(s,n,i):e.setAttribute(n,i)}else e.setAttribute(n,i)}removeAttribute(e,n,i){if(i){let r=Ng[i];r?e.removeAttributeNS(r,n):e.removeAttribute(`${i}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,i,r){r&(js.DashCase|js.Important)?e.style.setProperty(n,i,r&js.Important?"important":""):e.style[n]=i}removeStyle(e,n,i){i&js.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,i){e!=null&&(e[n]=i)}setValue(e,n){e.nodeValue=n}listen(e,n,i){if(typeof e=="string"&&(e=ha().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(i))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function xS(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var Fg=class extends Yc{constructor(e,n,i,r,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=n,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=MS(r.id,r.styles);for(let l of u){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=l,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,i){return super.insertBefore(this.nodeOrShadowRoot(e),n,i)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Qc=class extends Yc{constructor(e,n,i,r,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=r,this.styles=c?MS(c,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Ld=class extends Qc{constructor(e,n,i,r,s,o,a,c){let u=r+"-"+i.id;super(e,n,i,s,o,a,c,u),this.contentAttr=lL(u),this.hostAttr=dL(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let i=super.createElement(e,n);return super.setAttribute(i,this.contentAttr,""),i}},hL=(()=>{let e=class e extends Od{constructor(i){super(i)}supports(i){return!0}addEventListener(i,r,s){return i.addEventListener(r,s,!1),()=>this.removeEventListener(i,r,s)}removeEventListener(i,r,s){return i.removeEventListener(r,s)}};e.\u0275fac=function(r){return new(r||e)(He(Un))},e.\u0275prov=Ae({token:e,factory:e.\u0275fac});let t=e;return t})(),SS=["alt","control","meta","shift"],fL={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},pL={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},mL=(()=>{let e=class e extends Od{constructor(i){super(i)}supports(i){return e.parseEventName(i)!=null}addEventListener(i,r,s){let o=e.parseEventName(r),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ha().onAndCancel(i,o.domEventName,a))}static parseEventName(i){let r=i.toLowerCase().split("."),s=r.shift();if(r.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(r.pop()),a="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),a="code."),SS.forEach(l=>{let d=r.indexOf(l);d>-1&&(r.splice(d,1),a+=l+".")}),a+=o,r.length!=0||o.length===0)return null;let u={};return u.domEventName=s,u.fullKey=a,u}static matchEventFullKeyCode(i,r){let s=fL[i.key]||i.key,o="";return r.indexOf("code.")>-1&&(s=i.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),SS.forEach(a=>{if(a!==s){let c=pL[a];c(i)&&(o+=a+".")}}),o+=s,o===r)}static eventCallback(i,r,s){return o=>{e.matchEventFullKeyCode(o,i)&&s.runGuarded(()=>r(o))}}static _normalizeKey(i){return i==="esc"?"escape":i}};e.\u0275fac=function(r){return new(r||e)(He(Un))},e.\u0275prov=Ae({token:e,factory:e.\u0275fac});let t=e;return t})();function CS(t,e){return uS(ve({rootComponent:t},gL(e)))}function gL(t){return{appProviders:[...EL,...t?.providers??[]],platformProviders:wL}}function yL(){Lg.makeCurrent()}function vL(){return new lr}function _L(){return nx(document),document}var wL=[{provide:Kr,useValue:ES},{provide:dg,useValue:yL,multi:!0},{provide:Un,useFactory:_L,deps:[]}];var EL=[{provide:wd,useValue:"root"},{provide:lr,useFactory:vL,deps:[]},{provide:kg,useClass:hL,multi:!0,deps:[Un,yt,Kr]},{provide:kg,useClass:mL,multi:!0,deps:[Un]},bS,IS,TS,{provide:Lc,useExisting:bS},{provide:Pd,useClass:sL,deps:[]},[]];var DS=(()=>{let e=class e{constructor(i){this._doc=i}getTitle(){return this._doc.title}setTitle(i){this._doc.title=i||""}};e.\u0275fac=function(r){return new(r||e)(He(Un))},e.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Vg=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:function(r){let s=null;return r?s=new(r||e):s=He(bL),s},providedIn:"root"});let t=e;return t})(),bL=(()=>{let e=class e extends Vg{constructor(i){super(),this._doc=i}sanitize(i,r){if(r==null)return null;switch(i){case mr.NONE:return r;case mr.HTML:return $s(r,"HTML")?Yr(r):xx(this._doc,String(r)).toString();case mr.STYLE:return $s(r,"Style")?Yr(r):r;case mr.SCRIPT:if($s(r,"Script"))return Yr(r);throw new Pe(5200,!1);case mr.URL:return $s(r,"URL")?Yr(r):xd(String(r));case mr.RESOURCE_URL:if($s(r,"ResourceURL"))return Yr(r);throw new Pe(5201,!1);default:throw new Pe(5202,!1)}}bypassSecurityTrustHtml(i){return px(i)}bypassSecurityTrustStyle(i){return mx(i)}bypassSecurityTrustScript(i){return gx(i)}bypassSecurityTrustUrl(i){return yx(i)}bypassSecurityTrustResourceUrl(i){return vx(i)}};e.\u0275fac=function(r){return new(r||e)(He(Un))},e.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var We="primary",hu=Symbol("RouteTitle"),Wg=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function ya(t){return new Wg(t)}function xL(t,e,n){let i=n.path.split("/");if(i.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||i.length<t.length))return null;let r={};for(let s=0;s<i.length;s++){let o=i[s],a=t[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,i.length),posParams:r}}function SL(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!zi(t[n],e[n]))return!1;return!0}function zi(t,e){let n=t?jg(t):void 0,i=e?jg(e):void 0;if(!n||!i||n.length!=i.length)return!1;let r;for(let s=0;s<n.length;s++)if(r=n[s],!FS(t[r],e[r]))return!1;return!0}function jg(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function FS(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),i=[...e].sort();return n.every((r,s)=>i[s]===r)}else return t===e}function US(t){return t.length>0?t[t.length-1]:null}function is(t){return Vp(t)?t:Wc(t)?zt(Promise.resolve(t)):ze(t)}var TL={exact:BS,subset:zS},VS={exact:IL,subset:AL,ignored:()=>!0};function PS(t,e,n){return TL[n.paths](t.root,e.root,n.matrixParams)&&VS[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function IL(t,e){return zi(t,e)}function BS(t,e,n){if(!Qs(t.segments,e.segments)||!Ud(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!t.children[i]||!BS(t.children[i],e.children[i],n))return!1;return!0}function AL(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>FS(t[n],e[n]))}function zS(t,e,n){return HS(t,e,e.segments,n)}function HS(t,e,n,i){if(t.segments.length>n.length){let r=t.segments.slice(0,n.length);return!(!Qs(r,n)||e.hasChildren()||!Ud(r,n,i))}else if(t.segments.length===n.length){if(!Qs(t.segments,n)||!Ud(t.segments,n,i))return!1;for(let r in e.children)if(!t.children[r]||!zS(t.children[r],e.children[r],i))return!1;return!0}else{let r=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!Qs(t.segments,r)||!Ud(t.segments,r,i)||!t.children[We]?!1:HS(t.children[We],e,s,i)}}function Ud(t,e,n){return e.every((i,r)=>VS[n](t[r].parameters,i.parameters))}var ts=class{constructor(e=new dt([],{}),n={},i=null){this.root=e,this.queryParams=n,this.fragment=i}get queryParamMap(){return this._queryParamMap??=ya(this.queryParams),this._queryParamMap}toString(){return DL.serialize(this)}},dt=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Vd(this)}},Ys=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=ya(this.parameters),this._parameterMap}toString(){return WS(this)}};function ML(t,e){return Qs(t,e)&&t.every((n,i)=>zi(n.parameters,e[i].parameters))}function Qs(t,e){return t.length!==e.length?!1:t.every((n,i)=>n.path===e[i].path)}function CL(t,e){let n=[];return Object.entries(t.children).forEach(([i,r])=>{i===We&&(n=n.concat(e(r,i)))}),Object.entries(t.children).forEach(([i,r])=>{i!==We&&(n=n.concat(e(r,i)))}),n}var yy=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:()=>new zd,providedIn:"root"});let t=e;return t})(),zd=class{parse(e){let n=new qg(e);return new ts(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${Zc(e.root,!0)}`,i=NL(e.queryParams),r=typeof e.fragment=="string"?`#${RL(e.fragment)}`:"";return`${n}${i}${r}`}},DL=new zd;function Vd(t){return t.segments.map(e=>WS(e)).join("/")}function Zc(t,e){if(!t.hasChildren())return Vd(t);if(e){let n=t.children[We]?Zc(t.children[We],!1):"",i=[];return Object.entries(t.children).forEach(([r,s])=>{r!==We&&i.push(`${r}:${Zc(s,!1)}`)}),i.length>0?`${n}(${i.join("//")})`:n}else{let n=CL(t,(i,r)=>r===We?[Zc(t.children[We],!1)]:[`${r}:${Zc(i,!1)}`]);return Object.keys(t.children).length===1&&t.children[We]!=null?`${Vd(t)}/${n[0]}`:`${Vd(t)}/(${n.join("//")})`}}function GS(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function kd(t){return GS(t).replace(/%3B/gi,";")}function RL(t){return encodeURI(t)}function $g(t){return GS(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Bd(t){return decodeURIComponent(t)}function NS(t){return Bd(t.replace(/\+/g,"%20"))}function WS(t){return`${$g(t.path)}${PL(t.parameters)}`}function PL(t){return Object.entries(t).map(([e,n])=>`;${$g(e)}=${$g(n)}`).join("")}function NL(t){let e=Object.entries(t).map(([n,i])=>Array.isArray(i)?i.map(r=>`${kd(n)}=${kd(r)}`).join("&"):`${kd(n)}=${kd(i)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var OL=/^[^\/()?;#]+/;function Bg(t){let e=t.match(OL);return e?e[0]:""}var LL=/^[^\/()?;=#]+/;function kL(t){let e=t.match(LL);return e?e[0]:""}var FL=/^[^=?&#]+/;function UL(t){let e=t.match(FL);return e?e[0]:""}var VL=/^[^&#]+/;function BL(t){let e=t.match(VL);return e?e[0]:""}var qg=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new dt([],{}):new dt([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(i[We]=new dt(e,n)),i}parseSegment(){let e=Bg(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new Pe(4009,!1);return this.capture(e),new Ys(Bd(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=kL(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){let r=Bg(this.remaining);r&&(i=r,this.capture(i))}e[Bd(n)]=Bd(i)}parseQueryParam(e){let n=UL(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){let o=BL(this.remaining);o&&(i=o,this.capture(i))}let r=NS(n),s=NS(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=Bg(this.remaining),r=this.remaining[i.length];if(r!=="/"&&r!==")"&&r!==";")throw new Pe(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=We);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[We]:new dt([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new Pe(4011,!1)}};function jS(t){return t.segments.length>0?new dt([],{[We]:t}):t}function $S(t){let e={};for(let[i,r]of Object.entries(t.children)){let s=$S(r);if(i===We&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}let n=new dt(t.segments,e);return zL(n)}function zL(t){if(t.numberOfChildren===1&&t.children[We]){let e=t.children[We];return new dt(t.segments.concat(e.segments),e.children)}return t}function va(t){return t instanceof ts}function HL(t,e,n=null,i=null){let r=qS(t);return XS(r,e,n,i)}function qS(t){let e;function n(s){let o={};for(let c of s.children){let u=n(c);o[c.outlet]=u}let a=new dt(s.url,o);return s===t&&(e=a),a}let i=n(t.root),r=jS(i);return e??r}function XS(t,e,n,i){let r=t;for(;r.parent;)r=r.parent;if(e.length===0)return zg(r,r,r,n,i);let s=GL(e);if(s.toRoot())return zg(r,r,new dt([],{}),n,i);let o=WL(s,r,t),a=o.processChildren?tu(o.segmentGroup,o.index,s.commands):YS(o.segmentGroup,o.index,s.commands);return zg(r,o.segmentGroup,a,n,i)}function Hd(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function ru(t){return typeof t=="object"&&t!=null&&t.outlets}function zg(t,e,n,i,r){let s={};i&&Object.entries(i).forEach(([c,u])=>{s[c]=Array.isArray(u)?u.map(l=>`${l}`):`${u}`});let o;t===e?o=n:o=KS(t,e,n);let a=jS($S(o));return new ts(a,s,r)}function KS(t,e,n){let i={};return Object.entries(t.children).forEach(([r,s])=>{s===e?i[r]=n:i[r]=KS(s,e,n)}),new dt(t.segments,i)}var Gd=class{constructor(e,n,i){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=i,e&&i.length>0&&Hd(i[0]))throw new Pe(4003,!1);let r=i.find(ru);if(r&&r!==US(i))throw new Pe(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function GL(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new Gd(!0,0,t);let e=0,n=!1,i=t.reduce((r,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,u])=>{a[c]=typeof u=="string"?u.split("/"):u}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return typeof s!="string"?[...r,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?n=!0:a===".."?e++:a!=""&&r.push(a))}),r):[...r,s]},[]);return new Gd(n,e,i)}var ma=class{constructor(e,n,i){this.segmentGroup=e,this.processChildren=n,this.index=i}};function WL(t,e,n){if(t.isAbsolute)return new ma(e,!0,0);if(!n)return new ma(e,!1,NaN);if(n.parent===null)return new ma(n,!0,0);let i=Hd(t.commands[0])?0:1,r=n.segments.length-1+i;return jL(n,r,t.numberOfDoubleDots)}function jL(t,e,n){let i=t,r=e,s=n;for(;s>r;){if(s-=r,i=i.parent,!i)throw new Pe(4005,!1);r=i.segments.length}return new ma(i,!1,r-s)}function $L(t){return ru(t[0])?t[0].outlets:{[We]:t}}function YS(t,e,n){if(t??=new dt([],{}),t.segments.length===0&&t.hasChildren())return tu(t,e,n);let i=qL(t,e,n),r=n.slice(i.commandIndex);if(i.match&&i.pathIndex<t.segments.length){let s=new dt(t.segments.slice(0,i.pathIndex),{});return s.children[We]=new dt(t.segments.slice(i.pathIndex),t.children),tu(s,0,r)}else return i.match&&r.length===0?new dt(t.segments,{}):i.match&&!t.hasChildren()?Xg(t,e,n):i.match?tu(t,0,r):Xg(t,e,n)}function tu(t,e,n){if(n.length===0)return new dt(t.segments,{});{let i=$L(n),r={};if(Object.keys(i).some(s=>s!==We)&&t.children[We]&&t.numberOfChildren===1&&t.children[We].segments.length===0){let s=tu(t.children[We],e,n);return new dt(t.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(r[s]=YS(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{i[s]===void 0&&(r[s]=o)}),new dt(t.segments,r)}}function qL(t,e,n){let i=0,r=e,s={match:!1,pathIndex:0,commandIndex:0};for(;r<t.segments.length;){if(i>=n.length)return s;let o=t.segments[r],a=n[i];if(ru(a))break;let c=`${a}`,u=i<n.length-1?n[i+1]:null;if(r>0&&c===void 0)break;if(c&&u&&typeof u=="object"&&u.outlets===void 0){if(!LS(c,u,o))return s;i+=2}else{if(!LS(c,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}function Xg(t,e,n){let i=t.segments.slice(0,e),r=0;for(;r<n.length;){let s=n[r];if(ru(s)){let c=XL(s.outlets);return new dt(i,c)}if(r===0&&Hd(n[0])){let c=t.segments[e];i.push(new Ys(c.path,OS(n[0]))),r++;continue}let o=ru(s)?s.outlets[We]:`${s}`,a=r<n.length-1?n[r+1]:null;o&&a&&Hd(a)?(i.push(new Ys(o,OS(a))),r+=2):(i.push(new Ys(o,{})),r++)}return new dt(i,{})}function XL(t){let e={};return Object.entries(t).forEach(([n,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[n]=Xg(new dt([],{}),0,i))}),e}function OS(t){let e={};return Object.entries(t).forEach(([n,i])=>e[n]=`${i}`),e}function LS(t,e,n){return t==n.path&&zi(e,n.parameters)}var nu="imperative",rn=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(rn||{}),ti=class{constructor(e,n){this.id=e,this.url=n}},su=class extends ti{constructor(e,n,i="imperative",r=null){super(e,n),this.type=rn.NavigationStart,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Zs=class extends ti{constructor(e,n,i){super(e,n),this.urlAfterRedirects=i,this.type=rn.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},ei=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(ei||{}),Kg=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(Kg||{}),ns=class extends ti{constructor(e,n,i,r){super(e,n),this.reason=i,this.code=r,this.type=rn.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Js=class extends ti{constructor(e,n,i,r){super(e,n),this.reason=i,this.code=r,this.type=rn.NavigationSkipped}},ou=class extends ti{constructor(e,n,i,r){super(e,n),this.error=i,this.target=r,this.type=rn.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Wd=class extends ti{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r,this.type=rn.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Yg=class extends ti{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r,this.type=rn.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Qg=class extends ti{constructor(e,n,i,r,s){super(e,n),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=rn.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Zg=class extends ti{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r,this.type=rn.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Jg=class extends ti{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r,this.type=rn.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ey=class{constructor(e){this.route=e,this.type=rn.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},ty=class{constructor(e){this.route=e,this.type=rn.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},ny=class{constructor(e){this.snapshot=e,this.type=rn.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},iy=class{constructor(e){this.snapshot=e,this.type=rn.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ry=class{constructor(e){this.snapshot=e,this.type=rn.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},sy=class{constructor(e){this.snapshot=e,this.type=rn.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var au=class{},cu=class{constructor(e){this.url=e}};var oy=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Yd,this.attachRef=null}},Yd=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(i,r){let s=this.getOrCreateContext(i);s.outlet=r,this.contexts.set(i,s)}onChildOutletDestroyed(i){let r=this.getContext(i);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let i=this.contexts;return this.contexts=new Map,i}onOutletReAttached(i){this.contexts=i}getOrCreateContext(i){let r=this.getContext(i);return r||(r=new oy,this.contexts.set(i,r)),r}getContext(i){return this.contexts.get(i)||null}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),jd=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=ay(e,this._root);return n?n.children.map(i=>i.value):[]}firstChild(e){let n=ay(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=cy(e,this._root);return n.length<2?[]:n[n.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return cy(e,this._root).map(n=>n.value)}};function ay(t,e){if(t===e.value)return e;for(let n of e.children){let i=ay(t,n);if(i)return i}return null}function cy(t,e){if(t===e.value)return[e];for(let n of e.children){let i=cy(t,n);if(i.length)return i.unshift(e),i}return[]}var Vn=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function pa(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var $d=class extends jd{constructor(e,n){super(e),this.snapshot=n,_y(this,e)}toString(){return this.snapshot.toString()}};function QS(t){let e=KL(t),n=new tn([new Ys("",{})]),i=new tn({}),r=new tn({}),s=new tn({}),o=new tn(""),a=new _a(n,i,s,o,r,We,t,e.root);return a.snapshot=e.root,new $d(new Vn(a,[]),e)}function KL(t){let e={},n={},i={},r="",s=new uu([],e,i,r,n,We,t,null,{});return new qd("",new Vn(s,[]))}var _a=class{constructor(e,n,i,r,s,o,a,c){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(ot(u=>u[hu]))??ze(void 0),this.url=e,this.params=n,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(ot(e=>ya(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(ot(e=>ya(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function vy(t,e,n="emptyOnly"){let i,{routeConfig:r}=t;return e!==null&&(n==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:ve(ve({},e.params),t.params),data:ve(ve({},e.data),t.data),resolve:ve(ve(ve(ve({},t.data),e.data),r?.data),t._resolvedData)}:i={params:ve({},t.params),data:ve({},t.data),resolve:ve(ve({},t.data),t._resolvedData??{})},r&&JS(r)&&(i.resolve[hu]=r.title),i}var uu=class{get title(){return this.data?.[hu]}constructor(e,n,i,r,s,o,a,c,u){this.url=e,this.params=n,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ya(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ya(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},qd=class extends jd{constructor(e,n){super(n),this.url=e,_y(this,n)}toString(){return ZS(this._root)}};function _y(t,e){e.value._routerState=t,e.children.forEach(n=>_y(t,n))}function ZS(t){let e=t.children.length>0?` { ${t.children.map(ZS).join(", ")} } `:"";return`${t.value}${e}`}function Hg(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,zi(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),zi(e.params,n.params)||t.paramsSubject.next(n.params),SL(e.url,n.url)||t.urlSubject.next(n.url),zi(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function uy(t,e){let n=zi(t.params,e.params)&&ML(t.url,e.url),i=!t.parent!=!e.parent;return n&&!i&&(!t.parent||uy(t.parent,e.parent))}function JS(t){return typeof t.title=="string"||t.title===null}var wy=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=We,this.activateEvents=new Yn,this.deactivateEvents=new Yn,this.attachEvents=new Yn,this.detachEvents=new Yn,this.parentContexts=ge(Yd),this.location=ge(Xs),this.changeDetector=ge(la),this.environmentInjector=ge(Qn),this.inputBinder=ge(Ey,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(i){if(i.name){let{firstChange:r,previousValue:s}=i.name;if(r)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(i){return this.parentContexts.getContext(i)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let i=this.parentContexts.getContext(this.name);i?.route&&(i.attachRef?this.attach(i.attachRef,i.route):this.activateWith(i.route,i.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Pe(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Pe(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Pe(4012,!1);this.location.detach();let i=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(i.instance),i}attach(i,r){this.activated=i,this._activatedRoute=r,this.location.insert(i.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(i.instance)}deactivate(){if(this.activated){let i=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(i)}}activateWith(i,r){if(this.isActivated)throw new Pe(4013,!1);this._activatedRoute=i;let s=this.location,a=i.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,u=new ly(i,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:u,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=md({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[vd]});let t=e;return t})(),ly=class{constructor(e,n,i){this.route=e,this.childContexts=n,this.parent=i}get(e,n){return e===_a?this.route:e===Yd?this.childContexts:this.parent.get(e,n)}},Ey=new $e("");function YL(t,e,n){let i=lu(t,e._root,n?n._root:void 0);return new $d(i,e)}function lu(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let i=n.value;i._futureSnapshot=e.value;let r=QL(t,e,n);return new Vn(i,r)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>lu(t,a)),o}}let i=ZL(e.value),r=e.children.map(s=>lu(t,s));return new Vn(i,r)}}function QL(t,e,n){return e.children.map(i=>{for(let r of n.children)if(t.shouldReuseRoute(i.value,r.value.snapshot))return lu(t,i,r);return lu(t,i)})}function ZL(t){return new _a(new tn(t.url),new tn(t.params),new tn(t.queryParams),new tn(t.fragment),new tn(t.data),t.outlet,t.component,t)}var eT="ngNavigationCancelingError";function tT(t,e){let{redirectTo:n,navigationBehaviorOptions:i}=va(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=nT(!1,ei.Redirect);return r.url=n,r.navigationBehaviorOptions=i,r}function nT(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[eT]=!0,n.cancellationCode=e,n}function JL(t){return iT(t)&&va(t.url)}function iT(t){return!!t&&t[eT]}var ek=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=aa({type:e,selectors:[["ng-component"]],standalone:!0,features:[da],decls:1,vars:0,template:function(r,s){r&1&&Qr(0,"router-outlet")},dependencies:[wy],encapsulation:2});let t=e;return t})();function tk(t,e){return t.providers&&!t._injector&&(t._injector=Tg(t.providers,e,`Route: ${t.path}`)),t._injector??e}function by(t){let e=t.children&&t.children.map(by),n=e?Ct(ve({},t),{children:e}):ve({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==We&&(n.component=ek),n}function Hi(t){return t.outlet||We}function nk(t,e){let n=t.filter(i=>Hi(i)===e);return n.push(...t.filter(i=>Hi(i)!==e)),n}function fu(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var ik=(t,e,n,i)=>ot(r=>(new dy(e,r.targetRouterState,r.currentRouterState,n,i).activate(t),r)),dy=class{constructor(e,n,i,r,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,i,e),Hg(this.futureState.root),this.activateChildRoutes(n,i,e)}deactivateChildRoutes(e,n,i){let r=pa(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,n,i){let r=e.value,s=n?n.value:null;if(r===s)if(r.component){let o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,i);else s&&this.deactivateRouteAndItsChildren(n,i)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let i=n.getContext(e.value.outlet),r=i&&e.value.component?i.children:n,s=pa(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);if(i&&i.outlet){let o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let i=n.getContext(e.value.outlet),r=i&&e.value.component?i.children:n,s=pa(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,n,i){let r=pa(n);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new sy(s.value.snapshot))}),e.children.length&&this.forwardEvent(new iy(e.value.snapshot))}activateRoutes(e,n,i){let r=e.value,s=n?n.value:null;if(Hg(r),r===s)if(r.component){let o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,i);else if(r.component){let o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Hg(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=fu(r.snapshot);o.attachRef=null,o.route=r,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}},Xd=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},ga=class{constructor(e,n){this.component=e,this.route=n}};function rk(t,e,n){let i=t._root,r=e?e._root:null;return Jc(i,r,n,[i.value])}function sk(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function Ea(t,e){let n=Symbol(),i=e.get(t,n);return i===n?typeof t=="function"&&!ib(t)?t:e.get(t):i}function Jc(t,e,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=pa(e);return t.children.forEach(o=>{ok(o,s[o.value.outlet],n,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>iu(a,n.getContext(o),r)),r}function ok(t,e,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=ak(o,s,s.routeConfig.runGuardsAndResolvers);c?r.canActivateChecks.push(new Xd(i)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Jc(t,e,a?a.children:null,i,r):Jc(t,e,n,i,r),c&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new ga(a.outlet.component,o))}else o&&iu(e,a,r),r.canActivateChecks.push(new Xd(i)),s.component?Jc(t,null,a?a.children:null,i,r):Jc(t,null,n,i,r);return r}function ak(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!Qs(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Qs(t.url,e.url)||!zi(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!uy(t,e)||!zi(t.queryParams,e.queryParams);case"paramsChange":default:return!uy(t,e)}}function iu(t,e,n){let i=pa(t),r=t.value;Object.entries(i).forEach(([s,o])=>{r.component?e?iu(o,e.children.getContext(s),n):iu(o,null,n):iu(o,e,n)}),r.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new ga(e.outlet.component,r)):n.canDeactivateChecks.push(new ga(null,r)):n.canDeactivateChecks.push(new ga(null,r))}function pu(t){return typeof t=="function"}function ck(t){return typeof t=="boolean"}function uk(t){return t&&pu(t.canLoad)}function lk(t){return t&&pu(t.canActivate)}function dk(t){return t&&pu(t.canActivateChild)}function hk(t){return t&&pu(t.canDeactivate)}function fk(t){return t&&pu(t.canMatch)}function rT(t){return t instanceof sr||t?.name==="EmptyError"}var Fd=Symbol("INITIAL_VALUE");function wa(){return ui(t=>Bl(t.map(e=>e.pipe(or(1),Wp(Fd)))).pipe(ot(e=>{for(let n of e)if(n!==!0){if(n===Fd)return Fd;if(n===!1||n instanceof ts)return n}return!0}),ci(e=>e!==Fd),or(1)))}function pk(t,e){return Ht(n=>{let{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?ze(Ct(ve({},n),{guardsResult:!0})):mk(o,i,r,t).pipe(Ht(a=>a&&ck(a)?gk(i,s,t,e):ze(a)),ot(a=>Ct(ve({},n),{guardsResult:a})))})}function mk(t,e,n,i){return zt(t).pipe(Ht(r=>Ek(r.component,r.route,n,e,i)),Ci(r=>r!==!0,!0))}function gk(t,e,n,i){return zt(e).pipe(Xo(r=>qo(vk(r.route.parent,i),yk(r.route,i),wk(t,r.path,n),_k(t,r.route,n))),Ci(r=>r!==!0,!0))}function yk(t,e){return t!==null&&e&&e(new ry(t)),ze(!0)}function vk(t,e){return t!==null&&e&&e(new ny(t)),ze(!0)}function _k(t,e,n){let i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||i.length===0)return ze(!0);let r=i.map(s=>zl(()=>{let o=fu(e)??n,a=Ea(s,o),c=lk(a)?a.canActivate(e,t):Ws(o,()=>a(e,t));return is(c).pipe(Ci())}));return ze(r).pipe(wa())}function wk(t,e,n){let i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>sk(o)).filter(o=>o!==null).map(o=>zl(()=>{let a=o.guards.map(c=>{let u=fu(o.node)??n,l=Ea(c,u),d=dk(l)?l.canActivateChild(i,t):Ws(u,()=>l(i,t));return is(d).pipe(Ci())});return ze(a).pipe(wa())}));return ze(s).pipe(wa())}function Ek(t,e,n,i,r){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return ze(!0);let o=s.map(a=>{let c=fu(e)??r,u=Ea(a,c),l=hk(u)?u.canDeactivate(t,e,n,i):Ws(c,()=>u(t,e,n,i));return is(l).pipe(Ci())});return ze(o).pipe(wa())}function bk(t,e,n,i){let r=e.canLoad;if(r===void 0||r.length===0)return ze(!0);let s=r.map(o=>{let a=Ea(o,t),c=uk(a)?a.canLoad(e,n):Ws(t,()=>a(e,n));return is(c)});return ze(s).pipe(wa(),sT(i))}function sT(t){return Rp(kt(e=>{if(va(e))throw tT(t,e)}),ot(e=>e===!0))}function xk(t,e,n,i){let r=e.canMatch;if(!r||r.length===0)return ze(!0);let s=r.map(o=>{let a=Ea(o,t),c=fk(a)?a.canMatch(e,n):Ws(t,()=>a(e,n));return is(c)});return ze(s).pipe(wa(),sT(i))}var du=class{constructor(e){this.segmentGroup=e||null}},Kd=class extends Error{constructor(e){super(),this.urlTree=e}};function fa(t){return $o(new du(t))}function Sk(t){return $o(new Pe(4e3,!1))}function Tk(t){return $o(nT(!1,ei.GuardRejected))}var hy=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let i=[],r=n.root;for(;;){if(i=i.concat(r.segments),r.numberOfChildren===0)return ze(i);if(r.numberOfChildren>1||!r.children[We])return Sk(e.redirectTo);r=r.children[We]}}applyRedirectCommands(e,n,i){let r=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,i);if(n.startsWith("/"))throw new Kd(r);return r}applyRedirectCreateUrlTree(e,n,i,r){let s=this.createSegmentGroup(e,n.root,i,r);return new ts(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let i={};return Object.entries(e).forEach(([r,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);i[r]=n[a]}else i[r]=s}),i}createSegmentGroup(e,n,i,r){let s=this.createSegments(e,n.segments,i,r),o={};return Object.entries(n.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,i,r)}),new dt(s,o)}createSegments(e,n,i,r){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,n,i){let r=i[n.path.substring(1)];if(!r)throw new Pe(4001,!1);return r}findOrReturn(e,n){let i=0;for(let r of n){if(r.path===e.path)return n.splice(i),r;i++}return e}},fy={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Ik(t,e,n,i,r){let s=xy(t,e,n);return s.matched?(i=tk(e,i),xk(i,e,n,r).pipe(ot(o=>o===!0?s:ve({},fy)))):ze(s)}function xy(t,e,n){if(e.path==="**")return Ak(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?ve({},fy):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let r=(e.matcher||xL)(n,t,e);if(!r)return ve({},fy);let s={};Object.entries(r.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=r.consumed.length>0?ve(ve({},s),r.consumed[r.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:n.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function Ak(t){return{matched:!0,parameters:t.length>0?US(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function kS(t,e,n,i){return n.length>0&&Dk(t,n,i)?{segmentGroup:new dt(e,Ck(i,new dt(n,t.children))),slicedSegments:[]}:n.length===0&&Rk(t,n,i)?{segmentGroup:new dt(t.segments,Mk(t,n,i,t.children)),slicedSegments:n}:{segmentGroup:new dt(t.segments,t.children),slicedSegments:n}}function Mk(t,e,n,i){let r={};for(let s of n)if(Qd(t,e,s)&&!i[Hi(s)]){let o=new dt([],{});r[Hi(s)]=o}return ve(ve({},i),r)}function Ck(t,e){let n={};n[We]=e;for(let i of t)if(i.path===""&&Hi(i)!==We){let r=new dt([],{});n[Hi(i)]=r}return n}function Dk(t,e,n){return n.some(i=>Qd(t,e,i)&&Hi(i)!==We)}function Rk(t,e,n){return n.some(i=>Qd(t,e,i))}function Qd(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function Pk(t,e,n,i){return Hi(t)!==i&&(i===We||!Qd(e,n,t))?!1:xy(e,t,n).matched}function Nk(t,e,n){return e.length===0&&!t.children[n]}var py=class{};function Ok(t,e,n,i,r,s,o="emptyOnly"){return new my(t,e,n,i,r,o,s).recognize()}var Lk=31,my=class{constructor(e,n,i,r,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new hy(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new Pe(4002,`'${e.segmentGroup}'`)}recognize(){let e=kS(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(ot(n=>{let i=new uu([],Object.freeze({}),Object.freeze(ve({},this.urlTree.queryParams)),this.urlTree.fragment,{},We,this.rootComponentType,null,{}),r=new Vn(i,n),s=new qd("",r),o=HL(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,We).pipe(Br(i=>{if(i instanceof Kd)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof du?this.noMatchError(i):i}))}inheritParamsAndData(e,n){let i=e.value,r=vy(i,n,this.paramsInheritanceStrategy);i.params=Object.freeze(r.params),i.data=Object.freeze(r.data),e.children.forEach(s=>this.inheritParamsAndData(s,i))}processSegmentGroup(e,n,i,r){return i.segments.length===0&&i.hasChildren()?this.processChildren(e,n,i):this.processSegment(e,n,i,i.segments,r,!0).pipe(ot(s=>s instanceof Vn?[s]:[]))}processChildren(e,n,i){let r=[];for(let s of Object.keys(i.children))s==="primary"?r.unshift(s):r.push(s);return zt(r).pipe(Xo(s=>{let o=i.children[s],a=nk(n,s);return this.processSegmentGroup(e,a,o,s)}),Gp((s,o)=>(s.push(...o),s)),zr(null),Hp(),Ht(s=>{if(s===null)return fa(i);let o=oT(s);return kk(o),ze(o)}))}processSegment(e,n,i,r,s,o){return zt(n).pipe(Xo(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,i,r,s,o).pipe(Br(c=>{if(c instanceof du)return ze(null);throw c}))),Ci(a=>!!a),Br(a=>{if(rT(a))return Nk(i,r,s)?ze(new py):fa(i);throw a}))}processSegmentAgainstRoute(e,n,i,r,s,o,a){return Pk(i,r,s,o)?i.redirectTo===void 0?this.matchSegmentAgainstRoute(e,r,i,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,r,n,i,s,o):fa(r):fa(r)}expandSegmentAgainstRouteUsingRedirect(e,n,i,r,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:u,remainingSegments:l}=xy(n,r,s);if(!a)return fa(n);r.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Lk&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(c,r.redirectTo,u);return this.applyRedirects.lineralizeSegments(r,d).pipe(Ht(h=>this.processSegment(e,i,n,h.concat(l),o,!1)))}matchSegmentAgainstRoute(e,n,i,r,s){let o=Ik(n,i,r,e,this.urlSerializer);return i.path==="**"&&(n.children={}),o.pipe(ui(a=>a.matched?(e=i._injector??e,this.getChildConfig(e,i,r).pipe(ui(({routes:c})=>{let u=i._loadedInjector??e,{consumedSegments:l,remainingSegments:d,parameters:h}=a,p=new uu(l,h,Object.freeze(ve({},this.urlTree.queryParams)),this.urlTree.fragment,Uk(i),Hi(i),i.component??i._loadedComponent??null,i,Vk(i)),{segmentGroup:g,slicedSegments:y}=kS(n,l,d,c);if(y.length===0&&g.hasChildren())return this.processChildren(u,c,g).pipe(ot(f=>f===null?null:new Vn(p,f)));if(c.length===0&&y.length===0)return ze(new Vn(p,[]));let m=Hi(i)===s;return this.processSegment(u,c,g,y,m?We:s,!0).pipe(ot(f=>new Vn(p,f instanceof Vn?[f]:[])))}))):fa(n)))}getChildConfig(e,n,i){return n.children?ze({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?ze({routes:n._loadedRoutes,injector:n._loadedInjector}):bk(e,n,i,this.urlSerializer).pipe(Ht(r=>r?this.configLoader.loadChildren(e,n).pipe(kt(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):Tk(n))):ze({routes:[],injector:e})}};function kk(t){t.sort((e,n)=>e.value.outlet===We?-1:n.value.outlet===We?1:e.value.outlet.localeCompare(n.value.outlet))}function Fk(t){let e=t.value.routeConfig;return e&&e.path===""}function oT(t){let e=[],n=new Set;for(let i of t){if(!Fk(i)){e.push(i);continue}let r=e.find(s=>i.value.routeConfig===s.value.routeConfig);r!==void 0?(r.children.push(...i.children),n.add(r)):e.push(i)}for(let i of n){let r=oT(i.children);e.push(new Vn(i.value,r))}return e.filter(i=>!n.has(i))}function Uk(t){return t.data||{}}function Vk(t){return t.resolve||{}}function Bk(t,e,n,i,r,s){return Ht(o=>Ok(t,e,n,i,o.extractedUrl,r,s).pipe(ot(({state:a,tree:c})=>Ct(ve({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function zk(t,e){return Ht(n=>{let{targetSnapshot:i,guards:{canActivateChecks:r}}=n;if(!r.length)return ze(n);let s=new Set(r.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let u of aT(c))o.add(u);let a=0;return zt(o).pipe(Xo(c=>s.has(c)?Hk(c,i,t,e):(c.data=vy(c,c.parent,t).resolve,ze(void 0))),kt(()=>a++),Ko(1),Ht(c=>a===o.size?ze(n):qn))})}function aT(t){let e=t.children.map(n=>aT(n)).flat();return[t,...e]}function Hk(t,e,n,i){let r=t.routeConfig,s=t._resolve;return r?.title!==void 0&&!JS(r)&&(s[hu]=r.title),Gk(s,t,e,i).pipe(ot(o=>(t._resolvedData=o,t.data=vy(t,t.parent,n).resolve,null)))}function Gk(t,e,n,i){let r=jg(t);if(r.length===0)return ze({});let s={};return zt(r).pipe(Ht(o=>Wk(t[o],e,n,i).pipe(Ci(),kt(a=>{s[o]=a}))),Ko(1),zp(s),Br(o=>rT(o)?qn:$o(o)))}function Wk(t,e,n,i){let r=fu(e)??i,s=Ea(t,r),o=s.resolve?s.resolve(e,n):Ws(r,()=>s(e,n));return is(o)}function Gg(t){return ui(e=>{let n=t(e);return n?zt(n).pipe(ot(()=>e)):ze(e)})}var cT=(()=>{let e=class e{buildTitle(i){let r,s=i.root;for(;s!==void 0;)r=this.getResolvedTitleForRoute(s)??r,s=s.children.find(o=>o.outlet===We);return r}getResolvedTitleForRoute(i){return i.data[hu]}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:()=>ge(jk),providedIn:"root"});let t=e;return t})(),jk=(()=>{let e=class e extends cT{constructor(i){super(),this.title=i}updateTitle(i){let r=this.buildTitle(i);r!==void 0&&this.title.setTitle(r)}};e.\u0275fac=function(r){return new(r||e)(He(DS))},e.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Sy=new $e("",{providedIn:"root",factory:()=>({})}),Ty=new $e(""),$k=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=ge(Ig)}loadComponent(i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return ze(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let r=is(i.loadComponent()).pipe(ot(uT),kt(o=>{this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=o}),xc(()=>{this.componentLoaders.delete(i)})),s=new Ho(r,()=>new fn).pipe(zo());return this.componentLoaders.set(i,s),s}loadChildren(i,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return ze({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=qk(r,this.compiler,i,this.onLoadEndListener).pipe(xc(()=>{this.childrenLoaders.delete(r)})),a=new Ho(o,()=>new fn).pipe(zo());return this.childrenLoaders.set(r,a),a}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function qk(t,e,n,i){return is(t.loadChildren()).pipe(ot(uT),Ht(r=>r instanceof Fc||Array.isArray(r)?ze(r):zt(e.compileModuleAsync(r))),ot(r=>{i&&i(t);let s,o,a=!1;return Array.isArray(r)?(o=r,a=!0):(s=r.create(n).injector,o=s.get(Ty,[],{optional:!0,self:!0}).flat()),{routes:o.map(by),injector:s}}))}function Xk(t){return t&&typeof t=="object"&&"default"in t}function uT(t){return Xk(t)?t.default:t}var Iy=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:()=>ge(Kk),providedIn:"root"});let t=e;return t})(),Kk=(()=>{let e=class e{shouldProcessUrl(i){return!0}extract(i){return i}merge(i,r){return i}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Yk=new $e("");var Qk=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new fn,this.transitionAbortSubject=new fn,this.configLoader=ge($k),this.environmentInjector=ge(Qn),this.urlSerializer=ge(yy),this.rootContexts=ge(Yd),this.location=ge(Xc),this.inputBindingEnabled=ge(Ey,{optional:!0})!==null,this.titleStrategy=ge(cT),this.options=ge(Sy,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=ge(Iy),this.createViewTransition=ge(Yk,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>ze(void 0),this.rootComponentType=null;let i=s=>this.events.next(new ey(s)),r=s=>this.events.next(new ty(s));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=i}complete(){this.transitions?.complete()}handleNavigationRequest(i){let r=++this.navigationId;this.transitions?.next(Ct(ve(ve({},this.transitions.value),i),{id:r}))}setupNavigations(i,r,s){return this.transitions=new tn({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:nu,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(ci(o=>o.id!==0),ot(o=>Ct(ve({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),ui(o=>{this.currentTransition=o;let a=!1,c=!1;return ze(o).pipe(kt(u=>{this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?Ct(ve({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),ui(u=>{let l=!i.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=u.extras.onSameUrlNavigation??i.onSameUrlNavigation;if(!l&&d!=="reload"){let h="";return this.events.next(new Js(u.id,this.urlSerializer.serialize(u.rawUrl),h,Kg.IgnoredSameUrlNavigation)),u.resolve(null),qn}if(this.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return ze(u).pipe(ui(h=>{let p=this.transitions?.getValue();return this.events.next(new su(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),p!==this.transitions?.getValue()?qn:Promise.resolve(h)}),Bk(this.environmentInjector,this.configLoader,this.rootComponentType,i.config,this.urlSerializer,this.paramsInheritanceStrategy),kt(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=Ct(ve({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let p=new Wd(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(p)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){let{id:h,extractedUrl:p,source:g,restoredState:y,extras:m}=u,f=new su(h,this.urlSerializer.serialize(p),g,y);this.events.next(f);let b=QS(this.rootComponentType).snapshot;return this.currentTransition=o=Ct(ve({},u),{targetSnapshot:b,urlAfterRedirects:p,extras:Ct(ve({},m),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=p,ze(o)}else{let h="";return this.events.next(new Js(u.id,this.urlSerializer.serialize(u.extractedUrl),h,Kg.IgnoredByUrlHandlingStrategy)),u.resolve(null),qn}}),kt(u=>{let l=new Yg(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(l)}),ot(u=>(this.currentTransition=o=Ct(ve({},u),{guards:rk(u.targetSnapshot,u.currentSnapshot,this.rootContexts)}),o)),pk(this.environmentInjector,u=>this.events.next(u)),kt(u=>{if(o.guardsResult=u.guardsResult,va(u.guardsResult))throw tT(this.urlSerializer,u.guardsResult);let l=new Qg(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(l)}),ci(u=>u.guardsResult?!0:(this.cancelNavigationTransition(u,"",ei.GuardRejected),!1)),Gg(u=>{if(u.guards.canActivateChecks.length)return ze(u).pipe(kt(l=>{let d=new Zg(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),ui(l=>{let d=!1;return ze(l).pipe(zk(this.paramsInheritanceStrategy,this.environmentInjector),kt({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",ei.NoDataFromResolver)}}))}),kt(l=>{let d=new Jg(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),Gg(u=>{let l=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(kt(p=>{d.component=p}),ot(()=>{})));for(let p of d.children)h.push(...l(p));return h};return Bl(l(u.targetSnapshot.root)).pipe(zr(null),or(1))}),Gg(()=>this.afterPreactivation()),ui(()=>{let{currentSnapshot:u,targetSnapshot:l}=o,d=this.createViewTransition?.(this.environmentInjector,u.root,l.root);return d?zt(d).pipe(ot(()=>o)):ze(o)}),ot(u=>{let l=YL(i.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=o=Ct(ve({},u),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,o}),kt(()=>{this.events.next(new au)}),ik(this.rootContexts,i.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),or(1),kt({next:u=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Zs(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),this.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{a=!0}}),jp(this.transitionAbortSubject.pipe(kt(u=>{throw u}))),xc(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",ei.SupersededByNewNavigation),this.currentNavigation?.id===o.id&&(this.currentNavigation=null)}),Br(u=>{if(c=!0,iT(u))this.events.next(new ns(o.id,this.urlSerializer.serialize(o.extractedUrl),u.message,u.cancellationCode)),JL(u)?this.events.next(new cu(u.url)):o.resolve(!1);else{this.events.next(new ou(o.id,this.urlSerializer.serialize(o.extractedUrl),u,o.targetSnapshot??void 0));try{o.resolve(i.errorHandler(u))}catch(l){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(l)}}return qn}))}))}cancelNavigationTransition(i,r,s){let o=new ns(i.id,this.urlSerializer.serialize(i.extractedUrl),r,s);this.events.next(o),i.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Zk(t){return t!==nu}var Jk=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:()=>ge(eF),providedIn:"root"});let t=e;return t})(),gy=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},eF=(()=>{let e=class e extends gy{};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=og(e)))(s||e)}})(),e.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),lT=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:()=>ge(tF),providedIn:"root"});let t=e;return t})(),tF=(()=>{let e=class e extends lT{constructor(){super(...arguments),this.location=ge(Xc),this.urlSerializer=ge(yy),this.options=ge(Sy,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=ge(Iy),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new ts,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=QS(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(i){return this.location.subscribe(r=>{r.type==="popstate"&&i(r.url,r.state)})}handleRouterEvent(i,r){if(i instanceof su)this.stateMemento=this.createStateMemento();else if(i instanceof Js)this.rawUrlTree=r.initialUrl;else if(i instanceof Wd){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(s,r)}}else i instanceof au?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r))):i instanceof ns&&(i.code===ei.GuardRejected||i.code===ei.NoDataFromResolver)?this.restoreHistory(r):i instanceof ou?this.restoreHistory(r,!0):i instanceof Zs&&(this.lastSuccessfulId=i.id,this.currentPageId=this.browserPageId)}setBrowserUrl(i,r){let s=this.urlSerializer.serialize(i);if(this.location.isCurrentPathEqualTo(s)||r.extras.replaceUrl){let o=this.browserPageId,a=ve(ve({},r.extras.state),this.generateNgRouterState(r.id,o));this.location.replaceState(s,"",a)}else{let o=ve(ve({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(i,r=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===i.finalUrl&&o===0&&(this.resetState(i),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(i),this.resetUrlToCurrentUrlTree())}resetState(i){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(i,r){return this.canceledNavigationResolution==="computed"?{navigationId:i,\u0275routerPageId:r}:{navigationId:i}}};e.\u0275fac=(()=>{let i;return function(s){return(i||(i=og(e)))(s||e)}})(),e.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),eu=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(eu||{});function nF(t,e){t.events.pipe(ci(n=>n instanceof Zs||n instanceof ns||n instanceof ou||n instanceof Js),ot(n=>n instanceof Zs||n instanceof Js?eu.COMPLETE:(n instanceof ns?n.code===ei.Redirect||n.code===ei.SupersededByNewNavigation:!1)?eu.REDIRECTING:eu.FAILED),ci(n=>n!==eu.REDIRECTING),or(1)).subscribe(()=>{e()})}function iF(t){throw t}var rF={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},sF={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},dT=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=ge(Cd),this.stateManager=ge(lT),this.options=ge(Sy,{optional:!0})||{},this.pendingTasks=ge(Dd),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=ge(Qk),this.urlSerializer=ge(yy),this.location=ge(Xc),this.urlHandlingStrategy=ge(Iy),this._events=new fn,this.errorHandler=this.options.errorHandler||iF,this.navigated=!1,this.routeReuseStrategy=ge(Jk),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=ge(Ty,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!ge(Ey,{optional:!0}),this.eventsSubscription=new At,this.isNgZoneEnabled=ge(yt)instanceof yt&&yt.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:i=>{this.console.warn(i)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let i=this.navigationTransitions.events.subscribe(r=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(r,o),r instanceof ns&&r.code!==ei.Redirect&&r.code!==ei.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Zs)this.navigated=!0;else if(r instanceof cu){let a=this.urlHandlingStrategy.merge(r.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||Zk(s.source)};this.scheduleNavigation(a,nu,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}aF(r)&&this._events.next(r)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(i)}resetRootComponentType(i){this.routerState.root.component=i,this.navigationTransitions.rootComponentType=i}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),nu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((i,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(i,"popstate",r)},0)})}navigateToSyncWithBrowser(i,r,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let u=ve({},s);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(o.state=u)}let c=this.parseUrl(i);this.scheduleNavigation(c,r,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(i){this.config=i.map(by),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(i,r={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:u}=r,l=u?this.currentUrlTree.fragment:a,d=null;switch(c){case"merge":d=ve(ve({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let p=s?s.snapshot:this.routerState.snapshot.root;h=qS(p)}catch{(typeof i[0]!="string"||!i[0].startsWith("/"))&&(i=[]),h=this.currentUrlTree.root}return XS(h,i,d,l??null)}navigateByUrl(i,r={skipLocationChange:!1}){let s=va(i)?i:this.parseUrl(i),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,nu,null,r)}navigate(i,r={skipLocationChange:!1}){return oF(i),this.navigateByUrl(this.createUrlTree(i,r),r)}serializeUrl(i){return this.urlSerializer.serialize(i)}parseUrl(i){try{return this.urlSerializer.parse(i)}catch{return this.urlSerializer.parse("/")}}isActive(i,r){let s;if(r===!0?s=ve({},rF):r===!1?s=ve({},sF):s=r,va(i))return PS(this.currentUrlTree,i,s);let o=this.parseUrl(i);return PS(this.currentUrlTree,o,s)}removeEmptyProps(i){return Object.entries(i).reduce((r,[s,o])=>(o!=null&&(r[s]=o),r),{})}scheduleNavigation(i,r,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,u,l;a?(c=a.resolve,u=a.reject,l=a.promise):l=new Promise((h,p)=>{c=h,u=p});let d=this.pendingTasks.add();return nF(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:i,extras:o,resolve:c,reject:u,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(h=>Promise.reject(h))}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function oF(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new Pe(4008,!1)}function aF(t){return!(t instanceof au)&&!(t instanceof cu)}var cF=new $e("");function hT(t,...e){return _d([{provide:Ty,multi:!0,useValue:t},[],{provide:_a,useFactory:uF,deps:[dT]},{provide:Ag,multi:!0,useFactory:lF},e.map(n=>n.\u0275providers)])}function uF(t){return t.routerState.root}function lF(){let t=ge(mi);return e=>{let n=t.get(qc);if(e!==n.components[0])return;let i=t.get(dT),r=t.get(dF);t.get(hF)===1&&i.initialNavigation(),t.get(fF,null,Qe.Optional)?.setUpPreloading(),t.get(cF,null,Qe.Optional)?.init(),i.resetRootComponentType(n.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var dF=new $e("",{factory:()=>new fn}),hF=new $e("",{providedIn:"root",factory:()=>1});var fF=new $e("");var fT=[];var mT=function(t){let e=[],n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},pF=function(t){let e=[],n=0,i=0;for(;n<t.length;){let r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let s=t[n++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){let s=t[n++],o=t[n++],a=t[n++],c=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(c>>10)),e[i++]=String.fromCharCode(56320+(c&1023))}else{let s=t[n++],o=t[n++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},gT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();let n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<t.length;r+=3){let s=t[r],o=r+1<t.length,a=o?t[r+1]:0,c=r+2<t.length,u=c?t[r+2]:0,l=s>>2,d=(s&3)<<4|a>>4,h=(a&15)<<2|u>>6,p=u&63;c||(p=64,o||(h=64)),i.push(n[l],n[d],n[h],n[p])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(mT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):pF(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();let n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<t.length;){let s=n[t.charAt(r++)],a=r<t.length?n[t.charAt(r)]:0;++r;let u=r<t.length?n[t.charAt(r)]:64;++r;let d=r<t.length?n[t.charAt(r)]:64;if(++r,s==null||a==null||u==null||d==null)throw new My;let h=s<<2|a>>4;if(i.push(h),u!==64){let p=a<<4&240|u>>2;if(i.push(p),d!==64){let g=u<<6&192|d;i.push(g)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},My=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},mF=function(t){let e=mT(t);return gT.encodeByteArray(e,!0)},mu=function(t){return mF(t).replace(/\./g,"")},Dy=function(t){try{return gT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function gF(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var yF=()=>gF().__FIREBASE_DEFAULTS__,vF=()=>{if(typeof process>"u"||typeof process.env>"u")return;let t=process.env.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},_F=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=t&&Dy(t[1]);return e&&JSON.parse(e)},Ry=()=>{try{return yF()||vF()||_F()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Py=t=>{var e,n;return(n=(e=Ry())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Jd=t=>{let e=Py(t);if(!e)return;let n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},Ny=()=>{var t;return(t=Ry())===null||t===void 0?void 0:t.config},Oy=t=>{var e;return(e=Ry())===null||e===void 0?void 0:e[`_${t}`]};var Zd=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}};function eh(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let n={alg:"none",type:"JWT"},i=e||"demo-project",r=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[mu(JSON.stringify(n)),mu(JSON.stringify(o)),""].join(".")}function Xt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function yT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xt())}function vT(){let t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function _T(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function wT(){let t=Xt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Ly(){try{return typeof indexedDB=="object"}catch{return!1}}function ET(){return new Promise((t,e)=>{try{let n=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}var wF="FirebaseError",_n=class t extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=wF,Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,vr.prototype.create)}},vr=class{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){let i=n[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?EF(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new _n(r,a,i)}};function EF(t,e){return t.replace(bF,(n,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`})}var bF=/\{\$([^}]+)}/g;function bT(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function eo(t,e){if(t===e)return!0;let n=Object.keys(t),i=Object.keys(e);for(let r of n){if(!i.includes(r))return!1;let s=t[r],o=e[r];if(pT(s)&&pT(o)){if(!eo(s,o))return!1}else if(s!==o)return!1}for(let r of i)if(!n.includes(r))return!1;return!0}function pT(t){return t!==null&&typeof t=="object"}function gu(t){let e=[];for(let[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function xT(t,e){let n=new Cy(t,e);return n.subscribe.bind(n)}var Cy=class{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let r;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");xF(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:i},r.next===void 0&&(r.next=Ay),r.error===void 0&&(r.error=Ay),r.complete===void 0&&(r.complete=Ay);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function xF(t,e){if(typeof t!="object"||t===null)return!1;for(let n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Ay(){}var aY=4*60*60*1e3;function Bn(t){return t&&t._delegate?t._delegate:t}var Cn=class{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var to="[DEFAULT]";var ky=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){let i=new Zd;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:n});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;let i=this.normalizeInstanceIdentifier(e?.identifier),r=(n=e?.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(TF(e))try{this.getOrInitializeService({instanceIdentifier:to})}catch{}for(let[n,i]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(n);try{let s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=to){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return U(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=to){return this.instances.has(e)}getOptions(e=to){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:i,options:n});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,n){var i;let r=this.normalizeInstanceIdentifier(n),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);let o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){let i=this.onInitCallbacks.get(n);if(i)for(let r of i)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:SF(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=to){return this.component?this.component.multipleInstances?e:to:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function SF(t){return t===to?void 0:t}function TF(t){return t.instantiationMode==="EAGER"}var th=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let n=new ky(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}};var IF=[],ut=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}(ut||{}),AF={debug:ut.DEBUG,verbose:ut.VERBOSE,info:ut.INFO,warn:ut.WARN,error:ut.ERROR,silent:ut.SILENT},MF=ut.INFO,CF={[ut.DEBUG]:"log",[ut.VERBOSE]:"log",[ut.INFO]:"info",[ut.WARN]:"warn",[ut.ERROR]:"error"},DF=(t,e,...n)=>{if(e<t.logLevel)return;let i=new Date().toISOString(),r=CF[e];if(r)console[r](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},rs=class{constructor(e){this.name=e,this._logLevel=MF,this._logHandler=DF,this._userLogHandler=null,IF.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ut))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?AF[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ut.DEBUG,...e),this._logHandler(this,ut.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ut.VERBOSE,...e),this._logHandler(this,ut.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ut.INFO,...e),this._logHandler(this,ut.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ut.WARN,...e),this._logHandler(this,ut.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ut.ERROR,...e),this._logHandler(this,ut.ERROR,...e)}};var RF=(t,e)=>e.some(n=>t instanceof n),ST,TT;function PF(){return ST||(ST=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function NF(){return TT||(TT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var IT=new WeakMap,Uy=new WeakMap,AT=new WeakMap,Fy=new WeakMap,By=new WeakMap;function OF(t){let e=new Promise((n,i)=>{let r=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Gi(t.result)),r()},o=()=>{i(t.error),r()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&IT.set(n,t)}).catch(()=>{}),By.set(e,t),e}function LF(t){if(Uy.has(t))return;let e=new Promise((n,i)=>{let r=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),r()},o=()=>{i(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});Uy.set(t,e)}var Vy={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Uy.get(t);if(e==="objectStoreNames")return t.objectStoreNames||AT.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Gi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function MT(t){Vy=t(Vy)}function kF(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){let i=t.call(nh(this),e,...n);return AT.set(i,e.sort?e.sort():[e]),Gi(i)}:NF().includes(t)?function(...e){return t.apply(nh(this),e),Gi(IT.get(this))}:function(...e){return Gi(t.apply(nh(this),e))}}function FF(t){return typeof t=="function"?kF(t):(t instanceof IDBTransaction&&LF(t),RF(t,PF())?new Proxy(t,Vy):t)}function Gi(t){if(t instanceof IDBRequest)return OF(t);if(Fy.has(t))return Fy.get(t);let e=FF(t);return e!==t&&(Fy.set(t,e),By.set(e,t)),e}var nh=t=>By.get(t);function DT(t,e,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){let o=indexedDB.open(t,e),a=Gi(o);return i&&o.addEventListener("upgradeneeded",c=>{i(Gi(o.result),c.oldVersion,c.newVersion,Gi(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),r&&c.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}var UF=["get","getKey","getAll","getAllKeys","count"],VF=["put","add","delete","clear"],zy=new Map;function CT(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(zy.get(e))return zy.get(e);let n=e.replace(/FromIndex$/,""),i=e!==n,r=VF.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(r||UF.includes(n)))return;let s=function(o,...a){return U(this,null,function*(){let c=this.transaction(o,r?"readwrite":"readonly"),u=c.store;return i&&(u=u.index(a.shift())),(yield Promise.all([u[n](...a),r&&c.done]))[0]})};return zy.set(e,s),s}MT(t=>Ct(ve({},t),{get:(e,n,i)=>CT(e,n)||t.get(e,n,i),has:(e,n)=>!!CT(e,n)||t.has(e,n)}));var Gy=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(BF(n)){let i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}};function BF(t){let e=t.getComponent();return e?.type==="VERSION"}var Wy="@firebase/app",RT="0.9.27";var no=new rs("@firebase/app"),zF="@firebase/app-compat",HF="@firebase/analytics-compat",GF="@firebase/analytics",WF="@firebase/app-check-compat",jF="@firebase/app-check",$F="@firebase/auth",qF="@firebase/auth-compat",XF="@firebase/database",KF="@firebase/database-compat",YF="@firebase/functions",QF="@firebase/functions-compat",ZF="@firebase/installations",JF="@firebase/installations-compat",e2="@firebase/messaging",t2="@firebase/messaging-compat",n2="@firebase/performance",i2="@firebase/performance-compat",r2="@firebase/remote-config",s2="@firebase/remote-config-compat",o2="@firebase/storage",a2="@firebase/storage-compat",c2="@firebase/firestore",u2="@firebase/firestore-compat",l2="firebase",d2="10.8.0";var jy="[DEFAULT]",h2={[Wy]:"fire-core",[zF]:"fire-core-compat",[GF]:"fire-analytics",[HF]:"fire-analytics-compat",[jF]:"fire-app-check",[WF]:"fire-app-check-compat",[$F]:"fire-auth",[qF]:"fire-auth-compat",[XF]:"fire-rtdb",[KF]:"fire-rtdb-compat",[YF]:"fire-fn",[QF]:"fire-fn-compat",[ZF]:"fire-iid",[JF]:"fire-iid-compat",[e2]:"fire-fcm",[t2]:"fire-fcm-compat",[n2]:"fire-perf",[i2]:"fire-perf-compat",[r2]:"fire-rc",[s2]:"fire-rc-compat",[o2]:"fire-gcs",[a2]:"fire-gcs-compat",[c2]:"fire-fst",[u2]:"fire-fst-compat","fire-js":"fire-js",[l2]:"fire-js-all"};var yu=new Map,$y=new Map;function f2(t,e){try{t.container.addComponent(e)}catch(n){no.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Wi(t){let e=t.name;if($y.has(e))return no.debug(`There were multiple attempts to register component ${e}.`),!1;$y.set(e,t);for(let n of yu.values())f2(n,t);return!0}function io(t,e){let n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}var p2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},ss=new vr("app","Firebase",p2);var qy=class{constructor(e,n,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Cn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ss.create("app-deleted",{appName:this._name})}};var ji=d2;function _u(t,e={}){let n=t;typeof e!="object"&&(e={name:e});let i=Object.assign({name:jy,automaticDataCollectionEnabled:!1},e),r=i.name;if(typeof r!="string"||!r)throw ss.create("bad-app-name",{appName:String(r)});if(n||(n=Ny()),!n)throw ss.create("no-options");let s=yu.get(r);if(s){if(eo(n,s.options)&&eo(i,s.config))return s;throw ss.create("duplicate-app",{appName:r})}let o=new th(r);for(let c of $y.values())o.addComponent(c);let a=new qy(n,i,o);return yu.set(r,a),a}function os(t=jy){let e=yu.get(t);if(!e&&t===jy&&Ny())return _u();if(!e)throw ss.create("no-app",{appName:t});return e}function ih(){return Array.from(yu.values())}function Dt(t,e,n){var i;let r=(i=h2[t])!==null&&i!==void 0?i:t;n&&(r+=`-${n}`);let s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),no.warn(a.join(" "));return}Wi(new Cn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var m2="firebase-heartbeat-database",g2=1,vu="firebase-heartbeat-store",Hy=null;function LT(){return Hy||(Hy=DT(m2,g2,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(vu)}catch(n){console.warn(n)}}}}).catch(t=>{throw ss.create("idb-open",{originalErrorMessage:t.message})})),Hy}function y2(t){return U(this,null,function*(){try{let n=(yield LT()).transaction(vu),i=yield n.objectStore(vu).get(kT(t));return yield n.done,i}catch(e){if(e instanceof _n)no.warn(e.message);else{let n=ss.create("idb-get",{originalErrorMessage:e?.message});no.warn(n.message)}}})}function PT(t,e){return U(this,null,function*(){try{let i=(yield LT()).transaction(vu,"readwrite");yield i.objectStore(vu).put(e,kT(t)),yield i.done}catch(n){if(n instanceof _n)no.warn(n.message);else{let i=ss.create("idb-set",{originalErrorMessage:n?.message});no.warn(i.message)}}})}function kT(t){return`${t.name}!${t.options.appId}`}var v2=1024,_2=30*24*60*60*1e3,Xy=class{constructor(e){this.container=e,this._heartbeatsCache=null;let n=this.container.getProvider("app").getImmediate();this._storage=new Ky(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}triggerHeartbeat(){return U(this,null,function*(){var e,n;let r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=NT();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let a=new Date(o.date).valueOf();return Date.now()-a<=_2}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return U(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let n=NT(),{heartbeatsToSend:i,unsentEntries:r}=w2(this._heartbeatsCache.heartbeats),s=mu(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function NT(){return new Date().toISOString().substring(0,10)}function w2(t,e=v2){let n=[],i=t.slice();for(let r of t){let s=n.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),OT(n)>e){s.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),OT(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}var Ky=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return U(this,null,function*(){return Ly()?ET().then(()=>!0).catch(()=>!1):!1})}read(){return U(this,null,function*(){if(yield this._canUseIndexedDBPromise){let n=yield y2(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return U(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return PT(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return U(this,null,function*(){var n;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return PT(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return})}};function OT(t){return mu(JSON.stringify({version:2,heartbeats:t})).length}function E2(t){Wi(new Cn("platform-logger",e=>new Gy(e),"PRIVATE")),Wi(new Cn("heartbeat",e=>new Xy(e),"PRIVATE")),Dt(Wy,RT,t),Dt(Wy,RT,"esm2017"),Dt("fire-js","")}E2("");var b2="firebase",x2="10.8.0";Dt(b2,x2,"app");var so=new $r("ANGULARFIRE2_VERSION");function sh(t,e,n){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===n);if(s.length===1)return s[0]}return n.container.getProvider(t).getImmediate({optional:!0})}var wu=(t,e)=>{let n=e?[e]:ih(),i=[];return n.forEach(r=>{r.container.getProvider(t).instances.forEach(o=>{i.includes(o)||i.push(o)})}),i},xa=class{constructor(){return wu(S2)}},S2="app-check";function ba(){}var rh=class{zone;delegate;constructor(e,n=Fp){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,i){let r=this.zone,s=function(o){r.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,i)}},Yy=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let i=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",ba,{},ba,ba)),n.pipe(kt({next:i,complete:i,error:i})).subscribe(e).add(i)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Sa=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new rh(Zone.current)),this.insideAngular=n.run(()=>new rh(Zone.current,kp)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(i){return new(i||t)(He(yt))};static \u0275prov=Ae({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function oh(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function T2(t){return oh().ngZone.runOutsideAngular(()=>t())}function ro(t){return oh().ngZone.run(()=>t())}function I2(t){return A2(oh())(t)}function A2(t){return function(n){return n=n.lift(new Yy(t.ngZone)),n.pipe(Vr(t.outsideAngular),Ur(t.insideAngular))}}var M2=(t,e)=>function(){let i=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),ro(()=>t.apply(void 0,i))},Ta=(t,e)=>function(){let n,i=arguments;for(let s=0;s<arguments.length;s++)typeof i[s]=="function"&&(e&&(n||=ro(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",ba,{},ba,ba))),i[s]=M2(i[s],n));let r=T2(()=>t.apply(this,i));if(!e)if(r instanceof ct){let s=oh();return r.pipe(Vr(s.outsideAngular),Ur(s.insideAngular))}else return ro(()=>r);return r instanceof ct?r.pipe(I2):r instanceof Promise?ro(()=>new Promise((s,o)=>r.then(a=>ro(()=>s(a)),a=>ro(()=>o(a))))):typeof r=="function"&&n?function(){return setTimeout(()=>{n&&n.state==="scheduled"&&n.invoke()},10),r.apply(this,arguments)}:ro(()=>r)};var _r=class{constructor(e){return e}},oo=class{constructor(){return ih()}};function C2(t){return t&&t.length===1?t[0]:new _r(os())}var Qy=new $e("angularfire2._apps"),D2={provide:_r,useFactory:C2,deps:[[new Mn,Qy]]},R2={provide:oo,deps:[[new Mn,Qy]]};function P2(t){return(e,n)=>{let i=e.runOutsideAngular(()=>t(n));return new _r(i)}}var N2=(()=>{class t{constructor(n){Dt("angularfire",so.full,"core"),Dt("angularfire",so.full,"app"),Dt("angular",rS.full,n.toString())}static \u0275fac=function(i){return new(i||t)(He(Kr))};static \u0275mod=Fi({type:t});static \u0275inj=ki({providers:[D2,R2]})}return t})();function FT(t,...e){return{ngModule:N2,providers:[{provide:Qy,useFactory:P2(t),multi:!0,deps:[yt,mi,Sa,...e]}]}}var UT=Ta(_u,!0);function ZT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var JT=ZT,eI=new vr("auth","Firebase",ZT());var hh=new rs("@firebase/auth");function O2(t,...e){hh.logLevel<=ut.WARN&&hh.warn(`Auth (${ji}): ${t}`,...e)}function ch(t,...e){hh.logLevel<=ut.ERROR&&hh.error(`Auth (${ji}): ${t}`,...e)}function cs(t,...e){throw yv(t,...e)}function ao(t,...e){return yv(t,...e)}function L2(t,e,n){let i=Object.assign(Object.assign({},JT()),{[e]:n});return new vr("auth","Firebase",i).create(e,{appName:t.name})}function yv(t,...e){if(typeof t!="string"){let n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return eI.create(t,...e)}function Ve(t,e,...n){if(!t)throw yv(e,...n)}function wr(t){let e="INTERNAL ASSERTION FAILED: "+t;throw ch(e),new Error(e)}function us(t,e){t||wr(e)}function tv(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function k2(){return VT()==="http:"||VT()==="https:"}function VT(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}function F2(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(k2()||vT()||"connection"in navigator)?navigator.onLine:!0}function U2(){if(typeof navigator>"u")return null;let t=navigator;return t.languages&&t.languages[0]||t.language||null}var co=class{constructor(e,n){this.shortDelay=e,this.longDelay=n,us(n>e,"Short delay should be less than long delay!"),this.isMobile=yT()||_T()}get(){return F2()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function vv(t,e){us(t.emulator,"Emulator should always be set here");let{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}var fh=class{static initialize(e,n,i){this.fetchImpl=e,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;wr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;wr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;wr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var V2={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var B2=new co(3e4,6e4);function _v(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}function Ia(s,o,a,c){return U(this,arguments,function*(t,e,n,i,r={}){return tI(t,r,()=>U(this,null,function*(){let u={},l={};i&&(e==="GET"?l=i:u={body:JSON.stringify(i)});let d=gu(Object.assign({key:t.config.apiKey},l)).slice(1),h=yield t._getAdditionalHeaders();return h["Content-Type"]="application/json",t.languageCode&&(h["X-Firebase-Locale"]=t.languageCode),fh.fetch()(nI(t,t.config.apiHost,n,d),Object.assign({method:e,headers:h,referrerPolicy:"no-referrer"},u))}))})}function tI(t,e,n){return U(this,null,function*(){t._canInitEmulator=!1;let i=Object.assign(Object.assign({},V2),e);try{let r=new nv(t),s=yield Promise.race([n(),r.promise]);r.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw ah(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw ah(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw ah(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw ah(t,"user-disabled",o);let l=i[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw L2(t,l,u);cs(t,l)}}catch(r){if(r instanceof _n)throw r;cs(t,"network-request-failed",{message:String(r)})}})}function z2(s,o,a,c){return U(this,arguments,function*(t,e,n,i,r={}){let u=yield Ia(t,e,n,i,r);return"mfaPendingCredential"in u&&cs(t,"multi-factor-auth-required",{_serverResponse:u}),u})}function nI(t,e,n,i){let r=`${e}${n}?${i}`;return t.config.emulator?vv(t.config,r):`${t.config.apiScheme}://${r}`}var nv=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(ao(this.auth,"network-request-failed")),B2.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function ah(t,e,n){let i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);let r=ao(t,e,i);return r.customData._tokenResponse=n,r}function H2(t,e){return U(this,null,function*(){return Ia(t,"POST","/v1/accounts:delete",e)})}function G2(t,e){return U(this,null,function*(){return Ia(t,"POST","/v1/accounts:lookup",e)})}function Eu(t){if(t)try{let e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function wv(t,e=!1){return U(this,null,function*(){let n=Bn(t),i=yield n.getIdToken(e),r=Ev(i);Ve(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");let s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:Eu(Zy(r.auth_time)),issuedAtTime:Eu(Zy(r.iat)),expirationTime:Eu(Zy(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function Zy(t){return Number(t)*1e3}function Ev(t){let[e,n,i]=t.split(".");if(e===void 0||n===void 0||i===void 0)return ch("JWT malformed, contained fewer than 3 sections"),null;try{let r=Dy(n);return r?JSON.parse(r):(ch("Failed to decode base64 JWT payload"),null)}catch(r){return ch("Caught error parsing JWT payload as JSON",r?.toString()),null}}function W2(t){let e=Ev(t);return Ve(e,"internal-error"),Ve(typeof e.exp<"u","internal-error"),Ve(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function bu(t,e,n=!1){return U(this,null,function*(){if(n)return e;try{return yield e}catch(i){throw i instanceof _n&&j2(i)&&t.auth.currentUser===t&&(yield t.auth.signOut()),i}})}function j2({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}var iv=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){let i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;let r=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;let n=this.getInterval(e);this.timerId=setTimeout(()=>U(this,null,function*(){yield this.iteration()}),n)}iteration(){return U(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var ph=class{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Eu(this.lastLoginAt),this.creationTime=Eu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function mh(t){return U(this,null,function*(){var e;let n=t.auth,i=yield t.getIdToken(),r=yield bu(t,G2(n,{idToken:i}));Ve(r?.users.length,n,"internal-error");let s=r.users[0];t._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?q2(s.providerUserInfo):[],a=$2(t.providerData,o),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!a?.length,l=c?u:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new ph(s.createdAt,s.lastLoginAt),isAnonymous:l};Object.assign(t,d)})}function bv(t){return U(this,null,function*(){let e=Bn(t);yield mh(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function $2(t,e){return[...t.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function q2(t){return t.map(e=>{var{providerId:n}=e,i=Up(e,["providerId"]);return{providerId:n,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}function X2(t,e){return U(this,null,function*(){let n=yield tI(t,{},()=>U(this,null,function*(){let i=gu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=t.config,o=nI(t,r,"/v1/token",`key=${s}`),a=yield t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",fh.fetch()(o,{method:"POST",headers:a,body:i})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}})}function K2(t,e){return U(this,null,function*(){return Ia(t,"POST","/v2/accounts:revokeToken",_v(t,e))})}var gh=class t{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ve(e.idToken,"internal-error"),Ve(typeof e.idToken<"u","internal-error"),Ve(typeof e.refreshToken<"u","internal-error");let n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):W2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}getToken(e,n=!1){return U(this,null,function*(){return Ve(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null})}clearRefreshToken(){this.refreshToken=null}refresh(e,n){return U(this,null,function*(){let{accessToken:i,refreshToken:r,expiresIn:s}=yield X2(e,n);this.updateTokensAndExpiration(i,r,Number(s))})}updateTokensAndExpiration(e,n,i){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,n){let{refreshToken:i,accessToken:r,expirationTime:s}=n,o=new t;return i&&(Ve(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(Ve(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(Ve(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new t,this.toJSON())}_performRefresh(){return wr("not implemented")}};function as(t,e){Ve(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}var xu=class t{constructor(e){var{uid:n,auth:i,stsTokenManager:r}=e,s=Up(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new iv(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new ph(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return U(this,null,function*(){let n=yield bu(this,this.stsTokenManager.getToken(this.auth,e));return Ve(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n})}getIdTokenResult(e){return wv(this,e)}reload(){return bv(this)}_assign(e){this!==e&&(Ve(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let n=new t(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Ve(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,n=!1){return U(this,null,function*(){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),n&&(yield mh(this)),yield this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)})}delete(){return U(this,null,function*(){let e=yield this.getIdToken();return yield bu(this,H2(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var i,r,s,o,a,c,u,l;let d=(i=n.displayName)!==null&&i!==void 0?i:void 0,h=(r=n.email)!==null&&r!==void 0?r:void 0,p=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,g=(o=n.photoURL)!==null&&o!==void 0?o:void 0,y=(a=n.tenantId)!==null&&a!==void 0?a:void 0,m=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,f=(u=n.createdAt)!==null&&u!==void 0?u:void 0,b=(l=n.lastLoginAt)!==null&&l!==void 0?l:void 0,{uid:_,emailVerified:v,isAnonymous:x,providerData:A,stsTokenManager:I}=n;Ve(_&&I,e,"internal-error");let V=gh.fromJSON(this.name,I);Ve(typeof _=="string",e,"internal-error"),as(d,e.name),as(h,e.name),Ve(typeof v=="boolean",e,"internal-error"),Ve(typeof x=="boolean",e,"internal-error"),as(p,e.name),as(g,e.name),as(y,e.name),as(m,e.name),as(f,e.name),as(b,e.name);let G=new t({uid:_,auth:e,email:h,emailVerified:v,displayName:d,isAnonymous:x,photoURL:g,phoneNumber:p,tenantId:y,stsTokenManager:V,createdAt:f,lastLoginAt:b});return A&&Array.isArray(A)&&(G.providerData=A.map(w=>Object.assign({},w))),m&&(G._redirectEventId=m),G}static _fromIdTokenResponse(e,n,i=!1){return U(this,null,function*(){let r=new gh;r.updateFromServerResponse(n);let s=new t({uid:n.localId,auth:e,stsTokenManager:r,isAnonymous:i});return yield mh(s),s})}};var BT=new Map;function Er(t){us(t instanceof Function,"Expected a class definition");let e=BT.get(t);return e?(us(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,BT.set(t,e),e)}var Y2=(()=>{class t{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return U(this,null,function*(){return!0})}_set(n,i){return U(this,null,function*(){this.storage[n]=i})}_get(n){return U(this,null,function*(){let i=this.storage[n];return i===void 0?null:i})}_remove(n){return U(this,null,function*(){delete this.storage[n]})}_addListener(n,i){}_removeListener(n,i){}}return t.type="NONE",t})(),rv=Y2;function uh(t,e,n){return`firebase:${t}:${e}:${n}`}var yh=class t{constructor(e,n,i){this.persistence=e,this.auth=n,this.userKey=i;let{config:r,name:s}=this.auth;this.fullUserKey=uh(this.userKey,r.apiKey,s),this.fullPersistenceKey=uh("persistence",r.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return U(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?xu._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return U(this,null,function*(){if(this.persistence===e)return;let n=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,n,i="authUser"){return U(this,null,function*(){if(!n.length)return new t(Er(rv),e,i);let r=(yield Promise.all(n.map(u=>U(this,null,function*(){if(yield u._isAvailable())return u})))).filter(u=>u),s=r[0]||Er(rv),o=uh(i,e.config.apiKey,e.name),a=null;for(let u of n)try{let l=yield u._get(o);if(l){let d=xu._fromJSON(e,l);u!==s&&(a=d),s=u;break}}catch{}let c=r.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new t(s,e,i):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(n.map(u=>U(this,null,function*(){if(u!==s)try{yield u._remove(o)}catch{}}))),new t(s,e,i))})}};function zT(t){let e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(sI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(iI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(aI(e))return"Blackberry";if(cI(e))return"Webos";if(xv(e))return"Safari";if((e.includes("chrome/")||rI(e))&&!e.includes("edge/"))return"Chrome";if(oI(e))return"Android";{let n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=t.match(n);if(i?.length===2)return i[1]}return"Other"}function iI(t=Xt()){return/firefox\//i.test(t)}function xv(t=Xt()){let e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function rI(t=Xt()){return/crios\//i.test(t)}function sI(t=Xt()){return/iemobile/i.test(t)}function oI(t=Xt()){return/android/i.test(t)}function aI(t=Xt()){return/blackberry/i.test(t)}function cI(t=Xt()){return/webos/i.test(t)}function Th(t=Xt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Q2(t=Xt()){var e;return Th(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Z2(){return wT()&&document.documentMode===10}function uI(t=Xt()){return Th(t)||oI(t)||cI(t)||aI(t)||/windows phone/i.test(t)||sI(t)}function J2(){try{return!!(window&&window!==window.top)}catch{return!1}}function lI(t,e=[]){let n;switch(t){case"Browser":n=zT(Xt());break;case"Worker":n=`${zT(Xt())}-${t}`;break;default:n=t}let i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ji}/${i}`}var sv=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){let i=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});i.onAbort=n,this.queue.push(i);let r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}runMiddleware(e){return U(this,null,function*(){if(this.auth.currentUser===e)return;let n=[];try{for(let i of this.queue)yield i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(let r of n)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}})}};function eU(n){return U(this,arguments,function*(t,e={}){return Ia(t,"GET","/v2/passwordPolicy",_v(t,e))})}var tU=6,ov=class{constructor(e){var n,i,r,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:tU,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,i,r,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(i=c.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(r=c.containsLowercaseLetter)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,n){let i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=e.length>=i),r&&(n.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,n,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var av=class{constructor(e,n,i,r){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new vh(this),this.idTokenSubscription=new vh(this),this.beforeStateQueue=new sv(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=eI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Er(n)),this._initializationPromise=this.queue(()=>U(this,null,function*(){var i,r;if(!this._deleted&&(this.persistenceManager=yield yh.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(n),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return U(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUser(e){return U(this,null,function*(){var n;let i=yield this.assertedPersistence.getCurrentUser(),r=i,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=r?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(r)}catch(o){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ve(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)})}tryRedirectSignIn(e){return U(this,null,function*(){let n=null;try{n=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return n})}reloadAndSetCurrentUserOrClear(e){return U(this,null,function*(){try{yield mh(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=U2()}_delete(){return U(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return U(this,null,function*(){let n=e?Bn(e):null;return n&&Ve(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))})}_updateCurrentUser(e,n=!1){return U(this,null,function*(){if(!this._deleted)return e&&Ve(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>U(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return U(this,null,function*(){return yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0)})}setPersistence(e){return this.queue(()=>U(this,null,function*(){yield this.assertedPersistence.setPersistence(Er(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return U(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return U(this,null,function*(){let e=yield eU(this),n=new ov(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new vr("auth","Firebase",e())}onAuthStateChanged(e,n,i){return this.registerStateListener(this.authStateSubscription,e,n,i)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,i){return this.registerStateListener(this.idTokenSubscription,e,n,i)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{let i=this.onAuthStateChanged(()=>{i(),e()},n)}})}revokeAccessToken(e){return U(this,null,function*(){if(this.currentUser){let n=yield this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),yield K2(this,i)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,n){return U(this,null,function*(){let i=yield this.getOrInitRedirectPersistenceManager(n);return e===null?i.removeCurrentUser():i.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return U(this,null,function*(){if(!this.redirectPersistenceManager){let n=e&&Er(e)||this._popupRedirectResolver;Ve(n,this,"argument-error"),this.redirectPersistenceManager=yield yh.create(this,[Er(n._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return U(this,null,function*(){var n,i;return this._isInitialized&&(yield this.queue(()=>U(this,null,function*(){}))),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return U(this,null,function*(){if(e===this.currentUser)return this.queue(()=>U(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let i=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,i,r){if(this._deleted)return()=>{};let s=typeof n=="function"?n:n.next.bind(n),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ve(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){let c=e.addObserver(n,i,r);return()=>{o=!0,c()}}else{let c=e.addObserver(n);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return U(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ve(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=lI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return U(this,null,function*(){var e;let n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);let i=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();i&&(n["X-Firebase-Client"]=i);let r=yield this._getAppCheckToken();return r&&(n["X-Firebase-AppCheck"]=r),n})}_getAppCheckToken(){return U(this,null,function*(){var e;let n=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return n?.error&&O2(`Error while retrieving App Check token: ${n.error}`),n?.token})}};function Sv(t){return Bn(t)}var vh=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=xT(n=>this.observer=n)}get next(){return Ve(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Tv={loadJS(){return U(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function nU(t){Tv=t}function iU(t){return Tv.loadJS(t)}function rU(){return Tv.gapiScript}function dI(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function Iv(t,e){let n=io(t,"auth");if(n.isInitialized()){let r=n.getImmediate(),s=n.getOptions();if(eo(s,e??{}))return r;cs(r,"already-initialized")}return n.initialize({options:e})}function sU(t,e){let n=e?.persistence||[],i=(Array.isArray(n)?n:[n]).map(Er);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,e?.popupRedirectResolver)}function Av(t,e,n){let i=Sv(t);Ve(i._canInitEmulator,i,"emulator-config-failed"),Ve(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");let r=!!n?.disableWarnings,s=hI(e),{host:o,port:a}=oU(e),c=a===null?"":`:${a}`;i.config.emulator={url:`${s}//${o}${c}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||aU()}function hI(t){let e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function oU(t){let e=hI(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};let i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){let s=r[1];return{host:s,port:HT(i.substr(s.length+1))}}else{let[s,o]=i.split(":");return{host:s,port:HT(o)}}}function HT(t){if(!t)return null;let e=Number(t);return isNaN(e)?null:e}function aU(){function t(){let e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}var _h=class{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return wr("not implemented")}_getIdTokenResponse(e){return wr("not implemented")}_linkToIdToken(e,n){return wr("not implemented")}_getReauthenticationResolver(e){return wr("not implemented")}};function Jy(t,e){return U(this,null,function*(){return z2(t,"POST","/v1/accounts:signInWithIdp",_v(t,e))})}var wh=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var cv=class extends wh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var Su=class t{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,n,i,r=!1){return U(this,null,function*(){let s=yield xu._fromIdTokenResponse(e,i,r),o=GT(i);return new t({user:s,providerId:o,_tokenResponse:i,operationType:n})})}static _forOperation(e,n,i){return U(this,null,function*(){yield e._updateTokensIfNecessary(i,!0);let r=GT(i);return new t({user:e,providerId:r,_tokenResponse:i,operationType:n})})}};function GT(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}var uv=class t extends _n{constructor(e,n,i,r){var s;super(n.code,n.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,t.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,n,i,r){return new t(e,n,i,r)}};function fI(t,e,n,i){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?uv._fromErrorAndOperation(t,s,e,i):s})}function cU(t,e,n=!1){return U(this,null,function*(){let i=yield bu(t,e._linkToIdToken(t.auth,yield t.getIdToken()),n);return Su._forOperation(t,"link",i)})}function uU(t,e,n=!1){return U(this,null,function*(){let{auth:i}=t,r="reauthenticate";try{let s=yield bu(t,fI(i,r,e,t),n);Ve(s.idToken,i,"internal-error");let o=Ev(s.idToken);Ve(o,i,"internal-error");let{sub:a}=o;return Ve(t.uid===a,i,"user-mismatch"),Su._forOperation(t,r,s)}catch(s){throw s?.code==="auth/user-not-found"&&cs(i,"user-mismatch"),s}})}function lU(t,e,n=!1){return U(this,null,function*(){let i="signIn",r=yield fI(t,i,e),s=yield Su._fromIdTokenResponse(t,i,r);return n||(yield t._updateCurrentUser(s.user)),s})}function Mv(t,e,n,i){return Bn(t).onIdTokenChanged(e,n,i)}function Cv(t,e,n){return Bn(t).beforeAuthStateChanged(e,n)}var Eh="__sak";var bh=class{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Eh,"1"),this.storage.removeItem(Eh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){let n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};function dU(){let t=Xt();return xv(t)||Th(t)}var hU=1e3,fU=10,pU=(()=>{class t extends bh{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(n,i)=>this.onStorageEvent(n,i),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=dU()&&J2(),this.fallbackToPolling=uI(),this._shouldAllowMigration=!0}forAllChangedKeys(n){for(let i of Object.keys(this.listeners)){let r=this.storage.getItem(i),s=this.localCache[i];r!==s&&n(i,s,r)}}onStorageEvent(n,i=!1){if(!n.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}let r=n.key;if(i?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){let a=this.storage.getItem(r);if(n.newValue!==a)n.newValue!==null?this.storage.setItem(r,n.newValue):this.storage.removeItem(r);else if(this.localCache[r]===n.newValue&&!i)return}let s=()=>{let a=this.storage.getItem(r);!i&&this.localCache[r]===a||this.notifyListeners(r,a)},o=this.storage.getItem(r);Z2()&&o!==n.newValue&&n.newValue!==n.oldValue?setTimeout(s,fU):s()}notifyListeners(n,i){this.localCache[n]=i;let r=this.listeners[n];if(r)for(let s of Array.from(r))s(i&&JSON.parse(i))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((n,i,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:n,oldValue:i,newValue:r}),!0)})},hU)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(n,i){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[n]||(this.listeners[n]=new Set,this.localCache[n]=this.storage.getItem(n)),this.listeners[n].add(i)}_removeListener(n,i){this.listeners[n]&&(this.listeners[n].delete(i),this.listeners[n].size===0&&delete this.listeners[n]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(n,i){return U(this,null,function*(){yield kr(t.prototype,this,"_set").call(this,n,i),this.localCache[n]=JSON.stringify(i)})}_get(n){return U(this,null,function*(){let i=yield kr(t.prototype,this,"_get").call(this,n);return this.localCache[n]=JSON.stringify(i),i})}_remove(n){return U(this,null,function*(){yield kr(t.prototype,this,"_remove").call(this,n),delete this.localCache[n]})}}return t.type="LOCAL",t})(),pI=pU;var mU=(()=>{class t extends bh{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(n,i){}_removeListener(n,i){}}return t.type="SESSION",t})(),Dv=mU;function gU(t){return Promise.all(t.map(e=>U(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(n){return{fulfilled:!1,reason:n}}})))}var yU=(()=>{class t{constructor(n){this.eventTarget=n,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(n){let i=this.receivers.find(s=>s.isListeningto(n));if(i)return i;let r=new t(n);return this.receivers.push(r),r}isListeningto(n){return this.eventTarget===n}handleEvent(n){return U(this,null,function*(){let i=n,{eventId:r,eventType:s,data:o}=i.data,a=this.handlersMap[s];if(!a?.size)return;i.ports[0].postMessage({status:"ack",eventId:r,eventType:s});let c=Array.from(a).map(l=>U(this,null,function*(){return l(i.origin,o)})),u=yield gU(c);i.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})})}_subscribe(n,i){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[n]||(this.handlersMap[n]=new Set),this.handlersMap[n].add(i)}_unsubscribe(n,i){this.handlersMap[n]&&i&&this.handlersMap[n].delete(i),(!i||this.handlersMap[n].size===0)&&delete this.handlersMap[n],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}t.receivers=[];return t})();function mI(t="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(Math.random()*10);return t+n}var lv=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,n,i=50){return U(this,null,function*(){let r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let u=mI("",20);r.port1.start();let l=setTimeout(()=>{c(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(d){let h=d;if(h.data.eventId===u)switch(h.data.status){case"ack":clearTimeout(l),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(h.data.response);break;default:clearTimeout(l),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function $i(){return window}function vU(t){$i().location.href=t}function gI(){return typeof $i().WorkerGlobalScope<"u"&&typeof $i().importScripts=="function"}function _U(){return U(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function wU(){var t;return((t=navigator?.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function EU(){return gI()?self:null}var yI="firebaseLocalStorageDb",bU=1,xh="firebaseLocalStorage",vI="fbase_key",uo=class{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}};function Ih(t,e){return t.transaction([xh],e?"readwrite":"readonly").objectStore(xh)}function xU(){let t=indexedDB.deleteDatabase(yI);return new uo(t).toPromise()}function dv(){let t=indexedDB.open(yI,bU);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{let i=t.result;try{i.createObjectStore(xh,{keyPath:vI})}catch(r){n(r)}}),t.addEventListener("success",()=>U(this,null,function*(){let i=t.result;i.objectStoreNames.contains(xh)?e(i):(i.close(),yield xU(),e(yield dv()))}))})}function WT(t,e,n){return U(this,null,function*(){let i=Ih(t,!0).put({[vI]:e,value:n});return new uo(i).toPromise()})}function SU(t,e){return U(this,null,function*(){let n=Ih(t,!1).get(e),i=yield new uo(n).toPromise();return i===void 0?null:i.value})}function jT(t,e){let n=Ih(t,!0).delete(e);return new uo(n).toPromise()}var TU=800,IU=3,AU=(()=>{class t{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return U(this,null,function*(){return this.db?this.db:(this.db=yield dv(),this.db)})}_withRetries(n){return U(this,null,function*(){let i=0;for(;;)try{let r=yield this._openDb();return yield n(r)}catch(r){if(i++>IU)throw r;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return U(this,null,function*(){return gI()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return U(this,null,function*(){this.receiver=yU._getInstance(EU()),this.receiver._subscribe("keyChanged",(n,i)=>U(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(i.key)}})),this.receiver._subscribe("ping",(n,i)=>U(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return U(this,null,function*(){var n,i;if(this.activeServiceWorker=yield _U(),!this.activeServiceWorker)return;this.sender=new lv(this.activeServiceWorker);let r=yield this.sender._send("ping",{},800);r&&!((n=r[0])===null||n===void 0)&&n.fulfilled&&!((i=r[0])===null||i===void 0)&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(n){return U(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||wU()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:n},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return U(this,null,function*(){try{if(!indexedDB)return!1;let n=yield dv();return yield WT(n,Eh,"1"),yield jT(n,Eh),!0}catch{}return!1})}_withPendingWrite(n){return U(this,null,function*(){this.pendingWrites++;try{yield n()}finally{this.pendingWrites--}})}_set(n,i){return U(this,null,function*(){return this._withPendingWrite(()=>U(this,null,function*(){return yield this._withRetries(r=>WT(r,n,i)),this.localCache[n]=i,this.notifyServiceWorker(n)}))})}_get(n){return U(this,null,function*(){let i=yield this._withRetries(r=>SU(r,n));return this.localCache[n]=i,i})}_remove(n){return U(this,null,function*(){return this._withPendingWrite(()=>U(this,null,function*(){return yield this._withRetries(i=>jT(i,n)),delete this.localCache[n],this.notifyServiceWorker(n)}))})}_poll(){return U(this,null,function*(){let n=yield this._withRetries(s=>{let o=Ih(s,!1).getAll();return new uo(o).toPromise()});if(!n)return[];if(this.pendingWrites!==0)return[];let i=[],r=new Set;if(n.length!==0)for(let{fbase_key:s,value:o}of n)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),i.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),i.push(s));return i})}notifyListeners(n,i){this.localCache[n]=i;let r=this.listeners[n];if(r)for(let s of Array.from(r))s(i)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>U(this,null,function*(){return this._poll()}),TU)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(n,i){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[n]||(this.listeners[n]=new Set,this._get(n)),this.listeners[n].add(i)}_removeListener(n,i){this.listeners[n]&&(this.listeners[n].delete(i),this.listeners[n].size===0&&delete this.listeners[n]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return t.type="LOCAL",t})(),_I=AU;var JY=dI("rcb"),eQ=new co(3e4,6e4);function MU(t,e){return e?Er(e):(Ve(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}var Tu=class extends _h{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Jy(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Jy(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Jy(e,this._buildIdpRequest())}_buildIdpRequest(e){let n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}};function CU(t){return lU(t.auth,new Tu(t),t.bypassAuthState)}function DU(t){let{auth:e,user:n}=t;return Ve(n,e,"internal-error"),uU(n,new Tu(t),t.bypassAuthState)}function RU(t){return U(this,null,function*(){let{auth:e,user:n}=t;return Ve(n,e,"internal-error"),cU(n,new Tu(t),t.bypassAuthState)})}var hv=class{constructor(e,n,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise((e,n)=>U(this,null,function*(){this.pendingPromise={resolve:e,reject:n};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}}))}onAuthEvent(e){return U(this,null,function*(){let{urlResponse:n,sessionId:i,postBody:r,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:n,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(u){this.reject(u)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return CU;case"linkViaPopup":case"linkViaRedirect":return RU;case"reauthViaPopup":case"reauthViaRedirect":return DU;default:cs(this.auth,"internal-error")}}resolve(e){us(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){us(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var tQ=new co(2e3,1e4);var PU="pendingRedirect",lh=new Map,fv=class t extends hv{constructor(e,n,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}execute(){return U(this,null,function*(){let e=lh.get(this.auth._key());if(!e){try{let i=(yield NU(this.resolver,this.auth))?yield kr(t.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(i)}catch(n){e=()=>Promise.reject(n)}lh.set(this.auth._key(),e)}return this.bypassAuthState||lh.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return U(this,null,function*(){if(e.type==="signInViaRedirect")return kr(t.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let n=yield this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,kr(t.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return U(this,null,function*(){})}cleanUp(){}};function NU(t,e){return U(this,null,function*(){let n=kU(e),i=LU(t);if(!(yield i._isAvailable()))return!1;let r=(yield i._get(n))==="true";return yield i._remove(n),r})}function OU(t,e){lh.set(t._key(),e)}function LU(t){return Er(t._redirectPersistence)}function kU(t){return uh(PU,t.config.apiKey,t.name)}function FU(t,e,n=!1){return U(this,null,function*(){let i=Sv(t),r=MU(i,e),o=yield new fv(i,r,n).execute();return o&&!n&&(delete o.user._redirectEventId,yield i._persistUserIfCurrent(o.user),yield i._setRedirectUser(null,e)),o})}var UU=10*60*1e3,pv=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(n=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!VU(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var i;if(e.error&&!wI(e)){let r=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";n.onError(ao(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){let i=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=UU&&this.cachedEventUids.clear(),this.cachedEventUids.has($T(e))}saveEventToCache(e){this.cachedEventUids.add($T(e)),this.lastProcessedEventTime=Date.now()}};function $T(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function wI({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function VU(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return wI(t);default:return!1}}function BU(n){return U(this,arguments,function*(t,e={}){return Ia(t,"GET","/v1/projects",e)})}var zU=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,HU=/^https?/;function GU(t){return U(this,null,function*(){if(t.config.emulator)return;let{authorizedDomains:e}=yield BU(t);for(let n of e)try{if(WU(n))return}catch{}cs(t,"unauthorized-domain")})}function WU(t){let e=tv(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){let o=new URL(t);return o.hostname===""&&i===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===i}if(!HU.test(n))return!1;if(zU.test(t))return i===t;let r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}var jU=new co(3e4,6e4);function qT(){let t=$i().___jsl;if(t?.H){for(let e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function $U(t){return new Promise((e,n)=>{var i,r,s;function o(){qT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{qT(),n(ao(t,"network-request-failed"))},timeout:jU.get()})}if(!((r=(i=$i().gapi)===null||i===void 0?void 0:i.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((s=$i().gapi)===null||s===void 0)&&s.load)o();else{let a=dI("iframefcb");return $i()[a]=()=>{gapi.load?o():n(ao(t,"network-request-failed"))},iU(`${rU()}?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw dh=null,e})}var dh=null;function qU(t){return dh=dh||$U(t),dh}var XU=new co(5e3,15e3),KU="__/auth/iframe",YU="emulator/auth/iframe",QU={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ZU=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function JU(t){let e=t.config;Ve(e.authDomain,t,"auth-domain-config-required");let n=e.emulator?vv(e,YU):`https://${t.config.authDomain}/${KU}`,i={apiKey:e.apiKey,appName:t.name,v:ji},r=ZU.get(t.config.apiHost);r&&(i.eid=r);let s=t._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${gu(i).slice(1)}`}function eV(t){return U(this,null,function*(){let e=yield qU(t),n=$i().gapi;return Ve(n,t,"internal-error"),e.open({where:document.body,url:JU(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:QU,dontclear:!0},i=>new Promise((r,s)=>U(this,null,function*(){yield i.restyle({setHideOnLeave:!1});let o=ao(t,"network-request-failed"),a=$i().setTimeout(()=>{s(o)},XU.get());function c(){$i().clearTimeout(a),r(i)}i.ping(c).then(c,()=>{s(o)})})))})}var tV={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},nV=500,iV=600,rV="_blank",sV="http://localhost",Sh=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function oV(t,e,n,i=nV,r=iV){let s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString(),a="",c=Object.assign(Object.assign({},tV),{width:i.toString(),height:r.toString(),top:s,left:o}),u=Xt().toLowerCase();n&&(a=rI(u)?rV:n),iI(u)&&(e=e||sV,c.scrollbars="yes");let l=Object.entries(c).reduce((h,[p,g])=>`${h}${p}=${g},`,"");if(Q2(u)&&a!=="_self")return aV(e||"",a),new Sh(null);let d=window.open(e||"",a,l);Ve(d,t,"popup-blocked");try{d.focus()}catch{}return new Sh(d)}function aV(t,e){let n=document.createElement("a");n.href=t,n.target=e;let i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}var cV="__/auth/handler",uV="emulator/auth/handler",lV=encodeURIComponent("fac");function XT(t,e,n,i,r,s){return U(this,null,function*(){Ve(t.config.authDomain,t,"auth-domain-config-required"),Ve(t.config.apiKey,t,"invalid-api-key");let o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:ji,eventId:r};if(e instanceof wh){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",bT(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[l,d]of Object.entries(s||{}))o[l]=d}if(e instanceof cv){let l=e.getScopes().filter(d=>d!=="");l.length>0&&(o.scopes=l.join(","))}t.tenantId&&(o.tid=t.tenantId);let a=o;for(let l of Object.keys(a))a[l]===void 0&&delete a[l];let c=yield t._getAppCheckToken(),u=c?`#${lV}=${encodeURIComponent(c)}`:"";return`${dV(t)}?${gu(a).slice(1)}${u}`})}function dV({config:t}){return t.emulator?vv(t,uV):`https://${t.authDomain}/${cV}`}var ev="webStorageSupport",mv=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Dv,this._completeRedirectFn=FU,this._overrideRedirectResult=OU}_openPopup(e,n,i,r){return U(this,null,function*(){var s;us((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield XT(e,n,i,tv(),r);return oV(e,o,mI())})}_openRedirect(e,n,i,r){return U(this,null,function*(){yield this._originValidation(e);let s=yield XT(e,n,i,tv(),r);return vU(s),new Promise(()=>{})})}_initialize(e){let n=e._key();if(this.eventManagers[n]){let{manager:r,promise:s}=this.eventManagers[n];return r?Promise.resolve(r):(us(s,"If manager is not set, promise should be"),s)}let i=this.initAndGetManager(e);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}initAndGetManager(e){return U(this,null,function*(){let n=yield eV(e),i=new pv(e);return n.register("authEvent",r=>(Ve(r?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=n,i})}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(ev,{type:ev},r=>{var s;let o=(s=r?.[0])===null||s===void 0?void 0:s[ev];o!==void 0&&n(!!o),cs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=GU(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return uI()||xv()||Th()}},EI=mv;var KT="@firebase/auth",YT="1.6.0";var gv=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return U(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let n=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ve(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function hV(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function fV(t){Wi(new Cn("auth",(e,{options:n})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;Ve(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});let c={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:lI(t)},u=new av(i,r,s,c);return sU(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,i)=>{e.getProvider("auth-internal").initialize()})),Wi(new Cn("auth-internal",e=>{let n=Sv(e.getProvider("auth").getImmediate());return(i=>new gv(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Dt(KT,YT,hV(t)),Dt(KT,YT,"esm2017")}var pV=5*60,mV=Oy("authIdTokenMaxAge")||pV,QT=null,gV=t=>e=>U(void 0,null,function*(){let n=e&&(yield e.getIdTokenResult()),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>mV)return;let r=n?.token;QT!==r&&(QT=r,yield fetch(t,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});function Rv(t=os()){let e=io(t,"auth");if(e.isInitialized())return e.getImmediate();let n=Iv(t,{popupRedirectResolver:EI,persistence:[_I,pI,Dv]}),i=Oy("authTokenSyncURL");if(i){let s=gV(i);Cv(n,s,()=>s(n.currentUser)),Mv(n,o=>s(o))}let r=Py("auth");return r&&Av(n,`http://${r}`),n}function yV(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}nU({loadJS(t){return new Promise((e,n)=>{let i=document.createElement("script");i.setAttribute("src",t),i.onload=e,i.onerror=r=>{let s=ao("internal-error");s.customData=r,n(s)},i.type="text/javascript",i.charset="UTF-8",yV().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});fV("Browser");var bI="auth",Iu=class{constructor(e){return e}},Au=class{constructor(){return wu(bI)}};var Pv=new $e("angularfire2.auth-instances");function dB(t,e){let n=sh(bI,t,e);return n&&new Iu(n)}function hB(t){return(e,n)=>{let i=e.runOutsideAngular(()=>t(n));return new Iu(i)}}var fB={provide:Au,deps:[[new Mn,Pv]]},pB={provide:Iu,useFactory:dB,deps:[[new Mn,Pv],_r]},mB=(()=>{class t{constructor(){Dt("angularfire",so.full,"auth")}static \u0275fac=function(i){return new(i||t)};static \u0275mod=Fi({type:t});static \u0275inj=ki({providers:[pB,fB]})}return t})();function xI(t,...e){return{ngModule:mB,providers:[{provide:Pv,useFactory:hB(t),multi:!0,deps:[yt,mi,Sa,oo,[new Mn,xa],...e]}]}}var SI=Ta(Rv,!0);var gB=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},vi={},oe,e_=e_||{},Le=gB||self;function Bh(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function zu(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function yB(t){return Object.prototype.hasOwnProperty.call(t,Nv)&&t[Nv]||(t[Nv]=++vB)}var Nv="closure_uid_"+(1e9*Math.random()>>>0),vB=0;function _B(t,e,n){return t.call.apply(t.bind,arguments)}function wB(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,i),t.apply(e,r)}}return function(){return t.apply(e,arguments)}}function pn(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?pn=_B:pn=wB,pn.apply(null,arguments)}function Ah(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var i=n.slice();return i.push.apply(i,arguments),t.apply(this,i)}}function Yt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(i,r,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[r].apply(i,o)}}function ls(){this.s=this.s,this.o=this.o}var EB=0;ls.prototype.s=!1;ls.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),EB!=0)&&yB(this)};ls.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var FI=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function t_(t){let e=t.length;if(0<e){let n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function TI(t,e){for(let n=1;n<arguments.length;n++){let i=arguments[n];if(Bh(i)){let r=t.length||0,s=i.length||0;t.length=r+s;for(let o=0;o<s;o++)t[r+o]=i[o]}else t.push(i)}}function mn(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}mn.prototype.h=function(){this.defaultPrevented=!0};var bB=function(){if(!Le.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};Le.addEventListener("test",n,e),Le.removeEventListener("test",n,e)}catch{}return t}();function Nu(t){return/^[\s\xa0]*$/.test(t)}function zh(){var t=Le.navigator;return t&&(t=t.userAgent)?t:""}function qi(t){return zh().indexOf(t)!=-1}function n_(t){return n_[" "](t),t}n_[" "]=function(){};function xB(t,e){var n=d3;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var SB=qi("Opera"),Da=qi("Trident")||qi("MSIE"),UI=qi("Edge"),Uv=UI||Da,VI=qi("Gecko")&&!(zh().toLowerCase().indexOf("webkit")!=-1&&!qi("Edge"))&&!(qi("Trident")||qi("MSIE"))&&!qi("Edge"),TB=zh().toLowerCase().indexOf("webkit")!=-1&&!qi("Edge");function BI(){var t=Le.document;return t?t.documentMode:void 0}var Vv;e:{if(Mh="",Ch=function(){var t=zh();if(VI)return/rv:([^\);]+)(\)|;)/.exec(t);if(UI)return/Edge\/([\d\.]+)/.exec(t);if(Da)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(TB)return/WebKit\/(\S+)/.exec(t);if(SB)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),Ch&&(Mh=Ch?Ch[1]:""),Da&&(Dh=BI(),Dh!=null&&Dh>parseFloat(Mh))){Vv=String(Dh);break e}Vv=Mh}var Mh,Ch,Dh,Bv;Le.document&&Da?(Ov=BI(),Bv=Ov||parseInt(Vv,10)||void 0):Bv=void 0;var Ov,IB=Bv;function Ou(t,e){if(mn.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(VI){e:{try{n_(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=i.clientX!==void 0?i.clientX:i.pageX,this.clientY=i.clientY!==void 0?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:AB[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Ou.$.h.call(this)}}Yt(Ou,mn);var AB={2:"touch",3:"pen",4:"mouse"};Ou.prototype.h=function(){Ou.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Hu="closure_listenable_"+(1e6*Math.random()|0),MB=0;function CB(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.la=r,this.key=++MB,this.fa=this.ia=!1}function Hh(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function i_(t,e,n){for(let i in t)e.call(n,t[i],i,t)}function DB(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function zI(t){let e={};for(let n in t)e[n]=t[n];return e}var II="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function HI(t,e){let n,i;for(let r=1;r<arguments.length;r++){i=arguments[r];for(n in i)t[n]=i[n];for(let s=0;s<II.length;s++)n=II[s],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function Gh(t){this.src=t,this.g={},this.h=0}Gh.prototype.add=function(t,e,n,i,r){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=Hv(t,e,i,r);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new CB(e,this.src,s,!!i,r),e.ia=n,t.push(e)),e};function zv(t,e){var n=e.type;if(n in t.g){var i=t.g[n],r=FI(i,e),s;(s=0<=r)&&Array.prototype.splice.call(i,r,1),s&&(Hh(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Hv(t,e,n,i){for(var r=0;r<t.length;++r){var s=t[r];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==i)return r}return-1}var r_="closure_lm_"+(1e6*Math.random()|0),Lv={};function GI(t,e,n,i,r){if(i&&i.once)return jI(t,e,n,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)GI(t,e[s],n,i,r);return null}return n=a_(n),t&&t[Hu]?t.O(e,n,zu(i)?!!i.capture:!!i,r):WI(t,e,n,!1,i,r)}function WI(t,e,n,i,r,s){if(!e)throw Error("Invalid event type");var o=zu(r)?!!r.capture:!!r,a=o_(t);if(a||(t[r_]=a=new Gh(t)),n=a.add(e,n,i,o,s),n.proxy)return n;if(i=RB(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)bB||(r=o),r===void 0&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(qI(e.toString()),i);else if(t.addListener&&t.removeListener)t.addListener(i);else throw Error("addEventListener and attachEvent are unavailable.");return n}function RB(){function t(n){return e.call(t.src,t.listener,n)}let e=PB;return t}function jI(t,e,n,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)jI(t,e[s],n,i,r);return null}return n=a_(n),t&&t[Hu]?t.P(e,n,zu(i)?!!i.capture:!!i,r):WI(t,e,n,!0,i,r)}function $I(t,e,n,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)$I(t,e[s],n,i,r);else i=zu(i)?!!i.capture:!!i,n=a_(n),t&&t[Hu]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=Hv(s,n,i,r),-1<n&&(Hh(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=o_(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Hv(e,n,i,r)),(n=-1<t?e[t]:null)&&s_(n))}function s_(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Hu])zv(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(qI(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=o_(e))?(zv(n,t),n.h==0&&(n.src=null,e[r_]=null)):Hh(t)}}}function qI(t){return t in Lv?Lv[t]:Lv[t]="on"+t}function PB(t,e){if(t.fa)t=!0;else{e=new Ou(e,this);var n=t.listener,i=t.la||t.src;t.ia&&s_(t),t=n.call(i,e)}return t}function o_(t){return t=t[r_],t instanceof Gh?t:null}var kv="__closure_events_fn_"+(1e9*Math.random()>>>0);function a_(t){return typeof t=="function"?t:(t[kv]||(t[kv]=function(e){return t.handleEvent(e)}),t[kv])}function Kt(){ls.call(this),this.i=new Gh(this),this.S=this,this.J=null}Yt(Kt,ls);Kt.prototype[Hu]=!0;Kt.prototype.removeEventListener=function(t,e,n,i){$I(this,t,e,n,i)};function on(t,e){var n,i=t.J;if(i)for(n=[];i;i=i.J)n.push(i);if(t=t.S,i=e.type||e,typeof e=="string")e=new mn(e,t);else if(e instanceof mn)e.target=e.target||t;else{var r=e;e=new mn(i,t),HI(e,r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];r=Rh(o,i,!0,e)&&r}if(o=e.g=t,r=Rh(o,i,!0,e)&&r,r=Rh(o,i,!1,e)&&r,n)for(s=0;s<n.length;s++)o=e.g=n[s],r=Rh(o,i,!1,e)&&r}Kt.prototype.N=function(){if(Kt.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],i=0;i<n.length;i++)Hh(n[i]);delete t.g[e],t.h--}}this.J=null};Kt.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)};Kt.prototype.P=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};function Rh(t,e,n,i){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&zv(t.i,o),r=a.call(c,i)!==!1&&r}}return r&&!i.defaultPrevented}var c_=Le.JSON.stringify,Gv=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function NB(){var t=u_;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Wv=class{constructor(){this.h=this.g=null}add(e,n){let i=XI.get();i.set(e,n),this.h?this.h.next=i:this.g=i,this.h=i}},XI=new Gv(()=>new jv,t=>t.reset()),jv=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function OB(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function LB(t){Le.setTimeout(()=>{throw t},0)}var Lu,ku=!1,u_=new Wv,KI=()=>{let t=Le.Promise.resolve(void 0);Lu=()=>{t.then(kB)}},kB=()=>{for(var t;t=NB();){try{t.h.call(t.g)}catch(n){LB(n)}var e=XI;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}ku=!1};function Wh(t,e){Kt.call(this),this.h=t||1,this.g=e||Le,this.j=pn(this.qb,this),this.l=Date.now()}Yt(Wh,Kt);oe=Wh.prototype;oe.ga=!1;oe.T=null;oe.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),on(this,"tick"),this.ga&&(l_(this),this.start()))}};oe.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function l_(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}oe.N=function(){Wh.$.N.call(this),l_(this),delete this.g};function d_(t,e,n){if(typeof t=="function")n&&(t=pn(t,n));else if(t&&typeof t.handleEvent=="function")t=pn(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Le.setTimeout(t,e||0)}function YI(t){t.g=d_(()=>{t.g=null,t.i&&(t.i=!1,YI(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var $v=class extends ls{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:YI(this)}N(){super.N(),this.g&&(Le.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function Fu(t){ls.call(this),this.h=t,this.g={}}Yt(Fu,ls);var AI=[];function QI(t,e,n,i){Array.isArray(n)||(n&&(AI[0]=n.toString()),n=AI);for(var r=0;r<n.length;r++){var s=GI(e,n[r],i||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function ZI(t){i_(t.g,function(e,n){this.g.hasOwnProperty(n)&&s_(e)},t),t.g={}}Fu.prototype.N=function(){Fu.$.N.call(this),ZI(this)};Fu.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function jh(){this.g=!0}jh.prototype.Ea=function(){this.g=!1};function FB(t,e,n,i,r,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var d=l.split("_");o=2<=d.length&&d[1]=="type"?o+(l+"="+u+"&"):o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+`
`+n+`
`+o})}function UB(t,e,n,i,r,s,o){t.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+`
`+n+`
`+s+" "+o})}function Ma(t,e,n,i){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+BB(t,n)+(i?" "+i:"")})}function VB(t,e){t.info(function(){return"TIMEOUT: "+e})}jh.prototype.info=function(){};function BB(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<r.length;o++)r[o]=""}}}}return c_(n)}catch{return e}}var po={},MI=null;function $h(){return MI=MI||new Kt}po.Ta="serverreachability";function JI(t){mn.call(this,po.Ta,t)}Yt(JI,mn);function Uu(t){let e=$h();on(e,new JI(e))}po.STAT_EVENT="statevent";function eA(t,e){mn.call(this,po.STAT_EVENT,t),this.stat=e}Yt(eA,mn);function wn(t){let e=$h();on(e,new eA(e,t))}po.Ua="timingevent";function tA(t,e){mn.call(this,po.Ua,t),this.size=e}Yt(tA,mn);function Gu(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return Le.setTimeout(function(){t()},e)}var qh={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},nA={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function h_(){}h_.prototype.h=null;function CI(t){return t.h||(t.h=t.i())}function iA(){}var Wu={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function f_(){mn.call(this,"d")}Yt(f_,mn);function p_(){mn.call(this,"c")}Yt(p_,mn);var qv;function Xh(){}Yt(Xh,h_);Xh.prototype.g=function(){return new XMLHttpRequest};Xh.prototype.i=function(){return{}};qv=new Xh;function ju(t,e,n,i){this.l=t,this.j=e,this.m=n,this.W=i||1,this.U=new Fu(this),this.P=zB,t=Uv?125:void 0,this.V=new Wh(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new rA}function rA(){this.i=null,this.g="",this.h=!1}var zB=45e3,sA={},Xv={};oe=ju.prototype;oe.setTimeout=function(t){this.P=t};function Kv(t,e,n){t.L=1,t.A=Yh(xr(e)),t.u=n,t.S=!0,oA(t,null)}function oA(t,e){t.G=Date.now(),$u(t),t.B=xr(t.A);var n=t.B,i=t.W;Array.isArray(i)||(i=[String(i)]),pA(n.i,"t",i),t.o=0,n=t.l.J,t.h=new rA,t.g=LA(t.l,n?e:null,!t.u),0<t.O&&(t.M=new $v(pn(t.Pa,t,t.g),t.O)),QI(t.U,t.g,"readystatechange",t.nb),e=t.I?zI(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),Uu(),FB(t.j,t.v,t.B,t.m,t.W,t.u)}oe.nb=function(t){t=t.target;let e=this.M;e&&Xi(t)==3?e.l():this.Pa(t)};oe.Pa=function(t){try{if(t==this.g)e:{let l=Xi(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>l)&&(l!=3||Uv||this.g&&(this.h.h||this.g.ja()||NI(this.g)))){this.J||l!=4||e==7||(e==8||0>=d?Uu(3):Uu(2)),Kh(this);var n=this.g.da();this.ca=n;t:if(aA(this)){var i=NI(this.g);t="";var r=i.length,s=Xi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){lo(this),Pu(this);var o="";break t}this.h.i=new Le.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,UB(this.j,this.v,this.B,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Nu(a)){var u=a;break t}}u=null}if(n=u)Ma(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Yv(this,n);else{this.i=!1,this.s=3,wn(12),lo(this),Pu(this);break e}}this.S?(cA(this,l,o),Uv&&this.i&&l==3&&(QI(this.U,this.V,"tick",this.mb),this.V.start())):(Ma(this.j,this.m,o,null),Yv(this,o)),l==4&&lo(this),this.i&&!this.J&&(l==4?RA(this.l,this):(this.i=!1,$u(this)))}else c3(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,wn(12)):(this.s=0,wn(13)),lo(this),Pu(this)}}}catch{}finally{}};function aA(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function cA(t,e,n){let i=!0,r;for(;!t.J&&t.o<n.length;)if(r=HB(t,n),r==Xv){e==4&&(t.s=4,wn(14),i=!1),Ma(t.j,t.m,null,"[Incomplete Response]");break}else if(r==sA){t.s=4,wn(15),Ma(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}else Ma(t.j,t.m,r,null),Yv(t,r);aA(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,wn(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),w_(e),e.M=!0,wn(11))):(Ma(t.j,t.m,n,"[Invalid Chunked Response]"),lo(t),Pu(t))}oe.mb=function(){if(this.g){var t=Xi(this.g),e=this.g.ja();this.o<e.length&&(Kh(this),cA(this,t,e),this.i&&t!=4&&$u(this))}};function HB(t,e){var n=t.o,i=e.indexOf(`
`,n);return i==-1?Xv:(n=Number(e.substring(n,i)),isNaN(n)?sA:(i+=1,i+n>e.length?Xv:(e=e.slice(i,i+n),t.o=i+n,e)))}oe.cancel=function(){this.J=!0,lo(this)};function $u(t){t.Y=Date.now()+t.P,uA(t,t.P)}function uA(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=Gu(pn(t.lb,t),e)}function Kh(t){t.C&&(Le.clearTimeout(t.C),t.C=null)}oe.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(VB(this.j,this.B),this.L!=2&&(Uu(),wn(17)),lo(this),this.s=2,Pu(this)):uA(this,this.Y-t)};function Pu(t){t.l.H==0||t.J||RA(t.l,t)}function lo(t){Kh(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,l_(t.V),ZI(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Yv(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||Qv(n.i,t))){if(!t.K&&Qv(n.i,t)&&n.H==3){try{var i=n.Ja.g.parse(e)}catch{i=null}if(Array.isArray(i)&&i.length==3){var r=i;if(r[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)kh(n),Jh(n);else break e;__(n),wn(18)}}else n.Fa=r[1],0<n.Fa-n.V&&37500>r[2]&&n.G&&n.A==0&&!n.v&&(n.v=Gu(pn(n.ib,n),6e3));if(1>=yA(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else ho(n,11)}else if((t.K||n.g==t)&&kh(n),!Nu(e))for(r=n.Ja.g.parse(e),e=0;e<r.length;e++){let u=r[e];if(n.V=u[0],u=u[1],n.H==2)if(u[0]=="c"){n.K=u[1],n.pa=u[2];let l=u[3];l!=null&&(n.ra=l,n.l.info("VER="+n.ra));let d=u[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let h=u[5];h!=null&&typeof h=="number"&&0<h&&(i=1.5*h,n.L=i,n.l.info("backChannelRequestTimeoutMs_="+i)),i=n;let p=t.g;if(p){let g=p.g?p.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(g){var s=i.i;s.g||g.indexOf("spdy")==-1&&g.indexOf("quic")==-1&&g.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(m_(s,s.h),s.h=null))}if(i.F){let y=p.g?p.g.getResponseHeader("X-HTTP-Session-Id"):null;y&&(i.Da=y,St(i.I,i.F,y))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),i=n;var o=t;if(i.wa=OA(i,i.J?i.pa:null,i.Y),o.K){vA(i.i,o);var a=o,c=i.L;c&&a.setTimeout(c),a.C&&(Kh(a),$u(a)),i.g=o}else CA(i);0<n.j.length&&ef(n)}else u[0]!="stop"&&u[0]!="close"||ho(n,7);else n.H==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?ho(n,7):v_(n):u[0]!="noop"&&n.h&&n.h.Aa(u),n.A=0)}}Uu(4)}catch{}}function GB(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Bh(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}e=[],n=0;for(i in t)e[n++]=t[i];return e}function WB(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Bh(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let i in t)e[n++]=i;return e}}}function lA(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Bh(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=WB(t),i=GB(t),r=i.length,s=0;s<r;s++)e.call(void 0,i[s],n&&n[s],t)}var dA=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function jB(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}function fo(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof fo){this.h=t.h,Oh(this,t.j),this.s=t.s,this.g=t.g,Lh(this,t.m),this.l=t.l;var e=t.i,n=new Vu;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),DI(this,n),this.o=t.o}else t&&(e=String(t).match(dA))?(this.h=!1,Oh(this,e[1]||"",!0),this.s=Du(e[2]||""),this.g=Du(e[3]||"",!0),Lh(this,e[4]),this.l=Du(e[5]||"",!0),DI(this,e[6]||"",!0),this.o=Du(e[7]||"")):(this.h=!1,this.i=new Vu(null,this.h))}fo.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Ru(e,RI,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Ru(e,RI,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Ru(n,n.charAt(0)=="/"?XB:qB,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Ru(n,YB)),t.join("")};function xr(t){return new fo(t)}function Oh(t,e,n){t.j=n?Du(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Lh(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function DI(t,e,n){e instanceof Vu?(t.i=e,QB(t.i,t.h)):(n||(e=Ru(e,KB)),t.i=new Vu(e,t.h))}function St(t,e,n){t.i.set(e,n)}function Yh(t){return St(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Du(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ru(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,$B),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function $B(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var RI=/[#\/\?@]/g,qB=/[#\?:]/g,XB=/[#\?]/g,KB=/[#\?@]/g,YB=/#/g;function Vu(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function ds(t){t.g||(t.g=new Map,t.h=0,t.i&&jB(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}oe=Vu.prototype;oe.add=function(t,e){ds(this),this.i=null,t=Ra(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function hA(t,e){ds(t),e=Ra(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function fA(t,e){return ds(t),e=Ra(t,e),t.g.has(e)}oe.forEach=function(t,e){ds(this),this.g.forEach(function(n,i){n.forEach(function(r){t.call(e,r,i,this)},this)},this)};oe.ta=function(){ds(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let i=0;i<e.length;i++){let r=t[i];for(let s=0;s<r.length;s++)n.push(e[i])}return n};oe.Z=function(t){ds(this);let e=[];if(typeof t=="string")fA(this,t)&&(e=e.concat(this.g.get(Ra(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};oe.set=function(t,e){return ds(this),this.i=null,t=Ra(this,t),fA(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};oe.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function pA(t,e,n){hA(t,e),0<n.length&&(t.i=null,t.g.set(Ra(t,e),t_(n)),t.h+=n.length)}oe.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var i=e[n];let s=encodeURIComponent(String(i)),o=this.Z(i);for(i=0;i<o.length;i++){var r=s;o[i]!==""&&(r+="="+encodeURIComponent(String(o[i]))),t.push(r)}}return this.i=t.join("&")};function Ra(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function QB(t,e){e&&!t.j&&(ds(t),t.i=null,t.g.forEach(function(n,i){var r=i.toLowerCase();i!=r&&(hA(this,i),pA(this,r,n))},t)),t.j=e}var ZB=class{constructor(t,e){this.g=t,this.map=e}};function mA(t){this.l=t||JB,Le.PerformanceNavigationTiming?(t=Le.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(Le.g&&Le.g.Ka&&Le.g.Ka()&&Le.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var JB=10;function gA(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function yA(t){return t.h?1:t.g?t.g.size:0}function Qv(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function m_(t,e){t.g?t.g.add(e):t.h=e}function vA(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}mA.prototype.cancel=function(){if(this.i=_A(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function _A(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return t_(t.i)}var e3=class{stringify(t){return Le.JSON.stringify(t,void 0)}parse(t){return Le.JSON.parse(t,void 0)}};function t3(){this.g=new e3}function n3(t,e,n){let i=n||"";try{lA(t,function(r,s){let o=r;zu(r)&&(o=c_(r)),e.push(i+s+"="+encodeURIComponent(o))})}catch(r){throw e.push(i+"type="+encodeURIComponent("_badmap")),r}}function i3(t,e){let n=new jh;if(Le.Image){let i=new Image;i.onload=Ah(Ph,n,i,"TestLoadImage: loaded",!0,e),i.onerror=Ah(Ph,n,i,"TestLoadImage: error",!1,e),i.onabort=Ah(Ph,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=Ah(Ph,n,i,"TestLoadImage: timeout",!1,e),Le.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=t}else e(!1)}function Ph(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch{}}function qu(t){this.l=t.ec||null,this.j=t.ob||!1}Yt(qu,h_);qu.prototype.g=function(){return new Qh(this.l,this.j)};qu.prototype.i=function(t){return function(){return t}}({});function Qh(t,e){Kt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=g_,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Yt(Qh,Kt);var g_=0;oe=Qh.prototype;oe.open=function(t,e){if(this.readyState!=g_)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Bu(this)};oe.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Le).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};oe.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Xu(this)),this.readyState=g_};oe.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Bu(this)),this.g&&(this.readyState=3,Bu(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Le.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;wA(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function wA(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}oe.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Xu(this):Bu(this),this.readyState==3&&wA(this)}};oe.Za=function(t){this.g&&(this.response=this.responseText=t,Xu(this))};oe.Ya=function(t){this.g&&(this.response=t,Xu(this))};oe.ka=function(){this.g&&Xu(this)};function Xu(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Bu(t)}oe.setRequestHeader=function(t,e){this.v.append(t,e)};oe.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};oe.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Bu(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Qh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var r3=Le.JSON.parse;function Rt(t){Kt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=EA,this.L=this.M=!1}Yt(Rt,Kt);var EA="",s3=/^https?$/i,o3=["POST","PUT"];oe=Rt.prototype;oe.Oa=function(t){this.M=t};oe.ha=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():qv.g(),this.C=this.u?CI(this.u):CI(qv),this.g.onreadystatechange=pn(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){PI(this,s);return}if(t=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)n.set(r,i[r]);else if(typeof i.keys=="function"&&typeof i.get=="function")for(let s of i.keys())n.set(s,i.get(s));else throw Error("Unknown input type for opt_headers: "+String(i));i=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),r=Le.FormData&&t instanceof Le.FormData,!(0<=FI(o3,e))||i||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{SA(this),0<this.B&&((this.L=a3(this.g))?(this.g.timeout=this.B,this.g.ontimeout=pn(this.ua,this)):this.A=d_(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){PI(this,s)}};function a3(t){return Da&&typeof t.timeout=="number"&&t.ontimeout!==void 0}oe.ua=function(){typeof e_<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,on(this,"timeout"),this.abort(8))};function PI(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,bA(t),Zh(t)}function bA(t){t.F||(t.F=!0,on(t,"complete"),on(t,"error"))}oe.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,on(this,"complete"),on(this,"abort"),Zh(this))};oe.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Zh(this,!0)),Rt.$.N.call(this)};oe.La=function(){this.s||(this.G||this.v||this.l?xA(this):this.kb())};oe.kb=function(){xA(this)};function xA(t){if(t.h&&typeof e_<"u"&&(!t.C[1]||Xi(t)!=4||t.da()!=2)){if(t.v&&Xi(t)==4)d_(t.La,0,t);else if(on(t,"readystatechange"),Xi(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var i;if(i=o===0){var r=String(t.I).match(dA)[1]||null;!r&&Le.self&&Le.self.location&&(r=Le.self.location.protocol.slice(0,-1)),i=!s3.test(r?r.toLowerCase():"")}n=i}if(n)on(t,"complete"),on(t,"success");else{t.m=6;try{var s=2<Xi(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",bA(t)}}finally{Zh(t)}}}}function Zh(t,e){if(t.g){SA(t);let n=t.g,i=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||on(t,"ready");try{n.onreadystatechange=i}catch{}}}function SA(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Le.clearTimeout(t.A),t.A=null)}oe.isActive=function(){return!!this.g};function Xi(t){return t.g?t.g.readyState:0}oe.da=function(){try{return 2<Xi(this)?this.g.status:-1}catch{return-1}};oe.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};oe.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),r3(e)}};function NI(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case EA:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function c3(t){let e={};t=(t.g&&2<=Xi(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let i=0;i<t.length;i++){if(Nu(t[i]))continue;var n=OB(t[i]);let r=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[r]||[];e[r]=s,s.push(n)}DB(e,function(i){return i.join(", ")})}oe.Ia=function(){return this.m};oe.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function TA(t){let e="";return i_(t,function(n,i){e+=i,e+=":",e+=n,e+=`\r
`}),e}function y_(t,e,n){e:{for(i in n){var i=!1;break e}i=!0}i||(n=TA(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):St(t,e,n))}function Mu(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function IA(t){this.Ga=0,this.j=[],this.l=new jh,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Mu("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Mu("baseRetryDelayMs",5e3,t),this.hb=Mu("retryDelaySeedMs",1e4,t),this.eb=Mu("forwardChannelMaxRetries",2,t),this.xa=Mu("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new mA(t&&t.concurrentRequestLimit),this.Ja=new t3,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}oe=IA.prototype;oe.ra=8;oe.H=1;function v_(t){if(AA(t),t.H==3){var e=t.W++,n=xr(t.I);if(St(n,"SID",t.K),St(n,"RID",e),St(n,"TYPE","terminate"),Ku(t,n),e=new ju(t,t.l,e),e.L=2,e.A=Yh(xr(n)),n=!1,Le.navigator&&Le.navigator.sendBeacon)try{n=Le.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&Le.Image&&(new Image().src=e.A,n=!0),n||(e.g=LA(e.l,null),e.g.ha(e.A)),e.G=Date.now(),$u(e)}NA(t)}function Jh(t){t.g&&(w_(t),t.g.cancel(),t.g=null)}function AA(t){Jh(t),t.u&&(Le.clearTimeout(t.u),t.u=null),kh(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&Le.clearTimeout(t.m),t.m=null)}function ef(t){if(!gA(t.i)&&!t.m){t.m=!0;var e=t.Na;Lu||KI(),ku||(Lu(),ku=!0),u_.add(e,t),t.C=0}}function u3(t,e){return yA(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Gu(pn(t.Na,t,e),PA(t,t.C)),t.C++,!0)}oe.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let r=new ju(this,this.l,t),s=this.s;if(this.U&&(s?(s=zI(s),HI(s,this.U)):s=this.U),this.o!==null||this.O||(r.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var i=this.j[n];if("__data__"in i.map&&(i=i.map.__data__,typeof i=="string")){i=i.length;break t}i=void 0}if(i===void 0)break;if(e+=i,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=MA(this,r,e),n=xr(this.I),St(n,"RID",t),St(n,"CVER",22),this.F&&St(n,"X-HTTP-Session-Id",this.F),Ku(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(TA(s)))+"&"+e:this.o&&y_(n,this.o,s)),m_(this.i,r),this.bb&&St(n,"TYPE","init"),this.P?(St(n,"$req",e),St(n,"SID","null"),r.aa=!0,Kv(r,n,null)):Kv(r,n,e),this.H=2}}else this.H==3&&(t?OI(this,t):this.j.length==0||gA(this.i)||OI(this))};function OI(t,e){var n;e?n=e.m:n=t.W++;let i=xr(t.I);St(i,"SID",t.K),St(i,"RID",n),St(i,"AID",t.V),Ku(t,i),t.o&&t.s&&y_(i,t.o,t.s),n=new ju(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=MA(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),m_(t.i,n),Kv(n,i,e)}function Ku(t,e){t.na&&i_(t.na,function(n,i){St(e,i,n)}),t.h&&lA({},function(n,i){St(e,i,n)})}function MA(t,e,n){n=Math.min(t.j.length,n);var i=t.h?pn(t.h.Va,t.h,t):null;e:{var r=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=r[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<n;c++){let u=r[c].g,l=r[c].map;if(u-=s,0>u)s=Math.max(0,r[c].g-100),a=!1;else try{n3(l,o,"req"+u+"_")}catch{i&&i(l)}}if(a){i=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,i}function CA(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Lu||KI(),ku||(Lu(),ku=!0),u_.add(e,t),t.A=0}}function __(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Gu(pn(t.Ma,t),PA(t,t.A)),t.A++,!0)}oe.Ma=function(){if(this.u=null,DA(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Gu(pn(this.jb,this),t)}};oe.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,wn(10),Jh(this),DA(this))};function w_(t){t.B!=null&&(Le.clearTimeout(t.B),t.B=null)}function DA(t){t.g=new ju(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=xr(t.wa);St(e,"RID","rpc"),St(e,"SID",t.K),St(e,"AID",t.V),St(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&St(e,"TO",t.qa),St(e,"TYPE","xmlhttp"),Ku(t,e),t.o&&t.s&&y_(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=Yh(xr(e)),n.u=null,n.S=!0,oA(n,t)}oe.ib=function(){this.v!=null&&(this.v=null,Jh(this),__(this),wn(19))};function kh(t){t.v!=null&&(Le.clearTimeout(t.v),t.v=null)}function RA(t,e){var n=null;if(t.g==e){kh(t),w_(t),t.g=null;var i=2}else if(Qv(t.i,e))n=e.F,vA(t.i,e),i=1;else return;if(t.H!=0){if(e.i)if(i==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var r=t.C;i=$h(),on(i,new tA(i,n)),ef(t)}else CA(t);else if(r=e.s,r==3||r==0&&0<e.ca||!(i==1&&u3(t,e)||i==2&&__(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),r){case 1:ho(t,5);break;case 4:ho(t,10);break;case 3:ho(t,6);break;default:ho(t,2)}}}function PA(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function ho(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var i=pn(t.pb,t);n||(n=new fo("//www.google.com/images/cleardot.gif"),Le.location&&Le.location.protocol=="http"||Oh(n,"https"),Yh(n)),i3(n.toString(),i)}else wn(2);t.H=0,t.h&&t.h.za(e),NA(t),AA(t)}oe.pb=function(t){t?(this.l.info("Successfully pinged google.com"),wn(2)):(this.l.info("Failed to ping google.com"),wn(1))};function NA(t){if(t.H=0,t.ma=[],t.h){let e=_A(t.i);(e.length!=0||t.j.length!=0)&&(TI(t.ma,e),TI(t.ma,t.j),t.i.i.length=0,t_(t.j),t.j.length=0),t.h.ya()}}function OA(t,e,n){var i=n instanceof fo?xr(n):new fo(n);if(i.g!="")e&&(i.g=e+"."+i.g),Lh(i,i.m);else{var r=Le.location;i=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var s=new fo(null);i&&Oh(s,i),e&&(s.g=e),r&&Lh(s,r),n&&(s.l=n),i=s}return n=t.F,e=t.Da,n&&e&&St(i,n,e),St(i,"VER",t.ra),Ku(t,i),i}function LA(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new Rt(new qu({ob:n})):new Rt(t.va),e.Oa(t.J),e}oe.isActive=function(){return!!this.h&&this.h.isActive(this)};function kA(){}oe=kA.prototype;oe.Ba=function(){};oe.Aa=function(){};oe.za=function(){};oe.ya=function(){};oe.isActive=function(){return!0};oe.Va=function(){};function Fh(){if(Da&&!(10<=Number(IB)))throw Error("Environmental error: no available transport.")}Fh.prototype.g=function(t,e){return new zn(t,e)};function zn(t,e){Kt.call(this),this.g=new IA(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Nu(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Nu(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Pa(this)}Yt(zn,Kt);zn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;wn(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=OA(t,null,t.Y),ef(t)};zn.prototype.close=function(){v_(this.g)};zn.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=c_(t),t=n);e.j.push(new ZB(e.fb++,t)),e.H==3&&ef(e)};zn.prototype.N=function(){this.g.h=null,delete this.j,v_(this.g),delete this.g,zn.$.N.call(this)};function FA(t){f_.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Yt(FA,f_);function UA(){p_.call(this),this.status=1}Yt(UA,p_);function Pa(t){this.g=t}Yt(Pa,kA);Pa.prototype.Ba=function(){on(this.g,"a")};Pa.prototype.Aa=function(t){on(this.g,new FA(t))};Pa.prototype.za=function(t){on(this.g,new UA)};Pa.prototype.ya=function(){on(this.g,"b")};function l3(){this.blockSize=-1}function yi(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Yt(yi,l3);yi.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Fv(t,e,n){n||(n=0);var i=Array(16);if(typeof e=="string")for(var r=0;16>r;++r)i[r]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],r=t.g[2];var s=t.g[3],o=e+(s^n&(r^s))+i[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(r^e&(n^r))+i[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=r+(n^s&(e^n))+i[2]+606105819&4294967295,r=s+(o<<17&4294967295|o>>>15),o=n+(e^r&(s^e))+i[3]+3250441966&4294967295,n=r+(o<<22&4294967295|o>>>10),o=e+(s^n&(r^s))+i[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(r^e&(n^r))+i[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=r+(n^s&(e^n))+i[6]+2821735955&4294967295,r=s+(o<<17&4294967295|o>>>15),o=n+(e^r&(s^e))+i[7]+4249261313&4294967295,n=r+(o<<22&4294967295|o>>>10),o=e+(s^n&(r^s))+i[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(r^e&(n^r))+i[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=r+(n^s&(e^n))+i[10]+4294925233&4294967295,r=s+(o<<17&4294967295|o>>>15),o=n+(e^r&(s^e))+i[11]+2304563134&4294967295,n=r+(o<<22&4294967295|o>>>10),o=e+(s^n&(r^s))+i[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(r^e&(n^r))+i[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=r+(n^s&(e^n))+i[14]+2792965006&4294967295,r=s+(o<<17&4294967295|o>>>15),o=n+(e^r&(s^e))+i[15]+1236535329&4294967295,n=r+(o<<22&4294967295|o>>>10),o=e+(r^s&(n^r))+i[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^r&(e^n))+i[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=r+(e^n&(s^e))+i[11]+643717713&4294967295,r=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(r^s))+i[0]+3921069994&4294967295,n=r+(o<<20&4294967295|o>>>12),o=e+(r^s&(n^r))+i[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^r&(e^n))+i[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=r+(e^n&(s^e))+i[15]+3634488961&4294967295,r=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(r^s))+i[4]+3889429448&4294967295,n=r+(o<<20&4294967295|o>>>12),o=e+(r^s&(n^r))+i[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^r&(e^n))+i[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=r+(e^n&(s^e))+i[3]+4107603335&4294967295,r=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(r^s))+i[8]+1163531501&4294967295,n=r+(o<<20&4294967295|o>>>12),o=e+(r^s&(n^r))+i[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^r&(e^n))+i[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=r+(e^n&(s^e))+i[7]+1735328473&4294967295,r=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(r^s))+i[12]+2368359562&4294967295,n=r+(o<<20&4294967295|o>>>12),o=e+(n^r^s)+i[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^r)+i[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=r+(s^e^n)+i[11]+1839030562&4294967295,r=s+(o<<16&4294967295|o>>>16),o=n+(r^s^e)+i[14]+4259657740&4294967295,n=r+(o<<23&4294967295|o>>>9),o=e+(n^r^s)+i[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^r)+i[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=r+(s^e^n)+i[7]+4139469664&4294967295,r=s+(o<<16&4294967295|o>>>16),o=n+(r^s^e)+i[10]+3200236656&4294967295,n=r+(o<<23&4294967295|o>>>9),o=e+(n^r^s)+i[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^r)+i[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=r+(s^e^n)+i[3]+3572445317&4294967295,r=s+(o<<16&4294967295|o>>>16),o=n+(r^s^e)+i[6]+76029189&4294967295,n=r+(o<<23&4294967295|o>>>9),o=e+(n^r^s)+i[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^r)+i[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=r+(s^e^n)+i[15]+530742520&4294967295,r=s+(o<<16&4294967295|o>>>16),o=n+(r^s^e)+i[2]+3299628645&4294967295,n=r+(o<<23&4294967295|o>>>9),o=e+(r^(n|~s))+i[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~r))+i[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=r+(e^(s|~n))+i[14]+2878612391&4294967295,r=s+(o<<15&4294967295|o>>>17),o=n+(s^(r|~e))+i[5]+4237533241&4294967295,n=r+(o<<21&4294967295|o>>>11),o=e+(r^(n|~s))+i[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~r))+i[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=r+(e^(s|~n))+i[10]+4293915773&4294967295,r=s+(o<<15&4294967295|o>>>17),o=n+(s^(r|~e))+i[1]+2240044497&4294967295,n=r+(o<<21&4294967295|o>>>11),o=e+(r^(n|~s))+i[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~r))+i[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=r+(e^(s|~n))+i[6]+2734768916&4294967295,r=s+(o<<15&4294967295|o>>>17),o=n+(s^(r|~e))+i[13]+1309151649&4294967295,n=r+(o<<21&4294967295|o>>>11),o=e+(r^(n|~s))+i[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~r))+i[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=r+(e^(s|~n))+i[2]+718787259&4294967295,r=s+(o<<15&4294967295|o>>>17),o=n+(s^(r|~e))+i[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+r&4294967295,t.g[3]=t.g[3]+s&4294967295}yi.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,i=this.m,r=this.h,s=0;s<e;){if(r==0)for(;s<=n;)Fv(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(i[r++]=t.charCodeAt(s++),r==this.blockSize){Fv(this,i),r=0;break}}else for(;s<e;)if(i[r++]=t[s++],r==this.blockSize){Fv(this,i),r=0;break}}this.h=r,this.i+=e};yi.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var i=0;32>i;i+=8)t[n++]=this.g[e]>>>i&255;return t};function mt(t,e){this.h=e;for(var n=[],i=!0,r=t.length-1;0<=r;r--){var s=t[r]|0;i&&s==e||(n[r]=s,i=!1)}this.g=n}var d3={};function E_(t){return-128<=t&&128>t?xB(t,function(e){return new mt([e|0],0>e?-1:0)}):new mt([t|0],0>t?-1:0)}function Ki(t){if(isNaN(t)||!isFinite(t))return Ca;if(0>t)return sn(Ki(-t));for(var e=[],n=1,i=0;t>=n;i++)e[i]=t/n|0,n*=Zv;return new mt(e,0)}function VA(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return sn(VA(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Ki(Math.pow(e,8)),i=Ca,r=0;r<t.length;r+=8){var s=Math.min(8,t.length-r),o=parseInt(t.substring(r,r+s),e);8>s?(s=Ki(Math.pow(e,s)),i=i.R(s).add(Ki(o))):(i=i.R(n),i=i.add(Ki(o)))}return i}var Zv=4294967296,Ca=E_(0),Jv=E_(1),LI=E_(16777216);oe=mt.prototype;oe.ea=function(){if(ni(this))return-sn(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var i=this.D(n);t+=(0<=i?i:Zv+i)*e,e*=Zv}return t};oe.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(br(this))return"0";if(ni(this))return"-"+sn(this).toString(t);for(var e=Ki(Math.pow(t,6)),n=this,i="";;){var r=Vh(n,e).g;n=Uh(n,r.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=r,br(n))return s+i;for(;6>s.length;)s="0"+s;i=s+i}};oe.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function br(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function ni(t){return t.h==-1}oe.X=function(t){return t=Uh(this,t),ni(t)?-1:br(t)?0:1};function sn(t){for(var e=t.g.length,n=[],i=0;i<e;i++)n[i]=~t.g[i];return new mt(n,~t.h).add(Jv)}oe.abs=function(){return ni(this)?sn(this):this};oe.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0,r=0;r<=e;r++){var s=i+(this.D(r)&65535)+(t.D(r)&65535),o=(s>>>16)+(this.D(r)>>>16)+(t.D(r)>>>16);i=o>>>16,s&=65535,o&=65535,n[r]=o<<16|s}return new mt(n,n[n.length-1]&-2147483648?-1:0)};function Uh(t,e){return t.add(sn(e))}oe.R=function(t){if(br(this)||br(t))return Ca;if(ni(this))return ni(t)?sn(this).R(sn(t)):sn(sn(this).R(t));if(ni(t))return sn(this.R(sn(t)));if(0>this.X(LI)&&0>t.X(LI))return Ki(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],i=0;i<2*e;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<t.g.length;r++){var s=this.D(i)>>>16,o=this.D(i)&65535,a=t.D(r)>>>16,c=t.D(r)&65535;n[2*i+2*r]+=o*c,Nh(n,2*i+2*r),n[2*i+2*r+1]+=s*c,Nh(n,2*i+2*r+1),n[2*i+2*r+1]+=o*a,Nh(n,2*i+2*r+1),n[2*i+2*r+2]+=s*a,Nh(n,2*i+2*r+2)}for(i=0;i<e;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=e;i<2*e;i++)n[i]=0;return new mt(n,0)};function Nh(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Cu(t,e){this.g=t,this.h=e}function Vh(t,e){if(br(e))throw Error("division by zero");if(br(t))return new Cu(Ca,Ca);if(ni(t))return e=Vh(sn(t),e),new Cu(sn(e.g),sn(e.h));if(ni(e))return e=Vh(t,sn(e)),new Cu(sn(e.g),e.h);if(30<t.g.length){if(ni(t)||ni(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Jv,i=e;0>=i.X(t);)n=kI(n),i=kI(i);var r=Aa(n,1),s=Aa(i,1);for(i=Aa(i,2),n=Aa(n,2);!br(i);){var o=s.add(i);0>=o.X(t)&&(r=r.add(n),s=o),i=Aa(i,1),n=Aa(n,1)}return e=Uh(t,r.R(e)),new Cu(r,e)}for(r=Ca;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),i=Math.ceil(Math.log(n)/Math.LN2),i=48>=i?1:Math.pow(2,i-48),s=Ki(n),o=s.R(e);ni(o)||0<o.X(t);)n-=i,s=Ki(n),o=s.R(e);br(s)&&(s=Jv),r=r.add(s),t=Uh(t,o)}return new Cu(r,t)}oe.gb=function(t){return Vh(this,t).h};oe.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)&t.D(i);return new mt(n,this.h&t.h)};oe.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)|t.D(i);return new mt(n,this.h|t.h)};oe.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],i=0;i<e;i++)n[i]=this.D(i)^t.D(i);return new mt(n,this.h^t.h)};function kI(t){for(var e=t.g.length+1,n=[],i=0;i<e;i++)n[i]=t.D(i)<<1|t.D(i-1)>>>31;return new mt(n,t.h)}function Aa(t,e){var n=e>>5;e%=32;for(var i=t.g.length-n,r=[],s=0;s<i;s++)r[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new mt(r,t.h)}Fh.prototype.createWebChannel=Fh.prototype.g;zn.prototype.send=zn.prototype.u;zn.prototype.open=zn.prototype.m;zn.prototype.close=zn.prototype.close;qh.NO_ERROR=0;qh.TIMEOUT=8;qh.HTTP_ERROR=6;nA.COMPLETE="complete";iA.EventType=Wu;Wu.OPEN="a";Wu.CLOSE="b";Wu.ERROR="c";Wu.MESSAGE="d";Kt.prototype.listen=Kt.prototype.O;Rt.prototype.listenOnce=Rt.prototype.P;Rt.prototype.getLastError=Rt.prototype.Sa;Rt.prototype.getLastErrorCode=Rt.prototype.Ia;Rt.prototype.getStatus=Rt.prototype.da;Rt.prototype.getResponseJson=Rt.prototype.Wa;Rt.prototype.getResponseText=Rt.prototype.ja;Rt.prototype.send=Rt.prototype.ha;Rt.prototype.setWithCredentials=Rt.prototype.Oa;yi.prototype.digest=yi.prototype.l;yi.prototype.reset=yi.prototype.reset;yi.prototype.update=yi.prototype.j;mt.prototype.add=mt.prototype.add;mt.prototype.multiply=mt.prototype.R;mt.prototype.modulo=mt.prototype.gb;mt.prototype.compare=mt.prototype.X;mt.prototype.toNumber=mt.prototype.ea;mt.prototype.toString=mt.prototype.toString;mt.prototype.getBits=mt.prototype.D;mt.fromNumber=Ki;mt.fromString=VA;var h3=vi.createWebChannelTransport=function(){return new Fh},f3=vi.getStatEventTarget=function(){return $h()},p3=vi.ErrorCode=qh,m3=vi.EventType=nA,g3=vi.Event=po,y3=vi.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},GQ=vi.FetchXmlHttpFactory=qu,v3=vi.WebChannel=iA,_3=vi.XhrIo=Rt,w3=vi.Md5=yi,BA=vi.Integer=mt;var zA="@firebase/firestore";var Qt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Qt.UNAUTHENTICATED=new Qt(null),Qt.GOOGLE_CREDENTIALS=new Qt("google-credentials-uid"),Qt.FIRST_PARTY=new Qt("first-party-uid"),Qt.MOCK_USER=new Qt("mock-user");var Yu="10.8.0";var Oa=new rs("@firebase/firestore");function Hn(t,...e){if(Oa.logLevel<=ut.DEBUG){let n=e.map(G_);Oa.debug(`Firestore (${Yu}): ${t}`,...n)}}function H_(t,...e){if(Oa.logLevel<=ut.ERROR){let n=e.map(G_);Oa.error(`Firestore (${Yu}): ${t}`,...n)}}function E3(t,...e){if(Oa.logLevel<=ut.WARN){let n=e.map(G_);Oa.warn(`Firestore (${Yu}): ${t}`,...n)}}function G_(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function Dn(t="Unexpected state"){let e=`FIRESTORE (${Yu}) INTERNAL ASSERTION FAILED: `+t;throw H_(e),new Error(e)}function x_(t,e){t||Dn()}var an={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Gt=class extends _n{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var fs=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var tf=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},S_=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Qt.UNAUTHENTICATED))}shutdown(){}},T_=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},I_=class{constructor(e){this.t=e,this.currentUser=Qt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let i=this.i,r=c=>this.i!==i?(i=this.i,n(c)):Promise.resolve(),s=new fs;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new fs,e.enqueueRetryable(()=>r(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>U(this,null,function*(){yield c.promise,yield r(this.currentUser)}))},a=c=>{Hn("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(Hn("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new fs)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(i=>this.i!==e?(Hn("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(x_(typeof i.accessToken=="string"),new tf(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return x_(e===null||typeof e=="string"),new Qt(e)}},A_=class{constructor(e,n,i){this.l=e,this.h=n,this.P=i,this.type="FirstParty",this.user=Qt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},M_=class{constructor(e,n,i){this.l=e,this.h=n,this.P=i}getToken(){return Promise.resolve(new A_(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Qt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},C_=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},D_=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let i=s=>{s.error!=null&&Hn("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,Hn("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};let r=s=>{Hn("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?r(s):Hn("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(x_(typeof n.token=="string"),this.R=n.token,new C_(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function b3(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}var R_=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,i="";for(;i.length<20;){let r=b3(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<n&&(i+=e.charAt(r[s]%e.length))}return i}};function jA(t,e){return t<e?-1:t>e?1:0}var P_=class t{constructor(e,n,i){n===void 0?n=0:n>e.length&&Dn(),i===void 0?i=e.length-n:i>e.length-n&&Dn(),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(i=>{n.push(i)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let i=Math.min(e.length,n.length);for(let r=0;r<i;r++){let s=e.get(r),o=n.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},hs=class t extends P_{construct(e,n,i){return new t(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let i of e){if(i.indexOf("//")>=0)throw new Gt(an.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter(r=>r.length>0))}return new t(n)}static emptyPath(){return new t([])}};var mo=class t{constructor(e){this.path=e}static fromPath(e){return new t(hs.fromString(e))}static fromName(e){return new t(hs.fromString(e).popFirst(5))}static empty(){return new t(hs.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&hs.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return hs.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new hs(e.slice()))}};var N_=class{constructor(e,n,i,r){this.indexId=e,this.collectionGroup=n,this.fields=i,this.indexState=r}};N_.UNKNOWN_ID=-1;function $A(t){return t.name==="IndexedDbTransactionError"}function x3(t){return t===0&&1/t==-1/0}var S3=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],eZ=[...S3,"documentOverlays"],T3=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],I3=T3,tZ=[...I3,"indexConfiguration","indexState","indexEntries"];var La=class t{constructor(e,n){this.comparator=e,this.root=n||Qi.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Qi.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Qi.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let i=this.comparator(e,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(e){let n=0,i=this.root;for(;!i.isEmpty();){let r=this.comparator(e,i.key);if(r===0)return n+i.left.size;r<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,i)=>(e(n,i),!1))}toString(){let e=[];return this.inorderTraversal((n,i)=>(e.push(`${n}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Na(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Na(this.root,e,this.comparator,!1)}getReverseIterator(){return new Na(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Na(this.root,e,this.comparator,!0)}},Na=class{constructor(e,n,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?i(e.key,n):1,n&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Qi=class t{constructor(e,n,i,r,s){this.key=e,this.value=n,this.color=i??t.RED,this.left=r??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,i,r,s){return new t(e??this.key,n??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let r=this,s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,n,i),null):s===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let i,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return t.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Dn();let e=this.left.check();if(e!==this.right.check())throw Dn();return e+(this.isRed()?0:1)}};Qi.EMPTY=null,Qi.RED=!0,Qi.BLACK=!1;Qi.EMPTY=new class{constructor(){this.size=0}get key(){throw Dn()}get value(){throw Dn()}get color(){throw Dn()}get left(){throw Dn()}get right(){throw Dn()}copy(e,n,i,r,s){return this}insert(e,n,i){return new Qi(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var nf=class t{constructor(e){this.comparator=e,this.data=new La(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,i)=>(e(n),!1))}forEachInRange(e,n){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new rf(this.data.getIterator())}getIteratorFrom(e){return new rf(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(i=>{n=n.add(i)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),i=e.data.getIterator();for(;n.hasNext();){let r=n.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},rf=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var O_=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var ka=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new O_("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let i=new Uint8Array(n.length);for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return jA(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};ka.EMPTY_BYTE_STRING=new ka("");var iZ=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function HA(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function A3(t){return typeof t=="string"?ka.fromBase64String(t):ka.fromUint8Array(t)}var L_=class{constructor(e,n,i,r,s,o,a,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}},k_=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};function M3(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var rZ=new La(mo.comparator);var sZ=new La(mo.comparator);var oZ=new La(mo.comparator),aZ=new nf(mo.comparator);var cZ=new nf(jA);var GA,at;(at=GA||(GA={}))[at.OK=0]="OK",at[at.CANCELLED=1]="CANCELLED",at[at.UNKNOWN=2]="UNKNOWN",at[at.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",at[at.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",at[at.NOT_FOUND=5]="NOT_FOUND",at[at.ALREADY_EXISTS=6]="ALREADY_EXISTS",at[at.PERMISSION_DENIED=7]="PERMISSION_DENIED",at[at.UNAUTHENTICATED=16]="UNAUTHENTICATED",at[at.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",at[at.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",at[at.ABORTED=10]="ABORTED",at[at.OUT_OF_RANGE=11]="OUT_OF_RANGE",at[at.UNIMPLEMENTED=12]="UNIMPLEMENTED",at[at.INTERNAL=13]="INTERNAL",at[at.UNAVAILABLE=14]="UNAVAILABLE",at[at.DATA_LOSS=15]="DATA_LOSS";var uZ=new BA([4294967295,4294967295],0);var sf=class{constructor(){}Pt(e,n){this.It(e,n),n.Tt()}It(e,n){if("nullValue"in e)this.Et(n,5);else if("booleanValue"in e)this.Et(n,10),n.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(n,15),n.dt(HA(e.integerValue));else if("doubleValue"in e){let i=HA(e.doubleValue);isNaN(i)?this.Et(n,13):(this.Et(n,15),x3(i)?n.dt(0):n.dt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Et(n,20),typeof i=="string"?n.At(i):(n.At(`${i.seconds||""}`),n.dt(i.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,n),this.Vt(n);else if("bytesValue"in e)this.Et(n,30),n.ft(A3(e.bytesValue)),this.Vt(n);else if("referenceValue"in e)this.gt(e.referenceValue,n);else if("geoPointValue"in e){let i=e.geoPointValue;this.Et(n,45),n.dt(i.latitude||0),n.dt(i.longitude||0)}else"mapValue"in e?M3(e)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,n),this.Vt(n)):"arrayValue"in e?(this.wt(e.arrayValue,n),this.Vt(n)):Dn()}Rt(e,n){this.Et(n,25),this.St(e,n)}St(e,n){n.At(e)}yt(e,n){let i=e.fields||{};this.Et(n,55);for(let r of Object.keys(i))this.Rt(r,n),this.It(i[r],n)}wt(e,n){let i=e.values||[];this.Et(n,50);for(let r of i)this.It(r,n)}gt(e,n){this.Et(n,37),mo.fromName(e).path.forEach(i=>{this.Et(n,60),this.St(i,n)})}Et(e,n){e.dt(n)}Vt(e){e.dt(2)}};sf.bt=new sf;var lZ=new Uint8Array(0);var Yi=class t{constructor(e,n,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};Yi.DEFAULT_COLLECTION_PERCENTILE=10,Yi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Yi.DEFAULT=new Yi(41943040,Yi.DEFAULT_COLLECTION_PERCENTILE,Yi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Yi.DISABLED=new Yi(-1,0,0);function b_(){return typeof document<"u"?document:null}var F_=class{constructor(e,n,i=1e3,r=1.5,s=6e4){this.oi=e,this.timerId=n,this.Mo=i,this.xo=r,this.Oo=s,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();let n=Math.floor(this.No+this.Qo()),i=Math.max(0,Date.now()-this.Lo),r=Math.max(0,n-i);r>0&&Hn("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.No} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,r,()=>(this.Lo=Date.now(),e())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){this.Bo!==null&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){this.Bo!==null&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}};var U_=class t{constructor(e,n,i,r,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new fs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,i,r,s){let o=Date.now()+i,a=new t(e,n,o,r,s);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Gt(an.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function C3(t,e){if(H_("AsyncQueue",`${e}: ${t}`),$A(t))return new Gt(an.UNAVAILABLE,`${e}: ${t}`);throw t}var V_=class{constructor(e,n,i,r){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=r,this.user=Qt.UNAUTHENTICATED,this.clientId=R_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,s=>U(this,null,function*(){Hn("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(i,s=>(Hn("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Gt(an.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new fs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>U(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let i=C3(n,"Failed to shutdown persistence");e.reject(i)}})),e.promise}};function qA(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var WA=new Map;function D3(t,e,n,i){if(e===!0&&i===!0)throw new Gt(an.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function R3(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(i){return i.constructor?i.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Dn()}function P3(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Gt(an.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=R3(t);throw new Gt(an.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}var of=class{constructor(e){var n,i;if(e.host===void 0){if(e.ssl!==void 0)throw new Gt(an.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Gt(an.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}D3("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=qA((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Gt(an.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Gt(an.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Gt(an.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},af=class{constructor(e,n,i,r){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new of({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Gt(an.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new Gt(an.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new of(e),e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new S_;switch(i.type){case"firstParty":return new M_(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Gt(an.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let i=WA.get(n);i&&(Hn("ComponentProvider","Removing Datastore"),WA.delete(n),i.terminate())}(this),Promise.resolve()}};function XA(t,e,n,i={}){var r;let s=(t=P3(t,af))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&E3("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let a,c;if(typeof i.mockUserToken=="string")a=i.mockUserToken,c=Qt.MOCK_USER;else{a=eh(i.mockUserToken,(r=t._app)===null||r===void 0?void 0:r.options.projectId);let u=i.mockUserToken.sub||i.mockUserToken.user_id;if(!u)throw new Gt(an.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Qt(u)}t._authCredentials=new T_(new tf(a,c))}}var B_=class{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new F_(this,"async_queue_retry"),this._u=()=>{let n=b_();n&&Hn("AsyncQueue","Visibility state changed to "+n.visibilityState),this.jo.Ko()};let e=b_();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.au(),this.uu(e)}enterRestrictedMode(e){if(!this.tu){this.tu=!0,this.su=e||!1;let n=b_();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._u)}}enqueue(e){if(this.au(),this.tu)return new Promise(()=>{});let n=new fs;return this.uu(()=>this.tu&&this.su?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.eu.push(e),this.cu()))}cu(){return U(this,null,function*(){if(this.eu.length!==0){try{yield this.eu[0](),this.eu.shift(),this.jo.reset()}catch(e){if(!$A(e))throw e;Hn("AsyncQueue","Operation failed with retryable error: "+e)}this.eu.length>0&&this.jo.qo(()=>this.cu())}})}uu(e){let n=this.Xa.then(()=>(this.iu=!0,e().catch(i=>{this.ru=i,this.iu=!1;let r=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(i);throw H_("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.iu=!1,i))));return this.Xa=n,n}enqueueAfterDelay(e,n,i){this.au(),this.ou.indexOf(e)>-1&&(n=0);let r=U_.createAndSchedule(this,e,n,i,s=>this.lu(s));return this.nu.push(r),r}au(){this.ru&&Dn()}verifyOperationInProgress(){}hu(){return U(this,null,function*(){let e;do e=this.Xa,yield e;while(e!==this.Xa)})}Pu(e){for(let n of this.nu)if(n.timerId===e)return!0;return!1}Iu(e){return this.hu().then(()=>{this.nu.sort((n,i)=>n.targetTimeMs-i.targetTimeMs);for(let n of this.nu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.hu()})}Tu(e){this.ou.push(e)}lu(e){let n=this.nu.indexOf(e);this.nu.splice(n,1)}};var z_=class extends af{constructor(e,n,i,r){super(e,n,i,r),this.type="firestore",this._queue=function(){return new B_}(),this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||N3(this),this._firestoreClient.terminate()}};function KA(t,e){let n=typeof t=="object"?t:os(),i=typeof t=="string"?t:e||"(default)",r=io(n,"firestore").getImmediate({identifier:i});if(!r._initialized){let s=Jd("firestore");s&&XA(r,...s)}return r}function N3(t){var e,n,i;let r=t._freezeSettings(),s=function(a,c,u,l){return new L_(a,c,u,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,qA(l.experimentalLongPollingOptions),l.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,r);t._firestoreClient=new V_(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=r.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}var dZ=new RegExp("[~\\*/\\[\\]]");(function(e,n=!0){(function(r){Yu=r})(ji),Wi(new Cn("firestore",(i,{instanceIdentifier:r,options:s})=>{let o=i.getProvider("app").getImmediate(),a=new z_(new I_(i.getProvider("auth-internal")),new D_(i.getProvider("app-check-internal")),function(u,l){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Gt(an.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new k_(u.options.projectId,l)}(o,r),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Dt(zA,"4.4.2",e),Dt(zA,"4.4.2","esm2017")})();var Qu=class{constructor(e){return e}},YA="firestore",W_=class{constructor(){return wu(YA)}};var j_=new $e("angularfire2.firestore-instances");function O3(t,e){let n=sh(YA,t,e);return n&&new Qu(n)}function L3(t){return(e,n)=>{let i=e.runOutsideAngular(()=>t(n));return new Qu(i)}}var k3={provide:W_,deps:[[new Mn,j_]]},F3={provide:Qu,useFactory:O3,deps:[[new Mn,j_],_r]},U3=(()=>{class t{constructor(){Dt("angularfire",so.full,"fst")}static \u0275fac=function(i){return new(i||t)};static \u0275mod=Fi({type:t});static \u0275inj=ki({providers:[F3,k3]})}return t})();function QA(t,...e){return{ngModule:U3,providers:[{provide:j_,useFactory:L3(t),multi:!0,deps:[yt,mi,Sa,oo,[new Mn,Au],[new Mn,xa],...e]}]}}var ZA=Ta(KA,!0);var JA={production:!1,firebaseConfig:{apiKey:"AIzaSyCMu1LSE3pmBz2BgUFNMoC5sUJon1peWdI",authDomain:"webcam-recorder-d5ef6.firebaseapp.com",projectId:"webcam-recorder-d5ef6",storageBucket:"webcam-recorder-d5ef6.appspot.com",messagingSenderId:"1010665342769",appId:"1:1010665342769:web:33321adc131a10711ad210"}},eM={providers:[hT(fT),Hc(FT(()=>UT({projectId:"webcam-recorder-d5ef6",appId:"1:1010665342769:web:33321adc131a10711ad210",storageBucket:"webcam-recorder-d5ef6.appspot.com",apiKey:"AIzaSyCMu1LSE3pmBz2BgUFNMoC5sUJon1peWdI",authDomain:"webcam-recorder-d5ef6.firebaseapp.com",messagingSenderId:"1010665342769"}))),Hc(xI(()=>SI())),Hc(QA(()=>ZA()))]};var tw="161";var V3=0,tM=1,B3=2;var MC=1,z3=2,Cr=3,Ss=0,Pn=1,Rr=2,Es=0,rc=1,nM=2,iM=3,rM=4,H3=5,Eo=100,G3=101,W3=102,sM=103,oM=104,j3=200,$3=201,q3=202,X3=203,E0=204,b0=205,K3=206,Y3=207,Q3=208,Z3=209,J3=210,ez=211,tz=212,nz=213,iz=214,rz=0,sz=1,oz=2,Pf=3,az=4,cz=5,uz=6,lz=7,CC=0,dz=1,hz=2,bs=0,fz=1,pz=2,mz=3,gz=4,yz=5,vz=6;var aM=300,cc=301,uc=302,x0=303,S0=304,ip=306,T0=1e3,bi=1001,I0=1002,xn=1003,cM=1004;var Zu=1005;var Rn=1006,$_=1007;var xo=1008;var xs=1009,_z=1010,wz=1011,nw=1012,DC=1013,ws=1014,Pr=1015,ol=1016,RC=1017,PC=1018,So=1020,Ez=1021,xi=1023,bz=1024,xz=1025,To=1026,lc=1027,Sz=1028,NC=1029,Tz=1030,OC=1031,LC=1033,q_=33776,X_=33777,K_=33778,Y_=33779,uM=35840,lM=35841,dM=35842,hM=35843,kC=36196,fM=37492,pM=37496,mM=37808,gM=37809,yM=37810,vM=37811,_M=37812,wM=37813,EM=37814,bM=37815,xM=37816,SM=37817,TM=37818,IM=37819,AM=37820,MM=37821,Q_=36492,CM=36494,DM=36495,Iz=36283,RM=36284,PM=36285,NM=36286;var Nf=2300,Of=2301,Z_=2302,OM=2400,LM=2401,kM=2402;var FC=3e3,Io=3001,Az=3200,Mz=3201,Cz=0,Dz=1,ri="",cn="srgb",Or="srgb-linear",iw="display-p3",rp="display-p3-linear",Lf="linear",Tt="srgb",kf="rec709",Ff="p3";var Fa=7680;var FM=519,Rz=512,Pz=513,Nz=514,UC=515,Oz=516,Lz=517,kz=518,Fz=519,UM=35044;var VM="300 es",A0=1035,Nr=2e3,Uf=2001,Ts=class{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});let i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;let i=this._listeners;return i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;let r=this._listeners[e];if(r!==void 0){let s=r.indexOf(n);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let i=this._listeners[e.type];if(i!==void 0){e.target=this;let r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}},gn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],BM=1234567,il=Math.PI/180,al=180/Math.PI;function pc(){let t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(gn[t&255]+gn[t>>8&255]+gn[t>>16&255]+gn[t>>24&255]+"-"+gn[e&255]+gn[e>>8&255]+"-"+gn[e>>16&15|64]+gn[e>>24&255]+"-"+gn[n&63|128]+gn[n>>8&255]+"-"+gn[n>>16&255]+gn[n>>24&255]+gn[i&255]+gn[i>>8&255]+gn[i>>16&255]+gn[i>>24&255]).toLowerCase()}function Sn(t,e,n){return Math.max(e,Math.min(n,t))}function rw(t,e){return(t%e+e)%e}function Uz(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)}function Vz(t,e,n){return t!==e?(n-t)/(e-t):0}function rl(t,e,n){return(1-n)*t+n*e}function Bz(t,e,n,i){return rl(t,e,1-Math.exp(-n*i))}function zz(t,e=1){return e-Math.abs(rw(t,e*2)-e)}function Hz(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function Gz(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))}function Wz(t,e){return t+Math.floor(Math.random()*(e-t+1))}function jz(t,e){return t+Math.random()*(e-t)}function $z(t){return t*(.5-Math.random())}function qz(t){t!==void 0&&(BM=t);let e=BM+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Xz(t){return t*il}function Kz(t){return t*al}function M0(t){return(t&t-1)===0&&t!==0}function Yz(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function Vf(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function Qz(t,e,n,i,r){let s=Math.cos,o=Math.sin,a=s(n/2),c=o(n/2),u=s((e+i)/2),l=o((e+i)/2),d=s((e-i)/2),h=o((e-i)/2),p=s((i-e)/2),g=o((i-e)/2);switch(r){case"XYX":t.set(a*l,c*d,c*h,a*u);break;case"YZY":t.set(c*h,a*l,c*d,a*u);break;case"ZXZ":t.set(c*d,c*h,a*l,a*u);break;case"XZX":t.set(a*l,c*g,c*p,a*u);break;case"YXY":t.set(c*p,a*l,c*g,a*u);break;case"ZYZ":t.set(c*g,c*p,a*l,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Ja(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function En(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}var sp={DEG2RAD:il,RAD2DEG:al,generateUUID:pc,clamp:Sn,euclideanModulo:rw,mapLinear:Uz,inverseLerp:Vz,lerp:rl,damp:Bz,pingpong:zz,smoothstep:Hz,smootherstep:Gz,randInt:Wz,randFloat:jz,randFloatSpread:$z,seededRandom:qz,degToRad:Xz,radToDeg:Kz,isPowerOfTwo:M0,ceilPowerOfTwo:Yz,floorPowerOfTwo:Vf,setQuaternionFromProperEuler:Qz,normalize:En,denormalize:Ja},ht=class t{constructor(e=0,n=0){t.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let n=this.x,i=this.y,r=e.elements;return this.x=r[0]*n+r[3]*i+r[6],this.y=r[1]*n+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;let i=this.dot(e)/n;return Math.acos(Sn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){let i=Math.cos(n),r=Math.sin(n),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Ze=class t{constructor(e,n,i,r,s,o,a,c,u){t.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,i,r,s,o,a,c,u)}set(e,n,i,r,s,o,a,c,u){let l=this.elements;return l[0]=e,l[1]=r,l[2]=a,l[3]=n,l[4]=s,l[5]=c,l[6]=i,l[7]=o,l[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){let i=e.elements,r=n.elements,s=this.elements,o=i[0],a=i[3],c=i[6],u=i[1],l=i[4],d=i[7],h=i[2],p=i[5],g=i[8],y=r[0],m=r[3],f=r[6],b=r[1],_=r[4],v=r[7],x=r[2],A=r[5],I=r[8];return s[0]=o*y+a*b+c*x,s[3]=o*m+a*_+c*A,s[6]=o*f+a*v+c*I,s[1]=u*y+l*b+d*x,s[4]=u*m+l*_+d*A,s[7]=u*f+l*v+d*I,s[2]=h*y+p*b+g*x,s[5]=h*m+p*_+g*A,s[8]=h*f+p*v+g*I,this}multiplyScalar(e){let n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){let e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],u=e[7],l=e[8];return n*o*l-n*a*u-i*s*l+i*a*c+r*s*u-r*o*c}invert(){let e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],u=e[7],l=e[8],d=l*o-a*u,h=a*c-l*s,p=u*s-o*c,g=n*d+i*h+r*p;if(g===0)return this.set(0,0,0,0,0,0,0,0,0);let y=1/g;return e[0]=d*y,e[1]=(r*u-l*i)*y,e[2]=(a*i-r*o)*y,e[3]=h*y,e[4]=(l*n-r*c)*y,e[5]=(r*s-a*n)*y,e[6]=p*y,e[7]=(i*c-u*n)*y,e[8]=(o*n-i*s)*y,this}transpose(){let e,n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,r,s,o,a){let c=Math.cos(s),u=Math.sin(s);return this.set(i*c,i*u,-i*(c*o+u*a)+o+e,-r*u,r*c,-r*(-u*o+c*a)+a+n,0,0,1),this}scale(e,n){return this.premultiply(J_.makeScale(e,n)),this}rotate(e){return this.premultiply(J_.makeRotation(-e)),this}translate(e,n){return this.premultiply(J_.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){let n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){let n=this.elements,i=e.elements;for(let r=0;r<9;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){let i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}},J_=new Ze;function VC(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}function Bf(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function Zz(){let t=Bf("canvas");return t.style.display="block",t}var zM={};function sc(t){t in zM||(zM[t]=!0,console.warn(t))}var HM=new Ze().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),GM=new Ze().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),cf={[Or]:{transfer:Lf,primaries:kf,toReference:t=>t,fromReference:t=>t},[cn]:{transfer:Tt,primaries:kf,toReference:t=>t.convertSRGBToLinear(),fromReference:t=>t.convertLinearToSRGB()},[rp]:{transfer:Lf,primaries:Ff,toReference:t=>t.applyMatrix3(GM),fromReference:t=>t.applyMatrix3(HM)},[iw]:{transfer:Tt,primaries:Ff,toReference:t=>t.convertSRGBToLinear().applyMatrix3(GM),fromReference:t=>t.applyMatrix3(HM).convertLinearToSRGB()}},Jz=new Set([Or,rp]),vt={enabled:!0,_workingColorSpace:Or,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(t){if(!Jz.has(t))throw new Error(`Unsupported working color space, "${t}".`);this._workingColorSpace=t},convert:function(t,e,n){if(this.enabled===!1||e===n||!e||!n)return t;let i=cf[e].toReference,r=cf[n].fromReference;return r(i(t))},fromWorkingColorSpace:function(t,e){return this.convert(t,this._workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this._workingColorSpace)},getPrimaries:function(t){return cf[t].primaries},getTransfer:function(t){return t===ri?Lf:cf[t].transfer}};function oc(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function e0(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}var Ua,zf=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{Ua===void 0&&(Ua=Bf("canvas")),Ua.width=e.width,Ua.height=e.height;let i=Ua.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),n=Ua}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let n=Bf("canvas");n.width=e.width,n.height=e.height;let i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);let r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=oc(s[o]/255)*255;return i.putImageData(r,0,0),n}else if(e.data){let n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(oc(n[i]/255)*255):n[i]=oc(n[i]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},eH=0,Hf=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:eH++}),this.uuid=pc(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(t0(r[o].image)):s.push(t0(r[o]))}else s=t0(r);i.url=s}return n||(e.images[this.uuid]=i),i}};function t0(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?zf.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var tH=0,Ro=(()=>{class t extends Ts{constructor(n=t.DEFAULT_IMAGE,i=t.DEFAULT_MAPPING,r=bi,s=bi,o=Rn,a=xo,c=xi,u=xs,l=t.DEFAULT_ANISOTROPY,d=ri){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:tH++}),this.uuid=pc(),this.name="",this.source=new Hf(n),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=l,this.format=c,this.internalFormat=null,this.type=u,this.offset=new ht(0,0),this.repeat=new ht(1,1),this.center=new ht(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ze,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof d=="string"?this.colorSpace=d:(sc("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=d===Io?cn:ri),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(n=null){this.source.data=n}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(n){return this.name=n.name,this.source=n.source,this.mipmaps=n.mipmaps.slice(0),this.mapping=n.mapping,this.channel=n.channel,this.wrapS=n.wrapS,this.wrapT=n.wrapT,this.magFilter=n.magFilter,this.minFilter=n.minFilter,this.anisotropy=n.anisotropy,this.format=n.format,this.internalFormat=n.internalFormat,this.type=n.type,this.offset.copy(n.offset),this.repeat.copy(n.repeat),this.center.copy(n.center),this.rotation=n.rotation,this.matrixAutoUpdate=n.matrixAutoUpdate,this.matrix.copy(n.matrix),this.generateMipmaps=n.generateMipmaps,this.premultiplyAlpha=n.premultiplyAlpha,this.flipY=n.flipY,this.unpackAlignment=n.unpackAlignment,this.colorSpace=n.colorSpace,this.userData=JSON.parse(JSON.stringify(n.userData)),this.needsUpdate=!0,this}toJSON(n){let i=n===void 0||typeof n=="string";if(!i&&n.textures[this.uuid]!==void 0)return n.textures[this.uuid];let r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(n).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(n.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(n){if(this.mapping!==aM)return n;if(n.applyMatrix3(this.matrix),n.x<0||n.x>1)switch(this.wrapS){case T0:n.x=n.x-Math.floor(n.x);break;case bi:n.x=n.x<0?0:1;break;case I0:Math.abs(Math.floor(n.x)%2)===1?n.x=Math.ceil(n.x)-n.x:n.x=n.x-Math.floor(n.x);break}if(n.y<0||n.y>1)switch(this.wrapT){case T0:n.y=n.y-Math.floor(n.y);break;case bi:n.y=n.y<0?0:1;break;case I0:Math.abs(Math.floor(n.y)%2)===1?n.y=Math.ceil(n.y)-n.y:n.y=n.y-Math.floor(n.y);break}return this.flipY&&(n.y=1-n.y),n}set needsUpdate(n){n===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return sc("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===cn?Io:FC}set encoding(n){sc("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=n===Io?cn:ri}}return t.DEFAULT_IMAGE=null,t.DEFAULT_MAPPING=aM,t.DEFAULT_ANISOTROPY=1,t})(),un=class t{constructor(e=0,n=0,i=0,r=1){t.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let n=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*n+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*n+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*n+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*n+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,r,s,c=e.elements,u=c[0],l=c[4],d=c[8],h=c[1],p=c[5],g=c[9],y=c[2],m=c[6],f=c[10];if(Math.abs(l-h)<.01&&Math.abs(d-y)<.01&&Math.abs(g-m)<.01){if(Math.abs(l+h)<.1&&Math.abs(d+y)<.1&&Math.abs(g+m)<.1&&Math.abs(u+p+f-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;let _=(u+1)/2,v=(p+1)/2,x=(f+1)/2,A=(l+h)/4,I=(d+y)/4,V=(g+m)/4;return _>v&&_>x?_<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(_),r=A/i,s=I/i):v>x?v<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(v),i=A/r,s=V/r):x<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(x),i=I/s,r=V/s),this.set(i,r,s,n),this}let b=Math.sqrt((m-g)*(m-g)+(d-y)*(d-y)+(h-l)*(h-l));return Math.abs(b)<.001&&(b=1),this.x=(m-g)/b,this.y=(d-y)/b,this.z=(h-l)/b,this.w=Math.acos((u+p+f-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this}clampLength(e,n){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},C0=class extends Ts{constructor(e=1,n=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=1,this.scissor=new un(0,0,e,n),this.scissorTest=!1,this.viewport=new un(0,0,e,n);let r={width:e,height:n,depth:1};i.encoding!==void 0&&(sc("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===Io?cn:ri),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Rn,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new Ro(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,n,i=1){(this.width!==e||this.height!==n||this.depth!==i)&&(this.width=e,this.height=n,this.depth=i,this.texture.image.width=e,this.texture.image.height=n,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;let n=Object.assign({},e.texture.image);return this.texture.source=new Hf(n),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},Lr=class extends C0{constructor(e=1,n=1,i={}){super(e,n,i),this.isWebGLRenderTarget=!0}},Gf=class extends Ro{constructor(e=null,n=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=xn,this.minFilter=xn,this.wrapR=bi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};var D0=class extends Ro{constructor(e=null,n=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=xn,this.minFilter=xn,this.wrapR=bi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};var Is=class{constructor(e=0,n=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=r}static slerpFlat(e,n,i,r,s,o,a){let c=i[r+0],u=i[r+1],l=i[r+2],d=i[r+3],h=s[o+0],p=s[o+1],g=s[o+2],y=s[o+3];if(a===0){e[n+0]=c,e[n+1]=u,e[n+2]=l,e[n+3]=d;return}if(a===1){e[n+0]=h,e[n+1]=p,e[n+2]=g,e[n+3]=y;return}if(d!==y||c!==h||u!==p||l!==g){let m=1-a,f=c*h+u*p+l*g+d*y,b=f>=0?1:-1,_=1-f*f;if(_>Number.EPSILON){let x=Math.sqrt(_),A=Math.atan2(x,f*b);m=Math.sin(m*A)/x,a=Math.sin(a*A)/x}let v=a*b;if(c=c*m+h*v,u=u*m+p*v,l=l*m+g*v,d=d*m+y*v,m===1-a){let x=1/Math.sqrt(c*c+u*u+l*l+d*d);c*=x,u*=x,l*=x,d*=x}}e[n]=c,e[n+1]=u,e[n+2]=l,e[n+3]=d}static multiplyQuaternionsFlat(e,n,i,r,s,o){let a=i[r],c=i[r+1],u=i[r+2],l=i[r+3],d=s[o],h=s[o+1],p=s[o+2],g=s[o+3];return e[n]=a*g+l*d+c*p-u*h,e[n+1]=c*g+l*h+u*d-a*p,e[n+2]=u*g+l*p+a*h-c*d,e[n+3]=l*g-a*d-c*h-u*p,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,r){return this._x=e,this._y=n,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){let i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,c=Math.sin,u=a(i/2),l=a(r/2),d=a(s/2),h=c(i/2),p=c(r/2),g=c(s/2);switch(o){case"XYZ":this._x=h*l*d+u*p*g,this._y=u*p*d-h*l*g,this._z=u*l*g+h*p*d,this._w=u*l*d-h*p*g;break;case"YXZ":this._x=h*l*d+u*p*g,this._y=u*p*d-h*l*g,this._z=u*l*g-h*p*d,this._w=u*l*d+h*p*g;break;case"ZXY":this._x=h*l*d-u*p*g,this._y=u*p*d+h*l*g,this._z=u*l*g+h*p*d,this._w=u*l*d-h*p*g;break;case"ZYX":this._x=h*l*d-u*p*g,this._y=u*p*d+h*l*g,this._z=u*l*g-h*p*d,this._w=u*l*d+h*p*g;break;case"YZX":this._x=h*l*d+u*p*g,this._y=u*p*d+h*l*g,this._z=u*l*g-h*p*d,this._w=u*l*d-h*p*g;break;case"XZY":this._x=h*l*d-u*p*g,this._y=u*p*d-h*l*g,this._z=u*l*g+h*p*d,this._w=u*l*d+h*p*g;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){let i=n/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){let n=e.elements,i=n[0],r=n[4],s=n[8],o=n[1],a=n[5],c=n[9],u=n[2],l=n[6],d=n[10],h=i+a+d;if(h>0){let p=.5/Math.sqrt(h+1);this._w=.25/p,this._x=(l-c)*p,this._y=(s-u)*p,this._z=(o-r)*p}else if(i>a&&i>d){let p=2*Math.sqrt(1+i-a-d);this._w=(l-c)/p,this._x=.25*p,this._y=(r+o)/p,this._z=(s+u)/p}else if(a>d){let p=2*Math.sqrt(1+a-i-d);this._w=(s-u)/p,this._x=(r+o)/p,this._y=.25*p,this._z=(c+l)/p}else{let p=2*Math.sqrt(1+d-i-a);this._w=(o-r)/p,this._x=(s+u)/p,this._y=(c+l)/p,this._z=.25*p}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Sn(this.dot(e),-1,1)))}rotateTowards(e,n){let i=this.angleTo(e);if(i===0)return this;let r=Math.min(1,n/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){let i=e._x,r=e._y,s=e._z,o=e._w,a=n._x,c=n._y,u=n._z,l=n._w;return this._x=i*l+o*a+r*u-s*c,this._y=r*l+o*c+s*a-i*u,this._z=s*l+o*u+i*c-r*a,this._w=o*l-i*a-r*c-s*u,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);let i=this._x,r=this._y,s=this._z,o=this._w,a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;let c=1-a*a;if(c<=Number.EPSILON){let p=1-n;return this._w=p*o+n*this._w,this._x=p*i+n*this._x,this._y=p*r+n*this._y,this._z=p*s+n*this._z,this.normalize(),this}let u=Math.sqrt(c),l=Math.atan2(u,a),d=Math.sin((1-n)*l)/u,h=Math.sin(n*l)/u;return this._w=o*d+this._w*h,this._x=i*d+this._x*h,this._y=r*d+this._y*h,this._z=s*d+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){let e=Math.random(),n=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(n*Math.cos(r),i*Math.sin(s),i*Math.cos(s),n*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},k=class t{constructor(e=0,n=0,i=0){t.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(WM.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(WM.setFromAxisAngle(e,n))}applyMatrix3(e){let n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[3]*i+s[6]*r,this.y=s[1]*n+s[4]*i+s[7]*r,this.z=s[2]*n+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let n=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*n+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*n+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*n+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*n+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){let n=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,c=e.w,u=2*(o*r-a*i),l=2*(a*n-s*r),d=2*(s*i-o*n);return this.x=n+c*u+o*d-a*l,this.y=i+c*l+a*u-s*d,this.z=r+c*d+s*l-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[4]*i+s[8]*r,this.y=s[1]*n+s[5]*i+s[9]*r,this.z=s[2]*n+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){let i=e.x,r=e.y,s=e.z,o=n.x,a=n.y,c=n.z;return this.x=r*c-s*a,this.y=s*o-i*c,this.z=i*a-r*o,this}projectOnVector(e){let n=e.lengthSq();if(n===0)return this.set(0,0,0);let i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return n0.copy(this).projectOnVector(e),this.sub(n0)}reflect(e){return this.sub(n0.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;let i=this.dot(e)/n;return Math.acos(Sn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let n=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return n*n+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){let r=Math.sin(n)*e;return this.x=r*Math.sin(i),this.y=Math.cos(n)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){let n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){let n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=r,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,n=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(n),this.y=i*Math.sin(n),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},n0=new k,WM=new Is,Ao=class{constructor(e=new k(1/0,1/0,1/0),n=new k(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=3)this.expandByPoint(_i.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,i=e.count;n<i;n++)this.expandByPoint(_i.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){let i=_i.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);let i=e.geometry;if(i!==void 0){let s=i.getAttribute("position");if(n===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,_i):_i.fromBufferAttribute(s,o),_i.applyMatrix4(e.matrixWorld),this.expandByPoint(_i);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),uf.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),uf.copy(i.boundingBox)),uf.applyMatrix4(e.matrixWorld),this.union(uf)}let r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],n);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,_i),_i.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Ju),lf.subVectors(this.max,Ju),Va.subVectors(e.a,Ju),Ba.subVectors(e.b,Ju),za.subVectors(e.c,Ju),ps.subVectors(Ba,Va),ms.subVectors(za,Ba),go.subVectors(Va,za);let n=[0,-ps.z,ps.y,0,-ms.z,ms.y,0,-go.z,go.y,ps.z,0,-ps.x,ms.z,0,-ms.x,go.z,0,-go.x,-ps.y,ps.x,0,-ms.y,ms.x,0,-go.y,go.x,0];return!i0(n,Va,Ba,za,lf)||(n=[1,0,0,0,1,0,0,0,1],!i0(n,Va,Ba,za,lf))?!1:(df.crossVectors(ps,ms),n=[df.x,df.y,df.z],i0(n,Va,Ba,za,lf))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,_i).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(_i).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Sr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Sr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Sr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Sr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Sr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Sr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Sr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Sr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Sr),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},Sr=[new k,new k,new k,new k,new k,new k,new k,new k],_i=new k,uf=new Ao,Va=new k,Ba=new k,za=new k,ps=new k,ms=new k,go=new k,Ju=new k,lf=new k,df=new k,yo=new k;function i0(t,e,n,i,r){for(let s=0,o=t.length-3;s<=o;s+=3){yo.fromArray(t,s);let a=r.x*Math.abs(yo.x)+r.y*Math.abs(yo.y)+r.z*Math.abs(yo.z),c=e.dot(yo),u=n.dot(yo),l=i.dot(yo);if(Math.max(-Math.max(c,u,l),Math.min(c,u,l))>a)return!1}return!0}var nH=new Ao,el=new k,r0=new k,dc=class{constructor(e=new k,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){let i=this.center;n!==void 0?i.copy(n):nH.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){let i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;el.subVectors(e,this.center);let n=el.lengthSq();if(n>this.radius*this.radius){let i=Math.sqrt(n),r=(i-this.radius)*.5;this.center.addScaledVector(el,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(r0.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(el.copy(e.center).add(r0)),this.expandByPoint(el.copy(e.center).sub(r0))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},Tr=new k,s0=new k,hf=new k,gs=new k,o0=new k,ff=new k,a0=new k,Wf=class{constructor(e=new k,n=new k(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Tr)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);let i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let n=Tr.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(Tr.copy(this.origin).addScaledVector(this.direction,n),Tr.distanceToSquared(e))}distanceSqToSegment(e,n,i,r){s0.copy(e).add(n).multiplyScalar(.5),hf.copy(n).sub(e).normalize(),gs.copy(this.origin).sub(s0);let s=e.distanceTo(n)*.5,o=-this.direction.dot(hf),a=gs.dot(this.direction),c=-gs.dot(hf),u=gs.lengthSq(),l=Math.abs(1-o*o),d,h,p,g;if(l>0)if(d=o*c-a,h=o*a-c,g=s*l,d>=0)if(h>=-g)if(h<=g){let y=1/l;d*=y,h*=y,p=d*(d+o*h+2*a)+h*(o*d+h+2*c)+u}else h=s,d=Math.max(0,-(o*h+a)),p=-d*d+h*(h+2*c)+u;else h=-s,d=Math.max(0,-(o*h+a)),p=-d*d+h*(h+2*c)+u;else h<=-g?(d=Math.max(0,-(-o*s+a)),h=d>0?-s:Math.min(Math.max(-s,-c),s),p=-d*d+h*(h+2*c)+u):h<=g?(d=0,h=Math.min(Math.max(-s,-c),s),p=h*(h+2*c)+u):(d=Math.max(0,-(o*s+a)),h=d>0?s:Math.min(Math.max(-s,-c),s),p=-d*d+h*(h+2*c)+u);else h=o>0?-s:s,d=Math.max(0,-(o*h+a)),p=-d*d+h*(h+2*c)+u;return i&&i.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(s0).addScaledVector(hf,h),p}intersectSphere(e,n){Tr.subVectors(e.center,this.origin);let i=Tr.dot(this.direction),r=Tr.dot(Tr)-i*i,s=e.radius*e.radius;if(r>s)return null;let o=Math.sqrt(s-r),a=i-o,c=i+o;return c<0?null:a<0?this.at(c,n):this.at(a,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;let i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){let i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){let n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,r,s,o,a,c,u=1/this.direction.x,l=1/this.direction.y,d=1/this.direction.z,h=this.origin;return u>=0?(i=(e.min.x-h.x)*u,r=(e.max.x-h.x)*u):(i=(e.max.x-h.x)*u,r=(e.min.x-h.x)*u),l>=0?(s=(e.min.y-h.y)*l,o=(e.max.y-h.y)*l):(s=(e.max.y-h.y)*l,o=(e.min.y-h.y)*l),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),d>=0?(a=(e.min.z-h.z)*d,c=(e.max.z-h.z)*d):(a=(e.max.z-h.z)*d,c=(e.min.z-h.z)*d),i>c||a>r)||((a>i||i!==i)&&(i=a),(c<r||r!==r)&&(r=c),r<0)?null:this.at(i>=0?i:r,n)}intersectsBox(e){return this.intersectBox(e,Tr)!==null}intersectTriangle(e,n,i,r,s){o0.subVectors(n,e),ff.subVectors(i,e),a0.crossVectors(o0,ff);let o=this.direction.dot(a0),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;gs.subVectors(this.origin,e);let c=a*this.direction.dot(ff.crossVectors(gs,ff));if(c<0)return null;let u=a*this.direction.dot(o0.cross(gs));if(u<0||c+u>o)return null;let l=-a*gs.dot(a0);return l<0?null:this.at(l/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},ln=class t{constructor(e,n,i,r,s,o,a,c,u,l,d,h,p,g,y,m){t.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,i,r,s,o,a,c,u,l,d,h,p,g,y,m)}set(e,n,i,r,s,o,a,c,u,l,d,h,p,g,y,m){let f=this.elements;return f[0]=e,f[4]=n,f[8]=i,f[12]=r,f[1]=s,f[5]=o,f[9]=a,f[13]=c,f[2]=u,f[6]=l,f[10]=d,f[14]=h,f[3]=p,f[7]=g,f[11]=y,f[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new t().fromArray(this.elements)}copy(e){let n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){let n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){let n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){let n=this.elements,i=e.elements,r=1/Ha.setFromMatrixColumn(e,0).length(),s=1/Ha.setFromMatrixColumn(e,1).length(),o=1/Ha.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[3]=0,n[4]=i[4]*s,n[5]=i[5]*s,n[6]=i[6]*s,n[7]=0,n[8]=i[8]*o,n[9]=i[9]*o,n[10]=i[10]*o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){let n=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),c=Math.cos(r),u=Math.sin(r),l=Math.cos(s),d=Math.sin(s);if(e.order==="XYZ"){let h=o*l,p=o*d,g=a*l,y=a*d;n[0]=c*l,n[4]=-c*d,n[8]=u,n[1]=p+g*u,n[5]=h-y*u,n[9]=-a*c,n[2]=y-h*u,n[6]=g+p*u,n[10]=o*c}else if(e.order==="YXZ"){let h=c*l,p=c*d,g=u*l,y=u*d;n[0]=h+y*a,n[4]=g*a-p,n[8]=o*u,n[1]=o*d,n[5]=o*l,n[9]=-a,n[2]=p*a-g,n[6]=y+h*a,n[10]=o*c}else if(e.order==="ZXY"){let h=c*l,p=c*d,g=u*l,y=u*d;n[0]=h-y*a,n[4]=-o*d,n[8]=g+p*a,n[1]=p+g*a,n[5]=o*l,n[9]=y-h*a,n[2]=-o*u,n[6]=a,n[10]=o*c}else if(e.order==="ZYX"){let h=o*l,p=o*d,g=a*l,y=a*d;n[0]=c*l,n[4]=g*u-p,n[8]=h*u+y,n[1]=c*d,n[5]=y*u+h,n[9]=p*u-g,n[2]=-u,n[6]=a*c,n[10]=o*c}else if(e.order==="YZX"){let h=o*c,p=o*u,g=a*c,y=a*u;n[0]=c*l,n[4]=y-h*d,n[8]=g*d+p,n[1]=d,n[5]=o*l,n[9]=-a*l,n[2]=-u*l,n[6]=p*d+g,n[10]=h-y*d}else if(e.order==="XZY"){let h=o*c,p=o*u,g=a*c,y=a*u;n[0]=c*l,n[4]=-d,n[8]=u*l,n[1]=h*d+y,n[5]=o*l,n[9]=p*d-g,n[2]=g*d-p,n[6]=a*l,n[10]=y*d+h}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(iH,e,rH)}lookAt(e,n,i){let r=this.elements;return Gn.subVectors(e,n),Gn.lengthSq()===0&&(Gn.z=1),Gn.normalize(),ys.crossVectors(i,Gn),ys.lengthSq()===0&&(Math.abs(i.z)===1?Gn.x+=1e-4:Gn.z+=1e-4,Gn.normalize(),ys.crossVectors(i,Gn)),ys.normalize(),pf.crossVectors(Gn,ys),r[0]=ys.x,r[4]=pf.x,r[8]=Gn.x,r[1]=ys.y,r[5]=pf.y,r[9]=Gn.y,r[2]=ys.z,r[6]=pf.z,r[10]=Gn.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){let i=e.elements,r=n.elements,s=this.elements,o=i[0],a=i[4],c=i[8],u=i[12],l=i[1],d=i[5],h=i[9],p=i[13],g=i[2],y=i[6],m=i[10],f=i[14],b=i[3],_=i[7],v=i[11],x=i[15],A=r[0],I=r[4],V=r[8],G=r[12],w=r[1],M=r[5],j=r[9],X=r[13],D=r[2],z=r[6],O=r[10],K=r[14],W=r[3],q=r[7],$=r[11],ee=r[15];return s[0]=o*A+a*w+c*D+u*W,s[4]=o*I+a*M+c*z+u*q,s[8]=o*V+a*j+c*O+u*$,s[12]=o*G+a*X+c*K+u*ee,s[1]=l*A+d*w+h*D+p*W,s[5]=l*I+d*M+h*z+p*q,s[9]=l*V+d*j+h*O+p*$,s[13]=l*G+d*X+h*K+p*ee,s[2]=g*A+y*w+m*D+f*W,s[6]=g*I+y*M+m*z+f*q,s[10]=g*V+y*j+m*O+f*$,s[14]=g*G+y*X+m*K+f*ee,s[3]=b*A+_*w+v*D+x*W,s[7]=b*I+_*M+v*z+x*q,s[11]=b*V+_*j+v*O+x*$,s[15]=b*G+_*X+v*K+x*ee,this}multiplyScalar(e){let n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){let e=this.elements,n=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],c=e[9],u=e[13],l=e[2],d=e[6],h=e[10],p=e[14],g=e[3],y=e[7],m=e[11],f=e[15];return g*(+s*c*d-r*u*d-s*a*h+i*u*h+r*a*p-i*c*p)+y*(+n*c*p-n*u*h+s*o*h-r*o*p+r*u*l-s*c*l)+m*(+n*u*d-n*a*p-s*o*d+i*o*p+s*a*l-i*u*l)+f*(-r*a*l-n*c*d+n*a*h+r*o*d-i*o*h+i*c*l)}transpose(){let e=this.elements,n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){let r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=n,r[14]=i),this}invert(){let e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],u=e[7],l=e[8],d=e[9],h=e[10],p=e[11],g=e[12],y=e[13],m=e[14],f=e[15],b=d*m*u-y*h*u+y*c*p-a*m*p-d*c*f+a*h*f,_=g*h*u-l*m*u-g*c*p+o*m*p+l*c*f-o*h*f,v=l*y*u-g*d*u+g*a*p-o*y*p-l*a*f+o*d*f,x=g*d*c-l*y*c-g*a*h+o*y*h+l*a*m-o*d*m,A=n*b+i*_+r*v+s*x;if(A===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let I=1/A;return e[0]=b*I,e[1]=(y*h*s-d*m*s-y*r*p+i*m*p+d*r*f-i*h*f)*I,e[2]=(a*m*s-y*c*s+y*r*u-i*m*u-a*r*f+i*c*f)*I,e[3]=(d*c*s-a*h*s-d*r*u+i*h*u+a*r*p-i*c*p)*I,e[4]=_*I,e[5]=(l*m*s-g*h*s+g*r*p-n*m*p-l*r*f+n*h*f)*I,e[6]=(g*c*s-o*m*s-g*r*u+n*m*u+o*r*f-n*c*f)*I,e[7]=(o*h*s-l*c*s+l*r*u-n*h*u-o*r*p+n*c*p)*I,e[8]=v*I,e[9]=(g*d*s-l*y*s-g*i*p+n*y*p+l*i*f-n*d*f)*I,e[10]=(o*y*s-g*a*s+g*i*u-n*y*u-o*i*f+n*a*f)*I,e[11]=(l*a*s-o*d*s-l*i*u+n*d*u+o*i*p-n*a*p)*I,e[12]=x*I,e[13]=(l*y*r-g*d*r+g*i*h-n*y*h-l*i*m+n*d*m)*I,e[14]=(g*a*r-o*y*r-g*i*c+n*y*c+o*i*m-n*a*m)*I,e[15]=(o*d*r-l*a*r+l*i*c-n*d*c-o*i*h+n*a*h)*I,this}scale(e){let n=this.elements,i=e.x,r=e.y,s=e.z;return n[0]*=i,n[4]*=r,n[8]*=s,n[1]*=i,n[5]*=r,n[9]*=s,n[2]*=i,n[6]*=r,n[10]*=s,n[3]*=i,n[7]*=r,n[11]*=s,this}getMaxScaleOnAxis(){let e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,r))}makeTranslation(e,n,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){let n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){let n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){let n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){let i=Math.cos(n),r=Math.sin(n),s=1-i,o=e.x,a=e.y,c=e.z,u=s*o,l=s*a;return this.set(u*o+i,u*a-r*c,u*c+r*a,0,u*a+r*c,l*a+i,l*c-r*o,0,u*c-r*a,l*c+r*o,s*c*c+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,n,r,1,0,0,0,0,1),this}compose(e,n,i){let r=this.elements,s=n._x,o=n._y,a=n._z,c=n._w,u=s+s,l=o+o,d=a+a,h=s*u,p=s*l,g=s*d,y=o*l,m=o*d,f=a*d,b=c*u,_=c*l,v=c*d,x=i.x,A=i.y,I=i.z;return r[0]=(1-(y+f))*x,r[1]=(p+v)*x,r[2]=(g-_)*x,r[3]=0,r[4]=(p-v)*A,r[5]=(1-(h+f))*A,r[6]=(m+b)*A,r[7]=0,r[8]=(g+_)*I,r[9]=(m-b)*I,r[10]=(1-(h+y))*I,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,n,i){let r=this.elements,s=Ha.set(r[0],r[1],r[2]).length(),o=Ha.set(r[4],r[5],r[6]).length(),a=Ha.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],wi.copy(this);let u=1/s,l=1/o,d=1/a;return wi.elements[0]*=u,wi.elements[1]*=u,wi.elements[2]*=u,wi.elements[4]*=l,wi.elements[5]*=l,wi.elements[6]*=l,wi.elements[8]*=d,wi.elements[9]*=d,wi.elements[10]*=d,n.setFromRotationMatrix(wi),i.x=s,i.y=o,i.z=a,this}makePerspective(e,n,i,r,s,o,a=Nr){let c=this.elements,u=2*s/(n-e),l=2*s/(i-r),d=(n+e)/(n-e),h=(i+r)/(i-r),p,g;if(a===Nr)p=-(o+s)/(o-s),g=-2*o*s/(o-s);else if(a===Uf)p=-o/(o-s),g=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return c[0]=u,c[4]=0,c[8]=d,c[12]=0,c[1]=0,c[5]=l,c[9]=h,c[13]=0,c[2]=0,c[6]=0,c[10]=p,c[14]=g,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,n,i,r,s,o,a=Nr){let c=this.elements,u=1/(n-e),l=1/(i-r),d=1/(o-s),h=(n+e)*u,p=(i+r)*l,g,y;if(a===Nr)g=(o+s)*d,y=-2*d;else if(a===Uf)g=s*d,y=-1*d;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return c[0]=2*u,c[4]=0,c[8]=0,c[12]=-h,c[1]=0,c[5]=2*l,c[9]=0,c[13]=-p,c[2]=0,c[6]=0,c[10]=y,c[14]=-g,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){let n=this.elements,i=e.elements;for(let r=0;r<16;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){let i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}},Ha=new k,wi=new ln,iH=new k(0,0,0),rH=new k(1,1,1),ys=new k,pf=new k,Gn=new k,jM=new ln,$M=new Is,sH=(()=>{class t{constructor(n=0,i=0,r=0,s=t.DEFAULT_ORDER){this.isEuler=!0,this._x=n,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(n){this._x=n,this._onChangeCallback()}get y(){return this._y}set y(n){this._y=n,this._onChangeCallback()}get z(){return this._z}set z(n){this._z=n,this._onChangeCallback()}get order(){return this._order}set order(n){this._order=n,this._onChangeCallback()}set(n,i,r,s=this._order){return this._x=n,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(n){return this._x=n._x,this._y=n._y,this._z=n._z,this._order=n._order,this._onChangeCallback(),this}setFromRotationMatrix(n,i=this._order,r=!0){let s=n.elements,o=s[0],a=s[4],c=s[8],u=s[1],l=s[5],d=s[9],h=s[2],p=s[6],g=s[10];switch(i){case"XYZ":this._y=Math.asin(Sn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,g),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(p,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Sn(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(c,g),this._z=Math.atan2(u,l)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(Sn(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-h,g),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(u,o));break;case"ZYX":this._y=Math.asin(-Sn(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(p,g),this._z=Math.atan2(u,o)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(Sn(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-d,l),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(c,g));break;case"XZY":this._z=Math.asin(-Sn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(p,l),this._y=Math.atan2(c,o)):(this._x=Math.atan2(-d,g),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,r===!0&&this._onChangeCallback(),this}setFromQuaternion(n,i,r){return jM.makeRotationFromQuaternion(n),this.setFromRotationMatrix(jM,i,r)}setFromVector3(n,i=this._order){return this.set(n.x,n.y,n.z,i)}reorder(n){return $M.setFromEuler(this),this.setFromQuaternion($M,n)}equals(n){return n._x===this._x&&n._y===this._y&&n._z===this._z&&n._order===this._order}fromArray(n){return this._x=n[0],this._y=n[1],this._z=n[2],n[3]!==void 0&&(this._order=n[3]),this._onChangeCallback(),this}toArray(n=[],i=0){return n[i]=this._x,n[i+1]=this._y,n[i+2]=this._z,n[i+3]=this._order,n}_onChange(n){return this._onChangeCallback=n,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return t.DEFAULT_ORDER="XYZ",t})(),jf=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},oH=0,qM=new k,Ga=new Is,Ir=new ln,mf=new k,tl=new k,aH=new k,cH=new Is,XM=new k(1,0,0),KM=new k(0,1,0),YM=new k(0,0,1),uH={type:"added"},lH={type:"removed"},Po=(()=>{class t extends Ts{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:oH++}),this.uuid=pc(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=t.DEFAULT_UP.clone();let n=new k,i=new sH,r=new Is,s=new k(1,1,1);function o(){r.setFromEuler(i,!1)}function a(){i.setFromQuaternion(r,void 0,!1)}i._onChange(o),r._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:n},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new ln},normalMatrix:{value:new Ze}}),this.matrix=new ln,this.matrixWorld=new ln,this.matrixAutoUpdate=t.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=t.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new jf,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(n){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(n),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(n){return this.quaternion.premultiply(n),this}setRotationFromAxisAngle(n,i){this.quaternion.setFromAxisAngle(n,i)}setRotationFromEuler(n){this.quaternion.setFromEuler(n,!0)}setRotationFromMatrix(n){this.quaternion.setFromRotationMatrix(n)}setRotationFromQuaternion(n){this.quaternion.copy(n)}rotateOnAxis(n,i){return Ga.setFromAxisAngle(n,i),this.quaternion.multiply(Ga),this}rotateOnWorldAxis(n,i){return Ga.setFromAxisAngle(n,i),this.quaternion.premultiply(Ga),this}rotateX(n){return this.rotateOnAxis(XM,n)}rotateY(n){return this.rotateOnAxis(KM,n)}rotateZ(n){return this.rotateOnAxis(YM,n)}translateOnAxis(n,i){return qM.copy(n).applyQuaternion(this.quaternion),this.position.add(qM.multiplyScalar(i)),this}translateX(n){return this.translateOnAxis(XM,n)}translateY(n){return this.translateOnAxis(KM,n)}translateZ(n){return this.translateOnAxis(YM,n)}localToWorld(n){return this.updateWorldMatrix(!0,!1),n.applyMatrix4(this.matrixWorld)}worldToLocal(n){return this.updateWorldMatrix(!0,!1),n.applyMatrix4(Ir.copy(this.matrixWorld).invert())}lookAt(n,i,r){n.isVector3?mf.copy(n):mf.set(n,i,r);let s=this.parent;this.updateWorldMatrix(!0,!1),tl.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ir.lookAt(tl,mf,this.up):Ir.lookAt(mf,tl,this.up),this.quaternion.setFromRotationMatrix(Ir),s&&(Ir.extractRotation(s.matrixWorld),Ga.setFromRotationMatrix(Ir),this.quaternion.premultiply(Ga.invert()))}add(n){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return n===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",n),this):(n&&n.isObject3D?(n.parent!==null&&n.parent.remove(n),n.parent=this,this.children.push(n),n.dispatchEvent(uH)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",n),this)}remove(n){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}let i=this.children.indexOf(n);return i!==-1&&(n.parent=null,this.children.splice(i,1),n.dispatchEvent(lH)),this}removeFromParent(){let n=this.parent;return n!==null&&n.remove(this),this}clear(){return this.remove(...this.children)}attach(n){return this.updateWorldMatrix(!0,!1),Ir.copy(this.matrixWorld).invert(),n.parent!==null&&(n.parent.updateWorldMatrix(!0,!1),Ir.multiply(n.parent.matrixWorld)),n.applyMatrix4(Ir),this.add(n),n.updateWorldMatrix(!1,!0),this}getObjectById(n){return this.getObjectByProperty("id",n)}getObjectByName(n){return this.getObjectByProperty("name",n)}getObjectByProperty(n,i){if(this[n]===i)return this;for(let r=0,s=this.children.length;r<s;r++){let a=this.children[r].getObjectByProperty(n,i);if(a!==void 0)return a}}getObjectsByProperty(n,i,r=[]){this[n]===i&&r.push(this);let s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].getObjectsByProperty(n,i,r);return r}getWorldPosition(n){return this.updateWorldMatrix(!0,!1),n.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(n){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(tl,n,aH),n}getWorldScale(n){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(tl,cH,n),n}getWorldDirection(n){this.updateWorldMatrix(!0,!1);let i=this.matrixWorld.elements;return n.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(n){n(this);let i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverse(n)}traverseVisible(n){if(this.visible===!1)return;n(this);let i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverseVisible(n)}traverseAncestors(n){let i=this.parent;i!==null&&(n(i),i.traverseAncestors(n))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(n){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||n)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,n=!0);let i=this.children;for(let r=0,s=i.length;r<s;r++){let o=i[r];(o.matrixWorldAutoUpdate===!0||n===!0)&&o.updateMatrixWorld(n)}}updateWorldMatrix(n,i){let r=this.parent;if(n===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){let s=this.children;for(let o=0,a=s.length;o<a;o++){let c=s[o];c.matrixWorldAutoUpdate===!0&&c.updateWorldMatrix(!1,!0)}}}toJSON(n){let i=n===void 0||typeof n=="string",r={};i&&(n={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.visibility=this._visibility,s.active=this._active,s.bounds=this._bounds.map(c=>({boxInitialized:c.boxInitialized,boxMin:c.box.min.toArray(),boxMax:c.box.max.toArray(),sphereInitialized:c.sphereInitialized,sphereRadius:c.sphere.radius,sphereCenter:c.sphere.center.toArray()})),s.maxGeometryCount=this._maxGeometryCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.geometryCount=this._geometryCount,s.matricesTexture=this._matricesTexture.toJSON(n),this.boundingSphere!==null&&(s.boundingSphere={center:s.boundingSphere.center.toArray(),radius:s.boundingSphere.radius}),this.boundingBox!==null&&(s.boundingBox={min:s.boundingBox.min.toArray(),max:s.boundingBox.max.toArray()}));function o(c,u){return c[u.uuid]===void 0&&(c[u.uuid]=u.toJSON(n)),u.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(n).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(n).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(n.geometries,this.geometry);let c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){let u=c.shapes;if(Array.isArray(u))for(let l=0,d=u.length;l<d;l++){let h=u[l];o(n.shapes,h)}else o(n.shapes,u)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(n.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let c=[];for(let u=0,l=this.material.length;u<l;u++)c.push(o(n.materials,this.material[u]));s.material=c}else s.material=o(n.materials,this.material);if(this.children.length>0){s.children=[];for(let c=0;c<this.children.length;c++)s.children.push(this.children[c].toJSON(n).object)}if(this.animations.length>0){s.animations=[];for(let c=0;c<this.animations.length;c++){let u=this.animations[c];s.animations.push(o(n.animations,u))}}if(i){let c=a(n.geometries),u=a(n.materials),l=a(n.textures),d=a(n.images),h=a(n.shapes),p=a(n.skeletons),g=a(n.animations),y=a(n.nodes);c.length>0&&(r.geometries=c),u.length>0&&(r.materials=u),l.length>0&&(r.textures=l),d.length>0&&(r.images=d),h.length>0&&(r.shapes=h),p.length>0&&(r.skeletons=p),g.length>0&&(r.animations=g),y.length>0&&(r.nodes=y)}return r.object=s,r;function a(c){let u=[];for(let l in c){let d=c[l];delete d.metadata,u.push(d)}return u}}clone(n){return new this.constructor().copy(this,n)}copy(n,i=!0){if(this.name=n.name,this.up.copy(n.up),this.position.copy(n.position),this.rotation.order=n.rotation.order,this.quaternion.copy(n.quaternion),this.scale.copy(n.scale),this.matrix.copy(n.matrix),this.matrixWorld.copy(n.matrixWorld),this.matrixAutoUpdate=n.matrixAutoUpdate,this.matrixWorldAutoUpdate=n.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=n.matrixWorldNeedsUpdate,this.layers.mask=n.layers.mask,this.visible=n.visible,this.castShadow=n.castShadow,this.receiveShadow=n.receiveShadow,this.frustumCulled=n.frustumCulled,this.renderOrder=n.renderOrder,this.animations=n.animations.slice(),this.userData=JSON.parse(JSON.stringify(n.userData)),i===!0)for(let r=0;r<n.children.length;r++){let s=n.children[r];this.add(s.clone())}return this}}return t.DEFAULT_UP=new k(0,1,0),t.DEFAULT_MATRIX_AUTO_UPDATE=!0,t.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,t})(),Ei=new k,Ar=new k,c0=new k,Mr=new k,Wa=new k,ja=new k,QM=new k,u0=new k,l0=new k,d0=new k,ec=class t{constructor(e=new k,n=new k,i=new k){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,r){r.subVectors(i,n),Ei.subVectors(e,n),r.cross(Ei);let s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,n,i,r,s){Ei.subVectors(r,n),Ar.subVectors(i,n),c0.subVectors(e,n);let o=Ei.dot(Ei),a=Ei.dot(Ar),c=Ei.dot(c0),u=Ar.dot(Ar),l=Ar.dot(c0),d=o*u-a*a;if(d===0)return s.set(0,0,0),null;let h=1/d,p=(u*c-a*l)*h,g=(o*l-a*c)*h;return s.set(1-p-g,g,p)}static containsPoint(e,n,i,r){return this.getBarycoord(e,n,i,r,Mr)===null?!1:Mr.x>=0&&Mr.y>=0&&Mr.x+Mr.y<=1}static getInterpolation(e,n,i,r,s,o,a,c){return this.getBarycoord(e,n,i,r,Mr)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(s,Mr.x),c.addScaledVector(o,Mr.y),c.addScaledVector(a,Mr.z),c)}static isFrontFacing(e,n,i,r){return Ei.subVectors(i,n),Ar.subVectors(e,n),Ei.cross(Ar).dot(r)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,r){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,n,i,r){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ei.subVectors(this.c,this.b),Ar.subVectors(this.a,this.b),Ei.cross(Ar).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return t.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return t.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,i,r,s){return t.getInterpolation(e,this.a,this.b,this.c,n,i,r,s)}containsPoint(e){return t.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return t.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){let i=this.a,r=this.b,s=this.c,o,a;Wa.subVectors(r,i),ja.subVectors(s,i),u0.subVectors(e,i);let c=Wa.dot(u0),u=ja.dot(u0);if(c<=0&&u<=0)return n.copy(i);l0.subVectors(e,r);let l=Wa.dot(l0),d=ja.dot(l0);if(l>=0&&d<=l)return n.copy(r);let h=c*d-l*u;if(h<=0&&c>=0&&l<=0)return o=c/(c-l),n.copy(i).addScaledVector(Wa,o);d0.subVectors(e,s);let p=Wa.dot(d0),g=ja.dot(d0);if(g>=0&&p<=g)return n.copy(s);let y=p*u-c*g;if(y<=0&&u>=0&&g<=0)return a=u/(u-g),n.copy(i).addScaledVector(ja,a);let m=l*g-p*d;if(m<=0&&d-l>=0&&p-g>=0)return QM.subVectors(s,r),a=(d-l)/(d-l+(p-g)),n.copy(r).addScaledVector(QM,a);let f=1/(m+y+h);return o=y*f,a=h*f,n.copy(i).addScaledVector(Wa,o).addScaledVector(ja,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},BC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},vs={h:0,s:0,l:0},gf={h:0,s:0,l:0};function h0(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}var lt=class{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,i)}set(e,n,i){if(n===void 0&&i===void 0){let r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,n,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=cn){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,vt.toWorkingColorSpace(this,n),this}setRGB(e,n,i,r=vt.workingColorSpace){return this.r=e,this.g=n,this.b=i,vt.toWorkingColorSpace(this,r),this}setHSL(e,n,i,r=vt.workingColorSpace){if(e=rw(e,1),n=Sn(n,0,1),i=Sn(i,0,1),n===0)this.r=this.g=this.b=i;else{let s=i<=.5?i*(1+n):i+n-i*n,o=2*i-s;this.r=h0(o,s,e+1/3),this.g=h0(o,s,e),this.b=h0(o,s,e-1/3)}return vt.toWorkingColorSpace(this,r),this}setStyle(e,n=cn){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s,o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,n);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,n);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){let s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,n);if(o===6)return this.setHex(parseInt(s,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=cn){let i=BC[e.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=oc(e.r),this.g=oc(e.g),this.b=oc(e.b),this}copyLinearToSRGB(e){return this.r=e0(e.r),this.g=e0(e.g),this.b=e0(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=cn){return vt.fromWorkingColorSpace(yn.copy(this),e),Math.round(Sn(yn.r*255,0,255))*65536+Math.round(Sn(yn.g*255,0,255))*256+Math.round(Sn(yn.b*255,0,255))}getHexString(e=cn){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=vt.workingColorSpace){vt.fromWorkingColorSpace(yn.copy(this),n);let i=yn.r,r=yn.g,s=yn.b,o=Math.max(i,r,s),a=Math.min(i,r,s),c,u,l=(a+o)/2;if(a===o)c=0,u=0;else{let d=o-a;switch(u=l<=.5?d/(o+a):d/(2-o-a),o){case i:c=(r-s)/d+(r<s?6:0);break;case r:c=(s-i)/d+2;break;case s:c=(i-r)/d+4;break}c/=6}return e.h=c,e.s=u,e.l=l,e}getRGB(e,n=vt.workingColorSpace){return vt.fromWorkingColorSpace(yn.copy(this),n),e.r=yn.r,e.g=yn.g,e.b=yn.b,e}getStyle(e=cn){vt.fromWorkingColorSpace(yn.copy(this),e);let n=yn.r,i=yn.g,r=yn.b;return e!==cn?`color(${e} ${n.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,n,i){return this.getHSL(vs),this.setHSL(vs.h+e,vs.s+n,vs.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(vs),e.getHSL(gf);let i=rl(vs.h,gf.h,n),r=rl(vs.s,gf.s,n),s=rl(vs.l,gf.l,n);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let n=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*n+s[3]*i+s[6]*r,this.g=s[1]*n+s[4]*i+s[7]*r,this.b=s[2]*n+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}},yn=new lt;lt.NAMES=BC;var dH=0,Mo=class extends Ts{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:dH++}),this.uuid=pc(),this.name="",this.type="Material",this.blending=rc,this.side=Ss,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=E0,this.blendDst=b0,this.blendEquation=Eo,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new lt(0,0,0),this.blendAlpha=0,this.depthFunc=Pf,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=FM,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Fa,this.stencilZFail=Fa,this.stencilZPass=Fa,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let n in e){let i=e[n];if(i===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}let r=this[n];if(r===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[n]=i}}toJSON(e){let n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});let i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==rc&&(i.blending=this.blending),this.side!==Ss&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==E0&&(i.blendSrc=this.blendSrc),this.blendDst!==b0&&(i.blendDst=this.blendDst),this.blendEquation!==Eo&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==Pf&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==FM&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Fa&&(i.stencilFail=this.stencilFail),this.stencilZFail!==Fa&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==Fa&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){let o=[];for(let a in s){let c=s[a];delete c.metadata,o.push(c)}return o}if(n){let s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let n=e.clippingPlanes,i=null;if(n!==null){let r=n.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=n[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},$f=class extends Mo{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new lt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=CC,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}};var Ut=new k,yf=new ht,si=class{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=UM,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Pr,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return sc("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=n.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)yf.fromBufferAttribute(this,n),yf.applyMatrix3(e),this.setXY(n,yf.x,yf.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)Ut.fromBufferAttribute(this,n),Ut.applyMatrix3(e),this.setXYZ(n,Ut.x,Ut.y,Ut.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)Ut.fromBufferAttribute(this,n),Ut.applyMatrix4(e),this.setXYZ(n,Ut.x,Ut.y,Ut.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)Ut.fromBufferAttribute(this,n),Ut.applyNormalMatrix(e),this.setXYZ(n,Ut.x,Ut.y,Ut.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)Ut.fromBufferAttribute(this,n),Ut.transformDirection(e),this.setXYZ(n,Ut.x,Ut.y,Ut.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let i=this.array[e*this.itemSize+n];return this.normalized&&(i=Ja(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=En(i,this.array)),this.array[e*this.itemSize+n]=i,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=Ja(n,this.array)),n}setX(e,n){return this.normalized&&(n=En(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=Ja(n,this.array)),n}setY(e,n){return this.normalized&&(n=En(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=Ja(n,this.array)),n}setZ(e,n){return this.normalized&&(n=En(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=Ja(n,this.array)),n}setW(e,n){return this.normalized&&(n=En(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=En(n,this.array),i=En(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=En(n,this.array),i=En(i,this.array),r=En(r,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=En(n,this.array),i=En(i,this.array),r=En(r,this.array),s=En(s,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==UM&&(e.usage=this.usage),e}};var qf=class extends si{constructor(e,n,i){super(new Uint16Array(e),n,i)}};var Xf=class extends si{constructor(e,n,i){super(new Uint32Array(e),n,i)}};var Ti=class extends si{constructor(e,n,i){super(new Float32Array(e),n,i)}};var hH=0,ii=new ln,f0=new Po,$a=new k,Wn=new Ao,nl=new Ao,Zt=new k,Ji=class t extends Ts{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:hH++}),this.uuid=pc(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(VC(e)?Xf:qf)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){let n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let s=new Ze().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}let r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return ii.makeRotationFromQuaternion(e),this.applyMatrix4(ii),this}rotateX(e){return ii.makeRotationX(e),this.applyMatrix4(ii),this}rotateY(e){return ii.makeRotationY(e),this.applyMatrix4(ii),this}rotateZ(e){return ii.makeRotationZ(e),this.applyMatrix4(ii),this}translate(e,n,i){return ii.makeTranslation(e,n,i),this.applyMatrix4(ii),this}scale(e,n,i){return ii.makeScale(e,n,i),this.applyMatrix4(ii),this}lookAt(e){return f0.lookAt(e),f0.updateMatrix(),this.applyMatrix4(f0.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter($a).negate(),this.translate($a.x,$a.y,$a.z),this}setFromPoints(e){let n=[];for(let i=0,r=e.length;i<r;i++){let s=e[i];n.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Ti(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ao);let e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new k(-1/0,-1/0,-1/0),new k(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,r=n.length;i<r;i++){let s=n[i];Wn.setFromBufferAttribute(s),this.morphTargetsRelative?(Zt.addVectors(this.boundingBox.min,Wn.min),this.boundingBox.expandByPoint(Zt),Zt.addVectors(this.boundingBox.max,Wn.max),this.boundingBox.expandByPoint(Zt)):(this.boundingBox.expandByPoint(Wn.min),this.boundingBox.expandByPoint(Wn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new dc);let e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new k,1/0);return}if(e){let i=this.boundingSphere.center;if(Wn.setFromBufferAttribute(e),n)for(let s=0,o=n.length;s<o;s++){let a=n[s];nl.setFromBufferAttribute(a),this.morphTargetsRelative?(Zt.addVectors(Wn.min,nl.min),Wn.expandByPoint(Zt),Zt.addVectors(Wn.max,nl.max),Wn.expandByPoint(Zt)):(Wn.expandByPoint(nl.min),Wn.expandByPoint(nl.max))}Wn.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)Zt.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Zt));if(n)for(let s=0,o=n.length;s<o;s++){let a=n[s],c=this.morphTargetsRelative;for(let u=0,l=a.count;u<l;u++)Zt.fromBufferAttribute(a,u),c&&($a.fromBufferAttribute(e,u),Zt.add($a)),r=Math.max(r,i.distanceToSquared(Zt))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let i=e.array,r=n.position.array,s=n.normal.array,o=n.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new si(new Float32Array(4*a),4));let c=this.getAttribute("tangent").array,u=[],l=[];for(let w=0;w<a;w++)u[w]=new k,l[w]=new k;let d=new k,h=new k,p=new k,g=new ht,y=new ht,m=new ht,f=new k,b=new k;function _(w,M,j){d.fromArray(r,w*3),h.fromArray(r,M*3),p.fromArray(r,j*3),g.fromArray(o,w*2),y.fromArray(o,M*2),m.fromArray(o,j*2),h.sub(d),p.sub(d),y.sub(g),m.sub(g);let X=1/(y.x*m.y-m.x*y.y);isFinite(X)&&(f.copy(h).multiplyScalar(m.y).addScaledVector(p,-y.y).multiplyScalar(X),b.copy(p).multiplyScalar(y.x).addScaledVector(h,-m.x).multiplyScalar(X),u[w].add(f),u[M].add(f),u[j].add(f),l[w].add(b),l[M].add(b),l[j].add(b))}let v=this.groups;v.length===0&&(v=[{start:0,count:i.length}]);for(let w=0,M=v.length;w<M;++w){let j=v[w],X=j.start,D=j.count;for(let z=X,O=X+D;z<O;z+=3)_(i[z+0],i[z+1],i[z+2])}let x=new k,A=new k,I=new k,V=new k;function G(w){I.fromArray(s,w*3),V.copy(I);let M=u[w];x.copy(M),x.sub(I.multiplyScalar(I.dot(M))).normalize(),A.crossVectors(V,M);let X=A.dot(l[w])<0?-1:1;c[w*4]=x.x,c[w*4+1]=x.y,c[w*4+2]=x.z,c[w*4+3]=X}for(let w=0,M=v.length;w<M;++w){let j=v[w],X=j.start,D=j.count;for(let z=X,O=X+D;z<O;z+=3)G(i[z+0]),G(i[z+1]),G(i[z+2])}}computeVertexNormals(){let e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new si(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let h=0,p=i.count;h<p;h++)i.setXYZ(h,0,0,0);let r=new k,s=new k,o=new k,a=new k,c=new k,u=new k,l=new k,d=new k;if(e)for(let h=0,p=e.count;h<p;h+=3){let g=e.getX(h+0),y=e.getX(h+1),m=e.getX(h+2);r.fromBufferAttribute(n,g),s.fromBufferAttribute(n,y),o.fromBufferAttribute(n,m),l.subVectors(o,s),d.subVectors(r,s),l.cross(d),a.fromBufferAttribute(i,g),c.fromBufferAttribute(i,y),u.fromBufferAttribute(i,m),a.add(l),c.add(l),u.add(l),i.setXYZ(g,a.x,a.y,a.z),i.setXYZ(y,c.x,c.y,c.z),i.setXYZ(m,u.x,u.y,u.z)}else for(let h=0,p=n.count;h<p;h+=3)r.fromBufferAttribute(n,h+0),s.fromBufferAttribute(n,h+1),o.fromBufferAttribute(n,h+2),l.subVectors(o,s),d.subVectors(r,s),l.cross(d),i.setXYZ(h+0,l.x,l.y,l.z),i.setXYZ(h+1,l.x,l.y,l.z),i.setXYZ(h+2,l.x,l.y,l.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)Zt.fromBufferAttribute(e,n),Zt.normalize(),e.setXYZ(n,Zt.x,Zt.y,Zt.z)}toNonIndexed(){function e(a,c){let u=a.array,l=a.itemSize,d=a.normalized,h=new u.constructor(c.length*l),p=0,g=0;for(let y=0,m=c.length;y<m;y++){a.isInterleavedBufferAttribute?p=c[y]*a.data.stride+a.offset:p=c[y]*l;for(let f=0;f<l;f++)h[g++]=u[p++]}return new si(h,l,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let n=new t,i=this.index.array,r=this.attributes;for(let a in r){let c=r[a],u=e(c,i);n.setAttribute(a,u)}let s=this.morphAttributes;for(let a in s){let c=[],u=s[a];for(let l=0,d=u.length;l<d;l++){let h=u[l],p=e(h,i);c.push(p)}n.morphAttributes[a]=c}n.morphTargetsRelative=this.morphTargetsRelative;let o=this.groups;for(let a=0,c=o.length;a<c;a++){let u=o[a];n.addGroup(u.start,u.count,u.materialIndex)}return n}toJSON(){let e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let c=this.parameters;for(let u in c)c[u]!==void 0&&(e[u]=c[u]);return e}e.data={attributes:{}};let n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});let i=this.attributes;for(let c in i){let u=i[c];e.data.attributes[c]=u.toJSON(e.data)}let r={},s=!1;for(let c in this.morphAttributes){let u=this.morphAttributes[c],l=[];for(let d=0,h=u.length;d<h;d++){let p=u[d];l.push(p.toJSON(e.data))}l.length>0&&(r[c]=l,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);let o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));let a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let n={};this.name=e.name;let i=e.index;i!==null&&this.setIndex(i.clone(n));let r=e.attributes;for(let u in r){let l=r[u];this.setAttribute(u,l.clone(n))}let s=e.morphAttributes;for(let u in s){let l=[],d=s[u];for(let h=0,p=d.length;h<p;h++)l.push(d[h].clone(n));this.morphAttributes[u]=l}this.morphTargetsRelative=e.morphTargetsRelative;let o=e.groups;for(let u=0,l=o.length;u<l;u++){let d=o[u];this.addGroup(d.start,d.count,d.materialIndex)}let a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());let c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}},ZM=new ln,vo=new Wf,vf=new dc,JM=new k,qa=new k,Xa=new k,Ka=new k,p0=new k,_f=new k,wf=new ht,Ef=new ht,bf=new ht,eC=new k,tC=new k,nC=new k,xf=new k,Sf=new k,Si=class extends Po{constructor(e=new Ji,n=new $f){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){let r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){let a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,n){let i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;n.fromBufferAttribute(r,e);let a=this.morphTargetInfluences;if(s&&a){_f.set(0,0,0);for(let c=0,u=s.length;c<u;c++){let l=a[c],d=s[c];l!==0&&(p0.fromBufferAttribute(d,e),o?_f.addScaledVector(p0,l):_f.addScaledVector(p0.sub(n),l))}n.add(_f)}return n}raycast(e,n){let i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),vf.copy(i.boundingSphere),vf.applyMatrix4(s),vo.copy(e.ray).recast(e.near),!(vf.containsPoint(vo.origin)===!1&&(vo.intersectSphere(vf,JM)===null||vo.origin.distanceToSquared(JM)>(e.far-e.near)**2))&&(ZM.copy(s).invert(),vo.copy(e.ray).applyMatrix4(ZM),!(i.boundingBox!==null&&vo.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,n,vo)))}_computeIntersections(e,n,i){let r,s=this.geometry,o=this.material,a=s.index,c=s.attributes.position,u=s.attributes.uv,l=s.attributes.uv1,d=s.attributes.normal,h=s.groups,p=s.drawRange;if(a!==null)if(Array.isArray(o))for(let g=0,y=h.length;g<y;g++){let m=h[g],f=o[m.materialIndex],b=Math.max(m.start,p.start),_=Math.min(a.count,Math.min(m.start+m.count,p.start+p.count));for(let v=b,x=_;v<x;v+=3){let A=a.getX(v),I=a.getX(v+1),V=a.getX(v+2);r=Tf(this,f,e,i,u,l,d,A,I,V),r&&(r.faceIndex=Math.floor(v/3),r.face.materialIndex=m.materialIndex,n.push(r))}}else{let g=Math.max(0,p.start),y=Math.min(a.count,p.start+p.count);for(let m=g,f=y;m<f;m+=3){let b=a.getX(m),_=a.getX(m+1),v=a.getX(m+2);r=Tf(this,o,e,i,u,l,d,b,_,v),r&&(r.faceIndex=Math.floor(m/3),n.push(r))}}else if(c!==void 0)if(Array.isArray(o))for(let g=0,y=h.length;g<y;g++){let m=h[g],f=o[m.materialIndex],b=Math.max(m.start,p.start),_=Math.min(c.count,Math.min(m.start+m.count,p.start+p.count));for(let v=b,x=_;v<x;v+=3){let A=v,I=v+1,V=v+2;r=Tf(this,f,e,i,u,l,d,A,I,V),r&&(r.faceIndex=Math.floor(v/3),r.face.materialIndex=m.materialIndex,n.push(r))}}else{let g=Math.max(0,p.start),y=Math.min(c.count,p.start+p.count);for(let m=g,f=y;m<f;m+=3){let b=m,_=m+1,v=m+2;r=Tf(this,o,e,i,u,l,d,b,_,v),r&&(r.faceIndex=Math.floor(m/3),n.push(r))}}}};function fH(t,e,n,i,r,s,o,a){let c;if(e.side===Pn?c=i.intersectTriangle(o,s,r,!0,a):c=i.intersectTriangle(r,s,o,e.side===Ss,a),c===null)return null;Sf.copy(a),Sf.applyMatrix4(t.matrixWorld);let u=n.ray.origin.distanceTo(Sf);return u<n.near||u>n.far?null:{distance:u,point:Sf.clone(),object:t}}function Tf(t,e,n,i,r,s,o,a,c,u){t.getVertexPosition(a,qa),t.getVertexPosition(c,Xa),t.getVertexPosition(u,Ka);let l=fH(t,e,n,i,qa,Xa,Ka,xf);if(l){r&&(wf.fromBufferAttribute(r,a),Ef.fromBufferAttribute(r,c),bf.fromBufferAttribute(r,u),l.uv=ec.getInterpolation(xf,qa,Xa,Ka,wf,Ef,bf,new ht)),s&&(wf.fromBufferAttribute(s,a),Ef.fromBufferAttribute(s,c),bf.fromBufferAttribute(s,u),l.uv1=ec.getInterpolation(xf,qa,Xa,Ka,wf,Ef,bf,new ht),l.uv2=l.uv1),o&&(eC.fromBufferAttribute(o,a),tC.fromBufferAttribute(o,c),nC.fromBufferAttribute(o,u),l.normal=ec.getInterpolation(xf,qa,Xa,Ka,eC,tC,nC,new k),l.normal.dot(i.direction)>0&&l.normal.multiplyScalar(-1));let d={a,b:c,c:u,normal:new k,materialIndex:0};ec.getNormal(qa,Xa,Ka,d.normal),l.face=d}return l}var cl=class t extends Ji{constructor(e=1,n=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};let a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);let c=[],u=[],l=[],d=[],h=0,p=0;g("z","y","x",-1,-1,i,n,e,o,s,0),g("z","y","x",1,-1,i,n,-e,o,s,1),g("x","z","y",1,1,e,i,n,r,o,2),g("x","z","y",1,-1,e,i,-n,r,o,3),g("x","y","z",1,-1,e,n,i,r,s,4),g("x","y","z",-1,-1,e,n,-i,r,s,5),this.setIndex(c),this.setAttribute("position",new Ti(u,3)),this.setAttribute("normal",new Ti(l,3)),this.setAttribute("uv",new Ti(d,2));function g(y,m,f,b,_,v,x,A,I,V,G){let w=v/I,M=x/V,j=v/2,X=x/2,D=A/2,z=I+1,O=V+1,K=0,W=0,q=new k;for(let $=0;$<O;$++){let ee=$*M-X;for(let se=0;se<z;se++){let Me=se*w-j;q[y]=Me*b,q[m]=ee*_,q[f]=D,u.push(q.x,q.y,q.z),q[y]=0,q[m]=0,q[f]=A>0?1:-1,l.push(q.x,q.y,q.z),d.push(se/I),d.push(1-$/V),K+=1}}for(let $=0;$<V;$++)for(let ee=0;ee<I;ee++){let se=h+ee+z*$,Me=h+ee+z*($+1),H=h+(ee+1)+z*($+1),Q=h+(ee+1)+z*$;c.push(se,Me,Q),c.push(Me,H,Q),W+=6}a.addGroup(p,W,G),p+=W,h+=K}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new t(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function hc(t){let e={};for(let n in t){e[n]={};for(let i in t[n]){let r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][i]=null):e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function bn(t){let e={};for(let n=0;n<t.length;n++){let i=hc(t[n]);for(let r in i)e[r]=i[r]}return e}function pH(t){let e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function zC(t){return t.getRenderTarget()===null?t.outputColorSpace:vt.workingColorSpace}var mH={clone:hc,merge:bn},gH=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,yH=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,er=class extends Mo{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=gH,this.fragmentShader=yH,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=hc(e.uniforms),this.uniformsGroups=pH(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(let r in this.uniforms){let o=this.uniforms[r].value;o&&o.isTexture?n.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?n.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?n.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?n.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?n.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?n.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?n.uniforms[r]={type:"m4",value:o.toArray()}:n.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;let i={};for(let r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(n.extensions=i),n}},Kf=class extends Po{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ln,this.projectionMatrix=new ln,this.projectionMatrixInverse=new ln,this.coordinateSystem=Nr}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},_s=new k,iC=new ht,rC=new ht,Tn=class extends Kf{constructor(e=50,n=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let n=.5*this.getFilmHeight()/e;this.fov=al*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(il*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return al*2*Math.atan(Math.tan(il*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,i){_s.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(_s.x,_s.y).multiplyScalar(-e/_s.z),_s.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(_s.x,_s.y).multiplyScalar(-e/_s.z)}getViewSize(e,n){return this.getViewBounds(e,iC,rC),n.subVectors(rC,iC)}setViewOffset(e,n,i,r,s,o){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,n=e*Math.tan(il*.5*this.fov)/this.zoom,i=2*n,r=this.aspect*i,s=-.5*r,o=this.view;if(this.view!==null&&this.view.enabled){let c=o.fullWidth,u=o.fullHeight;s+=o.offsetX*r/c,n-=o.offsetY*i/u,r*=o.width/c,i*=o.height/u}let a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,n,n-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}},Ya=-90,Qa=1,R0=class extends Po{constructor(e,n,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;let r=new Tn(Ya,Qa,e,n);r.layers=this.layers,this.add(r);let s=new Tn(Ya,Qa,e,n);s.layers=this.layers,this.add(s);let o=new Tn(Ya,Qa,e,n);o.layers=this.layers,this.add(o);let a=new Tn(Ya,Qa,e,n);a.layers=this.layers,this.add(a);let c=new Tn(Ya,Qa,e,n);c.layers=this.layers,this.add(c);let u=new Tn(Ya,Qa,e,n);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){let e=this.coordinateSystem,n=this.children.concat(),[i,r,s,o,a,c]=n;for(let u of n)this.remove(u);if(e===Nr)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else if(e===Uf)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let u of n)this.add(u),u.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();let{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[s,o,a,c,u,l]=this.children,d=e.getRenderTarget(),h=e.getActiveCubeFace(),p=e.getActiveMipmapLevel(),g=e.xr.enabled;e.xr.enabled=!1;let y=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(n,s),e.setRenderTarget(i,1,r),e.render(n,o),e.setRenderTarget(i,2,r),e.render(n,a),e.setRenderTarget(i,3,r),e.render(n,c),e.setRenderTarget(i,4,r),e.render(n,u),i.texture.generateMipmaps=y,e.setRenderTarget(i,5,r),e.render(n,l),e.setRenderTarget(d,h,p),e.xr.enabled=g,i.texture.needsPMREMUpdate=!0}},Yf=class extends Ro{constructor(e,n,i,r,s,o,a,c,u,l){e=e!==void 0?e:[],n=n!==void 0?n:cc,super(e,n,i,r,s,o,a,c,u,l),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},P0=class extends Lr{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;let i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];n.encoding!==void 0&&(sc("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),n.colorSpace=n.encoding===Io?cn:ri),this.texture=new Yf(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:Rn}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;let i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new cl(5,5,5),s=new er({name:"CubemapFromEquirect",uniforms:hc(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Pn,blending:Es});s.uniforms.tEquirect.value=n;let o=new Si(r,s),a=n.minFilter;return n.minFilter===xo&&(n.minFilter=Rn),new R0(1,10,this).update(e,o),n.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,n,i,r){let s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(n,i,r);e.setRenderTarget(s)}},m0=new k,vH=new k,_H=new Ze,Dr=class{constructor(e=new k(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,r){return this.normal.set(e,n,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){let r=m0.subVectors(i,n).cross(vH.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){let i=e.delta(m0),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;let s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:n.copy(e.start).addScaledVector(i,s)}intersectsLine(e){let n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){let i=n||_H.getNormalMatrix(e),r=this.coplanarPoint(m0).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},_o=new dc,If=new k,Qf=class{constructor(e=new Dr,n=new Dr,i=new Dr,r=new Dr,s=new Dr,o=new Dr){this.planes=[e,n,i,r,s,o]}set(e,n,i,r,s,o){let a=this.planes;return a[0].copy(e),a[1].copy(n),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){let n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,n=Nr){let i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],c=r[3],u=r[4],l=r[5],d=r[6],h=r[7],p=r[8],g=r[9],y=r[10],m=r[11],f=r[12],b=r[13],_=r[14],v=r[15];if(i[0].setComponents(c-s,h-u,m-p,v-f).normalize(),i[1].setComponents(c+s,h+u,m+p,v+f).normalize(),i[2].setComponents(c+o,h+l,m+g,v+b).normalize(),i[3].setComponents(c-o,h-l,m-g,v-b).normalize(),i[4].setComponents(c-a,h-d,m-y,v-_).normalize(),n===Nr)i[5].setComponents(c+a,h+d,m+y,v+_).normalize();else if(n===Uf)i[5].setComponents(a,d,y,_).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),_o.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),_o.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(_o)}intersectsSprite(e){return _o.center.set(0,0,0),_o.radius=.7071067811865476,_o.applyMatrix4(e.matrixWorld),this.intersectsSphere(_o)}intersectsSphere(e){let n=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(n[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){let n=this.planes;for(let i=0;i<6;i++){let r=n[i];if(If.x=r.normal.x>0?e.max.x:e.min.x,If.y=r.normal.y>0?e.max.y:e.min.y,If.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(If)<0)return!1}return!0}containsPoint(e){let n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function HC(){let t=null,e=!1,n=null,i=null;function r(s,o){n(s,o),i=t.requestAnimationFrame(r)}return{start:function(){e!==!0&&n!==null&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){n=s},setContext:function(s){t=s}}}function wH(t,e){let n=e.isWebGL2,i=new WeakMap;function r(u,l){let d=u.array,h=u.usage,p=d.byteLength,g=t.createBuffer();t.bindBuffer(l,g),t.bufferData(l,d,h),u.onUploadCallback();let y;if(d instanceof Float32Array)y=t.FLOAT;else if(d instanceof Uint16Array)if(u.isFloat16BufferAttribute)if(n)y=t.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else y=t.UNSIGNED_SHORT;else if(d instanceof Int16Array)y=t.SHORT;else if(d instanceof Uint32Array)y=t.UNSIGNED_INT;else if(d instanceof Int32Array)y=t.INT;else if(d instanceof Int8Array)y=t.BYTE;else if(d instanceof Uint8Array)y=t.UNSIGNED_BYTE;else if(d instanceof Uint8ClampedArray)y=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);return{buffer:g,type:y,bytesPerElement:d.BYTES_PER_ELEMENT,version:u.version,size:p}}function s(u,l,d){let h=l.array,p=l._updateRange,g=l.updateRanges;if(t.bindBuffer(d,u),p.count===-1&&g.length===0&&t.bufferSubData(d,0,h),g.length!==0){for(let y=0,m=g.length;y<m;y++){let f=g[y];n?t.bufferSubData(d,f.start*h.BYTES_PER_ELEMENT,h,f.start,f.count):t.bufferSubData(d,f.start*h.BYTES_PER_ELEMENT,h.subarray(f.start,f.start+f.count))}l.clearUpdateRanges()}p.count!==-1&&(n?t.bufferSubData(d,p.offset*h.BYTES_PER_ELEMENT,h,p.offset,p.count):t.bufferSubData(d,p.offset*h.BYTES_PER_ELEMENT,h.subarray(p.offset,p.offset+p.count)),p.count=-1),l.onUploadCallback()}function o(u){return u.isInterleavedBufferAttribute&&(u=u.data),i.get(u)}function a(u){u.isInterleavedBufferAttribute&&(u=u.data);let l=i.get(u);l&&(t.deleteBuffer(l.buffer),i.delete(u))}function c(u,l){if(u.isGLBufferAttribute){let h=i.get(u);(!h||h.version<u.version)&&i.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}u.isInterleavedBufferAttribute&&(u=u.data);let d=i.get(u);if(d===void 0)i.set(u,r(u,l));else if(d.version<u.version){if(d.size!==u.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");s(d.buffer,u,l),d.version=u.version}}return{get:o,remove:a,update:c}}var Zf=class t extends Ji{constructor(e=1,n=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:i,heightSegments:r};let s=e/2,o=n/2,a=Math.floor(i),c=Math.floor(r),u=a+1,l=c+1,d=e/a,h=n/c,p=[],g=[],y=[],m=[];for(let f=0;f<l;f++){let b=f*h-o;for(let _=0;_<u;_++){let v=_*d-s;g.push(v,-b,0),y.push(0,0,1),m.push(_/a),m.push(1-f/c)}}for(let f=0;f<c;f++)for(let b=0;b<a;b++){let _=b+u*f,v=b+u*(f+1),x=b+1+u*(f+1),A=b+1+u*f;p.push(_,v,A),p.push(v,x,A)}this.setIndex(p),this.setAttribute("position",new Ti(g,3)),this.setAttribute("normal",new Ti(y,3)),this.setAttribute("uv",new Ti(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new t(e.width,e.height,e.widthSegments,e.heightSegments)}},EH=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,bH=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,xH=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,SH=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,TH=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,IH=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,AH=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,MH=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,CH=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,DH=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,RH=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,PH=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,NH=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,OH=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,LH=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,kH=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,FH=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,UH=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,VH=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,BH=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,zH=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,HH=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,GH=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,WH=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,jH=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,$H=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,qH=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,XH=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,KH=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,YH=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,QH="gl_FragColor = linearToOutputTexel( gl_FragColor );",ZH=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,JH=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,e4=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,t4=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,n4=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,i4=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,r4=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,s4=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,o4=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,a4=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,c4=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,u4=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,l4=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,d4=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,h4=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,f4=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,p4=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,m4=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,g4=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,y4=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,v4=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,_4=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,w4=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,E4=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,b4=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,x4=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,S4=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,T4=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,I4=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,A4=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,M4=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,C4=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,D4=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,R4=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,P4=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,N4=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,O4=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,L4=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,k4=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,F4=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,U4=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,V4=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,B4=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,z4=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,H4=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,G4=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,W4=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,j4=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,$4=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,q4=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,X4=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,K4=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Y4=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Q4=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Z4=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,J4=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,eG=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,tG=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,nG=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,iG=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,rG=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,sG=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,oG=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,aG=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,cG=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,uG=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,lG=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,dG=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,hG=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,fG=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,pG=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,mG=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,gG=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,yG=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,vG=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,_G=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,wG=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,EG=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,bG=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,xG=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,SG=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,TG=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,IG=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,AG=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,MG=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,CG=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,DG=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,RG=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,PG=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,NG=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,OG=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,LG=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,kG=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,FG=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,UG=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,VG=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,BG=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,zG=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,HG=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,GG=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,WG=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,jG=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,$G=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,qG=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,XG=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,KG=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,YG=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,QG=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ZG=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,JG=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,qe={alphahash_fragment:EH,alphahash_pars_fragment:bH,alphamap_fragment:xH,alphamap_pars_fragment:SH,alphatest_fragment:TH,alphatest_pars_fragment:IH,aomap_fragment:AH,aomap_pars_fragment:MH,batching_pars_vertex:CH,batching_vertex:DH,begin_vertex:RH,beginnormal_vertex:PH,bsdfs:NH,iridescence_fragment:OH,bumpmap_pars_fragment:LH,clipping_planes_fragment:kH,clipping_planes_pars_fragment:FH,clipping_planes_pars_vertex:UH,clipping_planes_vertex:VH,color_fragment:BH,color_pars_fragment:zH,color_pars_vertex:HH,color_vertex:GH,common:WH,cube_uv_reflection_fragment:jH,defaultnormal_vertex:$H,displacementmap_pars_vertex:qH,displacementmap_vertex:XH,emissivemap_fragment:KH,emissivemap_pars_fragment:YH,colorspace_fragment:QH,colorspace_pars_fragment:ZH,envmap_fragment:JH,envmap_common_pars_fragment:e4,envmap_pars_fragment:t4,envmap_pars_vertex:n4,envmap_physical_pars_fragment:p4,envmap_vertex:i4,fog_vertex:r4,fog_pars_vertex:s4,fog_fragment:o4,fog_pars_fragment:a4,gradientmap_pars_fragment:c4,lightmap_fragment:u4,lightmap_pars_fragment:l4,lights_lambert_fragment:d4,lights_lambert_pars_fragment:h4,lights_pars_begin:f4,lights_toon_fragment:m4,lights_toon_pars_fragment:g4,lights_phong_fragment:y4,lights_phong_pars_fragment:v4,lights_physical_fragment:_4,lights_physical_pars_fragment:w4,lights_fragment_begin:E4,lights_fragment_maps:b4,lights_fragment_end:x4,logdepthbuf_fragment:S4,logdepthbuf_pars_fragment:T4,logdepthbuf_pars_vertex:I4,logdepthbuf_vertex:A4,map_fragment:M4,map_pars_fragment:C4,map_particle_fragment:D4,map_particle_pars_fragment:R4,metalnessmap_fragment:P4,metalnessmap_pars_fragment:N4,morphcolor_vertex:O4,morphnormal_vertex:L4,morphtarget_pars_vertex:k4,morphtarget_vertex:F4,normal_fragment_begin:U4,normal_fragment_maps:V4,normal_pars_fragment:B4,normal_pars_vertex:z4,normal_vertex:H4,normalmap_pars_fragment:G4,clearcoat_normal_fragment_begin:W4,clearcoat_normal_fragment_maps:j4,clearcoat_pars_fragment:$4,iridescence_pars_fragment:q4,opaque_fragment:X4,packing:K4,premultiplied_alpha_fragment:Y4,project_vertex:Q4,dithering_fragment:Z4,dithering_pars_fragment:J4,roughnessmap_fragment:eG,roughnessmap_pars_fragment:tG,shadowmap_pars_fragment:nG,shadowmap_pars_vertex:iG,shadowmap_vertex:rG,shadowmask_pars_fragment:sG,skinbase_vertex:oG,skinning_pars_vertex:aG,skinning_vertex:cG,skinnormal_vertex:uG,specularmap_fragment:lG,specularmap_pars_fragment:dG,tonemapping_fragment:hG,tonemapping_pars_fragment:fG,transmission_fragment:pG,transmission_pars_fragment:mG,uv_pars_fragment:gG,uv_pars_vertex:yG,uv_vertex:vG,worldpos_vertex:_G,background_vert:wG,background_frag:EG,backgroundCube_vert:bG,backgroundCube_frag:xG,cube_vert:SG,cube_frag:TG,depth_vert:IG,depth_frag:AG,distanceRGBA_vert:MG,distanceRGBA_frag:CG,equirect_vert:DG,equirect_frag:RG,linedashed_vert:PG,linedashed_frag:NG,meshbasic_vert:OG,meshbasic_frag:LG,meshlambert_vert:kG,meshlambert_frag:FG,meshmatcap_vert:UG,meshmatcap_frag:VG,meshnormal_vert:BG,meshnormal_frag:zG,meshphong_vert:HG,meshphong_frag:GG,meshphysical_vert:WG,meshphysical_frag:jG,meshtoon_vert:$G,meshtoon_frag:qG,points_vert:XG,points_frag:KG,shadow_vert:YG,shadow_frag:QG,sprite_vert:ZG,sprite_frag:JG},re={common:{diffuse:{value:new lt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ze},alphaMap:{value:null},alphaMapTransform:{value:new Ze},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ze}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ze}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ze}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ze},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ze},normalScale:{value:new ht(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ze},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ze}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ze}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ze}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new lt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new lt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Ze},alphaTest:{value:0},uvTransform:{value:new Ze}},sprite:{diffuse:{value:new lt(16777215)},opacity:{value:1},center:{value:new ht(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ze},alphaMap:{value:null},alphaMapTransform:{value:new Ze},alphaTest:{value:0}}},Zi={basic:{uniforms:bn([re.common,re.specularmap,re.envmap,re.aomap,re.lightmap,re.fog]),vertexShader:qe.meshbasic_vert,fragmentShader:qe.meshbasic_frag},lambert:{uniforms:bn([re.common,re.specularmap,re.envmap,re.aomap,re.lightmap,re.emissivemap,re.bumpmap,re.normalmap,re.displacementmap,re.fog,re.lights,{emissive:{value:new lt(0)}}]),vertexShader:qe.meshlambert_vert,fragmentShader:qe.meshlambert_frag},phong:{uniforms:bn([re.common,re.specularmap,re.envmap,re.aomap,re.lightmap,re.emissivemap,re.bumpmap,re.normalmap,re.displacementmap,re.fog,re.lights,{emissive:{value:new lt(0)},specular:{value:new lt(1118481)},shininess:{value:30}}]),vertexShader:qe.meshphong_vert,fragmentShader:qe.meshphong_frag},standard:{uniforms:bn([re.common,re.envmap,re.aomap,re.lightmap,re.emissivemap,re.bumpmap,re.normalmap,re.displacementmap,re.roughnessmap,re.metalnessmap,re.fog,re.lights,{emissive:{value:new lt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:qe.meshphysical_vert,fragmentShader:qe.meshphysical_frag},toon:{uniforms:bn([re.common,re.aomap,re.lightmap,re.emissivemap,re.bumpmap,re.normalmap,re.displacementmap,re.gradientmap,re.fog,re.lights,{emissive:{value:new lt(0)}}]),vertexShader:qe.meshtoon_vert,fragmentShader:qe.meshtoon_frag},matcap:{uniforms:bn([re.common,re.bumpmap,re.normalmap,re.displacementmap,re.fog,{matcap:{value:null}}]),vertexShader:qe.meshmatcap_vert,fragmentShader:qe.meshmatcap_frag},points:{uniforms:bn([re.points,re.fog]),vertexShader:qe.points_vert,fragmentShader:qe.points_frag},dashed:{uniforms:bn([re.common,re.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:qe.linedashed_vert,fragmentShader:qe.linedashed_frag},depth:{uniforms:bn([re.common,re.displacementmap]),vertexShader:qe.depth_vert,fragmentShader:qe.depth_frag},normal:{uniforms:bn([re.common,re.bumpmap,re.normalmap,re.displacementmap,{opacity:{value:1}}]),vertexShader:qe.meshnormal_vert,fragmentShader:qe.meshnormal_frag},sprite:{uniforms:bn([re.sprite,re.fog]),vertexShader:qe.sprite_vert,fragmentShader:qe.sprite_frag},background:{uniforms:{uvTransform:{value:new Ze},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:qe.background_vert,fragmentShader:qe.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:qe.backgroundCube_vert,fragmentShader:qe.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:qe.cube_vert,fragmentShader:qe.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:qe.equirect_vert,fragmentShader:qe.equirect_frag},distanceRGBA:{uniforms:bn([re.common,re.displacementmap,{referencePosition:{value:new k},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:qe.distanceRGBA_vert,fragmentShader:qe.distanceRGBA_frag},shadow:{uniforms:bn([re.lights,re.fog,{color:{value:new lt(0)},opacity:{value:1}}]),vertexShader:qe.shadow_vert,fragmentShader:qe.shadow_frag}};Zi.physical={uniforms:bn([Zi.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ze},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ze},clearcoatNormalScale:{value:new ht(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ze},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ze},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ze},sheen:{value:0},sheenColor:{value:new lt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ze},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ze},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ze},transmissionSamplerSize:{value:new ht},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ze},attenuationDistance:{value:0},attenuationColor:{value:new lt(0)},specularColor:{value:new lt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ze},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ze},anisotropyVector:{value:new ht},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Ze}}]),vertexShader:qe.meshphysical_vert,fragmentShader:qe.meshphysical_frag};var Af={r:0,b:0,g:0};function eW(t,e,n,i,r,s,o){let a=new lt(0),c=s===!0?0:1,u,l,d=null,h=0,p=null;function g(m,f){let b=!1,_=f.isScene===!0?f.background:null;_&&_.isTexture&&(_=(f.backgroundBlurriness>0?n:e).get(_)),_===null?y(a,c):_&&_.isColor&&(y(_,1),b=!0);let v=t.xr.getEnvironmentBlendMode();v==="additive"?i.buffers.color.setClear(0,0,0,1,o):v==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(t.autoClear||b)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),_&&(_.isCubeTexture||_.mapping===ip)?(l===void 0&&(l=new Si(new cl(1,1,1),new er({name:"BackgroundCubeMaterial",uniforms:hc(Zi.backgroundCube.uniforms),vertexShader:Zi.backgroundCube.vertexShader,fragmentShader:Zi.backgroundCube.fragmentShader,side:Pn,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(x,A,I){this.matrixWorld.copyPosition(I.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(l)),l.material.uniforms.envMap.value=_,l.material.uniforms.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,l.material.uniforms.backgroundBlurriness.value=f.backgroundBlurriness,l.material.uniforms.backgroundIntensity.value=f.backgroundIntensity,l.material.toneMapped=vt.getTransfer(_.colorSpace)!==Tt,(d!==_||h!==_.version||p!==t.toneMapping)&&(l.material.needsUpdate=!0,d=_,h=_.version,p=t.toneMapping),l.layers.enableAll(),m.unshift(l,l.geometry,l.material,0,0,null)):_&&_.isTexture&&(u===void 0&&(u=new Si(new Zf(2,2),new er({name:"BackgroundMaterial",uniforms:hc(Zi.background.uniforms),vertexShader:Zi.background.vertexShader,fragmentShader:Zi.background.fragmentShader,side:Ss,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(u)),u.material.uniforms.t2D.value=_,u.material.uniforms.backgroundIntensity.value=f.backgroundIntensity,u.material.toneMapped=vt.getTransfer(_.colorSpace)!==Tt,_.matrixAutoUpdate===!0&&_.updateMatrix(),u.material.uniforms.uvTransform.value.copy(_.matrix),(d!==_||h!==_.version||p!==t.toneMapping)&&(u.material.needsUpdate=!0,d=_,h=_.version,p=t.toneMapping),u.layers.enableAll(),m.unshift(u,u.geometry,u.material,0,0,null))}function y(m,f){m.getRGB(Af,zC(t)),i.buffers.color.setClear(Af.r,Af.g,Af.b,f,o)}return{getClearColor:function(){return a},setClearColor:function(m,f=1){a.set(m),c=f,y(a,c)},getClearAlpha:function(){return c},setClearAlpha:function(m){c=m,y(a,c)},render:g}}function tW(t,e,n,i){let r=t.getParameter(t.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||s!==null,a={},c=m(null),u=c,l=!1;function d(D,z,O,K,W){let q=!1;if(o){let $=y(K,O,z);u!==$&&(u=$,p(u.object)),q=f(D,K,O,W),q&&b(D,K,O,W)}else{let $=z.wireframe===!0;(u.geometry!==K.id||u.program!==O.id||u.wireframe!==$)&&(u.geometry=K.id,u.program=O.id,u.wireframe=$,q=!0)}W!==null&&n.update(W,t.ELEMENT_ARRAY_BUFFER),(q||l)&&(l=!1,V(D,z,O,K),W!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n.get(W).buffer))}function h(){return i.isWebGL2?t.createVertexArray():s.createVertexArrayOES()}function p(D){return i.isWebGL2?t.bindVertexArray(D):s.bindVertexArrayOES(D)}function g(D){return i.isWebGL2?t.deleteVertexArray(D):s.deleteVertexArrayOES(D)}function y(D,z,O){let K=O.wireframe===!0,W=a[D.id];W===void 0&&(W={},a[D.id]=W);let q=W[z.id];q===void 0&&(q={},W[z.id]=q);let $=q[K];return $===void 0&&($=m(h()),q[K]=$),$}function m(D){let z=[],O=[],K=[];for(let W=0;W<r;W++)z[W]=0,O[W]=0,K[W]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:z,enabledAttributes:O,attributeDivisors:K,object:D,attributes:{},index:null}}function f(D,z,O,K){let W=u.attributes,q=z.attributes,$=0,ee=O.getAttributes();for(let se in ee)if(ee[se].location>=0){let H=W[se],Q=q[se];if(Q===void 0&&(se==="instanceMatrix"&&D.instanceMatrix&&(Q=D.instanceMatrix),se==="instanceColor"&&D.instanceColor&&(Q=D.instanceColor)),H===void 0||H.attribute!==Q||Q&&H.data!==Q.data)return!0;$++}return u.attributesNum!==$||u.index!==K}function b(D,z,O,K){let W={},q=z.attributes,$=0,ee=O.getAttributes();for(let se in ee)if(ee[se].location>=0){let H=q[se];H===void 0&&(se==="instanceMatrix"&&D.instanceMatrix&&(H=D.instanceMatrix),se==="instanceColor"&&D.instanceColor&&(H=D.instanceColor));let Q={};Q.attribute=H,H&&H.data&&(Q.data=H.data),W[se]=Q,$++}u.attributes=W,u.attributesNum=$,u.index=K}function _(){let D=u.newAttributes;for(let z=0,O=D.length;z<O;z++)D[z]=0}function v(D){x(D,0)}function x(D,z){let O=u.newAttributes,K=u.enabledAttributes,W=u.attributeDivisors;O[D]=1,K[D]===0&&(t.enableVertexAttribArray(D),K[D]=1),W[D]!==z&&((i.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](D,z),W[D]=z)}function A(){let D=u.newAttributes,z=u.enabledAttributes;for(let O=0,K=z.length;O<K;O++)z[O]!==D[O]&&(t.disableVertexAttribArray(O),z[O]=0)}function I(D,z,O,K,W,q,$){$===!0?t.vertexAttribIPointer(D,z,O,W,q):t.vertexAttribPointer(D,z,O,K,W,q)}function V(D,z,O,K){if(i.isWebGL2===!1&&(D.isInstancedMesh||K.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;_();let W=K.attributes,q=O.getAttributes(),$=z.defaultAttributeValues;for(let ee in q){let se=q[ee];if(se.location>=0){let Me=W[ee];if(Me===void 0&&(ee==="instanceMatrix"&&D.instanceMatrix&&(Me=D.instanceMatrix),ee==="instanceColor"&&D.instanceColor&&(Me=D.instanceColor)),Me!==void 0){let H=Me.normalized,Q=Me.itemSize,ce=n.get(Me);if(ce===void 0)continue;let we=ce.buffer,Te=ce.type,he=ce.bytesPerElement,Ce=i.isWebGL2===!0&&(Te===t.INT||Te===t.UNSIGNED_INT||Me.gpuType===DC);if(Me.isInterleavedBufferAttribute){let ke=Me.data,P=ke.stride,Bt=Me.offset;if(ke.isInstancedInterleavedBuffer){for(let Ee=0;Ee<se.locationSize;Ee++)x(se.location+Ee,ke.meshPerAttribute);D.isInstancedMesh!==!0&&K._maxInstanceCount===void 0&&(K._maxInstanceCount=ke.meshPerAttribute*ke.count)}else for(let Ee=0;Ee<se.locationSize;Ee++)v(se.location+Ee);t.bindBuffer(t.ARRAY_BUFFER,we);for(let Ee=0;Ee<se.locationSize;Ee++)I(se.location+Ee,Q/se.locationSize,Te,H,P*he,(Bt+Q/se.locationSize*Ee)*he,Ce)}else{if(Me.isInstancedBufferAttribute){for(let ke=0;ke<se.locationSize;ke++)x(se.location+ke,Me.meshPerAttribute);D.isInstancedMesh!==!0&&K._maxInstanceCount===void 0&&(K._maxInstanceCount=Me.meshPerAttribute*Me.count)}else for(let ke=0;ke<se.locationSize;ke++)v(se.location+ke);t.bindBuffer(t.ARRAY_BUFFER,we);for(let ke=0;ke<se.locationSize;ke++)I(se.location+ke,Q/se.locationSize,Te,H,Q*he,Q/se.locationSize*ke*he,Ce)}}else if($!==void 0){let H=$[ee];if(H!==void 0)switch(H.length){case 2:t.vertexAttrib2fv(se.location,H);break;case 3:t.vertexAttrib3fv(se.location,H);break;case 4:t.vertexAttrib4fv(se.location,H);break;default:t.vertexAttrib1fv(se.location,H)}}}}A()}function G(){j();for(let D in a){let z=a[D];for(let O in z){let K=z[O];for(let W in K)g(K[W].object),delete K[W];delete z[O]}delete a[D]}}function w(D){if(a[D.id]===void 0)return;let z=a[D.id];for(let O in z){let K=z[O];for(let W in K)g(K[W].object),delete K[W];delete z[O]}delete a[D.id]}function M(D){for(let z in a){let O=a[z];if(O[D.id]===void 0)continue;let K=O[D.id];for(let W in K)g(K[W].object),delete K[W];delete O[D.id]}}function j(){X(),l=!0,u!==c&&(u=c,p(u.object))}function X(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:d,reset:j,resetDefaultState:X,dispose:G,releaseStatesOfGeometry:w,releaseStatesOfProgram:M,initAttributes:_,enableAttribute:v,disableUnusedAttributes:A}}function nW(t,e,n,i){let r=i.isWebGL2,s;function o(l){s=l}function a(l,d){t.drawArrays(s,l,d),n.update(d,s,1)}function c(l,d,h){if(h===0)return;let p,g;if(r)p=t,g="drawArraysInstanced";else if(p=e.get("ANGLE_instanced_arrays"),g="drawArraysInstancedANGLE",p===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}p[g](s,l,d,h),n.update(d,s,h)}function u(l,d,h){if(h===0)return;let p=e.get("WEBGL_multi_draw");if(p===null)for(let g=0;g<h;g++)this.render(l[g],d[g]);else{p.multiDrawArraysWEBGL(s,l,0,d,0,h);let g=0;for(let y=0;y<h;y++)g+=d[y];n.update(g,s,1)}}this.setMode=o,this.render=a,this.renderInstances=c,this.renderMultiDraw=u}function iW(t,e,n){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){let I=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(I.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(I){if(I==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";I="mediump"}return I==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let o=typeof WebGL2RenderingContext<"u"&&t.constructor.name==="WebGL2RenderingContext",a=n.precision!==void 0?n.precision:"highp",c=s(a);c!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",c,"instead."),a=c);let u=o||e.has("WEBGL_draw_buffers"),l=n.logarithmicDepthBuffer===!0,d=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),h=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),p=t.getParameter(t.MAX_TEXTURE_SIZE),g=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),y=t.getParameter(t.MAX_VERTEX_ATTRIBS),m=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),f=t.getParameter(t.MAX_VARYING_VECTORS),b=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),_=h>0,v=o||e.has("OES_texture_float"),x=_&&v,A=o?t.getParameter(t.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:u,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:l,maxTextures:d,maxVertexTextures:h,maxTextureSize:p,maxCubemapSize:g,maxAttributes:y,maxVertexUniforms:m,maxVaryings:f,maxFragmentUniforms:b,vertexTextures:_,floatFragmentTextures:v,floatVertexTextures:x,maxSamples:A}}function rW(t){let e=this,n=null,i=0,r=!1,s=!1,o=new Dr,a=new Ze,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h){let p=d.length!==0||h||i!==0||r;return r=h,i=d.length,p},this.beginShadows=function(){s=!0,l(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,h){n=l(d,h,0)},this.setState=function(d,h,p){let g=d.clippingPlanes,y=d.clipIntersection,m=d.clipShadows,f=t.get(d);if(!r||g===null||g.length===0||s&&!m)s?l(null):u();else{let b=s?0:i,_=b*4,v=f.clippingState||null;c.value=v,v=l(g,h,_,p);for(let x=0;x!==_;++x)v[x]=n[x];f.clippingState=v,this.numIntersection=y?this.numPlanes:0,this.numPlanes+=b}};function u(){c.value!==n&&(c.value=n,c.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function l(d,h,p,g){let y=d!==null?d.length:0,m=null;if(y!==0){if(m=c.value,g!==!0||m===null){let f=p+y*4,b=h.matrixWorldInverse;a.getNormalMatrix(b),(m===null||m.length<f)&&(m=new Float32Array(f));for(let _=0,v=p;_!==y;++_,v+=4)o.copy(d[_]).applyMatrix4(b,a),o.normal.toArray(m,v),m[v+3]=o.constant}c.value=m,c.needsUpdate=!0}return e.numPlanes=y,e.numIntersection=0,m}}function sW(t){let e=new WeakMap;function n(o,a){return a===x0?o.mapping=cc:a===S0&&(o.mapping=uc),o}function i(o){if(o&&o.isTexture){let a=o.mapping;if(a===x0||a===S0)if(e.has(o)){let c=e.get(o).texture;return n(c,o.mapping)}else{let c=o.image;if(c&&c.height>0){let u=new P0(c.height);return u.fromEquirectangularTexture(t,o),e.set(o,u),o.addEventListener("dispose",r),n(u.texture,o.mapping)}else return null}}return o}function r(o){let a=o.target;a.removeEventListener("dispose",r);let c=e.get(a);c!==void 0&&(e.delete(a),c.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}var N0=class extends Kf{constructor(e=-1,n=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2,s=i-e,o=i+e,a=r+n,c=r-n;if(this.view!==null&&this.view.enabled){let u=(this.right-this.left)/this.view.fullWidth/this.zoom,l=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,o=s+u*this.view.width,a-=l*this.view.offsetY,c=a-l*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,c,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}},tc=4,sC=[.125,.215,.35,.446,.526,.582],bo=20,g0=new N0,oC=new lt,y0=null,v0=0,_0=0,wo=(1+Math.sqrt(5))/2,Za=1/wo,aC=[new k(1,1,1),new k(-1,1,1),new k(1,1,-1),new k(-1,1,-1),new k(0,wo,Za),new k(0,wo,-Za),new k(Za,0,wo),new k(-Za,0,wo),new k(wo,Za,0),new k(-wo,Za,0)],Jf=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,i=.1,r=100){y0=this._renderer.getRenderTarget(),v0=this._renderer.getActiveCubeFace(),_0=this._renderer.getActiveMipmapLevel(),this._setSize(256);let s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),n>0&&this._blur(s,0,0,n),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=lC(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=uC(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(y0,v0,_0),e.scissorTest=!1,Mf(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===cc||e.mapping===uc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),y0=this._renderer.getRenderTarget(),v0=this._renderer.getActiveCubeFace(),_0=this._renderer.getActiveMipmapLevel();let i=n||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,i={magFilter:Rn,minFilter:Rn,generateMipmaps:!1,type:ol,format:xi,colorSpace:Or,depthBuffer:!1},r=cC(e,n,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=cC(e,n,i);let{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=oW(s)),this._blurMaterial=aW(s,e,n)}return r}_compileMaterial(e){let n=new Si(this._lodPlanes[0],e);this._renderer.compile(n,g0)}_sceneToCubeUV(e,n,i,r){let a=new Tn(90,1,n,i),c=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],l=this._renderer,d=l.autoClear,h=l.toneMapping;l.getClearColor(oC),l.toneMapping=bs,l.autoClear=!1;let p=new $f({name:"PMREM.Background",side:Pn,depthWrite:!1,depthTest:!1}),g=new Si(new cl,p),y=!1,m=e.background;m?m.isColor&&(p.color.copy(m),e.background=null,y=!0):(p.color.copy(oC),y=!0);for(let f=0;f<6;f++){let b=f%3;b===0?(a.up.set(0,c[f],0),a.lookAt(u[f],0,0)):b===1?(a.up.set(0,0,c[f]),a.lookAt(0,u[f],0)):(a.up.set(0,c[f],0),a.lookAt(0,0,u[f]));let _=this._cubeSize;Mf(r,b*_,f>2?_:0,_,_),l.setRenderTarget(r),y&&l.render(g,a),l.render(e,a)}g.geometry.dispose(),g.material.dispose(),l.toneMapping=h,l.autoClear=d,e.background=m}_textureToCubeUV(e,n){let i=this._renderer,r=e.mapping===cc||e.mapping===uc;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=lC()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=uC());let s=r?this._cubemapMaterial:this._equirectMaterial,o=new Si(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;let c=this._cubeSize;Mf(n,0,0,3*c,2*c),i.setRenderTarget(n),i.render(o,g0)}_applyPMREM(e){let n=this._renderer,i=n.autoClear;n.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){let s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=aC[(r-1)%aC.length];this._blur(e,r-1,r,s,o)}n.autoClear=i}_blur(e,n,i,r,s){let o=this._pingPongRenderTarget;this._halfBlur(e,o,n,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,n,i,r,s,o,a){let c=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let l=3,d=new Si(this._lodPlanes[r],u),h=u.uniforms,p=this._sizeLods[i]-1,g=isFinite(s)?Math.PI/(2*p):2*Math.PI/(2*bo-1),y=s/g,m=isFinite(s)?1+Math.floor(l*y):bo;m>bo&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${bo}`);let f=[],b=0;for(let I=0;I<bo;++I){let V=I/y,G=Math.exp(-V*V/2);f.push(G),I===0?b+=G:I<m&&(b+=2*G)}for(let I=0;I<f.length;I++)f[I]=f[I]/b;h.envMap.value=e.texture,h.samples.value=m,h.weights.value=f,h.latitudinal.value=o==="latitudinal",a&&(h.poleAxis.value=a);let{_lodMax:_}=this;h.dTheta.value=g,h.mipInt.value=_-i;let v=this._sizeLods[r],x=3*v*(r>_-tc?r-_+tc:0),A=4*(this._cubeSize-v);Mf(n,x,A,3*v,2*v),c.setRenderTarget(n),c.render(d,g0)}};function oW(t){let e=[],n=[],i=[],r=t,s=t-tc+1+sC.length;for(let o=0;o<s;o++){let a=Math.pow(2,r);n.push(a);let c=1/a;o>t-tc?c=sC[o-t+tc-1]:o===0&&(c=0),i.push(c);let u=1/(a-2),l=-u,d=1+u,h=[l,l,d,l,d,d,l,l,d,d,l,d],p=6,g=6,y=3,m=2,f=1,b=new Float32Array(y*g*p),_=new Float32Array(m*g*p),v=new Float32Array(f*g*p);for(let A=0;A<p;A++){let I=A%3*2/3-1,V=A>2?0:-1,G=[I,V,0,I+2/3,V,0,I+2/3,V+1,0,I,V,0,I+2/3,V+1,0,I,V+1,0];b.set(G,y*g*A),_.set(h,m*g*A);let w=[A,A,A,A,A,A];v.set(w,f*g*A)}let x=new Ji;x.setAttribute("position",new si(b,y)),x.setAttribute("uv",new si(_,m)),x.setAttribute("faceIndex",new si(v,f)),e.push(x),r>tc&&r--}return{lodPlanes:e,sizeLods:n,sigmas:i}}function cC(t,e,n){let i=new Lr(t,e,n);return i.texture.mapping=ip,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Mf(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function aW(t,e,n){let i=new Float32Array(bo),r=new k(0,1,0);return new er({name:"SphericalGaussianBlur",defines:{n:bo,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:sw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Es,depthTest:!1,depthWrite:!1})}function uC(){return new er({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:sw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Es,depthTest:!1,depthWrite:!1})}function lC(){return new er({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:sw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Es,depthTest:!1,depthWrite:!1})}function sw(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function cW(t){let e=new WeakMap,n=null;function i(a){if(a&&a.isTexture){let c=a.mapping,u=c===x0||c===S0,l=c===cc||c===uc;if(u||l)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let d=e.get(a);return n===null&&(n=new Jf(t)),d=u?n.fromEquirectangular(a,d):n.fromCubemap(a,d),e.set(a,d),d.texture}else{if(e.has(a))return e.get(a).texture;{let d=a.image;if(u&&d&&d.height>0||l&&d&&r(d)){n===null&&(n=new Jf(t));let h=u?n.fromEquirectangular(a):n.fromCubemap(a);return e.set(a,h),a.addEventListener("dispose",s),h.texture}else return null}}}return a}function r(a){let c=0,u=6;for(let l=0;l<u;l++)a[l]!==void 0&&c++;return c===u}function s(a){let c=a.target;c.removeEventListener("dispose",s);let u=e.get(c);u!==void 0&&(e.delete(c),u.dispose())}function o(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:i,dispose:o}}function uW(t){let e={};function n(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(i)}return e[i]=r,r}return{has:function(i){return n(i)!==null},init:function(i){i.isWebGL2?(n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance")):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(i){let r=n(i);return r===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function lW(t,e,n,i){let r={},s=new WeakMap;function o(d){let h=d.target;h.index!==null&&e.remove(h.index);for(let g in h.attributes)e.remove(h.attributes[g]);for(let g in h.morphAttributes){let y=h.morphAttributes[g];for(let m=0,f=y.length;m<f;m++)e.remove(y[m])}h.removeEventListener("dispose",o),delete r[h.id];let p=s.get(h);p&&(e.remove(p),s.delete(h)),i.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,n.memory.geometries--}function a(d,h){return r[h.id]===!0||(h.addEventListener("dispose",o),r[h.id]=!0,n.memory.geometries++),h}function c(d){let h=d.attributes;for(let g in h)e.update(h[g],t.ARRAY_BUFFER);let p=d.morphAttributes;for(let g in p){let y=p[g];for(let m=0,f=y.length;m<f;m++)e.update(y[m],t.ARRAY_BUFFER)}}function u(d){let h=[],p=d.index,g=d.attributes.position,y=0;if(p!==null){let b=p.array;y=p.version;for(let _=0,v=b.length;_<v;_+=3){let x=b[_+0],A=b[_+1],I=b[_+2];h.push(x,A,A,I,I,x)}}else if(g!==void 0){let b=g.array;y=g.version;for(let _=0,v=b.length/3-1;_<v;_+=3){let x=_+0,A=_+1,I=_+2;h.push(x,A,A,I,I,x)}}else return;let m=new(VC(h)?Xf:qf)(h,1);m.version=y;let f=s.get(d);f&&e.remove(f),s.set(d,m)}function l(d){let h=s.get(d);if(h){let p=d.index;p!==null&&h.version<p.version&&u(d)}else u(d);return s.get(d)}return{get:a,update:c,getWireframeAttribute:l}}function dW(t,e,n,i){let r=i.isWebGL2,s;function o(p){s=p}let a,c;function u(p){a=p.type,c=p.bytesPerElement}function l(p,g){t.drawElements(s,g,a,p*c),n.update(g,s,1)}function d(p,g,y){if(y===0)return;let m,f;if(r)m=t,f="drawElementsInstanced";else if(m=e.get("ANGLE_instanced_arrays"),f="drawElementsInstancedANGLE",m===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[f](s,g,a,p*c,y),n.update(g,s,y)}function h(p,g,y){if(y===0)return;let m=e.get("WEBGL_multi_draw");if(m===null)for(let f=0;f<y;f++)this.render(p[f]/c,g[f]);else{m.multiDrawElementsWEBGL(s,g,0,a,p,0,y);let f=0;for(let b=0;b<y;b++)f+=g[b];n.update(f,s,1)}}this.setMode=o,this.setIndex=u,this.render=l,this.renderInstances=d,this.renderMultiDraw=h}function hW(t){let e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(n.calls++,o){case t.TRIANGLES:n.triangles+=a*(s/3);break;case t.LINES:n.lines+=a*(s/2);break;case t.LINE_STRIP:n.lines+=a*(s-1);break;case t.LINE_LOOP:n.lines+=a*s;break;case t.POINTS:n.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:r,update:i}}function fW(t,e){return t[0]-e[0]}function pW(t,e){return Math.abs(e[1])-Math.abs(t[1])}function mW(t,e,n){let i={},r=new Float32Array(8),s=new WeakMap,o=new un,a=[];for(let u=0;u<8;u++)a[u]=[u,0];function c(u,l,d){let h=u.morphTargetInfluences;if(e.isWebGL2===!0){let g=l.morphAttributes.position||l.morphAttributes.normal||l.morphAttributes.color,y=g!==void 0?g.length:0,m=s.get(l);if(m===void 0||m.count!==y){let z=function(){X.dispose(),s.delete(l),l.removeEventListener("dispose",z)};var p=z;m!==void 0&&m.texture.dispose();let _=l.morphAttributes.position!==void 0,v=l.morphAttributes.normal!==void 0,x=l.morphAttributes.color!==void 0,A=l.morphAttributes.position||[],I=l.morphAttributes.normal||[],V=l.morphAttributes.color||[],G=0;_===!0&&(G=1),v===!0&&(G=2),x===!0&&(G=3);let w=l.attributes.position.count*G,M=1;w>e.maxTextureSize&&(M=Math.ceil(w/e.maxTextureSize),w=e.maxTextureSize);let j=new Float32Array(w*M*4*y),X=new Gf(j,w,M,y);X.type=Pr,X.needsUpdate=!0;let D=G*4;for(let O=0;O<y;O++){let K=A[O],W=I[O],q=V[O],$=w*M*4*O;for(let ee=0;ee<K.count;ee++){let se=ee*D;_===!0&&(o.fromBufferAttribute(K,ee),j[$+se+0]=o.x,j[$+se+1]=o.y,j[$+se+2]=o.z,j[$+se+3]=0),v===!0&&(o.fromBufferAttribute(W,ee),j[$+se+4]=o.x,j[$+se+5]=o.y,j[$+se+6]=o.z,j[$+se+7]=0),x===!0&&(o.fromBufferAttribute(q,ee),j[$+se+8]=o.x,j[$+se+9]=o.y,j[$+se+10]=o.z,j[$+se+11]=q.itemSize===4?o.w:1)}}m={count:y,texture:X,size:new ht(w,M)},s.set(l,m),l.addEventListener("dispose",z)}let f=0;for(let _=0;_<h.length;_++)f+=h[_];let b=l.morphTargetsRelative?1:1-f;d.getUniforms().setValue(t,"morphTargetBaseInfluence",b),d.getUniforms().setValue(t,"morphTargetInfluences",h),d.getUniforms().setValue(t,"morphTargetsTexture",m.texture,n),d.getUniforms().setValue(t,"morphTargetsTextureSize",m.size)}else{let g=h===void 0?0:h.length,y=i[l.id];if(y===void 0||y.length!==g){y=[];for(let v=0;v<g;v++)y[v]=[v,0];i[l.id]=y}for(let v=0;v<g;v++){let x=y[v];x[0]=v,x[1]=h[v]}y.sort(pW);for(let v=0;v<8;v++)v<g&&y[v][1]?(a[v][0]=y[v][0],a[v][1]=y[v][1]):(a[v][0]=Number.MAX_SAFE_INTEGER,a[v][1]=0);a.sort(fW);let m=l.morphAttributes.position,f=l.morphAttributes.normal,b=0;for(let v=0;v<8;v++){let x=a[v],A=x[0],I=x[1];A!==Number.MAX_SAFE_INTEGER&&I?(m&&l.getAttribute("morphTarget"+v)!==m[A]&&l.setAttribute("morphTarget"+v,m[A]),f&&l.getAttribute("morphNormal"+v)!==f[A]&&l.setAttribute("morphNormal"+v,f[A]),r[v]=I,b+=I):(m&&l.hasAttribute("morphTarget"+v)===!0&&l.deleteAttribute("morphTarget"+v),f&&l.hasAttribute("morphNormal"+v)===!0&&l.deleteAttribute("morphNormal"+v),r[v]=0)}let _=l.morphTargetsRelative?1:1-b;d.getUniforms().setValue(t,"morphTargetBaseInfluence",_),d.getUniforms().setValue(t,"morphTargetInfluences",r)}}return{update:c}}function gW(t,e,n,i){let r=new WeakMap;function s(c){let u=i.render.frame,l=c.geometry,d=e.get(c,l);if(r.get(d)!==u&&(e.update(d),r.set(d,u)),c.isInstancedMesh&&(c.hasEventListener("dispose",a)===!1&&c.addEventListener("dispose",a),r.get(c)!==u&&(n.update(c.instanceMatrix,t.ARRAY_BUFFER),c.instanceColor!==null&&n.update(c.instanceColor,t.ARRAY_BUFFER),r.set(c,u))),c.isSkinnedMesh){let h=c.skeleton;r.get(h)!==u&&(h.update(),r.set(h,u))}return d}function o(){r=new WeakMap}function a(c){let u=c.target;u.removeEventListener("dispose",a),n.remove(u.instanceMatrix),u.instanceColor!==null&&n.remove(u.instanceColor)}return{update:s,dispose:o}}var ep=class extends Ro{constructor(e,n,i,r,s,o,a,c,u,l){if(l=l!==void 0?l:To,l!==To&&l!==lc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&l===To&&(i=ws),i===void 0&&l===lc&&(i=So),super(null,r,s,o,a,c,l,i,u),this.isDepthTexture=!0,this.image={width:e,height:n},this.magFilter=a!==void 0?a:xn,this.minFilter=c!==void 0?c:xn,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){let n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}},GC=new Ro,WC=new ep(1,1);WC.compareFunction=UC;var jC=new Gf,$C=new D0,qC=new Yf,dC=[],hC=[],fC=new Float32Array(16),pC=new Float32Array(9),mC=new Float32Array(4);function mc(t,e,n){let i=t[0];if(i<=0||i>0)return t;let r=e*n,s=dC[r];if(s===void 0&&(s=new Float32Array(r),dC[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=n,t[o].toArray(s,a)}return s}function Wt(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function jt(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function op(t,e){let n=hC[e];n===void 0&&(n=new Int32Array(e),hC[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function yW(t,e){let n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function vW(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Wt(n,e))return;t.uniform2fv(this.addr,e),jt(n,e)}}function _W(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Wt(n,e))return;t.uniform3fv(this.addr,e),jt(n,e)}}function wW(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Wt(n,e))return;t.uniform4fv(this.addr,e),jt(n,e)}}function EW(t,e){let n=this.cache,i=e.elements;if(i===void 0){if(Wt(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),jt(n,e)}else{if(Wt(n,i))return;mC.set(i),t.uniformMatrix2fv(this.addr,!1,mC),jt(n,i)}}function bW(t,e){let n=this.cache,i=e.elements;if(i===void 0){if(Wt(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),jt(n,e)}else{if(Wt(n,i))return;pC.set(i),t.uniformMatrix3fv(this.addr,!1,pC),jt(n,i)}}function xW(t,e){let n=this.cache,i=e.elements;if(i===void 0){if(Wt(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),jt(n,e)}else{if(Wt(n,i))return;fC.set(i),t.uniformMatrix4fv(this.addr,!1,fC),jt(n,i)}}function SW(t,e){let n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function TW(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Wt(n,e))return;t.uniform2iv(this.addr,e),jt(n,e)}}function IW(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Wt(n,e))return;t.uniform3iv(this.addr,e),jt(n,e)}}function AW(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Wt(n,e))return;t.uniform4iv(this.addr,e),jt(n,e)}}function MW(t,e){let n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function CW(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Wt(n,e))return;t.uniform2uiv(this.addr,e),jt(n,e)}}function DW(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Wt(n,e))return;t.uniform3uiv(this.addr,e),jt(n,e)}}function RW(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Wt(n,e))return;t.uniform4uiv(this.addr,e),jt(n,e)}}function PW(t,e,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r);let s=this.type===t.SAMPLER_2D_SHADOW?WC:GC;n.setTexture2D(e||s,r)}function NW(t,e,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||$C,r)}function OW(t,e,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||qC,r)}function LW(t,e,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||jC,r)}function kW(t){switch(t){case 5126:return yW;case 35664:return vW;case 35665:return _W;case 35666:return wW;case 35674:return EW;case 35675:return bW;case 35676:return xW;case 5124:case 35670:return SW;case 35667:case 35671:return TW;case 35668:case 35672:return IW;case 35669:case 35673:return AW;case 5125:return MW;case 36294:return CW;case 36295:return DW;case 36296:return RW;case 35678:case 36198:case 36298:case 36306:case 35682:return PW;case 35679:case 36299:case 36307:return NW;case 35680:case 36300:case 36308:case 36293:return OW;case 36289:case 36303:case 36311:case 36292:return LW}}function FW(t,e){t.uniform1fv(this.addr,e)}function UW(t,e){let n=mc(e,this.size,2);t.uniform2fv(this.addr,n)}function VW(t,e){let n=mc(e,this.size,3);t.uniform3fv(this.addr,n)}function BW(t,e){let n=mc(e,this.size,4);t.uniform4fv(this.addr,n)}function zW(t,e){let n=mc(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function HW(t,e){let n=mc(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function GW(t,e){let n=mc(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function WW(t,e){t.uniform1iv(this.addr,e)}function jW(t,e){t.uniform2iv(this.addr,e)}function $W(t,e){t.uniform3iv(this.addr,e)}function qW(t,e){t.uniform4iv(this.addr,e)}function XW(t,e){t.uniform1uiv(this.addr,e)}function KW(t,e){t.uniform2uiv(this.addr,e)}function YW(t,e){t.uniform3uiv(this.addr,e)}function QW(t,e){t.uniform4uiv(this.addr,e)}function ZW(t,e,n){let i=this.cache,r=e.length,s=op(n,r);Wt(i,s)||(t.uniform1iv(this.addr,s),jt(i,s));for(let o=0;o!==r;++o)n.setTexture2D(e[o]||GC,s[o])}function JW(t,e,n){let i=this.cache,r=e.length,s=op(n,r);Wt(i,s)||(t.uniform1iv(this.addr,s),jt(i,s));for(let o=0;o!==r;++o)n.setTexture3D(e[o]||$C,s[o])}function ej(t,e,n){let i=this.cache,r=e.length,s=op(n,r);Wt(i,s)||(t.uniform1iv(this.addr,s),jt(i,s));for(let o=0;o!==r;++o)n.setTextureCube(e[o]||qC,s[o])}function tj(t,e,n){let i=this.cache,r=e.length,s=op(n,r);Wt(i,s)||(t.uniform1iv(this.addr,s),jt(i,s));for(let o=0;o!==r;++o)n.setTexture2DArray(e[o]||jC,s[o])}function nj(t){switch(t){case 5126:return FW;case 35664:return UW;case 35665:return VW;case 35666:return BW;case 35674:return zW;case 35675:return HW;case 35676:return GW;case 5124:case 35670:return WW;case 35667:case 35671:return jW;case 35668:case 35672:return $W;case 35669:case 35673:return qW;case 5125:return XW;case 36294:return KW;case 36295:return YW;case 36296:return QW;case 35678:case 36198:case 36298:case 36306:case 35682:return ZW;case 35679:case 36299:case 36307:return JW;case 35680:case 36300:case 36308:case 36293:return ej;case 36289:case 36303:case 36311:case 36292:return tj}}var O0=class{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.setValue=kW(n.type)}},L0=class{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=nj(n.type)}},k0=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,i){let r=this.seq;for(let s=0,o=r.length;s!==o;++s){let a=r[s];a.setValue(e,n[a.id],i)}}},w0=/(\w+)(\])?(\[|\.)?/g;function gC(t,e){t.seq.push(e),t.map[e.id]=e}function ij(t,e,n){let i=t.name,r=i.length;for(w0.lastIndex=0;;){let s=w0.exec(i),o=w0.lastIndex,a=s[1],c=s[2]==="]",u=s[3];if(c&&(a=a|0),u===void 0||u==="["&&o+2===r){gC(n,u===void 0?new O0(a,t,e):new L0(a,t,e));break}else{let d=n.map[a];d===void 0&&(d=new k0(a),gC(n,d)),n=d}}}var ac=class{constructor(e,n){this.seq=[],this.map={};let i=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){let s=e.getActiveUniform(n,r),o=e.getUniformLocation(n,s.name);ij(s,o,this)}}setValue(e,n,i,r){let s=this.map[n];s!==void 0&&s.setValue(e,i,r)}setOptional(e,n,i){let r=n[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,n,i,r){for(let s=0,o=n.length;s!==o;++s){let a=n[s],c=i[a.id];c.needsUpdate!==!1&&a.setValue(e,c.value,r)}}static seqWithValue(e,n){let i=[];for(let r=0,s=e.length;r!==s;++r){let o=e[r];o.id in n&&i.push(o)}return i}};function yC(t,e,n){let i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}var rj=37297,sj=0;function oj(t,e){let n=t.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,n.length);for(let o=r;o<s;o++){let a=o+1;i.push(`${a===e?">":" "} ${a}: ${n[o]}`)}return i.join(`
`)}function aj(t){let e=vt.getPrimaries(vt.workingColorSpace),n=vt.getPrimaries(t),i;switch(e===n?i="":e===Ff&&n===kf?i="LinearDisplayP3ToLinearSRGB":e===kf&&n===Ff&&(i="LinearSRGBToLinearDisplayP3"),t){case Or:case rp:return[i,"LinearTransferOETF"];case cn:case iw:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",t),[i,"LinearTransferOETF"]}}function vC(t,e,n){let i=t.getShaderParameter(e,t.COMPILE_STATUS),r=t.getShaderInfoLog(e).trim();if(i&&r==="")return"";let s=/ERROR: 0:(\d+)/.exec(r);if(s){let o=parseInt(s[1]);return n.toUpperCase()+`

`+r+`

`+oj(t.getShaderSource(e),o)}else return r}function cj(t,e){let n=aj(e);return`vec4 ${t}( vec4 value ) { return ${n[0]}( ${n[1]}( value ) ); }`}function uj(t,e){let n;switch(e){case fz:n="Linear";break;case pz:n="Reinhard";break;case mz:n="OptimizedCineon";break;case gz:n="ACESFilmic";break;case vz:n="AgX";break;case yz:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function lj(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.normalMapTangentSpace||t.clearcoatNormalMap||t.flatShading||t.alphaToCoverage||t.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(nc).join(`
`)}function dj(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(nc).join(`
`)}function hj(t){let e=[];for(let n in t){let i=t[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join(`
`)}function fj(t,e){let n={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){let s=t.getActiveAttrib(e,r),o=s.name,a=1;s.type===t.FLOAT_MAT2&&(a=2),s.type===t.FLOAT_MAT3&&(a=3),s.type===t.FLOAT_MAT4&&(a=4),n[o]={type:s.type,location:t.getAttribLocation(e,o),locationSize:a}}return n}function nc(t){return t!==""}function _C(t,e){let n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function wC(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var pj=/^[ \t]*#include +<([\w\d./]+)>/gm;function F0(t){return t.replace(pj,gj)}var mj=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function gj(t,e){let n=qe[e];if(n===void 0){let i=mj.get(e);if(i!==void 0)n=qe[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return F0(n)}var yj=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function EC(t){return t.replace(yj,vj)}function vj(t,e,n,i){let r="";for(let s=parseInt(e);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function bC(t){let e=`precision ${t.precision} float;
	precision ${t.precision} int;
	precision ${t.precision} sampler2D;
	precision ${t.precision} samplerCube;
	`;return t.isWebGL2&&(e+=`precision ${t.precision} sampler3D;
		precision ${t.precision} sampler2DArray;
		precision ${t.precision} sampler2DShadow;
		precision ${t.precision} samplerCubeShadow;
		precision ${t.precision} sampler2DArrayShadow;
		precision ${t.precision} isampler2D;
		precision ${t.precision} isampler3D;
		precision ${t.precision} isamplerCube;
		precision ${t.precision} isampler2DArray;
		precision ${t.precision} usampler2D;
		precision ${t.precision} usampler3D;
		precision ${t.precision} usamplerCube;
		precision ${t.precision} usampler2DArray;
		`),t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function _j(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===MC?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===z3?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Cr&&(e="SHADOWMAP_TYPE_VSM"),e}function wj(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case cc:case uc:e="ENVMAP_TYPE_CUBE";break;case ip:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Ej(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case uc:e="ENVMAP_MODE_REFRACTION";break}return e}function bj(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case CC:e="ENVMAP_BLENDING_MULTIPLY";break;case dz:e="ENVMAP_BLENDING_MIX";break;case hz:e="ENVMAP_BLENDING_ADD";break}return e}function xj(t){let e=t.envMapCubeUVHeight;if(e===null)return null;let n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:i,maxMip:n}}function Sj(t,e,n,i){let r=t.getContext(),s=n.defines,o=n.vertexShader,a=n.fragmentShader,c=_j(n),u=wj(n),l=Ej(n),d=bj(n),h=xj(n),p=n.isWebGL2?"":lj(n),g=dj(n),y=hj(s),m=r.createProgram(),f,b,_=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(f=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,y].filter(nc).join(`
`),f.length>0&&(f+=`
`),b=[p,"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,y].filter(nc).join(`
`),b.length>0&&(b+=`
`)):(f=[bC(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,y,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+l:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(nc).join(`
`),b=[p,bC(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,y,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.envMap?"#define "+l:"",n.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==bs?"#define TONE_MAPPING":"",n.toneMapping!==bs?qe.tonemapping_pars_fragment:"",n.toneMapping!==bs?uj("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",qe.colorspace_pars_fragment,cj("linearToOutputTexel",n.outputColorSpace),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(nc).join(`
`)),o=F0(o),o=_C(o,n),o=wC(o,n),a=F0(a),a=_C(a,n),a=wC(a,n),o=EC(o),a=EC(a),n.isWebGL2&&n.isRawShaderMaterial!==!0&&(_=`#version 300 es
`,f=[g,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+f,b=["precision mediump sampler2DArray;","#define varying in",n.glslVersion===VM?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===VM?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+b);let v=_+f+o,x=_+b+a,A=yC(r,r.VERTEX_SHADER,v),I=yC(r,r.FRAGMENT_SHADER,x);r.attachShader(m,A),r.attachShader(m,I),n.index0AttributeName!==void 0?r.bindAttribLocation(m,0,n.index0AttributeName):n.morphTargets===!0&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m);function V(j){if(t.debug.checkShaderErrors){let X=r.getProgramInfoLog(m).trim(),D=r.getShaderInfoLog(A).trim(),z=r.getShaderInfoLog(I).trim(),O=!0,K=!0;if(r.getProgramParameter(m,r.LINK_STATUS)===!1)if(O=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(r,m,A,I);else{let W=vC(r,A,"vertex"),q=vC(r,I,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(m,r.VALIDATE_STATUS)+`

Material Name: `+j.name+`
Material Type: `+j.type+`

Program Info Log: `+X+`
`+W+`
`+q)}else X!==""?console.warn("THREE.WebGLProgram: Program Info Log:",X):(D===""||z==="")&&(K=!1);K&&(j.diagnostics={runnable:O,programLog:X,vertexShader:{log:D,prefix:f},fragmentShader:{log:z,prefix:b}})}r.deleteShader(A),r.deleteShader(I),G=new ac(r,m),w=fj(r,m)}let G;this.getUniforms=function(){return G===void 0&&V(this),G};let w;this.getAttributes=function(){return w===void 0&&V(this),w};let M=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return M===!1&&(M=r.getProgramParameter(m,rj)),M},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=sj++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=A,this.fragmentShader=I,this}var Tj=0,U0=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let n=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(n),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){let n=this.materialCache.get(e);for(let i of n)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let n=this.materialCache,i=n.get(e);return i===void 0&&(i=new Set,n.set(e,i)),i}_getShaderStage(e){let n=this.shaderCache,i=n.get(e);return i===void 0&&(i=new V0(e),n.set(e,i)),i}},V0=class{constructor(e){this.id=Tj++,this.code=e,this.usedTimes=0}};function Ij(t,e,n,i,r,s,o){let a=new jf,c=new U0,u=new Set,l=[],d=r.isWebGL2,h=r.logarithmicDepthBuffer,p=r.vertexTextures,g=r.precision,y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(w){return u.add(w),w===0?"uv":`uv${w}`}function f(w,M,j,X,D){let z=X.fog,O=D.geometry,K=w.isMeshStandardMaterial?X.environment:null,W=(w.isMeshStandardMaterial?n:e).get(w.envMap||K),q=W&&W.mapping===ip?W.image.height:null,$=y[w.type];w.precision!==null&&(g=r.getMaxPrecision(w.precision),g!==w.precision&&console.warn("THREE.WebGLProgram.getParameters:",w.precision,"not supported, using",g,"instead."));let ee=O.morphAttributes.position||O.morphAttributes.normal||O.morphAttributes.color,se=ee!==void 0?ee.length:0,Me=0;O.morphAttributes.position!==void 0&&(Me=1),O.morphAttributes.normal!==void 0&&(Me=2),O.morphAttributes.color!==void 0&&(Me=3);let H,Q,ce,we;if($){let Et=Zi[$];H=Et.vertexShader,Q=Et.fragmentShader}else H=w.vertexShader,Q=w.fragmentShader,c.update(w),ce=c.getVertexShaderID(w),we=c.getFragmentShaderID(w);let Te=t.getRenderTarget(),he=D.isInstancedMesh===!0,Ce=D.isBatchedMesh===!0,ke=!!w.map,P=!!w.matcap,Bt=!!W,Ee=!!w.aoMap,de=!!w.lightMap,le=!!w.bumpMap,tt=!!w.normalMap,be=!!w.displacementMap,T=!!w.emissiveMap,E=!!w.metalnessMap,N=!!w.roughnessMap,J=w.anisotropy>0,Y=w.clearcoat>0,te=w.iridescence>0,me=w.sheen>0,ae=w.transmission>0,fe=J&&!!w.anisotropyMap,Re=Y&&!!w.clearcoatMap,Xe=Y&&!!w.clearcoatNormalMap,Z=Y&&!!w.clearcoatRoughnessMap,gt=te&&!!w.iridescenceMap,Je=te&&!!w.iridescenceThicknessMap,Fe=me&&!!w.sheenColorMap,Se=me&&!!w.sheenRoughnessMap,pe=!!w.specularMap,je=!!w.specularColorMap,ft=!!w.specularIntensityMap,xt=ae&&!!w.transmissionMap,nt=ae&&!!w.thicknessMap,_t=!!w.gradientMap,C=!!w.alphaMap,ne=w.alphaTest>0,ie=!!w.alphaHash,ye=!!w.extensions,Ie=bs;w.toneMapped&&(Te===null||Te.isXRRenderTarget===!0)&&(Ie=t.toneMapping);let pt={isWebGL2:d,shaderID:$,shaderType:w.type,shaderName:w.name,vertexShader:H,fragmentShader:Q,defines:w.defines,customVertexShaderID:ce,customFragmentShaderID:we,isRawShaderMaterial:w.isRawShaderMaterial===!0,glslVersion:w.glslVersion,precision:g,batching:Ce,instancing:he,instancingColor:he&&D.instanceColor!==null,supportsVertexTextures:p,outputColorSpace:Te===null?t.outputColorSpace:Te.isXRRenderTarget===!0?Te.texture.colorSpace:Or,alphaToCoverage:!!w.alphaToCoverage,map:ke,matcap:P,envMap:Bt,envMapMode:Bt&&W.mapping,envMapCubeUVHeight:q,aoMap:Ee,lightMap:de,bumpMap:le,normalMap:tt,displacementMap:p&&be,emissiveMap:T,normalMapObjectSpace:tt&&w.normalMapType===Dz,normalMapTangentSpace:tt&&w.normalMapType===Cz,metalnessMap:E,roughnessMap:N,anisotropy:J,anisotropyMap:fe,clearcoat:Y,clearcoatMap:Re,clearcoatNormalMap:Xe,clearcoatRoughnessMap:Z,iridescence:te,iridescenceMap:gt,iridescenceThicknessMap:Je,sheen:me,sheenColorMap:Fe,sheenRoughnessMap:Se,specularMap:pe,specularColorMap:je,specularIntensityMap:ft,transmission:ae,transmissionMap:xt,thicknessMap:nt,gradientMap:_t,opaque:w.transparent===!1&&w.blending===rc&&w.alphaToCoverage===!1,alphaMap:C,alphaTest:ne,alphaHash:ie,combine:w.combine,mapUv:ke&&m(w.map.channel),aoMapUv:Ee&&m(w.aoMap.channel),lightMapUv:de&&m(w.lightMap.channel),bumpMapUv:le&&m(w.bumpMap.channel),normalMapUv:tt&&m(w.normalMap.channel),displacementMapUv:be&&m(w.displacementMap.channel),emissiveMapUv:T&&m(w.emissiveMap.channel),metalnessMapUv:E&&m(w.metalnessMap.channel),roughnessMapUv:N&&m(w.roughnessMap.channel),anisotropyMapUv:fe&&m(w.anisotropyMap.channel),clearcoatMapUv:Re&&m(w.clearcoatMap.channel),clearcoatNormalMapUv:Xe&&m(w.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Z&&m(w.clearcoatRoughnessMap.channel),iridescenceMapUv:gt&&m(w.iridescenceMap.channel),iridescenceThicknessMapUv:Je&&m(w.iridescenceThicknessMap.channel),sheenColorMapUv:Fe&&m(w.sheenColorMap.channel),sheenRoughnessMapUv:Se&&m(w.sheenRoughnessMap.channel),specularMapUv:pe&&m(w.specularMap.channel),specularColorMapUv:je&&m(w.specularColorMap.channel),specularIntensityMapUv:ft&&m(w.specularIntensityMap.channel),transmissionMapUv:xt&&m(w.transmissionMap.channel),thicknessMapUv:nt&&m(w.thicknessMap.channel),alphaMapUv:C&&m(w.alphaMap.channel),vertexTangents:!!O.attributes.tangent&&(tt||J),vertexColors:w.vertexColors,vertexAlphas:w.vertexColors===!0&&!!O.attributes.color&&O.attributes.color.itemSize===4,pointsUvs:D.isPoints===!0&&!!O.attributes.uv&&(ke||C),fog:!!z,useFog:w.fog===!0,fogExp2:!!z&&z.isFogExp2,flatShading:w.flatShading===!0,sizeAttenuation:w.sizeAttenuation===!0,logarithmicDepthBuffer:h,skinning:D.isSkinnedMesh===!0,morphTargets:O.morphAttributes.position!==void 0,morphNormals:O.morphAttributes.normal!==void 0,morphColors:O.morphAttributes.color!==void 0,morphTargetsCount:se,morphTextureStride:Me,numDirLights:M.directional.length,numPointLights:M.point.length,numSpotLights:M.spot.length,numSpotLightMaps:M.spotLightMap.length,numRectAreaLights:M.rectArea.length,numHemiLights:M.hemi.length,numDirLightShadows:M.directionalShadowMap.length,numPointLightShadows:M.pointShadowMap.length,numSpotLightShadows:M.spotShadowMap.length,numSpotLightShadowsWithMaps:M.numSpotLightShadowsWithMaps,numLightProbes:M.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:w.dithering,shadowMapEnabled:t.shadowMap.enabled&&j.length>0,shadowMapType:t.shadowMap.type,toneMapping:Ie,useLegacyLights:t._useLegacyLights,decodeVideoTexture:ke&&w.map.isVideoTexture===!0&&vt.getTransfer(w.map.colorSpace)===Tt,premultipliedAlpha:w.premultipliedAlpha,doubleSided:w.side===Rr,flipSided:w.side===Pn,useDepthPacking:w.depthPacking>=0,depthPacking:w.depthPacking||0,index0AttributeName:w.index0AttributeName,extensionDerivatives:ye&&w.extensions.derivatives===!0,extensionFragDepth:ye&&w.extensions.fragDepth===!0,extensionDrawBuffers:ye&&w.extensions.drawBuffers===!0,extensionShaderTextureLOD:ye&&w.extensions.shaderTextureLOD===!0,extensionClipCullDistance:ye&&w.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:ye&&w.extensions.multiDraw===!0&&i.has("WEBGL_multi_draw"),rendererExtensionFragDepth:d||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||i.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:w.customProgramCacheKey()};return pt.vertexUv1s=u.has(1),pt.vertexUv2s=u.has(2),pt.vertexUv3s=u.has(3),u.clear(),pt}function b(w){let M=[];if(w.shaderID?M.push(w.shaderID):(M.push(w.customVertexShaderID),M.push(w.customFragmentShaderID)),w.defines!==void 0)for(let j in w.defines)M.push(j),M.push(w.defines[j]);return w.isRawShaderMaterial===!1&&(_(M,w),v(M,w),M.push(t.outputColorSpace)),M.push(w.customProgramCacheKey),M.join()}function _(w,M){w.push(M.precision),w.push(M.outputColorSpace),w.push(M.envMapMode),w.push(M.envMapCubeUVHeight),w.push(M.mapUv),w.push(M.alphaMapUv),w.push(M.lightMapUv),w.push(M.aoMapUv),w.push(M.bumpMapUv),w.push(M.normalMapUv),w.push(M.displacementMapUv),w.push(M.emissiveMapUv),w.push(M.metalnessMapUv),w.push(M.roughnessMapUv),w.push(M.anisotropyMapUv),w.push(M.clearcoatMapUv),w.push(M.clearcoatNormalMapUv),w.push(M.clearcoatRoughnessMapUv),w.push(M.iridescenceMapUv),w.push(M.iridescenceThicknessMapUv),w.push(M.sheenColorMapUv),w.push(M.sheenRoughnessMapUv),w.push(M.specularMapUv),w.push(M.specularColorMapUv),w.push(M.specularIntensityMapUv),w.push(M.transmissionMapUv),w.push(M.thicknessMapUv),w.push(M.combine),w.push(M.fogExp2),w.push(M.sizeAttenuation),w.push(M.morphTargetsCount),w.push(M.morphAttributeCount),w.push(M.numDirLights),w.push(M.numPointLights),w.push(M.numSpotLights),w.push(M.numSpotLightMaps),w.push(M.numHemiLights),w.push(M.numRectAreaLights),w.push(M.numDirLightShadows),w.push(M.numPointLightShadows),w.push(M.numSpotLightShadows),w.push(M.numSpotLightShadowsWithMaps),w.push(M.numLightProbes),w.push(M.shadowMapType),w.push(M.toneMapping),w.push(M.numClippingPlanes),w.push(M.numClipIntersection),w.push(M.depthPacking)}function v(w,M){a.disableAll(),M.isWebGL2&&a.enable(0),M.supportsVertexTextures&&a.enable(1),M.instancing&&a.enable(2),M.instancingColor&&a.enable(3),M.matcap&&a.enable(4),M.envMap&&a.enable(5),M.normalMapObjectSpace&&a.enable(6),M.normalMapTangentSpace&&a.enable(7),M.clearcoat&&a.enable(8),M.iridescence&&a.enable(9),M.alphaTest&&a.enable(10),M.vertexColors&&a.enable(11),M.vertexAlphas&&a.enable(12),M.vertexUv1s&&a.enable(13),M.vertexUv2s&&a.enable(14),M.vertexUv3s&&a.enable(15),M.vertexTangents&&a.enable(16),M.anisotropy&&a.enable(17),M.alphaHash&&a.enable(18),M.batching&&a.enable(19),w.push(a.mask),a.disableAll(),M.fog&&a.enable(0),M.useFog&&a.enable(1),M.flatShading&&a.enable(2),M.logarithmicDepthBuffer&&a.enable(3),M.skinning&&a.enable(4),M.morphTargets&&a.enable(5),M.morphNormals&&a.enable(6),M.morphColors&&a.enable(7),M.premultipliedAlpha&&a.enable(8),M.shadowMapEnabled&&a.enable(9),M.useLegacyLights&&a.enable(10),M.doubleSided&&a.enable(11),M.flipSided&&a.enable(12),M.useDepthPacking&&a.enable(13),M.dithering&&a.enable(14),M.transmission&&a.enable(15),M.sheen&&a.enable(16),M.opaque&&a.enable(17),M.pointsUvs&&a.enable(18),M.decodeVideoTexture&&a.enable(19),M.alphaToCoverage&&a.enable(20),w.push(a.mask)}function x(w){let M=y[w.type],j;if(M){let X=Zi[M];j=mH.clone(X.uniforms)}else j=w.uniforms;return j}function A(w,M){let j;for(let X=0,D=l.length;X<D;X++){let z=l[X];if(z.cacheKey===M){j=z,++j.usedTimes;break}}return j===void 0&&(j=new Sj(t,M,w,s),l.push(j)),j}function I(w){if(--w.usedTimes===0){let M=l.indexOf(w);l[M]=l[l.length-1],l.pop(),w.destroy()}}function V(w){c.remove(w)}function G(){c.dispose()}return{getParameters:f,getProgramCacheKey:b,getUniforms:x,acquireProgram:A,releaseProgram:I,releaseShaderCache:V,programs:l,dispose:G}}function Aj(){let t=new WeakMap;function e(s){let o=t.get(s);return o===void 0&&(o={},t.set(s,o)),o}function n(s){t.delete(s)}function i(s,o,a){t.get(s)[o]=a}function r(){t=new WeakMap}return{get:e,remove:n,update:i,dispose:r}}function Mj(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function xC(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function SC(){let t=[],e=0,n=[],i=[],r=[];function s(){e=0,n.length=0,i.length=0,r.length=0}function o(d,h,p,g,y,m){let f=t[e];return f===void 0?(f={id:d.id,object:d,geometry:h,material:p,groupOrder:g,renderOrder:d.renderOrder,z:y,group:m},t[e]=f):(f.id=d.id,f.object=d,f.geometry=h,f.material=p,f.groupOrder=g,f.renderOrder=d.renderOrder,f.z=y,f.group=m),e++,f}function a(d,h,p,g,y,m){let f=o(d,h,p,g,y,m);p.transmission>0?i.push(f):p.transparent===!0?r.push(f):n.push(f)}function c(d,h,p,g,y,m){let f=o(d,h,p,g,y,m);p.transmission>0?i.unshift(f):p.transparent===!0?r.unshift(f):n.unshift(f)}function u(d,h){n.length>1&&n.sort(d||Mj),i.length>1&&i.sort(h||xC),r.length>1&&r.sort(h||xC)}function l(){for(let d=e,h=t.length;d<h;d++){let p=t[d];if(p.id===null)break;p.id=null,p.object=null,p.geometry=null,p.material=null,p.group=null}}return{opaque:n,transmissive:i,transparent:r,init:s,push:a,unshift:c,finish:l,sort:u}}function Cj(){let t=new WeakMap;function e(i,r){let s=t.get(i),o;return s===void 0?(o=new SC,t.set(i,[o])):r>=s.length?(o=new SC,s.push(o)):o=s[r],o}function n(){t=new WeakMap}return{get:e,dispose:n}}function Dj(){let t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new k,color:new lt};break;case"SpotLight":n={position:new k,direction:new k,color:new lt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new k,color:new lt,distance:0,decay:0};break;case"HemisphereLight":n={direction:new k,skyColor:new lt,groundColor:new lt};break;case"RectAreaLight":n={color:new lt,position:new k,halfWidth:new k,halfHeight:new k};break}return t[e.id]=n,n}}}function Rj(){let t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ht};break;case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ht};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ht,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}var Pj=0;function Nj(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function Oj(t,e){let n=new Dj,i=Rj(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let l=0;l<9;l++)r.probe.push(new k);let s=new k,o=new ln,a=new ln;function c(l,d){let h=0,p=0,g=0;for(let j=0;j<9;j++)r.probe[j].set(0,0,0);let y=0,m=0,f=0,b=0,_=0,v=0,x=0,A=0,I=0,V=0,G=0;l.sort(Nj);let w=d===!0?Math.PI:1;for(let j=0,X=l.length;j<X;j++){let D=l[j],z=D.color,O=D.intensity,K=D.distance,W=D.shadow&&D.shadow.map?D.shadow.map.texture:null;if(D.isAmbientLight)h+=z.r*O*w,p+=z.g*O*w,g+=z.b*O*w;else if(D.isLightProbe){for(let q=0;q<9;q++)r.probe[q].addScaledVector(D.sh.coefficients[q],O);G++}else if(D.isDirectionalLight){let q=n.get(D);if(q.color.copy(D.color).multiplyScalar(D.intensity*w),D.castShadow){let $=D.shadow,ee=i.get(D);ee.shadowBias=$.bias,ee.shadowNormalBias=$.normalBias,ee.shadowRadius=$.radius,ee.shadowMapSize=$.mapSize,r.directionalShadow[y]=ee,r.directionalShadowMap[y]=W,r.directionalShadowMatrix[y]=D.shadow.matrix,v++}r.directional[y]=q,y++}else if(D.isSpotLight){let q=n.get(D);q.position.setFromMatrixPosition(D.matrixWorld),q.color.copy(z).multiplyScalar(O*w),q.distance=K,q.coneCos=Math.cos(D.angle),q.penumbraCos=Math.cos(D.angle*(1-D.penumbra)),q.decay=D.decay,r.spot[f]=q;let $=D.shadow;if(D.map&&(r.spotLightMap[I]=D.map,I++,$.updateMatrices(D),D.castShadow&&V++),r.spotLightMatrix[f]=$.matrix,D.castShadow){let ee=i.get(D);ee.shadowBias=$.bias,ee.shadowNormalBias=$.normalBias,ee.shadowRadius=$.radius,ee.shadowMapSize=$.mapSize,r.spotShadow[f]=ee,r.spotShadowMap[f]=W,A++}f++}else if(D.isRectAreaLight){let q=n.get(D);q.color.copy(z).multiplyScalar(O),q.halfWidth.set(D.width*.5,0,0),q.halfHeight.set(0,D.height*.5,0),r.rectArea[b]=q,b++}else if(D.isPointLight){let q=n.get(D);if(q.color.copy(D.color).multiplyScalar(D.intensity*w),q.distance=D.distance,q.decay=D.decay,D.castShadow){let $=D.shadow,ee=i.get(D);ee.shadowBias=$.bias,ee.shadowNormalBias=$.normalBias,ee.shadowRadius=$.radius,ee.shadowMapSize=$.mapSize,ee.shadowCameraNear=$.camera.near,ee.shadowCameraFar=$.camera.far,r.pointShadow[m]=ee,r.pointShadowMap[m]=W,r.pointShadowMatrix[m]=D.shadow.matrix,x++}r.point[m]=q,m++}else if(D.isHemisphereLight){let q=n.get(D);q.skyColor.copy(D.color).multiplyScalar(O*w),q.groundColor.copy(D.groundColor).multiplyScalar(O*w),r.hemi[_]=q,_++}}b>0&&(e.isWebGL2?t.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=re.LTC_FLOAT_1,r.rectAreaLTC2=re.LTC_FLOAT_2):(r.rectAreaLTC1=re.LTC_HALF_1,r.rectAreaLTC2=re.LTC_HALF_2):t.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=re.LTC_FLOAT_1,r.rectAreaLTC2=re.LTC_FLOAT_2):t.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=re.LTC_HALF_1,r.rectAreaLTC2=re.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=h,r.ambient[1]=p,r.ambient[2]=g;let M=r.hash;(M.directionalLength!==y||M.pointLength!==m||M.spotLength!==f||M.rectAreaLength!==b||M.hemiLength!==_||M.numDirectionalShadows!==v||M.numPointShadows!==x||M.numSpotShadows!==A||M.numSpotMaps!==I||M.numLightProbes!==G)&&(r.directional.length=y,r.spot.length=f,r.rectArea.length=b,r.point.length=m,r.hemi.length=_,r.directionalShadow.length=v,r.directionalShadowMap.length=v,r.pointShadow.length=x,r.pointShadowMap.length=x,r.spotShadow.length=A,r.spotShadowMap.length=A,r.directionalShadowMatrix.length=v,r.pointShadowMatrix.length=x,r.spotLightMatrix.length=A+I-V,r.spotLightMap.length=I,r.numSpotLightShadowsWithMaps=V,r.numLightProbes=G,M.directionalLength=y,M.pointLength=m,M.spotLength=f,M.rectAreaLength=b,M.hemiLength=_,M.numDirectionalShadows=v,M.numPointShadows=x,M.numSpotShadows=A,M.numSpotMaps=I,M.numLightProbes=G,r.version=Pj++)}function u(l,d){let h=0,p=0,g=0,y=0,m=0,f=d.matrixWorldInverse;for(let b=0,_=l.length;b<_;b++){let v=l[b];if(v.isDirectionalLight){let x=r.directional[h];x.direction.setFromMatrixPosition(v.matrixWorld),s.setFromMatrixPosition(v.target.matrixWorld),x.direction.sub(s),x.direction.transformDirection(f),h++}else if(v.isSpotLight){let x=r.spot[g];x.position.setFromMatrixPosition(v.matrixWorld),x.position.applyMatrix4(f),x.direction.setFromMatrixPosition(v.matrixWorld),s.setFromMatrixPosition(v.target.matrixWorld),x.direction.sub(s),x.direction.transformDirection(f),g++}else if(v.isRectAreaLight){let x=r.rectArea[y];x.position.setFromMatrixPosition(v.matrixWorld),x.position.applyMatrix4(f),a.identity(),o.copy(v.matrixWorld),o.premultiply(f),a.extractRotation(o),x.halfWidth.set(v.width*.5,0,0),x.halfHeight.set(0,v.height*.5,0),x.halfWidth.applyMatrix4(a),x.halfHeight.applyMatrix4(a),y++}else if(v.isPointLight){let x=r.point[p];x.position.setFromMatrixPosition(v.matrixWorld),x.position.applyMatrix4(f),p++}else if(v.isHemisphereLight){let x=r.hemi[m];x.direction.setFromMatrixPosition(v.matrixWorld),x.direction.transformDirection(f),m++}}}return{setup:c,setupView:u,state:r}}function TC(t,e){let n=new Oj(t,e),i=[],r=[];function s(){i.length=0,r.length=0}function o(d){i.push(d)}function a(d){r.push(d)}function c(d){n.setup(i,d)}function u(d){n.setupView(i,d)}return{init:s,state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:c,setupLightsView:u,pushLight:o,pushShadow:a}}function Lj(t,e){let n=new WeakMap;function i(s,o=0){let a=n.get(s),c;return a===void 0?(c=new TC(t,e),n.set(s,[c])):o>=a.length?(c=new TC(t,e),a.push(c)):c=a[o],c}function r(){n=new WeakMap}return{get:i,dispose:r}}var B0=class extends Mo{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Az,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},z0=class extends Mo{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},kj=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Fj=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Uj(t,e,n){let i=new Qf,r=new ht,s=new ht,o=new un,a=new B0({depthPacking:Mz}),c=new z0,u={},l=n.maxTextureSize,d={[Ss]:Pn,[Pn]:Ss,[Rr]:Rr},h=new er({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ht},radius:{value:4}},vertexShader:kj,fragmentShader:Fj}),p=h.clone();p.defines.HORIZONTAL_PASS=1;let g=new Ji;g.setAttribute("position",new si(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let y=new Si(g,h),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=MC;let f=this.type;this.render=function(A,I,V){if(m.enabled===!1||m.autoUpdate===!1&&m.needsUpdate===!1||A.length===0)return;let G=t.getRenderTarget(),w=t.getActiveCubeFace(),M=t.getActiveMipmapLevel(),j=t.state;j.setBlending(Es),j.buffers.color.setClear(1,1,1,1),j.buffers.depth.setTest(!0),j.setScissorTest(!1);let X=f!==Cr&&this.type===Cr,D=f===Cr&&this.type!==Cr;for(let z=0,O=A.length;z<O;z++){let K=A[z],W=K.shadow;if(W===void 0){console.warn("THREE.WebGLShadowMap:",K,"has no shadow.");continue}if(W.autoUpdate===!1&&W.needsUpdate===!1)continue;r.copy(W.mapSize);let q=W.getFrameExtents();if(r.multiply(q),s.copy(W.mapSize),(r.x>l||r.y>l)&&(r.x>l&&(s.x=Math.floor(l/q.x),r.x=s.x*q.x,W.mapSize.x=s.x),r.y>l&&(s.y=Math.floor(l/q.y),r.y=s.y*q.y,W.mapSize.y=s.y)),W.map===null||X===!0||D===!0){let ee=this.type!==Cr?{minFilter:xn,magFilter:xn}:{};W.map!==null&&W.map.dispose(),W.map=new Lr(r.x,r.y,ee),W.map.texture.name=K.name+".shadowMap",W.camera.updateProjectionMatrix()}t.setRenderTarget(W.map),t.clear();let $=W.getViewportCount();for(let ee=0;ee<$;ee++){let se=W.getViewport(ee);o.set(s.x*se.x,s.y*se.y,s.x*se.z,s.y*se.w),j.viewport(o),W.updateMatrices(K,ee),i=W.getFrustum(),v(I,V,W.camera,K,this.type)}W.isPointLightShadow!==!0&&this.type===Cr&&b(W,V),W.needsUpdate=!1}f=this.type,m.needsUpdate=!1,t.setRenderTarget(G,w,M)};function b(A,I){let V=e.update(y);h.defines.VSM_SAMPLES!==A.blurSamples&&(h.defines.VSM_SAMPLES=A.blurSamples,p.defines.VSM_SAMPLES=A.blurSamples,h.needsUpdate=!0,p.needsUpdate=!0),A.mapPass===null&&(A.mapPass=new Lr(r.x,r.y)),h.uniforms.shadow_pass.value=A.map.texture,h.uniforms.resolution.value=A.mapSize,h.uniforms.radius.value=A.radius,t.setRenderTarget(A.mapPass),t.clear(),t.renderBufferDirect(I,null,V,h,y,null),p.uniforms.shadow_pass.value=A.mapPass.texture,p.uniforms.resolution.value=A.mapSize,p.uniforms.radius.value=A.radius,t.setRenderTarget(A.map),t.clear(),t.renderBufferDirect(I,null,V,p,y,null)}function _(A,I,V,G){let w=null,M=V.isPointLight===!0?A.customDistanceMaterial:A.customDepthMaterial;if(M!==void 0)w=M;else if(w=V.isPointLight===!0?c:a,t.localClippingEnabled&&I.clipShadows===!0&&Array.isArray(I.clippingPlanes)&&I.clippingPlanes.length!==0||I.displacementMap&&I.displacementScale!==0||I.alphaMap&&I.alphaTest>0||I.map&&I.alphaTest>0){let j=w.uuid,X=I.uuid,D=u[j];D===void 0&&(D={},u[j]=D);let z=D[X];z===void 0&&(z=w.clone(),D[X]=z,I.addEventListener("dispose",x)),w=z}if(w.visible=I.visible,w.wireframe=I.wireframe,G===Cr?w.side=I.shadowSide!==null?I.shadowSide:I.side:w.side=I.shadowSide!==null?I.shadowSide:d[I.side],w.alphaMap=I.alphaMap,w.alphaTest=I.alphaTest,w.map=I.map,w.clipShadows=I.clipShadows,w.clippingPlanes=I.clippingPlanes,w.clipIntersection=I.clipIntersection,w.displacementMap=I.displacementMap,w.displacementScale=I.displacementScale,w.displacementBias=I.displacementBias,w.wireframeLinewidth=I.wireframeLinewidth,w.linewidth=I.linewidth,V.isPointLight===!0&&w.isMeshDistanceMaterial===!0){let j=t.properties.get(w);j.light=V}return w}function v(A,I,V,G,w){if(A.visible===!1)return;if(A.layers.test(I.layers)&&(A.isMesh||A.isLine||A.isPoints)&&(A.castShadow||A.receiveShadow&&w===Cr)&&(!A.frustumCulled||i.intersectsObject(A))){A.modelViewMatrix.multiplyMatrices(V.matrixWorldInverse,A.matrixWorld);let X=e.update(A),D=A.material;if(Array.isArray(D)){let z=X.groups;for(let O=0,K=z.length;O<K;O++){let W=z[O],q=D[W.materialIndex];if(q&&q.visible){let $=_(A,q,G,w);A.onBeforeShadow(t,A,I,V,X,$,W),t.renderBufferDirect(V,null,X,$,A,W),A.onAfterShadow(t,A,I,V,X,$,W)}}}else if(D.visible){let z=_(A,D,G,w);A.onBeforeShadow(t,A,I,V,X,z,null),t.renderBufferDirect(V,null,X,z,A,null),A.onAfterShadow(t,A,I,V,X,z,null)}}let j=A.children;for(let X=0,D=j.length;X<D;X++)v(j[X],I,V,G,w)}function x(A){A.target.removeEventListener("dispose",x);for(let V in u){let G=u[V],w=A.target.uuid;w in G&&(G[w].dispose(),delete G[w])}}}function Vj(t,e,n){let i=n.isWebGL2;function r(){let C=!1,ne=new un,ie=null,ye=new un(0,0,0,0);return{setMask:function(Ie){ie!==Ie&&!C&&(t.colorMask(Ie,Ie,Ie,Ie),ie=Ie)},setLocked:function(Ie){C=Ie},setClear:function(Ie,pt,Et,en,jn){jn===!0&&(Ie*=en,pt*=en,Et*=en),ne.set(Ie,pt,Et,en),ye.equals(ne)===!1&&(t.clearColor(Ie,pt,Et,en),ye.copy(ne))},reset:function(){C=!1,ie=null,ye.set(-1,0,0,0)}}}function s(){let C=!1,ne=null,ie=null,ye=null;return{setTest:function(Ie){Ie?he(t.DEPTH_TEST):Ce(t.DEPTH_TEST)},setMask:function(Ie){ne!==Ie&&!C&&(t.depthMask(Ie),ne=Ie)},setFunc:function(Ie){if(ie!==Ie){switch(Ie){case rz:t.depthFunc(t.NEVER);break;case sz:t.depthFunc(t.ALWAYS);break;case oz:t.depthFunc(t.LESS);break;case Pf:t.depthFunc(t.LEQUAL);break;case az:t.depthFunc(t.EQUAL);break;case cz:t.depthFunc(t.GEQUAL);break;case uz:t.depthFunc(t.GREATER);break;case lz:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}ie=Ie}},setLocked:function(Ie){C=Ie},setClear:function(Ie){ye!==Ie&&(t.clearDepth(Ie),ye=Ie)},reset:function(){C=!1,ne=null,ie=null,ye=null}}}function o(){let C=!1,ne=null,ie=null,ye=null,Ie=null,pt=null,Et=null,en=null,jn=null;return{setTest:function(bt){C||(bt?he(t.STENCIL_TEST):Ce(t.STENCIL_TEST))},setMask:function(bt){ne!==bt&&!C&&(t.stencilMask(bt),ne=bt)},setFunc:function(bt,vn,Mi){(ie!==bt||ye!==vn||Ie!==Mi)&&(t.stencilFunc(bt,vn,Mi),ie=bt,ye=vn,Ie=Mi)},setOp:function(bt,vn,Mi){(pt!==bt||Et!==vn||en!==Mi)&&(t.stencilOp(bt,vn,Mi),pt=bt,Et=vn,en=Mi)},setLocked:function(bt){C=bt},setClear:function(bt){jn!==bt&&(t.clearStencil(bt),jn=bt)},reset:function(){C=!1,ne=null,ie=null,ye=null,Ie=null,pt=null,Et=null,en=null,jn=null}}}let a=new r,c=new s,u=new o,l=new WeakMap,d=new WeakMap,h={},p={},g=new WeakMap,y=[],m=null,f=!1,b=null,_=null,v=null,x=null,A=null,I=null,V=null,G=new lt(0,0,0),w=0,M=!1,j=null,X=null,D=null,z=null,O=null,K=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),W=!1,q=0,$=t.getParameter(t.VERSION);$.indexOf("WebGL")!==-1?(q=parseFloat(/^WebGL (\d)/.exec($)[1]),W=q>=1):$.indexOf("OpenGL ES")!==-1&&(q=parseFloat(/^OpenGL ES (\d)/.exec($)[1]),W=q>=2);let ee=null,se={},Me=t.getParameter(t.SCISSOR_BOX),H=t.getParameter(t.VIEWPORT),Q=new un().fromArray(Me),ce=new un().fromArray(H);function we(C,ne,ie,ye){let Ie=new Uint8Array(4),pt=t.createTexture();t.bindTexture(C,pt),t.texParameteri(C,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(C,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let Et=0;Et<ie;Et++)i&&(C===t.TEXTURE_3D||C===t.TEXTURE_2D_ARRAY)?t.texImage3D(ne,0,t.RGBA,1,1,ye,0,t.RGBA,t.UNSIGNED_BYTE,Ie):t.texImage2D(ne+Et,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,Ie);return pt}let Te={};Te[t.TEXTURE_2D]=we(t.TEXTURE_2D,t.TEXTURE_2D,1),Te[t.TEXTURE_CUBE_MAP]=we(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(Te[t.TEXTURE_2D_ARRAY]=we(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),Te[t.TEXTURE_3D]=we(t.TEXTURE_3D,t.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),c.setClear(1),u.setClear(0),he(t.DEPTH_TEST),c.setFunc(Pf),be(!1),T(tM),he(t.CULL_FACE),le(Es);function he(C){h[C]!==!0&&(t.enable(C),h[C]=!0)}function Ce(C){h[C]!==!1&&(t.disable(C),h[C]=!1)}function ke(C,ne){return p[C]!==ne?(t.bindFramebuffer(C,ne),p[C]=ne,i&&(C===t.DRAW_FRAMEBUFFER&&(p[t.FRAMEBUFFER]=ne),C===t.FRAMEBUFFER&&(p[t.DRAW_FRAMEBUFFER]=ne)),!0):!1}function P(C,ne){let ie=y,ye=!1;if(C)if(ie=g.get(ne),ie===void 0&&(ie=[],g.set(ne,ie)),C.isWebGLMultipleRenderTargets){let Ie=C.texture;if(ie.length!==Ie.length||ie[0]!==t.COLOR_ATTACHMENT0){for(let pt=0,Et=Ie.length;pt<Et;pt++)ie[pt]=t.COLOR_ATTACHMENT0+pt;ie.length=Ie.length,ye=!0}}else ie[0]!==t.COLOR_ATTACHMENT0&&(ie[0]=t.COLOR_ATTACHMENT0,ye=!0);else ie[0]!==t.BACK&&(ie[0]=t.BACK,ye=!0);ye&&(n.isWebGL2?t.drawBuffers(ie):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(ie))}function Bt(C){return m!==C?(t.useProgram(C),m=C,!0):!1}let Ee={[Eo]:t.FUNC_ADD,[G3]:t.FUNC_SUBTRACT,[W3]:t.FUNC_REVERSE_SUBTRACT};if(i)Ee[sM]=t.MIN,Ee[oM]=t.MAX;else{let C=e.get("EXT_blend_minmax");C!==null&&(Ee[sM]=C.MIN_EXT,Ee[oM]=C.MAX_EXT)}let de={[j3]:t.ZERO,[$3]:t.ONE,[q3]:t.SRC_COLOR,[E0]:t.SRC_ALPHA,[J3]:t.SRC_ALPHA_SATURATE,[Q3]:t.DST_COLOR,[K3]:t.DST_ALPHA,[X3]:t.ONE_MINUS_SRC_COLOR,[b0]:t.ONE_MINUS_SRC_ALPHA,[Z3]:t.ONE_MINUS_DST_COLOR,[Y3]:t.ONE_MINUS_DST_ALPHA,[ez]:t.CONSTANT_COLOR,[tz]:t.ONE_MINUS_CONSTANT_COLOR,[nz]:t.CONSTANT_ALPHA,[iz]:t.ONE_MINUS_CONSTANT_ALPHA};function le(C,ne,ie,ye,Ie,pt,Et,en,jn,bt){if(C===Es){f===!0&&(Ce(t.BLEND),f=!1);return}if(f===!1&&(he(t.BLEND),f=!0),C!==H3){if(C!==b||bt!==M){if((_!==Eo||A!==Eo)&&(t.blendEquation(t.FUNC_ADD),_=Eo,A=Eo),bt)switch(C){case rc:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case nM:t.blendFunc(t.ONE,t.ONE);break;case iM:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case rM:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",C);break}else switch(C){case rc:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case nM:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case iM:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case rM:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",C);break}v=null,x=null,I=null,V=null,G.set(0,0,0),w=0,b=C,M=bt}return}Ie=Ie||ne,pt=pt||ie,Et=Et||ye,(ne!==_||Ie!==A)&&(t.blendEquationSeparate(Ee[ne],Ee[Ie]),_=ne,A=Ie),(ie!==v||ye!==x||pt!==I||Et!==V)&&(t.blendFuncSeparate(de[ie],de[ye],de[pt],de[Et]),v=ie,x=ye,I=pt,V=Et),(en.equals(G)===!1||jn!==w)&&(t.blendColor(en.r,en.g,en.b,jn),G.copy(en),w=jn),b=C,M=!1}function tt(C,ne){C.side===Rr?Ce(t.CULL_FACE):he(t.CULL_FACE);let ie=C.side===Pn;ne&&(ie=!ie),be(ie),C.blending===rc&&C.transparent===!1?le(Es):le(C.blending,C.blendEquation,C.blendSrc,C.blendDst,C.blendEquationAlpha,C.blendSrcAlpha,C.blendDstAlpha,C.blendColor,C.blendAlpha,C.premultipliedAlpha),c.setFunc(C.depthFunc),c.setTest(C.depthTest),c.setMask(C.depthWrite),a.setMask(C.colorWrite);let ye=C.stencilWrite;u.setTest(ye),ye&&(u.setMask(C.stencilWriteMask),u.setFunc(C.stencilFunc,C.stencilRef,C.stencilFuncMask),u.setOp(C.stencilFail,C.stencilZFail,C.stencilZPass)),N(C.polygonOffset,C.polygonOffsetFactor,C.polygonOffsetUnits),C.alphaToCoverage===!0?he(t.SAMPLE_ALPHA_TO_COVERAGE):Ce(t.SAMPLE_ALPHA_TO_COVERAGE)}function be(C){j!==C&&(C?t.frontFace(t.CW):t.frontFace(t.CCW),j=C)}function T(C){C!==V3?(he(t.CULL_FACE),C!==X&&(C===tM?t.cullFace(t.BACK):C===B3?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):Ce(t.CULL_FACE),X=C}function E(C){C!==D&&(W&&t.lineWidth(C),D=C)}function N(C,ne,ie){C?(he(t.POLYGON_OFFSET_FILL),(z!==ne||O!==ie)&&(t.polygonOffset(ne,ie),z=ne,O=ie)):Ce(t.POLYGON_OFFSET_FILL)}function J(C){C?he(t.SCISSOR_TEST):Ce(t.SCISSOR_TEST)}function Y(C){C===void 0&&(C=t.TEXTURE0+K-1),ee!==C&&(t.activeTexture(C),ee=C)}function te(C,ne,ie){ie===void 0&&(ee===null?ie=t.TEXTURE0+K-1:ie=ee);let ye=se[ie];ye===void 0&&(ye={type:void 0,texture:void 0},se[ie]=ye),(ye.type!==C||ye.texture!==ne)&&(ee!==ie&&(t.activeTexture(ie),ee=ie),t.bindTexture(C,ne||Te[C]),ye.type=C,ye.texture=ne)}function me(){let C=se[ee];C!==void 0&&C.type!==void 0&&(t.bindTexture(C.type,null),C.type=void 0,C.texture=void 0)}function ae(){try{t.compressedTexImage2D.apply(t,arguments)}catch(C){console.error("THREE.WebGLState:",C)}}function fe(){try{t.compressedTexImage3D.apply(t,arguments)}catch(C){console.error("THREE.WebGLState:",C)}}function Re(){try{t.texSubImage2D.apply(t,arguments)}catch(C){console.error("THREE.WebGLState:",C)}}function Xe(){try{t.texSubImage3D.apply(t,arguments)}catch(C){console.error("THREE.WebGLState:",C)}}function Z(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(C){console.error("THREE.WebGLState:",C)}}function gt(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(C){console.error("THREE.WebGLState:",C)}}function Je(){try{t.texStorage2D.apply(t,arguments)}catch(C){console.error("THREE.WebGLState:",C)}}function Fe(){try{t.texStorage3D.apply(t,arguments)}catch(C){console.error("THREE.WebGLState:",C)}}function Se(){try{t.texImage2D.apply(t,arguments)}catch(C){console.error("THREE.WebGLState:",C)}}function pe(){try{t.texImage3D.apply(t,arguments)}catch(C){console.error("THREE.WebGLState:",C)}}function je(C){Q.equals(C)===!1&&(t.scissor(C.x,C.y,C.z,C.w),Q.copy(C))}function ft(C){ce.equals(C)===!1&&(t.viewport(C.x,C.y,C.z,C.w),ce.copy(C))}function xt(C,ne){let ie=d.get(ne);ie===void 0&&(ie=new WeakMap,d.set(ne,ie));let ye=ie.get(C);ye===void 0&&(ye=t.getUniformBlockIndex(ne,C.name),ie.set(C,ye))}function nt(C,ne){let ye=d.get(ne).get(C);l.get(ne)!==ye&&(t.uniformBlockBinding(ne,ye,C.__bindingPointIndex),l.set(ne,ye))}function _t(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),i===!0&&(t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),h={},ee=null,se={},p={},g=new WeakMap,y=[],m=null,f=!1,b=null,_=null,v=null,x=null,A=null,I=null,V=null,G=new lt(0,0,0),w=0,M=!1,j=null,X=null,D=null,z=null,O=null,Q.set(0,0,t.canvas.width,t.canvas.height),ce.set(0,0,t.canvas.width,t.canvas.height),a.reset(),c.reset(),u.reset()}return{buffers:{color:a,depth:c,stencil:u},enable:he,disable:Ce,bindFramebuffer:ke,drawBuffers:P,useProgram:Bt,setBlending:le,setMaterial:tt,setFlipSided:be,setCullFace:T,setLineWidth:E,setPolygonOffset:N,setScissorTest:J,activeTexture:Y,bindTexture:te,unbindTexture:me,compressedTexImage2D:ae,compressedTexImage3D:fe,texImage2D:Se,texImage3D:pe,updateUBOMapping:xt,uniformBlockBinding:nt,texStorage2D:Je,texStorage3D:Fe,texSubImage2D:Re,texSubImage3D:Xe,compressedTexSubImage2D:Z,compressedTexSubImage3D:gt,scissor:je,viewport:ft,reset:_t}}function Bj(t,e,n,i,r,s,o){let a=r.isWebGL2,c=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,u=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),l=new WeakMap,d,h=new WeakMap,p=!1;try{p=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function g(T,E){return p?new OffscreenCanvas(T,E):Bf("canvas")}function y(T,E,N,J){let Y=1;if((T.width>J||T.height>J)&&(Y=J/Math.max(T.width,T.height)),Y<1||E===!0)if(typeof HTMLImageElement<"u"&&T instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&T instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&T instanceof ImageBitmap){let te=E?Vf:Math.floor,me=te(Y*T.width),ae=te(Y*T.height);d===void 0&&(d=g(me,ae));let fe=N?g(me,ae):d;return fe.width=me,fe.height=ae,fe.getContext("2d").drawImage(T,0,0,me,ae),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+T.width+"x"+T.height+") to ("+me+"x"+ae+")."),fe}else return"data"in T&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+T.width+"x"+T.height+")."),T;return T}function m(T){return M0(T.width)&&M0(T.height)}function f(T){return a?!1:T.wrapS!==bi||T.wrapT!==bi||T.minFilter!==xn&&T.minFilter!==Rn}function b(T,E){return T.generateMipmaps&&E&&T.minFilter!==xn&&T.minFilter!==Rn}function _(T){t.generateMipmap(T)}function v(T,E,N,J,Y=!1){if(a===!1)return E;if(T!==null){if(t[T]!==void 0)return t[T];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+T+"'")}let te=E;if(E===t.RED&&(N===t.FLOAT&&(te=t.R32F),N===t.HALF_FLOAT&&(te=t.R16F),N===t.UNSIGNED_BYTE&&(te=t.R8)),E===t.RED_INTEGER&&(N===t.UNSIGNED_BYTE&&(te=t.R8UI),N===t.UNSIGNED_SHORT&&(te=t.R16UI),N===t.UNSIGNED_INT&&(te=t.R32UI),N===t.BYTE&&(te=t.R8I),N===t.SHORT&&(te=t.R16I),N===t.INT&&(te=t.R32I)),E===t.RG&&(N===t.FLOAT&&(te=t.RG32F),N===t.HALF_FLOAT&&(te=t.RG16F),N===t.UNSIGNED_BYTE&&(te=t.RG8)),E===t.RGBA){let me=Y?Lf:vt.getTransfer(J);N===t.FLOAT&&(te=t.RGBA32F),N===t.HALF_FLOAT&&(te=t.RGBA16F),N===t.UNSIGNED_BYTE&&(te=me===Tt?t.SRGB8_ALPHA8:t.RGBA8),N===t.UNSIGNED_SHORT_4_4_4_4&&(te=t.RGBA4),N===t.UNSIGNED_SHORT_5_5_5_1&&(te=t.RGB5_A1)}return(te===t.R16F||te===t.R32F||te===t.RG16F||te===t.RG32F||te===t.RGBA16F||te===t.RGBA32F)&&e.get("EXT_color_buffer_float"),te}function x(T,E,N){return b(T,N)===!0||T.isFramebufferTexture&&T.minFilter!==xn&&T.minFilter!==Rn?Math.log2(Math.max(E.width,E.height))+1:T.mipmaps!==void 0&&T.mipmaps.length>0?T.mipmaps.length:T.isCompressedTexture&&Array.isArray(T.image)?E.mipmaps.length:1}function A(T){return T===xn||T===cM||T===Zu?t.NEAREST:t.LINEAR}function I(T){let E=T.target;E.removeEventListener("dispose",I),G(E),E.isVideoTexture&&l.delete(E)}function V(T){let E=T.target;E.removeEventListener("dispose",V),M(E)}function G(T){let E=i.get(T);if(E.__webglInit===void 0)return;let N=T.source,J=h.get(N);if(J){let Y=J[E.__cacheKey];Y.usedTimes--,Y.usedTimes===0&&w(T),Object.keys(J).length===0&&h.delete(N)}i.remove(T)}function w(T){let E=i.get(T);t.deleteTexture(E.__webglTexture);let N=T.source,J=h.get(N);delete J[E.__cacheKey],o.memory.textures--}function M(T){let E=T.texture,N=i.get(T),J=i.get(E);if(J.__webglTexture!==void 0&&(t.deleteTexture(J.__webglTexture),o.memory.textures--),T.depthTexture&&T.depthTexture.dispose(),T.isWebGLCubeRenderTarget)for(let Y=0;Y<6;Y++){if(Array.isArray(N.__webglFramebuffer[Y]))for(let te=0;te<N.__webglFramebuffer[Y].length;te++)t.deleteFramebuffer(N.__webglFramebuffer[Y][te]);else t.deleteFramebuffer(N.__webglFramebuffer[Y]);N.__webglDepthbuffer&&t.deleteRenderbuffer(N.__webglDepthbuffer[Y])}else{if(Array.isArray(N.__webglFramebuffer))for(let Y=0;Y<N.__webglFramebuffer.length;Y++)t.deleteFramebuffer(N.__webglFramebuffer[Y]);else t.deleteFramebuffer(N.__webglFramebuffer);if(N.__webglDepthbuffer&&t.deleteRenderbuffer(N.__webglDepthbuffer),N.__webglMultisampledFramebuffer&&t.deleteFramebuffer(N.__webglMultisampledFramebuffer),N.__webglColorRenderbuffer)for(let Y=0;Y<N.__webglColorRenderbuffer.length;Y++)N.__webglColorRenderbuffer[Y]&&t.deleteRenderbuffer(N.__webglColorRenderbuffer[Y]);N.__webglDepthRenderbuffer&&t.deleteRenderbuffer(N.__webglDepthRenderbuffer)}if(T.isWebGLMultipleRenderTargets)for(let Y=0,te=E.length;Y<te;Y++){let me=i.get(E[Y]);me.__webglTexture&&(t.deleteTexture(me.__webglTexture),o.memory.textures--),i.remove(E[Y])}i.remove(E),i.remove(T)}let j=0;function X(){j=0}function D(){let T=j;return T>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+T+" texture units while this GPU supports only "+r.maxTextures),j+=1,T}function z(T){let E=[];return E.push(T.wrapS),E.push(T.wrapT),E.push(T.wrapR||0),E.push(T.magFilter),E.push(T.minFilter),E.push(T.anisotropy),E.push(T.internalFormat),E.push(T.format),E.push(T.type),E.push(T.generateMipmaps),E.push(T.premultiplyAlpha),E.push(T.flipY),E.push(T.unpackAlignment),E.push(T.colorSpace),E.join()}function O(T,E){let N=i.get(T);if(T.isVideoTexture&&tt(T),T.isRenderTargetTexture===!1&&T.version>0&&N.__version!==T.version){let J=T.image;if(J===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(J.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Q(N,T,E);return}}n.bindTexture(t.TEXTURE_2D,N.__webglTexture,t.TEXTURE0+E)}function K(T,E){let N=i.get(T);if(T.version>0&&N.__version!==T.version){Q(N,T,E);return}n.bindTexture(t.TEXTURE_2D_ARRAY,N.__webglTexture,t.TEXTURE0+E)}function W(T,E){let N=i.get(T);if(T.version>0&&N.__version!==T.version){Q(N,T,E);return}n.bindTexture(t.TEXTURE_3D,N.__webglTexture,t.TEXTURE0+E)}function q(T,E){let N=i.get(T);if(T.version>0&&N.__version!==T.version){ce(N,T,E);return}n.bindTexture(t.TEXTURE_CUBE_MAP,N.__webglTexture,t.TEXTURE0+E)}let $={[T0]:t.REPEAT,[bi]:t.CLAMP_TO_EDGE,[I0]:t.MIRRORED_REPEAT},ee={[xn]:t.NEAREST,[cM]:t.NEAREST_MIPMAP_NEAREST,[Zu]:t.NEAREST_MIPMAP_LINEAR,[Rn]:t.LINEAR,[$_]:t.LINEAR_MIPMAP_NEAREST,[xo]:t.LINEAR_MIPMAP_LINEAR},se={[Rz]:t.NEVER,[Fz]:t.ALWAYS,[Pz]:t.LESS,[UC]:t.LEQUAL,[Nz]:t.EQUAL,[kz]:t.GEQUAL,[Oz]:t.GREATER,[Lz]:t.NOTEQUAL};function Me(T,E,N){if(E.type===Pr&&e.has("OES_texture_float_linear")===!1&&(E.magFilter===Rn||E.magFilter===$_||E.magFilter===Zu||E.magFilter===xo||E.minFilter===Rn||E.minFilter===$_||E.minFilter===Zu||E.minFilter===xo)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),N?(t.texParameteri(T,t.TEXTURE_WRAP_S,$[E.wrapS]),t.texParameteri(T,t.TEXTURE_WRAP_T,$[E.wrapT]),(T===t.TEXTURE_3D||T===t.TEXTURE_2D_ARRAY)&&t.texParameteri(T,t.TEXTURE_WRAP_R,$[E.wrapR]),t.texParameteri(T,t.TEXTURE_MAG_FILTER,ee[E.magFilter]),t.texParameteri(T,t.TEXTURE_MIN_FILTER,ee[E.minFilter])):(t.texParameteri(T,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(T,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),(T===t.TEXTURE_3D||T===t.TEXTURE_2D_ARRAY)&&t.texParameteri(T,t.TEXTURE_WRAP_R,t.CLAMP_TO_EDGE),(E.wrapS!==bi||E.wrapT!==bi)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(T,t.TEXTURE_MAG_FILTER,A(E.magFilter)),t.texParameteri(T,t.TEXTURE_MIN_FILTER,A(E.minFilter)),E.minFilter!==xn&&E.minFilter!==Rn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),E.compareFunction&&(t.texParameteri(T,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(T,t.TEXTURE_COMPARE_FUNC,se[E.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){let J=e.get("EXT_texture_filter_anisotropic");if(E.magFilter===xn||E.minFilter!==Zu&&E.minFilter!==xo||E.type===Pr&&e.has("OES_texture_float_linear")===!1||a===!1&&E.type===ol&&e.has("OES_texture_half_float_linear")===!1)return;(E.anisotropy>1||i.get(E).__currentAnisotropy)&&(t.texParameterf(T,J.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(E.anisotropy,r.getMaxAnisotropy())),i.get(E).__currentAnisotropy=E.anisotropy)}}function H(T,E){let N=!1;T.__webglInit===void 0&&(T.__webglInit=!0,E.addEventListener("dispose",I));let J=E.source,Y=h.get(J);Y===void 0&&(Y={},h.set(J,Y));let te=z(E);if(te!==T.__cacheKey){Y[te]===void 0&&(Y[te]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,N=!0),Y[te].usedTimes++;let me=Y[T.__cacheKey];me!==void 0&&(Y[T.__cacheKey].usedTimes--,me.usedTimes===0&&w(E)),T.__cacheKey=te,T.__webglTexture=Y[te].texture}return N}function Q(T,E,N){let J=t.TEXTURE_2D;(E.isDataArrayTexture||E.isCompressedArrayTexture)&&(J=t.TEXTURE_2D_ARRAY),E.isData3DTexture&&(J=t.TEXTURE_3D);let Y=H(T,E),te=E.source;n.bindTexture(J,T.__webglTexture,t.TEXTURE0+N);let me=i.get(te);if(te.version!==me.__version||Y===!0){n.activeTexture(t.TEXTURE0+N);let ae=vt.getPrimaries(vt.workingColorSpace),fe=E.colorSpace===ri?null:vt.getPrimaries(E.colorSpace),Re=E.colorSpace===ri||ae===fe?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,E.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,E.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,E.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Re);let Xe=f(E)&&m(E.image)===!1,Z=y(E.image,Xe,!1,r.maxTextureSize);Z=be(E,Z);let gt=m(Z)||a,Je=s.convert(E.format,E.colorSpace),Fe=s.convert(E.type),Se=v(E.internalFormat,Je,Fe,E.colorSpace,E.isVideoTexture);Me(J,E,gt);let pe,je=E.mipmaps,ft=a&&E.isVideoTexture!==!0&&Se!==kC,xt=me.__version===void 0||Y===!0,nt=te.dataReady,_t=x(E,Z,gt);if(E.isDepthTexture)Se=t.DEPTH_COMPONENT,a?E.type===Pr?Se=t.DEPTH_COMPONENT32F:E.type===ws?Se=t.DEPTH_COMPONENT24:E.type===So?Se=t.DEPTH24_STENCIL8:Se=t.DEPTH_COMPONENT16:E.type===Pr&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),E.format===To&&Se===t.DEPTH_COMPONENT&&E.type!==nw&&E.type!==ws&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),E.type=ws,Fe=s.convert(E.type)),E.format===lc&&Se===t.DEPTH_COMPONENT&&(Se=t.DEPTH_STENCIL,E.type!==So&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),E.type=So,Fe=s.convert(E.type))),xt&&(ft?n.texStorage2D(t.TEXTURE_2D,1,Se,Z.width,Z.height):n.texImage2D(t.TEXTURE_2D,0,Se,Z.width,Z.height,0,Je,Fe,null));else if(E.isDataTexture)if(je.length>0&&gt){ft&&xt&&n.texStorage2D(t.TEXTURE_2D,_t,Se,je[0].width,je[0].height);for(let C=0,ne=je.length;C<ne;C++)pe=je[C],ft?nt&&n.texSubImage2D(t.TEXTURE_2D,C,0,0,pe.width,pe.height,Je,Fe,pe.data):n.texImage2D(t.TEXTURE_2D,C,Se,pe.width,pe.height,0,Je,Fe,pe.data);E.generateMipmaps=!1}else ft?(xt&&n.texStorage2D(t.TEXTURE_2D,_t,Se,Z.width,Z.height),nt&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,Z.width,Z.height,Je,Fe,Z.data)):n.texImage2D(t.TEXTURE_2D,0,Se,Z.width,Z.height,0,Je,Fe,Z.data);else if(E.isCompressedTexture)if(E.isCompressedArrayTexture){ft&&xt&&n.texStorage3D(t.TEXTURE_2D_ARRAY,_t,Se,je[0].width,je[0].height,Z.depth);for(let C=0,ne=je.length;C<ne;C++)pe=je[C],E.format!==xi?Je!==null?ft?nt&&n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,C,0,0,0,pe.width,pe.height,Z.depth,Je,pe.data,0,0):n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,C,Se,pe.width,pe.height,Z.depth,0,pe.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ft?nt&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,C,0,0,0,pe.width,pe.height,Z.depth,Je,Fe,pe.data):n.texImage3D(t.TEXTURE_2D_ARRAY,C,Se,pe.width,pe.height,Z.depth,0,Je,Fe,pe.data)}else{ft&&xt&&n.texStorage2D(t.TEXTURE_2D,_t,Se,je[0].width,je[0].height);for(let C=0,ne=je.length;C<ne;C++)pe=je[C],E.format!==xi?Je!==null?ft?nt&&n.compressedTexSubImage2D(t.TEXTURE_2D,C,0,0,pe.width,pe.height,Je,pe.data):n.compressedTexImage2D(t.TEXTURE_2D,C,Se,pe.width,pe.height,0,pe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ft?nt&&n.texSubImage2D(t.TEXTURE_2D,C,0,0,pe.width,pe.height,Je,Fe,pe.data):n.texImage2D(t.TEXTURE_2D,C,Se,pe.width,pe.height,0,Je,Fe,pe.data)}else if(E.isDataArrayTexture)ft?(xt&&n.texStorage3D(t.TEXTURE_2D_ARRAY,_t,Se,Z.width,Z.height,Z.depth),nt&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,Z.width,Z.height,Z.depth,Je,Fe,Z.data)):n.texImage3D(t.TEXTURE_2D_ARRAY,0,Se,Z.width,Z.height,Z.depth,0,Je,Fe,Z.data);else if(E.isData3DTexture)ft?(xt&&n.texStorage3D(t.TEXTURE_3D,_t,Se,Z.width,Z.height,Z.depth),nt&&n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,Z.width,Z.height,Z.depth,Je,Fe,Z.data)):n.texImage3D(t.TEXTURE_3D,0,Se,Z.width,Z.height,Z.depth,0,Je,Fe,Z.data);else if(E.isFramebufferTexture){if(xt)if(ft)n.texStorage2D(t.TEXTURE_2D,_t,Se,Z.width,Z.height);else{let C=Z.width,ne=Z.height;for(let ie=0;ie<_t;ie++)n.texImage2D(t.TEXTURE_2D,ie,Se,C,ne,0,Je,Fe,null),C>>=1,ne>>=1}}else if(je.length>0&&gt){ft&&xt&&n.texStorage2D(t.TEXTURE_2D,_t,Se,je[0].width,je[0].height);for(let C=0,ne=je.length;C<ne;C++)pe=je[C],ft?nt&&n.texSubImage2D(t.TEXTURE_2D,C,0,0,Je,Fe,pe):n.texImage2D(t.TEXTURE_2D,C,Se,Je,Fe,pe);E.generateMipmaps=!1}else ft?(xt&&n.texStorage2D(t.TEXTURE_2D,_t,Se,Z.width,Z.height),nt&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,Je,Fe,Z)):n.texImage2D(t.TEXTURE_2D,0,Se,Je,Fe,Z);b(E,gt)&&_(J),me.__version=te.version,E.onUpdate&&E.onUpdate(E)}T.__version=E.version}function ce(T,E,N){if(E.image.length!==6)return;let J=H(T,E),Y=E.source;n.bindTexture(t.TEXTURE_CUBE_MAP,T.__webglTexture,t.TEXTURE0+N);let te=i.get(Y);if(Y.version!==te.__version||J===!0){n.activeTexture(t.TEXTURE0+N);let me=vt.getPrimaries(vt.workingColorSpace),ae=E.colorSpace===ri?null:vt.getPrimaries(E.colorSpace),fe=E.colorSpace===ri||me===ae?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,E.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,E.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,E.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,fe);let Re=E.isCompressedTexture||E.image[0].isCompressedTexture,Xe=E.image[0]&&E.image[0].isDataTexture,Z=[];for(let C=0;C<6;C++)!Re&&!Xe?Z[C]=y(E.image[C],!1,!0,r.maxCubemapSize):Z[C]=Xe?E.image[C].image:E.image[C],Z[C]=be(E,Z[C]);let gt=Z[0],Je=m(gt)||a,Fe=s.convert(E.format,E.colorSpace),Se=s.convert(E.type),pe=v(E.internalFormat,Fe,Se,E.colorSpace),je=a&&E.isVideoTexture!==!0,ft=te.__version===void 0||J===!0,xt=Y.dataReady,nt=x(E,gt,Je);Me(t.TEXTURE_CUBE_MAP,E,Je);let _t;if(Re){je&&ft&&n.texStorage2D(t.TEXTURE_CUBE_MAP,nt,pe,gt.width,gt.height);for(let C=0;C<6;C++){_t=Z[C].mipmaps;for(let ne=0;ne<_t.length;ne++){let ie=_t[ne];E.format!==xi?Fe!==null?je?xt&&n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+C,ne,0,0,ie.width,ie.height,Fe,ie.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+C,ne,pe,ie.width,ie.height,0,ie.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):je?xt&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+C,ne,0,0,ie.width,ie.height,Fe,Se,ie.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+C,ne,pe,ie.width,ie.height,0,Fe,Se,ie.data)}}}else{_t=E.mipmaps,je&&ft&&(_t.length>0&&nt++,n.texStorage2D(t.TEXTURE_CUBE_MAP,nt,pe,Z[0].width,Z[0].height));for(let C=0;C<6;C++)if(Xe){je?xt&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+C,0,0,0,Z[C].width,Z[C].height,Fe,Se,Z[C].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+C,0,pe,Z[C].width,Z[C].height,0,Fe,Se,Z[C].data);for(let ne=0;ne<_t.length;ne++){let ye=_t[ne].image[C].image;je?xt&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+C,ne+1,0,0,ye.width,ye.height,Fe,Se,ye.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+C,ne+1,pe,ye.width,ye.height,0,Fe,Se,ye.data)}}else{je?xt&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+C,0,0,0,Fe,Se,Z[C]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+C,0,pe,Fe,Se,Z[C]);for(let ne=0;ne<_t.length;ne++){let ie=_t[ne];je?xt&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+C,ne+1,0,0,Fe,Se,ie.image[C]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+C,ne+1,pe,Fe,Se,ie.image[C])}}}b(E,Je)&&_(t.TEXTURE_CUBE_MAP),te.__version=Y.version,E.onUpdate&&E.onUpdate(E)}T.__version=E.version}function we(T,E,N,J,Y,te){let me=s.convert(N.format,N.colorSpace),ae=s.convert(N.type),fe=v(N.internalFormat,me,ae,N.colorSpace);if(!i.get(E).__hasExternalTextures){let Xe=Math.max(1,E.width>>te),Z=Math.max(1,E.height>>te);Y===t.TEXTURE_3D||Y===t.TEXTURE_2D_ARRAY?n.texImage3D(Y,te,fe,Xe,Z,E.depth,0,me,ae,null):n.texImage2D(Y,te,fe,Xe,Z,0,me,ae,null)}n.bindFramebuffer(t.FRAMEBUFFER,T),le(E)?c.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,J,Y,i.get(N).__webglTexture,0,de(E)):(Y===t.TEXTURE_2D||Y>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&Y<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,J,Y,i.get(N).__webglTexture,te),n.bindFramebuffer(t.FRAMEBUFFER,null)}function Te(T,E,N){if(t.bindRenderbuffer(t.RENDERBUFFER,T),E.depthBuffer&&!E.stencilBuffer){let J=a===!0?t.DEPTH_COMPONENT24:t.DEPTH_COMPONENT16;if(N||le(E)){let Y=E.depthTexture;Y&&Y.isDepthTexture&&(Y.type===Pr?J=t.DEPTH_COMPONENT32F:Y.type===ws&&(J=t.DEPTH_COMPONENT24));let te=de(E);le(E)?c.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,te,J,E.width,E.height):t.renderbufferStorageMultisample(t.RENDERBUFFER,te,J,E.width,E.height)}else t.renderbufferStorage(t.RENDERBUFFER,J,E.width,E.height);t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,T)}else if(E.depthBuffer&&E.stencilBuffer){let J=de(E);N&&le(E)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,J,t.DEPTH24_STENCIL8,E.width,E.height):le(E)?c.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,J,t.DEPTH24_STENCIL8,E.width,E.height):t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,E.width,E.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,T)}else{let J=E.isWebGLMultipleRenderTargets===!0?E.texture:[E.texture];for(let Y=0;Y<J.length;Y++){let te=J[Y],me=s.convert(te.format,te.colorSpace),ae=s.convert(te.type),fe=v(te.internalFormat,me,ae,te.colorSpace),Re=de(E);N&&le(E)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,Re,fe,E.width,E.height):le(E)?c.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Re,fe,E.width,E.height):t.renderbufferStorage(t.RENDERBUFFER,fe,E.width,E.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function he(T,E){if(E&&E.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,T),!(E.depthTexture&&E.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(E.depthTexture).__webglTexture||E.depthTexture.image.width!==E.width||E.depthTexture.image.height!==E.height)&&(E.depthTexture.image.width=E.width,E.depthTexture.image.height=E.height,E.depthTexture.needsUpdate=!0),O(E.depthTexture,0);let J=i.get(E.depthTexture).__webglTexture,Y=de(E);if(E.depthTexture.format===To)le(E)?c.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,J,0,Y):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,J,0);else if(E.depthTexture.format===lc)le(E)?c.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,J,0,Y):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,J,0);else throw new Error("Unknown depthTexture format")}function Ce(T){let E=i.get(T),N=T.isWebGLCubeRenderTarget===!0;if(T.depthTexture&&!E.__autoAllocateDepthBuffer){if(N)throw new Error("target.depthTexture not supported in Cube render targets");he(E.__webglFramebuffer,T)}else if(N){E.__webglDepthbuffer=[];for(let J=0;J<6;J++)n.bindFramebuffer(t.FRAMEBUFFER,E.__webglFramebuffer[J]),E.__webglDepthbuffer[J]=t.createRenderbuffer(),Te(E.__webglDepthbuffer[J],T,!1)}else n.bindFramebuffer(t.FRAMEBUFFER,E.__webglFramebuffer),E.__webglDepthbuffer=t.createRenderbuffer(),Te(E.__webglDepthbuffer,T,!1);n.bindFramebuffer(t.FRAMEBUFFER,null)}function ke(T,E,N){let J=i.get(T);E!==void 0&&we(J.__webglFramebuffer,T,T.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),N!==void 0&&Ce(T)}function P(T){let E=T.texture,N=i.get(T),J=i.get(E);T.addEventListener("dispose",V),T.isWebGLMultipleRenderTargets!==!0&&(J.__webglTexture===void 0&&(J.__webglTexture=t.createTexture()),J.__version=E.version,o.memory.textures++);let Y=T.isWebGLCubeRenderTarget===!0,te=T.isWebGLMultipleRenderTargets===!0,me=m(T)||a;if(Y){N.__webglFramebuffer=[];for(let ae=0;ae<6;ae++)if(a&&E.mipmaps&&E.mipmaps.length>0){N.__webglFramebuffer[ae]=[];for(let fe=0;fe<E.mipmaps.length;fe++)N.__webglFramebuffer[ae][fe]=t.createFramebuffer()}else N.__webglFramebuffer[ae]=t.createFramebuffer()}else{if(a&&E.mipmaps&&E.mipmaps.length>0){N.__webglFramebuffer=[];for(let ae=0;ae<E.mipmaps.length;ae++)N.__webglFramebuffer[ae]=t.createFramebuffer()}else N.__webglFramebuffer=t.createFramebuffer();if(te)if(r.drawBuffers){let ae=T.texture;for(let fe=0,Re=ae.length;fe<Re;fe++){let Xe=i.get(ae[fe]);Xe.__webglTexture===void 0&&(Xe.__webglTexture=t.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&T.samples>0&&le(T)===!1){let ae=te?E:[E];N.__webglMultisampledFramebuffer=t.createFramebuffer(),N.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,N.__webglMultisampledFramebuffer);for(let fe=0;fe<ae.length;fe++){let Re=ae[fe];N.__webglColorRenderbuffer[fe]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,N.__webglColorRenderbuffer[fe]);let Xe=s.convert(Re.format,Re.colorSpace),Z=s.convert(Re.type),gt=v(Re.internalFormat,Xe,Z,Re.colorSpace,T.isXRRenderTarget===!0),Je=de(T);t.renderbufferStorageMultisample(t.RENDERBUFFER,Je,gt,T.width,T.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+fe,t.RENDERBUFFER,N.__webglColorRenderbuffer[fe])}t.bindRenderbuffer(t.RENDERBUFFER,null),T.depthBuffer&&(N.__webglDepthRenderbuffer=t.createRenderbuffer(),Te(N.__webglDepthRenderbuffer,T,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(Y){n.bindTexture(t.TEXTURE_CUBE_MAP,J.__webglTexture),Me(t.TEXTURE_CUBE_MAP,E,me);for(let ae=0;ae<6;ae++)if(a&&E.mipmaps&&E.mipmaps.length>0)for(let fe=0;fe<E.mipmaps.length;fe++)we(N.__webglFramebuffer[ae][fe],T,E,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+ae,fe);else we(N.__webglFramebuffer[ae],T,E,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+ae,0);b(E,me)&&_(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(te){let ae=T.texture;for(let fe=0,Re=ae.length;fe<Re;fe++){let Xe=ae[fe],Z=i.get(Xe);n.bindTexture(t.TEXTURE_2D,Z.__webglTexture),Me(t.TEXTURE_2D,Xe,me),we(N.__webglFramebuffer,T,Xe,t.COLOR_ATTACHMENT0+fe,t.TEXTURE_2D,0),b(Xe,me)&&_(t.TEXTURE_2D)}n.unbindTexture()}else{let ae=t.TEXTURE_2D;if((T.isWebGL3DRenderTarget||T.isWebGLArrayRenderTarget)&&(a?ae=T.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(ae,J.__webglTexture),Me(ae,E,me),a&&E.mipmaps&&E.mipmaps.length>0)for(let fe=0;fe<E.mipmaps.length;fe++)we(N.__webglFramebuffer[fe],T,E,t.COLOR_ATTACHMENT0,ae,fe);else we(N.__webglFramebuffer,T,E,t.COLOR_ATTACHMENT0,ae,0);b(E,me)&&_(ae),n.unbindTexture()}T.depthBuffer&&Ce(T)}function Bt(T){let E=m(T)||a,N=T.isWebGLMultipleRenderTargets===!0?T.texture:[T.texture];for(let J=0,Y=N.length;J<Y;J++){let te=N[J];if(b(te,E)){let me=T.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,ae=i.get(te).__webglTexture;n.bindTexture(me,ae),_(me),n.unbindTexture()}}}function Ee(T){if(a&&T.samples>0&&le(T)===!1){let E=T.isWebGLMultipleRenderTargets?T.texture:[T.texture],N=T.width,J=T.height,Y=t.COLOR_BUFFER_BIT,te=[],me=T.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,ae=i.get(T),fe=T.isWebGLMultipleRenderTargets===!0;if(fe)for(let Re=0;Re<E.length;Re++)n.bindFramebuffer(t.FRAMEBUFFER,ae.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Re,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,ae.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Re,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,ae.__webglMultisampledFramebuffer),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,ae.__webglFramebuffer);for(let Re=0;Re<E.length;Re++){te.push(t.COLOR_ATTACHMENT0+Re),T.depthBuffer&&te.push(me);let Xe=ae.__ignoreDepthValues!==void 0?ae.__ignoreDepthValues:!1;if(Xe===!1&&(T.depthBuffer&&(Y|=t.DEPTH_BUFFER_BIT),T.stencilBuffer&&(Y|=t.STENCIL_BUFFER_BIT)),fe&&t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,ae.__webglColorRenderbuffer[Re]),Xe===!0&&(t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[me]),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[me])),fe){let Z=i.get(E[Re]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,Z,0)}t.blitFramebuffer(0,0,N,J,0,0,N,J,Y,t.NEAREST),u&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,te)}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),fe)for(let Re=0;Re<E.length;Re++){n.bindFramebuffer(t.FRAMEBUFFER,ae.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Re,t.RENDERBUFFER,ae.__webglColorRenderbuffer[Re]);let Xe=i.get(E[Re]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,ae.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Re,t.TEXTURE_2D,Xe,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,ae.__webglMultisampledFramebuffer)}}function de(T){return Math.min(r.maxSamples,T.samples)}function le(T){let E=i.get(T);return a&&T.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&E.__useRenderToTexture!==!1}function tt(T){let E=o.render.frame;l.get(T)!==E&&(l.set(T,E),T.update())}function be(T,E){let N=T.colorSpace,J=T.format,Y=T.type;return T.isCompressedTexture===!0||T.isVideoTexture===!0||T.format===A0||N!==Or&&N!==ri&&(vt.getTransfer(N)===Tt?a===!1?e.has("EXT_sRGB")===!0&&J===xi?(T.format=A0,T.minFilter=Rn,T.generateMipmaps=!1):E=zf.sRGBToLinear(E):(J!==xi||Y!==xs)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",N)),E}this.allocateTextureUnit=D,this.resetTextureUnits=X,this.setTexture2D=O,this.setTexture2DArray=K,this.setTexture3D=W,this.setTextureCube=q,this.rebindTextures=ke,this.setupRenderTarget=P,this.updateRenderTargetMipmap=Bt,this.updateMultisampleRenderTarget=Ee,this.setupDepthRenderbuffer=Ce,this.setupFrameBufferTexture=we,this.useMultisampledRTT=le}function zj(t,e,n){let i=n.isWebGL2;function r(s,o=ri){let a,c=vt.getTransfer(o);if(s===xs)return t.UNSIGNED_BYTE;if(s===RC)return t.UNSIGNED_SHORT_4_4_4_4;if(s===PC)return t.UNSIGNED_SHORT_5_5_5_1;if(s===_z)return t.BYTE;if(s===wz)return t.SHORT;if(s===nw)return t.UNSIGNED_SHORT;if(s===DC)return t.INT;if(s===ws)return t.UNSIGNED_INT;if(s===Pr)return t.FLOAT;if(s===ol)return i?t.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===Ez)return t.ALPHA;if(s===xi)return t.RGBA;if(s===bz)return t.LUMINANCE;if(s===xz)return t.LUMINANCE_ALPHA;if(s===To)return t.DEPTH_COMPONENT;if(s===lc)return t.DEPTH_STENCIL;if(s===A0)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===Sz)return t.RED;if(s===NC)return t.RED_INTEGER;if(s===Tz)return t.RG;if(s===OC)return t.RG_INTEGER;if(s===LC)return t.RGBA_INTEGER;if(s===q_||s===X_||s===K_||s===Y_)if(c===Tt)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===q_)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===X_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===K_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===Y_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===q_)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===X_)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===K_)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===Y_)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===uM||s===lM||s===dM||s===hM)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===uM)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===lM)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===dM)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===hM)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===kC)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===fM||s===pM)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===fM)return c===Tt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===pM)return c===Tt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===mM||s===gM||s===yM||s===vM||s===_M||s===wM||s===EM||s===bM||s===xM||s===SM||s===TM||s===IM||s===AM||s===MM)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===mM)return c===Tt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===gM)return c===Tt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===yM)return c===Tt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===vM)return c===Tt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===_M)return c===Tt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===wM)return c===Tt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===EM)return c===Tt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===bM)return c===Tt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===xM)return c===Tt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===SM)return c===Tt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===TM)return c===Tt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===IM)return c===Tt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===AM)return c===Tt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===MM)return c===Tt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===Q_||s===CM||s===DM)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===Q_)return c===Tt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===CM)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===DM)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===Iz||s===RM||s===PM||s===NM)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===Q_)return a.COMPRESSED_RED_RGTC1_EXT;if(s===RM)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===PM)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===NM)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===So?i?t.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):t[s]!==void 0?t[s]:null}return{convert:r}}var H0=class extends Tn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}},ic=class extends Po{constructor(){super(),this.isGroup=!0,this.type="Group"}},Hj={type:"move"},sl=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new ic,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new ic,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new k,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new k),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new ic,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new k,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new k),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let n=this._hand;if(n)for(let i of e.hand.values())this._getHandJoint(n,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,i){let r=null,s=null,o=null,a=this._targetRay,c=this._grip,u=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(u&&e.hand){o=!0;for(let y of e.hand.values()){let m=n.getJointPose(y,i),f=this._getHandJoint(u,y);m!==null&&(f.matrix.fromArray(m.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.matrixWorldNeedsUpdate=!0,f.jointRadius=m.radius),f.visible=m!==null}let l=u.joints["index-finger-tip"],d=u.joints["thumb-tip"],h=l.position.distanceTo(d.position),p=.02,g=.005;u.inputState.pinching&&h>p+g?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&h<=p-g&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(s=n.getPose(e.gripSpace,i),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));a!==null&&(r=n.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Hj)))}return a!==null&&(a.visible=r!==null),c!==null&&(c.visible=s!==null),u!==null&&(u.visible=o!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){let i=new ic;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[n.jointName]=i,e.add(i)}return e.joints[n.jointName]}},Gj=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,Wj=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepthEXT = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepthEXT = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`,G0=class{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,n,i){if(this.texture===null){let r=new Ro,s=e.properties.get(r);s.__webglTexture=n.texture,(n.depthNear!=i.depthNear||n.depthFar!=i.depthFar)&&(this.depthNear=n.depthNear,this.depthFar=n.depthFar),this.texture=r}}render(e,n){if(this.texture!==null){if(this.mesh===null){let i=n.cameras[0].viewport,r=new er({extensions:{fragDepth:!0},vertexShader:Gj,fragmentShader:Wj,uniforms:{depthColor:{value:this.texture},depthWidth:{value:i.z},depthHeight:{value:i.w}}});this.mesh=new Si(new Zf(20,20),r)}e.render(this.mesh,n)}}reset(){this.texture=null,this.mesh=null}},W0=class extends Ts{constructor(e,n){super();let i=this,r=null,s=1,o=null,a="local-floor",c=1,u=null,l=null,d=null,h=null,p=null,g=null,y=new G0,m=n.getContextAttributes(),f=null,b=null,_=[],v=[],x=new ht,A=null,I=new Tn;I.layers.enable(1),I.viewport=new un;let V=new Tn;V.layers.enable(2),V.viewport=new un;let G=[I,V],w=new H0;w.layers.enable(1),w.layers.enable(2);let M=null,j=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(H){let Q=_[H];return Q===void 0&&(Q=new sl,_[H]=Q),Q.getTargetRaySpace()},this.getControllerGrip=function(H){let Q=_[H];return Q===void 0&&(Q=new sl,_[H]=Q),Q.getGripSpace()},this.getHand=function(H){let Q=_[H];return Q===void 0&&(Q=new sl,_[H]=Q),Q.getHandSpace()};function X(H){let Q=v.indexOf(H.inputSource);if(Q===-1)return;let ce=_[Q];ce!==void 0&&(ce.update(H.inputSource,H.frame,u||o),ce.dispatchEvent({type:H.type,data:H.inputSource}))}function D(){r.removeEventListener("select",X),r.removeEventListener("selectstart",X),r.removeEventListener("selectend",X),r.removeEventListener("squeeze",X),r.removeEventListener("squeezestart",X),r.removeEventListener("squeezeend",X),r.removeEventListener("end",D),r.removeEventListener("inputsourceschange",z);for(let H=0;H<_.length;H++){let Q=v[H];Q!==null&&(v[H]=null,_[H].disconnect(Q))}M=null,j=null,y.reset(),e.setRenderTarget(f),p=null,h=null,d=null,r=null,b=null,Me.stop(),i.isPresenting=!1,e.setPixelRatio(A),e.setSize(x.width,x.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(H){s=H,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(H){a=H,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(H){u=H},this.getBaseLayer=function(){return h!==null?h:p},this.getBinding=function(){return d},this.getFrame=function(){return g},this.getSession=function(){return r},this.setSession=function(H){return U(this,null,function*(){if(r=H,r!==null){if(f=e.getRenderTarget(),r.addEventListener("select",X),r.addEventListener("selectstart",X),r.addEventListener("selectend",X),r.addEventListener("squeeze",X),r.addEventListener("squeezestart",X),r.addEventListener("squeezeend",X),r.addEventListener("end",D),r.addEventListener("inputsourceschange",z),m.xrCompatible!==!0&&(yield n.makeXRCompatible()),A=e.getPixelRatio(),e.getSize(x),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){let Q={antialias:r.renderState.layers===void 0?m.antialias:!0,alpha:!0,depth:m.depth,stencil:m.stencil,framebufferScaleFactor:s};p=new XRWebGLLayer(r,n,Q),r.updateRenderState({baseLayer:p}),e.setPixelRatio(1),e.setSize(p.framebufferWidth,p.framebufferHeight,!1),b=new Lr(p.framebufferWidth,p.framebufferHeight,{format:xi,type:xs,colorSpace:e.outputColorSpace,stencilBuffer:m.stencil})}else{let Q=null,ce=null,we=null;m.depth&&(we=m.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,Q=m.stencil?lc:To,ce=m.stencil?So:ws);let Te={colorFormat:n.RGBA8,depthFormat:we,scaleFactor:s};d=new XRWebGLBinding(r,n),h=d.createProjectionLayer(Te),r.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),b=new Lr(h.textureWidth,h.textureHeight,{format:xi,type:xs,depthTexture:new ep(h.textureWidth,h.textureHeight,ce,void 0,void 0,void 0,void 0,void 0,void 0,Q),stencilBuffer:m.stencil,colorSpace:e.outputColorSpace,samples:m.antialias?4:0});let he=e.properties.get(b);he.__ignoreDepthValues=h.ignoreDepthValues}b.isXRRenderTarget=!0,this.setFoveation(c),u=null,o=yield r.requestReferenceSpace(a),Me.setContext(r),Me.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}})},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode};function z(H){for(let Q=0;Q<H.removed.length;Q++){let ce=H.removed[Q],we=v.indexOf(ce);we>=0&&(v[we]=null,_[we].disconnect(ce))}for(let Q=0;Q<H.added.length;Q++){let ce=H.added[Q],we=v.indexOf(ce);if(we===-1){for(let he=0;he<_.length;he++)if(he>=v.length){v.push(ce),we=he;break}else if(v[he]===null){v[he]=ce,we=he;break}if(we===-1)break}let Te=_[we];Te&&Te.connect(ce)}}let O=new k,K=new k;function W(H,Q,ce){O.setFromMatrixPosition(Q.matrixWorld),K.setFromMatrixPosition(ce.matrixWorld);let we=O.distanceTo(K),Te=Q.projectionMatrix.elements,he=ce.projectionMatrix.elements,Ce=Te[14]/(Te[10]-1),ke=Te[14]/(Te[10]+1),P=(Te[9]+1)/Te[5],Bt=(Te[9]-1)/Te[5],Ee=(Te[8]-1)/Te[0],de=(he[8]+1)/he[0],le=Ce*Ee,tt=Ce*de,be=we/(-Ee+de),T=be*-Ee;Q.matrixWorld.decompose(H.position,H.quaternion,H.scale),H.translateX(T),H.translateZ(be),H.matrixWorld.compose(H.position,H.quaternion,H.scale),H.matrixWorldInverse.copy(H.matrixWorld).invert();let E=Ce+be,N=ke+be,J=le-T,Y=tt+(we-T),te=P*ke/N*E,me=Bt*ke/N*E;H.projectionMatrix.makePerspective(J,Y,te,me,E,N),H.projectionMatrixInverse.copy(H.projectionMatrix).invert()}function q(H,Q){Q===null?H.matrixWorld.copy(H.matrix):H.matrixWorld.multiplyMatrices(Q.matrixWorld,H.matrix),H.matrixWorldInverse.copy(H.matrixWorld).invert()}this.updateCamera=function(H){if(r===null)return;y.texture!==null&&(H.near=y.depthNear,H.far=y.depthFar),w.near=V.near=I.near=H.near,w.far=V.far=I.far=H.far,(M!==w.near||j!==w.far)&&(r.updateRenderState({depthNear:w.near,depthFar:w.far}),M=w.near,j=w.far,I.near=M,I.far=j,V.near=M,V.far=j,I.updateProjectionMatrix(),V.updateProjectionMatrix(),H.updateProjectionMatrix());let Q=H.parent,ce=w.cameras;q(w,Q);for(let we=0;we<ce.length;we++)q(ce[we],Q);ce.length===2?W(w,I,V):w.projectionMatrix.copy(I.projectionMatrix),$(H,w,Q)};function $(H,Q,ce){ce===null?H.matrix.copy(Q.matrixWorld):(H.matrix.copy(ce.matrixWorld),H.matrix.invert(),H.matrix.multiply(Q.matrixWorld)),H.matrix.decompose(H.position,H.quaternion,H.scale),H.updateMatrixWorld(!0),H.projectionMatrix.copy(Q.projectionMatrix),H.projectionMatrixInverse.copy(Q.projectionMatrixInverse),H.isPerspectiveCamera&&(H.fov=al*2*Math.atan(1/H.projectionMatrix.elements[5]),H.zoom=1)}this.getCamera=function(){return w},this.getFoveation=function(){if(!(h===null&&p===null))return c},this.setFoveation=function(H){c=H,h!==null&&(h.fixedFoveation=H),p!==null&&p.fixedFoveation!==void 0&&(p.fixedFoveation=H)},this.hasDepthSensing=function(){return y.texture!==null};let ee=null;function se(H,Q){if(l=Q.getViewerPose(u||o),g=Q,l!==null){let ce=l.views;p!==null&&(e.setRenderTargetFramebuffer(b,p.framebuffer),e.setRenderTarget(b));let we=!1;ce.length!==w.cameras.length&&(w.cameras.length=0,we=!0);for(let he=0;he<ce.length;he++){let Ce=ce[he],ke=null;if(p!==null)ke=p.getViewport(Ce);else{let Bt=d.getViewSubImage(h,Ce);ke=Bt.viewport,he===0&&(e.setRenderTargetTextures(b,Bt.colorTexture,h.ignoreDepthValues?void 0:Bt.depthStencilTexture),e.setRenderTarget(b))}let P=G[he];P===void 0&&(P=new Tn,P.layers.enable(he),P.viewport=new un,G[he]=P),P.matrix.fromArray(Ce.transform.matrix),P.matrix.decompose(P.position,P.quaternion,P.scale),P.projectionMatrix.fromArray(Ce.projectionMatrix),P.projectionMatrixInverse.copy(P.projectionMatrix).invert(),P.viewport.set(ke.x,ke.y,ke.width,ke.height),he===0&&(w.matrix.copy(P.matrix),w.matrix.decompose(w.position,w.quaternion,w.scale)),we===!0&&w.cameras.push(P)}let Te=r.enabledFeatures;if(Te&&Te.includes("depth-sensing")){let he=d.getDepthInformation(ce[0]);he&&he.isValid&&he.texture&&y.init(e,he,r.renderState)}}for(let ce=0;ce<_.length;ce++){let we=v[ce],Te=_[ce];we!==null&&Te!==void 0&&Te.update(we,Q,u||o)}y.render(e,w),ee&&ee(H,Q),Q.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:Q}),g=null}let Me=new HC;Me.setAnimationLoop(se),this.setAnimationLoop=function(H){ee=H},this.dispose=function(){}}};function jj(t,e){function n(m,f){m.matrixAutoUpdate===!0&&m.updateMatrix(),f.value.copy(m.matrix)}function i(m,f){f.color.getRGB(m.fogColor.value,zC(t)),f.isFog?(m.fogNear.value=f.near,m.fogFar.value=f.far):f.isFogExp2&&(m.fogDensity.value=f.density)}function r(m,f,b,_,v){f.isMeshBasicMaterial||f.isMeshLambertMaterial?s(m,f):f.isMeshToonMaterial?(s(m,f),d(m,f)):f.isMeshPhongMaterial?(s(m,f),l(m,f)):f.isMeshStandardMaterial?(s(m,f),h(m,f),f.isMeshPhysicalMaterial&&p(m,f,v)):f.isMeshMatcapMaterial?(s(m,f),g(m,f)):f.isMeshDepthMaterial?s(m,f):f.isMeshDistanceMaterial?(s(m,f),y(m,f)):f.isMeshNormalMaterial?s(m,f):f.isLineBasicMaterial?(o(m,f),f.isLineDashedMaterial&&a(m,f)):f.isPointsMaterial?c(m,f,b,_):f.isSpriteMaterial?u(m,f):f.isShadowMaterial?(m.color.value.copy(f.color),m.opacity.value=f.opacity):f.isShaderMaterial&&(f.uniformsNeedUpdate=!1)}function s(m,f){m.opacity.value=f.opacity,f.color&&m.diffuse.value.copy(f.color),f.emissive&&m.emissive.value.copy(f.emissive).multiplyScalar(f.emissiveIntensity),f.map&&(m.map.value=f.map,n(f.map,m.mapTransform)),f.alphaMap&&(m.alphaMap.value=f.alphaMap,n(f.alphaMap,m.alphaMapTransform)),f.bumpMap&&(m.bumpMap.value=f.bumpMap,n(f.bumpMap,m.bumpMapTransform),m.bumpScale.value=f.bumpScale,f.side===Pn&&(m.bumpScale.value*=-1)),f.normalMap&&(m.normalMap.value=f.normalMap,n(f.normalMap,m.normalMapTransform),m.normalScale.value.copy(f.normalScale),f.side===Pn&&m.normalScale.value.negate()),f.displacementMap&&(m.displacementMap.value=f.displacementMap,n(f.displacementMap,m.displacementMapTransform),m.displacementScale.value=f.displacementScale,m.displacementBias.value=f.displacementBias),f.emissiveMap&&(m.emissiveMap.value=f.emissiveMap,n(f.emissiveMap,m.emissiveMapTransform)),f.specularMap&&(m.specularMap.value=f.specularMap,n(f.specularMap,m.specularMapTransform)),f.alphaTest>0&&(m.alphaTest.value=f.alphaTest);let b=e.get(f).envMap;if(b&&(m.envMap.value=b,m.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,m.reflectivity.value=f.reflectivity,m.ior.value=f.ior,m.refractionRatio.value=f.refractionRatio),f.lightMap){m.lightMap.value=f.lightMap;let _=t._useLegacyLights===!0?Math.PI:1;m.lightMapIntensity.value=f.lightMapIntensity*_,n(f.lightMap,m.lightMapTransform)}f.aoMap&&(m.aoMap.value=f.aoMap,m.aoMapIntensity.value=f.aoMapIntensity,n(f.aoMap,m.aoMapTransform))}function o(m,f){m.diffuse.value.copy(f.color),m.opacity.value=f.opacity,f.map&&(m.map.value=f.map,n(f.map,m.mapTransform))}function a(m,f){m.dashSize.value=f.dashSize,m.totalSize.value=f.dashSize+f.gapSize,m.scale.value=f.scale}function c(m,f,b,_){m.diffuse.value.copy(f.color),m.opacity.value=f.opacity,m.size.value=f.size*b,m.scale.value=_*.5,f.map&&(m.map.value=f.map,n(f.map,m.uvTransform)),f.alphaMap&&(m.alphaMap.value=f.alphaMap,n(f.alphaMap,m.alphaMapTransform)),f.alphaTest>0&&(m.alphaTest.value=f.alphaTest)}function u(m,f){m.diffuse.value.copy(f.color),m.opacity.value=f.opacity,m.rotation.value=f.rotation,f.map&&(m.map.value=f.map,n(f.map,m.mapTransform)),f.alphaMap&&(m.alphaMap.value=f.alphaMap,n(f.alphaMap,m.alphaMapTransform)),f.alphaTest>0&&(m.alphaTest.value=f.alphaTest)}function l(m,f){m.specular.value.copy(f.specular),m.shininess.value=Math.max(f.shininess,1e-4)}function d(m,f){f.gradientMap&&(m.gradientMap.value=f.gradientMap)}function h(m,f){m.metalness.value=f.metalness,f.metalnessMap&&(m.metalnessMap.value=f.metalnessMap,n(f.metalnessMap,m.metalnessMapTransform)),m.roughness.value=f.roughness,f.roughnessMap&&(m.roughnessMap.value=f.roughnessMap,n(f.roughnessMap,m.roughnessMapTransform)),e.get(f).envMap&&(m.envMapIntensity.value=f.envMapIntensity)}function p(m,f,b){m.ior.value=f.ior,f.sheen>0&&(m.sheenColor.value.copy(f.sheenColor).multiplyScalar(f.sheen),m.sheenRoughness.value=f.sheenRoughness,f.sheenColorMap&&(m.sheenColorMap.value=f.sheenColorMap,n(f.sheenColorMap,m.sheenColorMapTransform)),f.sheenRoughnessMap&&(m.sheenRoughnessMap.value=f.sheenRoughnessMap,n(f.sheenRoughnessMap,m.sheenRoughnessMapTransform))),f.clearcoat>0&&(m.clearcoat.value=f.clearcoat,m.clearcoatRoughness.value=f.clearcoatRoughness,f.clearcoatMap&&(m.clearcoatMap.value=f.clearcoatMap,n(f.clearcoatMap,m.clearcoatMapTransform)),f.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=f.clearcoatRoughnessMap,n(f.clearcoatRoughnessMap,m.clearcoatRoughnessMapTransform)),f.clearcoatNormalMap&&(m.clearcoatNormalMap.value=f.clearcoatNormalMap,n(f.clearcoatNormalMap,m.clearcoatNormalMapTransform),m.clearcoatNormalScale.value.copy(f.clearcoatNormalScale),f.side===Pn&&m.clearcoatNormalScale.value.negate())),f.iridescence>0&&(m.iridescence.value=f.iridescence,m.iridescenceIOR.value=f.iridescenceIOR,m.iridescenceThicknessMinimum.value=f.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=f.iridescenceThicknessRange[1],f.iridescenceMap&&(m.iridescenceMap.value=f.iridescenceMap,n(f.iridescenceMap,m.iridescenceMapTransform)),f.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=f.iridescenceThicknessMap,n(f.iridescenceThicknessMap,m.iridescenceThicknessMapTransform))),f.transmission>0&&(m.transmission.value=f.transmission,m.transmissionSamplerMap.value=b.texture,m.transmissionSamplerSize.value.set(b.width,b.height),f.transmissionMap&&(m.transmissionMap.value=f.transmissionMap,n(f.transmissionMap,m.transmissionMapTransform)),m.thickness.value=f.thickness,f.thicknessMap&&(m.thicknessMap.value=f.thicknessMap,n(f.thicknessMap,m.thicknessMapTransform)),m.attenuationDistance.value=f.attenuationDistance,m.attenuationColor.value.copy(f.attenuationColor)),f.anisotropy>0&&(m.anisotropyVector.value.set(f.anisotropy*Math.cos(f.anisotropyRotation),f.anisotropy*Math.sin(f.anisotropyRotation)),f.anisotropyMap&&(m.anisotropyMap.value=f.anisotropyMap,n(f.anisotropyMap,m.anisotropyMapTransform))),m.specularIntensity.value=f.specularIntensity,m.specularColor.value.copy(f.specularColor),f.specularColorMap&&(m.specularColorMap.value=f.specularColorMap,n(f.specularColorMap,m.specularColorMapTransform)),f.specularIntensityMap&&(m.specularIntensityMap.value=f.specularIntensityMap,n(f.specularIntensityMap,m.specularIntensityMapTransform))}function g(m,f){f.matcap&&(m.matcap.value=f.matcap)}function y(m,f){let b=e.get(f).light;m.referencePosition.value.setFromMatrixPosition(b.matrixWorld),m.nearDistance.value=b.shadow.camera.near,m.farDistance.value=b.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function $j(t,e,n,i){let r={},s={},o=[],a=n.isWebGL2?t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS):0;function c(b,_){let v=_.program;i.uniformBlockBinding(b,v)}function u(b,_){let v=r[b.id];v===void 0&&(g(b),v=l(b),r[b.id]=v,b.addEventListener("dispose",m));let x=_.program;i.updateUBOMapping(b,x);let A=e.render.frame;s[b.id]!==A&&(h(b),s[b.id]=A)}function l(b){let _=d();b.__bindingPointIndex=_;let v=t.createBuffer(),x=b.__size,A=b.usage;return t.bindBuffer(t.UNIFORM_BUFFER,v),t.bufferData(t.UNIFORM_BUFFER,x,A),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,_,v),v}function d(){for(let b=0;b<a;b++)if(o.indexOf(b)===-1)return o.push(b),b;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(b){let _=r[b.id],v=b.uniforms,x=b.__cache;t.bindBuffer(t.UNIFORM_BUFFER,_);for(let A=0,I=v.length;A<I;A++){let V=Array.isArray(v[A])?v[A]:[v[A]];for(let G=0,w=V.length;G<w;G++){let M=V[G];if(p(M,A,G,x)===!0){let j=M.__offset,X=Array.isArray(M.value)?M.value:[M.value],D=0;for(let z=0;z<X.length;z++){let O=X[z],K=y(O);typeof O=="number"||typeof O=="boolean"?(M.__data[0]=O,t.bufferSubData(t.UNIFORM_BUFFER,j+D,M.__data)):O.isMatrix3?(M.__data[0]=O.elements[0],M.__data[1]=O.elements[1],M.__data[2]=O.elements[2],M.__data[3]=0,M.__data[4]=O.elements[3],M.__data[5]=O.elements[4],M.__data[6]=O.elements[5],M.__data[7]=0,M.__data[8]=O.elements[6],M.__data[9]=O.elements[7],M.__data[10]=O.elements[8],M.__data[11]=0):(O.toArray(M.__data,D),D+=K.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,j,M.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function p(b,_,v,x){let A=b.value,I=_+"_"+v;if(x[I]===void 0)return typeof A=="number"||typeof A=="boolean"?x[I]=A:x[I]=A.clone(),!0;{let V=x[I];if(typeof A=="number"||typeof A=="boolean"){if(V!==A)return x[I]=A,!0}else if(V.equals(A)===!1)return V.copy(A),!0}return!1}function g(b){let _=b.uniforms,v=0,x=16;for(let I=0,V=_.length;I<V;I++){let G=Array.isArray(_[I])?_[I]:[_[I]];for(let w=0,M=G.length;w<M;w++){let j=G[w],X=Array.isArray(j.value)?j.value:[j.value];for(let D=0,z=X.length;D<z;D++){let O=X[D],K=y(O),W=v%x;W!==0&&x-W<K.boundary&&(v+=x-W),j.__data=new Float32Array(K.storage/Float32Array.BYTES_PER_ELEMENT),j.__offset=v,v+=K.storage}}}let A=v%x;return A>0&&(v+=x-A),b.__size=v,b.__cache={},this}function y(b){let _={boundary:0,storage:0};return typeof b=="number"||typeof b=="boolean"?(_.boundary=4,_.storage=4):b.isVector2?(_.boundary=8,_.storage=8):b.isVector3||b.isColor?(_.boundary=16,_.storage=12):b.isVector4?(_.boundary=16,_.storage=16):b.isMatrix3?(_.boundary=48,_.storage=48):b.isMatrix4?(_.boundary=64,_.storage=64):b.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",b),_}function m(b){let _=b.target;_.removeEventListener("dispose",m);let v=o.indexOf(_.__bindingPointIndex);o.splice(v,1),t.deleteBuffer(r[_.id]),delete r[_.id],delete s[_.id]}function f(){for(let b in r)t.deleteBuffer(r[b]);o=[],r={},s={}}return{bind:c,update:u,dispose:f}}var ul=class{constructor(e={}){let{canvas:n=Zz(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:u=!1,powerPreference:l="default",failIfMajorPerformanceCaveat:d=!1}=e;this.isWebGLRenderer=!0;let h;i!==null?h=i.getContextAttributes().alpha:h=o;let p=new Uint32Array(4),g=new Int32Array(4),y=null,m=null,f=[],b=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=cn,this._useLegacyLights=!1,this.toneMapping=bs,this.toneMappingExposure=1;let _=this,v=!1,x=0,A=0,I=null,V=-1,G=null,w=new un,M=new un,j=null,X=new lt(0),D=0,z=n.width,O=n.height,K=1,W=null,q=null,$=new un(0,0,z,O),ee=new un(0,0,z,O),se=!1,Me=new Qf,H=!1,Q=!1,ce=null,we=new ln,Te=new ht,he=new k,Ce={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ke(){return I===null?K:1}let P=i;function Bt(S,R){for(let F=0;F<S.length;F++){let B=S[F],L=n.getContext(B,R);if(L!==null)return L}return null}try{let S={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:c,preserveDrawingBuffer:u,powerPreference:l,failIfMajorPerformanceCaveat:d};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${tw}`),n.addEventListener("webglcontextlost",_t,!1),n.addEventListener("webglcontextrestored",C,!1),n.addEventListener("webglcontextcreationerror",ne,!1),P===null){let R=["webgl2","webgl","experimental-webgl"];if(_.isWebGL1Renderer===!0&&R.shift(),P=Bt(R,S),P===null)throw Bt(R)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&P instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),P.getShaderPrecisionFormat===void 0&&(P.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(S){throw console.error("THREE.WebGLRenderer: "+S.message),S}let Ee,de,le,tt,be,T,E,N,J,Y,te,me,ae,fe,Re,Xe,Z,gt,Je,Fe,Se,pe,je,ft;function xt(){Ee=new uW(P),de=new iW(P,Ee,e),Ee.init(de),pe=new zj(P,Ee,de),le=new Vj(P,Ee,de),tt=new hW(P),be=new Aj,T=new Bj(P,Ee,le,be,de,pe,tt),E=new sW(_),N=new cW(_),J=new wH(P,de),je=new tW(P,Ee,J,de),Y=new lW(P,J,tt,je),te=new gW(P,Y,J,tt),Je=new mW(P,de,T),Xe=new rW(be),me=new Ij(_,E,N,Ee,de,je,Xe),ae=new jj(_,be),fe=new Cj,Re=new Lj(Ee,de),gt=new eW(_,E,N,le,te,h,c),Z=new Uj(_,te,de),ft=new $j(P,tt,de,le),Fe=new nW(P,Ee,tt,de),Se=new dW(P,Ee,tt,de),tt.programs=me.programs,_.capabilities=de,_.extensions=Ee,_.properties=be,_.renderLists=fe,_.shadowMap=Z,_.state=le,_.info=tt}xt();let nt=new W0(_,P);this.xr=nt,this.getContext=function(){return P},this.getContextAttributes=function(){return P.getContextAttributes()},this.forceContextLoss=function(){let S=Ee.get("WEBGL_lose_context");S&&S.loseContext()},this.forceContextRestore=function(){let S=Ee.get("WEBGL_lose_context");S&&S.restoreContext()},this.getPixelRatio=function(){return K},this.setPixelRatio=function(S){S!==void 0&&(K=S,this.setSize(z,O,!1))},this.getSize=function(S){return S.set(z,O)},this.setSize=function(S,R,F=!0){if(nt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}z=S,O=R,n.width=Math.floor(S*K),n.height=Math.floor(R*K),F===!0&&(n.style.width=S+"px",n.style.height=R+"px"),this.setViewport(0,0,S,R)},this.getDrawingBufferSize=function(S){return S.set(z*K,O*K).floor()},this.setDrawingBufferSize=function(S,R,F){z=S,O=R,K=F,n.width=Math.floor(S*F),n.height=Math.floor(R*F),this.setViewport(0,0,S,R)},this.getCurrentViewport=function(S){return S.copy(w)},this.getViewport=function(S){return S.copy($)},this.setViewport=function(S,R,F,B){S.isVector4?$.set(S.x,S.y,S.z,S.w):$.set(S,R,F,B),le.viewport(w.copy($).multiplyScalar(K).floor())},this.getScissor=function(S){return S.copy(ee)},this.setScissor=function(S,R,F,B){S.isVector4?ee.set(S.x,S.y,S.z,S.w):ee.set(S,R,F,B),le.scissor(M.copy(ee).multiplyScalar(K).floor())},this.getScissorTest=function(){return se},this.setScissorTest=function(S){le.setScissorTest(se=S)},this.setOpaqueSort=function(S){W=S},this.setTransparentSort=function(S){q=S},this.getClearColor=function(S){return S.copy(gt.getClearColor())},this.setClearColor=function(){gt.setClearColor.apply(gt,arguments)},this.getClearAlpha=function(){return gt.getClearAlpha()},this.setClearAlpha=function(){gt.setClearAlpha.apply(gt,arguments)},this.clear=function(S=!0,R=!0,F=!0){let B=0;if(S){let L=!1;if(I!==null){let ue=I.texture.format;L=ue===LC||ue===OC||ue===NC}if(L){let ue=I.texture.type,_e=ue===xs||ue===ws||ue===nw||ue===So||ue===RC||ue===PC,De=gt.getClearColor(),Ne=gt.getClearAlpha(),Ke=De.r,Be=De.g,Ge=De.b;_e?(p[0]=Ke,p[1]=Be,p[2]=Ge,p[3]=Ne,P.clearBufferuiv(P.COLOR,0,p)):(g[0]=Ke,g[1]=Be,g[2]=Ge,g[3]=Ne,P.clearBufferiv(P.COLOR,0,g))}else B|=P.COLOR_BUFFER_BIT}R&&(B|=P.DEPTH_BUFFER_BIT),F&&(B|=P.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),P.clear(B)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",_t,!1),n.removeEventListener("webglcontextrestored",C,!1),n.removeEventListener("webglcontextcreationerror",ne,!1),fe.dispose(),Re.dispose(),be.dispose(),E.dispose(),N.dispose(),te.dispose(),je.dispose(),ft.dispose(),me.dispose(),nt.dispose(),nt.removeEventListener("sessionstart",jn),nt.removeEventListener("sessionend",bt),ce&&(ce.dispose(),ce=null),vn.stop()};function _t(S){S.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),v=!0}function C(){console.log("THREE.WebGLRenderer: Context Restored."),v=!1;let S=tt.autoReset,R=Z.enabled,F=Z.autoUpdate,B=Z.needsUpdate,L=Z.type;xt(),tt.autoReset=S,Z.enabled=R,Z.autoUpdate=F,Z.needsUpdate=B,Z.type=L}function ne(S){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",S.statusMessage)}function ie(S){let R=S.target;R.removeEventListener("dispose",ie),ye(R)}function ye(S){Ie(S),be.remove(S)}function Ie(S){let R=be.get(S).programs;R!==void 0&&(R.forEach(function(F){me.releaseProgram(F)}),S.isShaderMaterial&&me.releaseShaderCache(S))}this.renderBufferDirect=function(S,R,F,B,L,ue){R===null&&(R=Ce);let _e=L.isMesh&&L.matrixWorld.determinant()<0,De=RD(S,R,F,B,L);le.setMaterial(B,_e);let Ne=F.index,Ke=1;if(B.wireframe===!0){if(Ne=Y.getWireframeAttribute(F),Ne===void 0)return;Ke=2}let Be=F.drawRange,Ge=F.attributes.position,Nt=Be.start*Ke,Nn=(Be.start+Be.count)*Ke;ue!==null&&(Nt=Math.max(Nt,ue.start*Ke),Nn=Math.min(Nn,(ue.start+ue.count)*Ke)),Ne!==null?(Nt=Math.max(Nt,0),Nn=Math.min(Nn,Ne.count)):Ge!=null&&(Nt=Math.max(Nt,0),Nn=Math.min(Nn,Ge.count));let $t=Nn-Nt;if($t<0||$t===1/0)return;je.setup(L,B,De,F,Ne);let rr,It=Fe;if(Ne!==null&&(rr=J.get(Ne),It=Se,It.setIndex(rr)),L.isMesh)B.wireframe===!0?(le.setLineWidth(B.wireframeLinewidth*ke()),It.setMode(P.LINES)):It.setMode(P.TRIANGLES);else if(L.isLine){let Ye=B.linewidth;Ye===void 0&&(Ye=1),le.setLineWidth(Ye*ke()),L.isLineSegments?It.setMode(P.LINES):L.isLineLoop?It.setMode(P.LINE_LOOP):It.setMode(P.LINE_STRIP)}else L.isPoints?It.setMode(P.POINTS):L.isSprite&&It.setMode(P.TRIANGLES);if(L.isBatchedMesh)It.renderMultiDraw(L._multiDrawStarts,L._multiDrawCounts,L._multiDrawCount);else if(L.isInstancedMesh)It.renderInstances(Nt,$t,L.count);else if(F.isInstancedBufferGeometry){let Ye=F._maxInstanceCount!==void 0?F._maxInstanceCount:1/0,yp=Math.min(F.instanceCount,Ye);It.renderInstances(Nt,$t,yp)}else It.render(Nt,$t)};function pt(S,R,F){S.transparent===!0&&S.side===Rr&&S.forceSinglePass===!1?(S.side=Pn,S.needsUpdate=!0,wl(S,R,F),S.side=Ss,S.needsUpdate=!0,wl(S,R,F),S.side=Rr):wl(S,R,F)}this.compile=function(S,R,F=null){F===null&&(F=S),m=Re.get(F),m.init(),b.push(m),F.traverseVisible(function(L){L.isLight&&L.layers.test(R.layers)&&(m.pushLight(L),L.castShadow&&m.pushShadow(L))}),S!==F&&S.traverseVisible(function(L){L.isLight&&L.layers.test(R.layers)&&(m.pushLight(L),L.castShadow&&m.pushShadow(L))}),m.setupLights(_._useLegacyLights);let B=new Set;return S.traverse(function(L){let ue=L.material;if(ue)if(Array.isArray(ue))for(let _e=0;_e<ue.length;_e++){let De=ue[_e];pt(De,F,L),B.add(De)}else pt(ue,F,L),B.add(ue)}),b.pop(),m=null,B},this.compileAsync=function(S,R,F=null){let B=this.compile(S,R,F);return new Promise(L=>{function ue(){if(B.forEach(function(_e){be.get(_e).currentProgram.isReady()&&B.delete(_e)}),B.size===0){L(S);return}setTimeout(ue,10)}Ee.get("KHR_parallel_shader_compile")!==null?ue():setTimeout(ue,10)})};let Et=null;function en(S){Et&&Et(S)}function jn(){vn.stop()}function bt(){vn.start()}let vn=new HC;vn.setAnimationLoop(en),typeof self<"u"&&vn.setContext(self),this.setAnimationLoop=function(S){Et=S,nt.setAnimationLoop(S),S===null?vn.stop():vn.start()},nt.addEventListener("sessionstart",jn),nt.addEventListener("sessionend",bt),this.render=function(S,R){if(R!==void 0&&R.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(v===!0)return;S.matrixWorldAutoUpdate===!0&&S.updateMatrixWorld(),R.parent===null&&R.matrixWorldAutoUpdate===!0&&R.updateMatrixWorld(),nt.enabled===!0&&nt.isPresenting===!0&&(nt.cameraAutoUpdate===!0&&nt.updateCamera(R),R=nt.getCamera()),S.isScene===!0&&S.onBeforeRender(_,S,R,I),m=Re.get(S,b.length),m.init(),b.push(m),we.multiplyMatrices(R.projectionMatrix,R.matrixWorldInverse),Me.setFromProjectionMatrix(we),Q=this.localClippingEnabled,H=Xe.init(this.clippingPlanes,Q),y=fe.get(S,f.length),y.init(),f.push(y),Mi(S,R,0,_.sortObjects),y.finish(),_.sortObjects===!0&&y.sort(W,q),this.info.render.frame++,H===!0&&Xe.beginShadows();let F=m.state.shadowsArray;if(Z.render(F,S,R),H===!0&&Xe.endShadows(),this.info.autoReset===!0&&this.info.reset(),(nt.enabled===!1||nt.isPresenting===!1||nt.hasDepthSensing()===!1)&&gt.render(y,S),m.setupLights(_._useLegacyLights),R.isArrayCamera){let B=R.cameras;for(let L=0,ue=B.length;L<ue;L++){let _e=B[L];Tw(y,S,_e,_e.viewport)}}else Tw(y,S,R);I!==null&&(T.updateMultisampleRenderTarget(I),T.updateRenderTargetMipmap(I)),S.isScene===!0&&S.onAfterRender(_,S,R),je.resetDefaultState(),V=-1,G=null,b.pop(),b.length>0?m=b[b.length-1]:m=null,f.pop(),f.length>0?y=f[f.length-1]:y=null};function Mi(S,R,F,B){if(S.visible===!1)return;if(S.layers.test(R.layers)){if(S.isGroup)F=S.renderOrder;else if(S.isLOD)S.autoUpdate===!0&&S.update(R);else if(S.isLight)m.pushLight(S),S.castShadow&&m.pushShadow(S);else if(S.isSprite){if(!S.frustumCulled||Me.intersectsSprite(S)){B&&he.setFromMatrixPosition(S.matrixWorld).applyMatrix4(we);let _e=te.update(S),De=S.material;De.visible&&y.push(S,_e,De,F,he.z,null)}}else if((S.isMesh||S.isLine||S.isPoints)&&(!S.frustumCulled||Me.intersectsObject(S))){let _e=te.update(S),De=S.material;if(B&&(S.boundingSphere!==void 0?(S.boundingSphere===null&&S.computeBoundingSphere(),he.copy(S.boundingSphere.center)):(_e.boundingSphere===null&&_e.computeBoundingSphere(),he.copy(_e.boundingSphere.center)),he.applyMatrix4(S.matrixWorld).applyMatrix4(we)),Array.isArray(De)){let Ne=_e.groups;for(let Ke=0,Be=Ne.length;Ke<Be;Ke++){let Ge=Ne[Ke],Nt=De[Ge.materialIndex];Nt&&Nt.visible&&y.push(S,_e,Nt,F,he.z,Ge)}}else De.visible&&y.push(S,_e,De,F,he.z,null)}}let ue=S.children;for(let _e=0,De=ue.length;_e<De;_e++)Mi(ue[_e],R,F,B)}function Tw(S,R,F,B){let L=S.opaque,ue=S.transmissive,_e=S.transparent;m.setupLightsView(F),H===!0&&Xe.setGlobalState(_.clippingPlanes,F),ue.length>0&&DD(L,ue,R,F),B&&le.viewport(w.copy(B)),L.length>0&&_l(L,R,F),ue.length>0&&_l(ue,R,F),_e.length>0&&_l(_e,R,F),le.buffers.depth.setTest(!0),le.buffers.depth.setMask(!0),le.buffers.color.setMask(!0),le.setPolygonOffset(!1)}function DD(S,R,F,B){if((F.isScene===!0?F.overrideMaterial:null)!==null)return;let ue=de.isWebGL2;ce===null&&(ce=new Lr(1,1,{generateMipmaps:!0,type:Ee.has("EXT_color_buffer_half_float")?ol:xs,minFilter:xo,samples:ue?4:0})),_.getDrawingBufferSize(Te),ue?ce.setSize(Te.x,Te.y):ce.setSize(Vf(Te.x),Vf(Te.y));let _e=_.getRenderTarget();_.setRenderTarget(ce),_.getClearColor(X),D=_.getClearAlpha(),D<1&&_.setClearColor(16777215,.5),_.clear();let De=_.toneMapping;_.toneMapping=bs,_l(S,F,B),T.updateMultisampleRenderTarget(ce),T.updateRenderTargetMipmap(ce);let Ne=!1;for(let Ke=0,Be=R.length;Ke<Be;Ke++){let Ge=R[Ke],Nt=Ge.object,Nn=Ge.geometry,$t=Ge.material,rr=Ge.group;if($t.side===Rr&&Nt.layers.test(B.layers)){let It=$t.side;$t.side=Pn,$t.needsUpdate=!0,Iw(Nt,F,B,Nn,$t,rr),$t.side=It,$t.needsUpdate=!0,Ne=!0}}Ne===!0&&(T.updateMultisampleRenderTarget(ce),T.updateRenderTargetMipmap(ce)),_.setRenderTarget(_e),_.setClearColor(X,D),_.toneMapping=De}function _l(S,R,F){let B=R.isScene===!0?R.overrideMaterial:null;for(let L=0,ue=S.length;L<ue;L++){let _e=S[L],De=_e.object,Ne=_e.geometry,Ke=B===null?_e.material:B,Be=_e.group;De.layers.test(F.layers)&&Iw(De,R,F,Ne,Ke,Be)}}function Iw(S,R,F,B,L,ue){S.onBeforeRender(_,R,F,B,L,ue),S.modelViewMatrix.multiplyMatrices(F.matrixWorldInverse,S.matrixWorld),S.normalMatrix.getNormalMatrix(S.modelViewMatrix),L.onBeforeRender(_,R,F,B,S,ue),L.transparent===!0&&L.side===Rr&&L.forceSinglePass===!1?(L.side=Pn,L.needsUpdate=!0,_.renderBufferDirect(F,R,B,L,S,ue),L.side=Ss,L.needsUpdate=!0,_.renderBufferDirect(F,R,B,L,S,ue),L.side=Rr):_.renderBufferDirect(F,R,B,L,S,ue),S.onAfterRender(_,R,F,B,L,ue)}function wl(S,R,F){R.isScene!==!0&&(R=Ce);let B=be.get(S),L=m.state.lights,ue=m.state.shadowsArray,_e=L.state.version,De=me.getParameters(S,L.state,ue,R,F),Ne=me.getProgramCacheKey(De),Ke=B.programs;B.environment=S.isMeshStandardMaterial?R.environment:null,B.fog=R.fog,B.envMap=(S.isMeshStandardMaterial?N:E).get(S.envMap||B.environment),Ke===void 0&&(S.addEventListener("dispose",ie),Ke=new Map,B.programs=Ke);let Be=Ke.get(Ne);if(Be!==void 0){if(B.currentProgram===Be&&B.lightsStateVersion===_e)return Mw(S,De),Be}else De.uniforms=me.getUniforms(S),S.onBuild(F,De,_),S.onBeforeCompile(De,_),Be=me.acquireProgram(De,Ne),Ke.set(Ne,Be),B.uniforms=De.uniforms;let Ge=B.uniforms;return(!S.isShaderMaterial&&!S.isRawShaderMaterial||S.clipping===!0)&&(Ge.clippingPlanes=Xe.uniform),Mw(S,De),B.needsLights=ND(S),B.lightsStateVersion=_e,B.needsLights&&(Ge.ambientLightColor.value=L.state.ambient,Ge.lightProbe.value=L.state.probe,Ge.directionalLights.value=L.state.directional,Ge.directionalLightShadows.value=L.state.directionalShadow,Ge.spotLights.value=L.state.spot,Ge.spotLightShadows.value=L.state.spotShadow,Ge.rectAreaLights.value=L.state.rectArea,Ge.ltc_1.value=L.state.rectAreaLTC1,Ge.ltc_2.value=L.state.rectAreaLTC2,Ge.pointLights.value=L.state.point,Ge.pointLightShadows.value=L.state.pointShadow,Ge.hemisphereLights.value=L.state.hemi,Ge.directionalShadowMap.value=L.state.directionalShadowMap,Ge.directionalShadowMatrix.value=L.state.directionalShadowMatrix,Ge.spotShadowMap.value=L.state.spotShadowMap,Ge.spotLightMatrix.value=L.state.spotLightMatrix,Ge.spotLightMap.value=L.state.spotLightMap,Ge.pointShadowMap.value=L.state.pointShadowMap,Ge.pointShadowMatrix.value=L.state.pointShadowMatrix),B.currentProgram=Be,B.uniformsList=null,Be}function Aw(S){if(S.uniformsList===null){let R=S.currentProgram.getUniforms();S.uniformsList=ac.seqWithValue(R.seq,S.uniforms)}return S.uniformsList}function Mw(S,R){let F=be.get(S);F.outputColorSpace=R.outputColorSpace,F.batching=R.batching,F.instancing=R.instancing,F.instancingColor=R.instancingColor,F.skinning=R.skinning,F.morphTargets=R.morphTargets,F.morphNormals=R.morphNormals,F.morphColors=R.morphColors,F.morphTargetsCount=R.morphTargetsCount,F.numClippingPlanes=R.numClippingPlanes,F.numIntersection=R.numClipIntersection,F.vertexAlphas=R.vertexAlphas,F.vertexTangents=R.vertexTangents,F.toneMapping=R.toneMapping}function RD(S,R,F,B,L){R.isScene!==!0&&(R=Ce),T.resetTextureUnits();let ue=R.fog,_e=B.isMeshStandardMaterial?R.environment:null,De=I===null?_.outputColorSpace:I.isXRRenderTarget===!0?I.texture.colorSpace:Or,Ne=(B.isMeshStandardMaterial?N:E).get(B.envMap||_e),Ke=B.vertexColors===!0&&!!F.attributes.color&&F.attributes.color.itemSize===4,Be=!!F.attributes.tangent&&(!!B.normalMap||B.anisotropy>0),Ge=!!F.morphAttributes.position,Nt=!!F.morphAttributes.normal,Nn=!!F.morphAttributes.color,$t=bs;B.toneMapped&&(I===null||I.isXRRenderTarget===!0)&&($t=_.toneMapping);let rr=F.morphAttributes.position||F.morphAttributes.normal||F.morphAttributes.color,It=rr!==void 0?rr.length:0,Ye=be.get(B),yp=m.state.lights;if(H===!0&&(Q===!0||S!==G)){let $n=S===G&&B.id===V;Xe.setState(B,S,$n)}let Mt=!1;B.version===Ye.__version?(Ye.needsLights&&Ye.lightsStateVersion!==yp.state.version||Ye.outputColorSpace!==De||L.isBatchedMesh&&Ye.batching===!1||!L.isBatchedMesh&&Ye.batching===!0||L.isInstancedMesh&&Ye.instancing===!1||!L.isInstancedMesh&&Ye.instancing===!0||L.isSkinnedMesh&&Ye.skinning===!1||!L.isSkinnedMesh&&Ye.skinning===!0||L.isInstancedMesh&&Ye.instancingColor===!0&&L.instanceColor===null||L.isInstancedMesh&&Ye.instancingColor===!1&&L.instanceColor!==null||Ye.envMap!==Ne||B.fog===!0&&Ye.fog!==ue||Ye.numClippingPlanes!==void 0&&(Ye.numClippingPlanes!==Xe.numPlanes||Ye.numIntersection!==Xe.numIntersection)||Ye.vertexAlphas!==Ke||Ye.vertexTangents!==Be||Ye.morphTargets!==Ge||Ye.morphNormals!==Nt||Ye.morphColors!==Nn||Ye.toneMapping!==$t||de.isWebGL2===!0&&Ye.morphTargetsCount!==It)&&(Mt=!0):(Mt=!0,Ye.__version=B.version);let Cs=Ye.currentProgram;Mt===!0&&(Cs=wl(B,R,L));let Cw=!1,wc=!1,vp=!1,hn=Cs.getUniforms(),Ds=Ye.uniforms;if(le.useProgram(Cs.program)&&(Cw=!0,wc=!0,vp=!0),B.id!==V&&(V=B.id,wc=!0),Cw||G!==S){hn.setValue(P,"projectionMatrix",S.projectionMatrix),hn.setValue(P,"viewMatrix",S.matrixWorldInverse);let $n=hn.map.cameraPosition;$n!==void 0&&$n.setValue(P,he.setFromMatrixPosition(S.matrixWorld)),de.logarithmicDepthBuffer&&hn.setValue(P,"logDepthBufFC",2/(Math.log(S.far+1)/Math.LN2)),(B.isMeshPhongMaterial||B.isMeshToonMaterial||B.isMeshLambertMaterial||B.isMeshBasicMaterial||B.isMeshStandardMaterial||B.isShaderMaterial)&&hn.setValue(P,"isOrthographic",S.isOrthographicCamera===!0),G!==S&&(G=S,wc=!0,vp=!0)}if(L.isSkinnedMesh){hn.setOptional(P,L,"bindMatrix"),hn.setOptional(P,L,"bindMatrixInverse");let $n=L.skeleton;$n&&(de.floatVertexTextures?($n.boneTexture===null&&$n.computeBoneTexture(),hn.setValue(P,"boneTexture",$n.boneTexture,T)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}L.isBatchedMesh&&(hn.setOptional(P,L,"batchingTexture"),hn.setValue(P,"batchingTexture",L._matricesTexture,T));let _p=F.morphAttributes;if((_p.position!==void 0||_p.normal!==void 0||_p.color!==void 0&&de.isWebGL2===!0)&&Je.update(L,F,Cs),(wc||Ye.receiveShadow!==L.receiveShadow)&&(Ye.receiveShadow=L.receiveShadow,hn.setValue(P,"receiveShadow",L.receiveShadow)),B.isMeshGouraudMaterial&&B.envMap!==null&&(Ds.envMap.value=Ne,Ds.flipEnvMap.value=Ne.isCubeTexture&&Ne.isRenderTargetTexture===!1?-1:1),wc&&(hn.setValue(P,"toneMappingExposure",_.toneMappingExposure),Ye.needsLights&&PD(Ds,vp),ue&&B.fog===!0&&ae.refreshFogUniforms(Ds,ue),ae.refreshMaterialUniforms(Ds,B,K,O,ce),ac.upload(P,Aw(Ye),Ds,T)),B.isShaderMaterial&&B.uniformsNeedUpdate===!0&&(ac.upload(P,Aw(Ye),Ds,T),B.uniformsNeedUpdate=!1),B.isSpriteMaterial&&hn.setValue(P,"center",L.center),hn.setValue(P,"modelViewMatrix",L.modelViewMatrix),hn.setValue(P,"normalMatrix",L.normalMatrix),hn.setValue(P,"modelMatrix",L.matrixWorld),B.isShaderMaterial||B.isRawShaderMaterial){let $n=B.uniformsGroups;for(let wp=0,OD=$n.length;wp<OD;wp++)if(de.isWebGL2){let Dw=$n[wp];ft.update(Dw,Cs),ft.bind(Dw,Cs)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Cs}function PD(S,R){S.ambientLightColor.needsUpdate=R,S.lightProbe.needsUpdate=R,S.directionalLights.needsUpdate=R,S.directionalLightShadows.needsUpdate=R,S.pointLights.needsUpdate=R,S.pointLightShadows.needsUpdate=R,S.spotLights.needsUpdate=R,S.spotLightShadows.needsUpdate=R,S.rectAreaLights.needsUpdate=R,S.hemisphereLights.needsUpdate=R}function ND(S){return S.isMeshLambertMaterial||S.isMeshToonMaterial||S.isMeshPhongMaterial||S.isMeshStandardMaterial||S.isShadowMaterial||S.isShaderMaterial&&S.lights===!0}this.getActiveCubeFace=function(){return x},this.getActiveMipmapLevel=function(){return A},this.getRenderTarget=function(){return I},this.setRenderTargetTextures=function(S,R,F){be.get(S.texture).__webglTexture=R,be.get(S.depthTexture).__webglTexture=F;let B=be.get(S);B.__hasExternalTextures=!0,B.__hasExternalTextures&&(B.__autoAllocateDepthBuffer=F===void 0,B.__autoAllocateDepthBuffer||Ee.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),B.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(S,R){let F=be.get(S);F.__webglFramebuffer=R,F.__useDefaultFramebuffer=R===void 0},this.setRenderTarget=function(S,R=0,F=0){I=S,x=R,A=F;let B=!0,L=null,ue=!1,_e=!1;if(S){let Ne=be.get(S);Ne.__useDefaultFramebuffer!==void 0?(le.bindFramebuffer(P.FRAMEBUFFER,null),B=!1):Ne.__webglFramebuffer===void 0?T.setupRenderTarget(S):Ne.__hasExternalTextures&&T.rebindTextures(S,be.get(S.texture).__webglTexture,be.get(S.depthTexture).__webglTexture);let Ke=S.texture;(Ke.isData3DTexture||Ke.isDataArrayTexture||Ke.isCompressedArrayTexture)&&(_e=!0);let Be=be.get(S).__webglFramebuffer;S.isWebGLCubeRenderTarget?(Array.isArray(Be[R])?L=Be[R][F]:L=Be[R],ue=!0):de.isWebGL2&&S.samples>0&&T.useMultisampledRTT(S)===!1?L=be.get(S).__webglMultisampledFramebuffer:Array.isArray(Be)?L=Be[F]:L=Be,w.copy(S.viewport),M.copy(S.scissor),j=S.scissorTest}else w.copy($).multiplyScalar(K).floor(),M.copy(ee).multiplyScalar(K).floor(),j=se;if(le.bindFramebuffer(P.FRAMEBUFFER,L)&&de.drawBuffers&&B&&le.drawBuffers(S,L),le.viewport(w),le.scissor(M),le.setScissorTest(j),ue){let Ne=be.get(S.texture);P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,P.TEXTURE_CUBE_MAP_POSITIVE_X+R,Ne.__webglTexture,F)}else if(_e){let Ne=be.get(S.texture),Ke=R||0;P.framebufferTextureLayer(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,Ne.__webglTexture,F||0,Ke)}V=-1},this.readRenderTargetPixels=function(S,R,F,B,L,ue,_e){if(!(S&&S.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let De=be.get(S).__webglFramebuffer;if(S.isWebGLCubeRenderTarget&&_e!==void 0&&(De=De[_e]),De){le.bindFramebuffer(P.FRAMEBUFFER,De);try{let Ne=S.texture,Ke=Ne.format,Be=Ne.type;if(Ke!==xi&&pe.convert(Ke)!==P.getParameter(P.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let Ge=Be===ol&&(Ee.has("EXT_color_buffer_half_float")||de.isWebGL2&&Ee.has("EXT_color_buffer_float"));if(Be!==xs&&pe.convert(Be)!==P.getParameter(P.IMPLEMENTATION_COLOR_READ_TYPE)&&!(Be===Pr&&(de.isWebGL2||Ee.has("OES_texture_float")||Ee.has("WEBGL_color_buffer_float")))&&!Ge){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}R>=0&&R<=S.width-B&&F>=0&&F<=S.height-L&&P.readPixels(R,F,B,L,pe.convert(Ke),pe.convert(Be),ue)}finally{let Ne=I!==null?be.get(I).__webglFramebuffer:null;le.bindFramebuffer(P.FRAMEBUFFER,Ne)}}},this.copyFramebufferToTexture=function(S,R,F=0){let B=Math.pow(2,-F),L=Math.floor(R.image.width*B),ue=Math.floor(R.image.height*B);T.setTexture2D(R,0),P.copyTexSubImage2D(P.TEXTURE_2D,F,0,0,S.x,S.y,L,ue),le.unbindTexture()},this.copyTextureToTexture=function(S,R,F,B=0){let L=R.image.width,ue=R.image.height,_e=pe.convert(F.format),De=pe.convert(F.type);T.setTexture2D(F,0),P.pixelStorei(P.UNPACK_FLIP_Y_WEBGL,F.flipY),P.pixelStorei(P.UNPACK_PREMULTIPLY_ALPHA_WEBGL,F.premultiplyAlpha),P.pixelStorei(P.UNPACK_ALIGNMENT,F.unpackAlignment),R.isDataTexture?P.texSubImage2D(P.TEXTURE_2D,B,S.x,S.y,L,ue,_e,De,R.image.data):R.isCompressedTexture?P.compressedTexSubImage2D(P.TEXTURE_2D,B,S.x,S.y,R.mipmaps[0].width,R.mipmaps[0].height,_e,R.mipmaps[0].data):P.texSubImage2D(P.TEXTURE_2D,B,S.x,S.y,_e,De,R.image),B===0&&F.generateMipmaps&&P.generateMipmap(P.TEXTURE_2D),le.unbindTexture()},this.copyTextureToTexture3D=function(S,R,F,B,L=0){if(_.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let ue=S.max.x-S.min.x+1,_e=S.max.y-S.min.y+1,De=S.max.z-S.min.z+1,Ne=pe.convert(B.format),Ke=pe.convert(B.type),Be;if(B.isData3DTexture)T.setTexture3D(B,0),Be=P.TEXTURE_3D;else if(B.isDataArrayTexture||B.isCompressedArrayTexture)T.setTexture2DArray(B,0),Be=P.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}P.pixelStorei(P.UNPACK_FLIP_Y_WEBGL,B.flipY),P.pixelStorei(P.UNPACK_PREMULTIPLY_ALPHA_WEBGL,B.premultiplyAlpha),P.pixelStorei(P.UNPACK_ALIGNMENT,B.unpackAlignment);let Ge=P.getParameter(P.UNPACK_ROW_LENGTH),Nt=P.getParameter(P.UNPACK_IMAGE_HEIGHT),Nn=P.getParameter(P.UNPACK_SKIP_PIXELS),$t=P.getParameter(P.UNPACK_SKIP_ROWS),rr=P.getParameter(P.UNPACK_SKIP_IMAGES),It=F.isCompressedTexture?F.mipmaps[L]:F.image;P.pixelStorei(P.UNPACK_ROW_LENGTH,It.width),P.pixelStorei(P.UNPACK_IMAGE_HEIGHT,It.height),P.pixelStorei(P.UNPACK_SKIP_PIXELS,S.min.x),P.pixelStorei(P.UNPACK_SKIP_ROWS,S.min.y),P.pixelStorei(P.UNPACK_SKIP_IMAGES,S.min.z),F.isDataTexture||F.isData3DTexture?P.texSubImage3D(Be,L,R.x,R.y,R.z,ue,_e,De,Ne,Ke,It.data):F.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),P.compressedTexSubImage3D(Be,L,R.x,R.y,R.z,ue,_e,De,Ne,It.data)):P.texSubImage3D(Be,L,R.x,R.y,R.z,ue,_e,De,Ne,Ke,It),P.pixelStorei(P.UNPACK_ROW_LENGTH,Ge),P.pixelStorei(P.UNPACK_IMAGE_HEIGHT,Nt),P.pixelStorei(P.UNPACK_SKIP_PIXELS,Nn),P.pixelStorei(P.UNPACK_SKIP_ROWS,$t),P.pixelStorei(P.UNPACK_SKIP_IMAGES,rr),L===0&&B.generateMipmaps&&P.generateMipmap(Be),le.unbindTexture()},this.initTexture=function(S){S.isCubeTexture?T.setTextureCube(S,0):S.isData3DTexture?T.setTexture3D(S,0):S.isDataArrayTexture||S.isCompressedArrayTexture?T.setTexture2DArray(S,0):T.setTexture2D(S,0),le.unbindTexture()},this.resetState=function(){x=0,A=0,I=null,le.reset(),je.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Nr}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let n=this.getContext();n.drawingBufferColorSpace=e===iw?"display-p3":"srgb",n.unpackColorSpace=vt.workingColorSpace===rp?"display-p3":"srgb"}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===cn?Io:FC}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Io?cn:Or}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}},j0=class extends ul{};j0.prototype.isWebGL1Renderer=!0;var tp=class extends Po{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n}};var ll=class extends Mo{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new lt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},IC=new ln,$0=new Wf,Cf=new dc,Df=new k,np=class extends Po{constructor(e=new Ji,n=new ll){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,n){let i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Cf.copy(i.boundingSphere),Cf.applyMatrix4(r),Cf.radius+=s,e.ray.intersectsSphere(Cf)===!1)return;IC.copy(r).invert(),$0.copy(e.ray).applyMatrix4(IC);let a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,u=i.index,d=i.attributes.position;if(u!==null){let h=Math.max(0,o.start),p=Math.min(u.count,o.start+o.count);for(let g=h,y=p;g<y;g++){let m=u.getX(g);Df.fromBufferAttribute(d,m),AC(Df,m,c,r,e,n,this)}}else{let h=Math.max(0,o.start),p=Math.min(d.count,o.start+o.count);for(let g=h,y=p;g<y;g++)Df.fromBufferAttribute(d,g),AC(Df,g,c,r,e,n,this)}}updateMorphTargets(){let n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){let r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){let a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}};function AC(t,e,n,i,r,s,o){let a=$0.distanceSqToPoint(t);if(a<n){let c=new k;$0.closestPointToPoint(t,c),c.applyMatrix4(i);let u=r.ray.origin.distanceTo(c);if(u<r.near||u>r.far)return;s.push({distance:u,distanceToRay:Math.sqrt(a),point:c,index:e,face:null,object:o})}}function Rf(t,e,n){return!t||!n&&t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}function qj(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}var fc=class{constructor(e,n,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new n.constructor(i),this.sampleValues=n,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){let n=this.parameterPositions,i=this._cachedIndex,r=n[i],s=n[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(r===void 0){if(e<s)break i;return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=n[++i],e<r)break t}o=n.length;break n}if(!(e>=s)){let a=n[1];e<a&&(i=2,s=a);for(let c=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===c)break;if(r=s,s=n[--i-1],e>=s)break t}o=i,i=0;break n}break e}for(;i<o;){let a=i+o>>>1;e<n[a]?o=a:i=a+1}if(r=n[i],s=n[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let n=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)n[o]=i[s+o];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},q0=class extends fc{constructor(e,n,i,r){super(e,n,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:OM,endingEnd:OM}}intervalChanged_(e,n,i){let r=this.parameterPositions,s=e-2,o=e+1,a=r[s],c=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case LM:s=e,a=2*n-i;break;case kM:s=r.length-2,a=n+r[s]-r[s+1];break;default:s=e,a=i}if(c===void 0)switch(this.getSettings_().endingEnd){case LM:o=e,c=2*i-n;break;case kM:o=1,c=i+r[1]-r[0];break;default:o=e-1,c=n}let u=(i-n)*.5,l=this.valueSize;this._weightPrev=u/(n-a),this._weightNext=u/(c-i),this._offsetPrev=s*l,this._offsetNext=o*l}interpolate_(e,n,i,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,u=c-a,l=this._offsetPrev,d=this._offsetNext,h=this._weightPrev,p=this._weightNext,g=(i-n)/(r-n),y=g*g,m=y*g,f=-h*m+2*h*y-h*g,b=(1+h)*m+(-1.5-2*h)*y+(-.5+h)*g+1,_=(-1-p)*m+(1.5+p)*y+.5*g,v=p*m-p*y;for(let x=0;x!==a;++x)s[x]=f*o[l+x]+b*o[u+x]+_*o[c+x]+v*o[d+x];return s}},X0=class extends fc{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,u=c-a,l=(i-n)/(r-n),d=1-l;for(let h=0;h!==a;++h)s[h]=o[u+h]*d+o[c+h]*l;return s}},K0=class extends fc{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}},Ii=class{constructor(e,n,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Rf(n,this.TimeBufferType),this.values=Rf(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){let n=e.constructor,i;if(n.toJSON!==this.toJSON)i=n.toJSON(e);else{i={name:e.name,times:Rf(e.times,Array),values:Rf(e.values,Array)};let r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new K0(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new X0(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new q0(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case Nf:n=this.InterpolantFactoryMethodDiscrete;break;case Of:n=this.InterpolantFactoryMethodLinear;break;case Z_:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){let i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Nf;case this.InterpolantFactoryMethodLinear:return Of;case this.InterpolantFactoryMethodSmooth:return Z_}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]+=e}return this}scale(e){if(e!==1){let n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]*=e}return this}trim(e,n){let i=this.times,r=i.length,s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;o!==-1&&i[o]>n;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);let a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0,n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let i=this.times,r=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){let c=i[a];if(typeof c=="number"&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(o!==null&&o>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,c,o),e=!1;break}o=c}if(r!==void 0&&qj(r))for(let a=0,c=r.length;a!==c;++a){let u=r[a];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,u),e=!1;break}}return e}optimize(){let e=this.times.slice(),n=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===Z_,s=e.length-1,o=1;for(let a=1;a<s;++a){let c=!1,u=e[a],l=e[a+1];if(u!==l&&(a!==1||u!==e[0]))if(r)c=!0;else{let d=a*i,h=d-i,p=d+i;for(let g=0;g!==i;++g){let y=n[d+g];if(y!==n[h+g]||y!==n[p+g]){c=!0;break}}}if(c){if(a!==o){e[o]=e[a];let d=a*i,h=o*i;for(let p=0;p!==i;++p)n[h+p]=n[d+p]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,c=o*i,u=0;u!==i;++u)n[c+u]=n[a+u];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=n.slice(0,o*i)):(this.times=e,this.values=n),this}clone(){let e=this.times.slice(),n=this.values.slice(),i=this.constructor,r=new i(this.name,e,n);return r.createInterpolant=this.createInterpolant,r}};Ii.prototype.TimeBufferType=Float32Array;Ii.prototype.ValueBufferType=Float32Array;Ii.prototype.DefaultInterpolation=Of;var Co=class extends Ii{};Co.prototype.ValueTypeName="bool";Co.prototype.ValueBufferType=Array;Co.prototype.DefaultInterpolation=Nf;Co.prototype.InterpolantFactoryMethodLinear=void 0;Co.prototype.InterpolantFactoryMethodSmooth=void 0;var Y0=class extends Ii{};Y0.prototype.ValueTypeName="color";var Q0=class extends Ii{};Q0.prototype.ValueTypeName="number";var Z0=class extends fc{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=(i-n)/(r-n),u=e*a;for(let l=u+a;u!==l;u+=4)Is.slerpFlat(s,0,o,u-a,o,u,c);return s}},dl=class extends Ii{InterpolantFactoryMethodLinear(e){return new Z0(this.times,this.values,this.getValueSize(),e)}};dl.prototype.ValueTypeName="quaternion";dl.prototype.DefaultInterpolation=Of;dl.prototype.InterpolantFactoryMethodSmooth=void 0;var Do=class extends Ii{};Do.prototype.ValueTypeName="string";Do.prototype.ValueBufferType=Array;Do.prototype.DefaultInterpolation=Nf;Do.prototype.InterpolantFactoryMethodLinear=void 0;Do.prototype.InterpolantFactoryMethodSmooth=void 0;var J0=class extends Ii{};J0.prototype.ValueTypeName="vector";var ow="\\[\\]\\.:\\/",Xj=new RegExp("["+ow+"]","g"),aw="[^"+ow+"]",Kj="[^"+ow.replace("\\.","")+"]",Yj=/((?:WC+[\/:])*)/.source.replace("WC",aw),Qj=/(WCOD+)?/.source.replace("WCOD",Kj),Zj=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",aw),Jj=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",aw),e$=new RegExp("^"+Yj+Qj+Zj+Jj+"$"),t$=["material","materials","bones","map"],ew=class{constructor(e,n,i){let r=i||Ot.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,r)}getValue(e,n){this.bind();let i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,n)}setValue(e,n){let i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,n)}bind(){let e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].bind()}unbind(){let e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].unbind()}},Ot=(()=>{class t{constructor(n,i,r){this.path=i,this.parsedPath=r||t.parseTrackName(i),this.node=t.findNode(n,this.parsedPath.nodeName),this.rootNode=n,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(n,i,r){return n&&n.isAnimationObjectGroup?new t.Composite(n,i,r):new t(n,i,r)}static sanitizeNodeName(n){return n.replace(/\s/g,"_").replace(Xj,"")}static parseTrackName(n){let i=e$.exec(n);if(i===null)throw new Error("PropertyBinding: Cannot parse trackName: "+n);let r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){let o=r.nodeName.substring(s+1);t$.indexOf(o)!==-1&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+n);return r}static findNode(n,i){if(i===void 0||i===""||i==="."||i===-1||i===n.name||i===n.uuid)return n;if(n.skeleton){let r=n.skeleton.getBoneByName(i);if(r!==void 0)return r}if(n.children){let r=function(o){for(let a=0;a<o.length;a++){let c=o[a];if(c.name===i||c.uuid===i)return c;let u=r(c.children);if(u)return u}return null},s=r(n.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(n,i){n[i]=this.targetObject[this.propertyName]}_getValue_array(n,i){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)n[i++]=r[s]}_getValue_arrayElement(n,i){n[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(n,i){this.resolvedProperty.toArray(n,i)}_setValue_direct(n,i){this.targetObject[this.propertyName]=n[i]}_setValue_direct_setNeedsUpdate(n,i){this.targetObject[this.propertyName]=n[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(n,i){this.targetObject[this.propertyName]=n[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(n,i){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=n[i++]}_setValue_array_setNeedsUpdate(n,i){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=n[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(n,i){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=n[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(n,i){this.resolvedProperty[this.propertyIndex]=n[i]}_setValue_arrayElement_setNeedsUpdate(n,i){this.resolvedProperty[this.propertyIndex]=n[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(n,i){this.resolvedProperty[this.propertyIndex]=n[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(n,i){this.resolvedProperty.fromArray(n,i)}_setValue_fromArray_setNeedsUpdate(n,i){this.resolvedProperty.fromArray(n,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(n,i){this.resolvedProperty.fromArray(n,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(n,i){this.bind(),this.getValue(n,i)}_setValue_unbound(n,i){this.bind(),this.setValue(n,i)}bind(){let n=this.node,i=this.parsedPath,r=i.objectName,s=i.propertyName,o=i.propertyIndex;if(n||(n=t.findNode(this.rootNode,i.nodeName),this.node=n),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!n){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let l=i.objectIndex;switch(r){case"materials":if(!n.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!n.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}n=n.material.materials;break;case"bones":if(!n.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}n=n.skeleton.bones;for(let d=0;d<n.length;d++)if(n[d].name===l){l=d;break}break;case"map":if("map"in n){n=n.map;break}if(!n.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!n.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}n=n.material.map;break;default:if(n[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}n=n[r]}if(l!==void 0){if(n[l]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,n);return}n=n[l]}}let a=n[s];if(a===void 0){let l=i.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+s+" but it wasn't found.",n);return}let c=this.Versioning.None;this.targetObject=n,n.needsUpdate!==void 0?c=this.Versioning.NeedsUpdate:n.matrixWorldNeedsUpdate!==void 0&&(c=this.Versioning.MatrixWorldNeedsUpdate);let u=this.BindingType.Direct;if(o!==void 0){if(s==="morphTargetInfluences"){if(!n.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!n.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}n.morphTargetDictionary[o]!==void 0&&(o=n.morphTargetDictionary[o])}u=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else a.fromArray!==void 0&&a.toArray!==void 0?(u=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(u=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return t.Composite=ew,t})();Ot.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Ot.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Ot.prototype.GetterByBindingType=[Ot.prototype._getValue_direct,Ot.prototype._getValue_array,Ot.prototype._getValue_arrayElement,Ot.prototype._getValue_toArray];Ot.prototype.SetterByBindingTypeAndVersioning=[[Ot.prototype._setValue_direct,Ot.prototype._setValue_direct_setNeedsUpdate,Ot.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ot.prototype._setValue_array,Ot.prototype._setValue_array_setNeedsUpdate,Ot.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ot.prototype._setValue_arrayElement,Ot.prototype._setValue_arrayElement_setNeedsUpdate,Ot.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ot.prototype._setValue_fromArray,Ot.prototype._setValue_fromArray_setNeedsUpdate,Ot.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var WJ=new Float32Array(1);typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:tw}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=tw);var i$=["rendererContainer"],XC=(()=>{let e=class e{constructor(){this.animate=()=>{requestAnimationFrame(this.animate),this.points.rotation.x+=.002,this.points.rotation.y+=.002,this.renderer.render(this.scene,this.camera)}}ngOnDestroy(){this.renderer&&this.renderer.dispose()}ngAfterViewInit(){this.initThree(),this.rendererContainer&&console.log(this.rendererContainer.nativeElement)}initThree(){if(!this.rendererContainer)return;this.scene=new tp,this.camera=new Tn(75,window.innerWidth/window.innerHeight,.1,1e3),this.renderer=new ul,this.renderer.setSize(window.innerWidth,window.innerHeight),this.rendererContainer.nativeElement.appendChild(this.renderer.domElement);let i=[];for(let o=0;o<1e3;o++){let a=sp.randFloatSpread(2),c=sp.randFloatSpread(2),u=sp.randFloatSpread(2);i.push(a,c,u)}let r=new Ji;r.setAttribute("position",new Ti(i,3));let s=new ll({color:16777215,size:.002});this.points=new np(r,s),this.scene.add(this.points),this.camera.position.z=1,this.animate()}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=aa({type:e,selectors:[["app-stars"]],viewQuery:function(r,s){if(r&1&&Md(i$,5),r&2){let o;jc(o=$c())&&(s.rendererContainer=o.first)}},standalone:!0,features:[da],decls:2,vars:0,consts:[["rendererContainer",""]],template:function(r,s){r&1&&Qr(0,"div",null,0)},styles:["[_nghost-%COMP%]{display:block;position:absolute;top:0;left:0;width:100%;height:100%;z-index:-1}"]});let t=e;return t})();var Sw=WD(tD());var cD="firebasestorage.googleapis.com",uD="storageBucket",c$=2*60*1e3,u$=10*60*1e3;var Pt=class t extends _n{constructor(e,n,i=0){super(pw(e),`Firebase Storage: ${n} (${pw(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,t.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return pw(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Lt=function(t){return t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment",t}(Lt||{});function pw(t){return"storage/"+t}function ww(){let t="An unknown error occurred, please check the error payload for server response.";return new Pt(Lt.UNKNOWN,t)}function l$(t){return new Pt(Lt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function d$(t){return new Pt(Lt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function h$(){let t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Pt(Lt.UNAUTHENTICATED,t)}function f$(){return new Pt(Lt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function p$(t){return new Pt(Lt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function m$(){return new Pt(Lt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function g$(){return new Pt(Lt.CANCELED,"User canceled the upload/download.")}function y$(t){return new Pt(Lt.INVALID_URL,"Invalid URL '"+t+"'.")}function v$(t){return new Pt(Lt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function _$(){return new Pt(Lt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+uD+"' property when initializing the app?")}function w$(){return new Pt(Lt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function E$(){return new Pt(Lt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function b$(t){return new Pt(Lt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function mw(t){return new Pt(Lt.INVALID_ARGUMENT,t)}function lD(){return new Pt(Lt.APP_DELETED,"The Firebase app was deleted.")}function x$(t){return new Pt(Lt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function gl(t,e){return new Pt(Lt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function ml(t){throw new Pt(Lt.INTERNAL_ERROR,"Internal error: "+t)}var Ai=class t{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let i;try{i=t.makeFromUrl(e,n)}catch{return new t(e,"")}if(i.path==="")return i;throw v$(e)}static makeFromUrl(e,n){let i=null,r="([A-Za-z0-9.\\-_]+)";function s(v){v.path.charAt(v.path.length-1)==="/"&&(v.path_=v.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),c={bucket:1,path:3};function u(v){v.path_=decodeURIComponent(v.path)}let l="v[A-Za-z0-9_]+",d=n.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",p=new RegExp(`^https?://${d}/${l}/b/${r}/o${h}`,"i"),g={bucket:1,path:3},y=n===cD?"(?:storage.googleapis.com|storage.cloud.google.com)":n,m="([^?#]*)",f=new RegExp(`^https?://${y}/${r}/${m}`,"i"),_=[{regex:a,indices:c,postModify:s},{regex:p,indices:g,postModify:u},{regex:f,indices:{bucket:1,path:2},postModify:u}];for(let v=0;v<_.length;v++){let x=_[v],A=x.regex.exec(e);if(A){let I=A[x.indices.bucket],V=A[x.indices.path];V||(V=""),i=new t(I,V),x.postModify(i);break}}if(i==null)throw y$(e);return i}},gw=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function S$(t,e,n){let i=1,r=null,s=null,o=!1,a=0;function c(){return a===2}let u=!1;function l(...m){u||(u=!0,e.apply(null,m))}function d(m){r=setTimeout(()=>{r=null,t(p,c())},m)}function h(){s&&clearTimeout(s)}function p(m,...f){if(u){h();return}if(m){h(),l.call(null,m,...f);return}if(c()||o){h(),l.call(null,m,...f);return}i<64&&(i*=2);let _;a===1?(a=2,_=0):_=(i+Math.random())*1e3,d(_)}let g=!1;function y(m){g||(g=!0,h(),!u&&(r!==null?(m||(a=2),clearTimeout(r),d(0)):m||(a=1)))}return d(0),s=setTimeout(()=>{o=!0,y(!0)},n),y}function T$(t){t(!1)}function I$(t){return t!==void 0}function A$(t){return typeof t=="object"&&!Array.isArray(t)}function Ew(t){return typeof t=="string"||t instanceof String}function nD(t){return bw()&&t instanceof Blob}function bw(){return typeof Blob<"u"}function iD(t,e,n,i){if(i<e)throw mw(`Invalid value for '${t}'. Expected ${e} or greater.`);if(i>n)throw mw(`Invalid value for '${t}'. Expected ${n} or less.`)}function xw(t,e,n){let i=e;return n==null&&(i=`https://${e}`),`${n}://${i}/v0${t}`}function dD(t){let e=encodeURIComponent,n="?";for(let i in t)if(t.hasOwnProperty(i)){let r=e(i)+"="+e(t[i]);n=n+r+"&"}return n=n.slice(0,-1),n}var vc=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}(vc||{});function M$(t,e){let n=t>=500&&t<600,r=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||r||s}var yw=class{constructor(e,n,i,r,s,o,a,c,u,l,d,h=!0){this.url_=e,this.method_=n,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=l,this.connectionFactory_=d,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,g)=>{this.resolve_=p,this.reject_=g,this.start_()})}start_(){let e=(i,r)=>{if(r){i(!1,new yc(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let c=a.loaded,u=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===vc.NO_ERROR,c=s.getStatus();if(!a||M$(c,this.additionalRetryCodes_)&&this.retry){let l=s.getErrorCode()===vc.ABORT;i(!1,new yc(!1,null,l));return}let u=this.successCodes_.indexOf(c)!==-1;i(!0,new yc(u,s))})},n=(i,r)=>{let s=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());I$(c)?s(c):s()}catch(c){o(c)}else if(a!==null){let c=ww();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(r.canceled){let c=this.appDelete_?lD():g$();o(c)}else{let c=m$();o(c)}};this.canceled_?n(!1,new yc(!1,null,!0)):this.backoffId_=S$(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&T$(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},yc=class{constructor(e,n,i){this.wasSuccessCode=e,this.connection=n,this.canceled=!!i}};function C$(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function D$(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function R$(t,e){e&&(t["X-Firebase-GMPID"]=e)}function P$(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function N$(t,e,n,i,r,s,o=!0){let a=dD(t.urlParams),c=t.url+a,u=Object.assign({},t.headers);return R$(u,e),C$(u,n),D$(u,s),P$(u,i),new yw(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r,o)}function O$(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function L$(...t){let e=O$();if(e!==void 0){let n=new e;for(let i=0;i<t.length;i++)n.append(t[i]);return n.getBlob()}else{if(bw())return new Blob(t);throw new Pt(Lt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function k$(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}function F$(t){if(typeof atob>"u")throw b$("base-64");return atob(t)}var ir={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},yl=class{constructor(e,n){this.data=e,this.contentType=n||null}};function U$(t,e){switch(t){case ir.RAW:return new yl(hD(e));case ir.BASE64:case ir.BASE64URL:return new yl(fD(t,e));case ir.DATA_URL:return new yl(B$(e),z$(e))}throw ww()}function hD(t){let e=[];for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{let s=i,o=t.charCodeAt(++n);i=65536|(s&1023)<<10|o&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function V$(t){let e;try{e=decodeURIComponent(t)}catch{throw gl(ir.DATA_URL,"Malformed data URL.")}return hD(e)}function fD(t,e){switch(t){case ir.BASE64:{let r=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(r||s)throw gl(t,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case ir.BASE64URL:{let r=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(r||s)throw gl(t,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=F$(e)}catch(r){throw r.message.includes("polyfill")?r:gl(t,"Invalid character found")}let i=new Uint8Array(n.length);for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return i}var pp=class{constructor(e){this.base64=!1,this.contentType=null;let n=e.match(/^data:([^,]+)?,/);if(n===null)throw gl(ir.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let i=n[1]||null;i!=null&&(this.base64=H$(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}};function B$(t){let e=new pp(t);return e.base64?fD(ir.BASE64,e.rest):V$(e.rest)}function z$(t){return new pp(t).contentType}function H$(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}var mp=class t{constructor(e,n){let i=0,r="";nD(e)?(this.data_=e,i=e.size,r=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,n){if(nD(this.data_)){let i=this.data_,r=k$(i,e,n);return r===null?null:new t(r)}else{let i=new Uint8Array(this.data_.buffer,e,n-e);return new t(i,!0)}}static getBlob(...e){if(bw()){let n=e.map(i=>i instanceof t?i.data_:i);return new t(L$.apply(null,n))}else{let n=e.map(o=>Ew(o)?U$(ir.RAW,o).data:o.data_),i=0;n.forEach(o=>{i+=o.byteLength});let r=new Uint8Array(i),s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)r[s++]=o[a]}),new t(r,!0)}}uploadData(){return this.data_}};function pD(t){let e;try{e=JSON.parse(t)}catch{return null}return A$(e)?e:null}function G$(t){if(t.length===0)return null;let e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function W$(t,e){let n=e.split("/").filter(i=>i.length>0).join("/");return t.length===0?n:t+"/"+n}function mD(t){let e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}function j$(t,e){return e}var dn=class{constructor(e,n,i,r){this.server=e,this.local=n||e,this.writable=!!i,this.xform=r||j$}},fp=null;function $$(t){return!Ew(t)||t.length<2?t:mD(t)}function gD(){if(fp)return fp;let t=[];t.push(new dn("bucket")),t.push(new dn("generation")),t.push(new dn("metageneration")),t.push(new dn("name","fullPath",!0));function e(s,o){return $$(o)}let n=new dn("name");n.xform=e,t.push(n);function i(s,o){return o!==void 0?Number(o):o}let r=new dn("size");return r.xform=i,t.push(r),t.push(new dn("timeCreated")),t.push(new dn("updated")),t.push(new dn("md5Hash",null,!0)),t.push(new dn("cacheControl",null,!0)),t.push(new dn("contentDisposition",null,!0)),t.push(new dn("contentEncoding",null,!0)),t.push(new dn("contentLanguage",null,!0)),t.push(new dn("contentType",null,!0)),t.push(new dn("metadata","customMetadata",!0)),fp=t,fp}function q$(t,e){function n(){let i=t.bucket,r=t.fullPath,s=new Ai(i,r);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function X$(t,e,n){let i={};i.type="file";let r=n.length;for(let s=0;s<r;s++){let o=n[s];i[o.local]=o.xform(i,e[o.server])}return q$(i,t),i}function yD(t,e,n){let i=pD(e);return i===null?null:X$(t,i,n)}function K$(t,e,n,i){let r=pD(e);if(r===null||!Ew(r.downloadTokens))return null;let s=r.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(u=>{let l=t.bucket,d=t.fullPath,h="/b/"+o(l)+"/o/"+o(d),p=xw(h,n,i),g=dD({alt:"media",token:u});return p+g})[0]}function Y$(t,e){let n={},i=e.length;for(let r=0;r<i;r++){let s=e[r];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}var gp=class{constructor(e,n,i,r){this.url=e,this.method=n,this.handler=i,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function vD(t){if(!t)throw ww()}function Q$(t,e){function n(i,r){let s=yD(t,r,e);return vD(s!==null),s}return n}function Z$(t,e){function n(i,r){let s=yD(t,r,e);return vD(s!==null),K$(s,r,t.host,t._protocol)}return n}function _D(t){function e(n,i){let r;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?r=f$():r=h$():n.getStatus()===402?r=d$(t.bucket):n.getStatus()===403?r=p$(t.path):r=i,r.status=n.getStatus(),r.serverResponse=i.serverResponse,r}return e}function J$(t){let e=_D(t);function n(i,r){let s=e(i,r);return i.getStatus()===404&&(s=l$(t.path)),s.serverResponse=r.serverResponse,s}return n}function e5(t,e,n){let i=e.fullServerUrl(),r=xw(i,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new gp(r,s,Z$(t,n),o);return a.errorHandler=J$(e),a}function t5(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function n5(t,e,n){let i=Object.assign({},n);return i.fullPath=t.path,i.size=e.size(),i.contentType||(i.contentType=t5(null,e)),i}function i5(t,e,n,i,r){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let _="";for(let v=0;v<2;v++)_=_+Math.random().toString().slice(2);return _}let c=a();o["Content-Type"]="multipart/related; boundary="+c;let u=n5(e,i,r),l=Y$(u,n),d="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+l+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,h=`\r
--`+c+"--",p=mp.getBlob(d,i,h);if(p===null)throw w$();let g={name:u.fullPath},y=xw(s,t.host,t._protocol),m="POST",f=t.maxUploadRetryTime,b=new gp(y,m,Q$(t,n),f);return b.urlParams=g,b.headers=o,b.body=p.uploadData(),b.errorHandler=_D(e),b}var QJ=256*1024;var rD=null,vw=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=vc.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=vc.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=vc.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,i,r){if(this.sent_)throw ml("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),r!==void 0)for(let s in r)r.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,r[s].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ml("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ml("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ml("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ml("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},_w=class extends vw{initXhr(){this.xhr_.responseType="text"}};function wD(){return rD?rD():new _w}var _c=class t{constructor(e,n){this._service=e,n instanceof Ai?this._location=n:this._location=Ai.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new t(e,n)}get root(){let e=new Ai(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return mD(this._location.path)}get storage(){return this._service}get parent(){let e=G$(this._location.path);if(e===null)return null;let n=new Ai(this._location.bucket,e);return new t(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw x$(e)}};function r5(t,e,n){t._throwIfRoot("uploadBytes");let i=i5(t.storage,t._location,gD(),new mp(e,!0),n);return t.storage.makeRequestWithTokens(i,wD).then(r=>({metadata:r,ref:t}))}function s5(t){t._throwIfRoot("getDownloadURL");let e=e5(t.storage,t._location,gD());return t.storage.makeRequestWithTokens(e,wD).then(n=>{if(n===null)throw E$();return n})}function o5(t,e){let n=W$(t._location.path,e),i=new Ai(t._location.bucket,n);return new _c(t.storage,i)}function a5(t){return/^[A-Za-z]+:\/\//.test(t)}function c5(t,e){return new _c(t,e)}function ED(t,e){if(t instanceof vl){let n=t;if(n._bucket==null)throw _$();let i=new _c(n,n._bucket);return e!=null?ED(i,e):i}else return e!==void 0?o5(t,e):t}function u5(t,e){if(e&&a5(e)){if(t instanceof vl)return c5(t,e);throw mw("To use ref(service, url), the first argument must be a Storage instance.")}else return ED(t,e)}function sD(t,e){let n=e?.[uD];return n==null?null:Ai.makeFromBucketSpec(n,t)}function l5(t,e,n,i={}){t.host=`${e}:${n}`,t._protocol="http";let{mockUserToken:r}=i;r&&(t._overrideAuthToken=typeof r=="string"?r:eh(r,t.app.options.projectId))}var vl=class{constructor(e,n,i,r,s){this.app=e,this._authProvider=n,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._bucket=null,this._host=cD,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=c$,this._maxUploadRetryTime=u$,this._requests=new Set,r!=null?this._bucket=Ai.makeFromBucketSpec(r,this._host):this._bucket=sD(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ai.makeFromBucketSpec(this._url,e):this._bucket=sD(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){iD("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){iD("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return U(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let n=yield e.getToken();if(n!==null)return n.accessToken}return null})}_getAppCheckToken(){return U(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new _c(this,e)}_makeRequest(e,n,i,r,s=!0){if(this._deleted)return new gw(lD());{let o=N$(e,this._appId,i,r,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,n){return U(this,null,function*(){let[i,r]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,i,r).getPromise()})}},oD="@firebase/storage",aD="0.12.1";var bD="storage";function xD(t,e,n){return t=Bn(t),r5(t,e,n)}function SD(t){return t=Bn(t),s5(t)}function TD(t,e){return t=Bn(t),u5(t,e)}function ID(t=os(),e){t=Bn(t);let i=io(t,bD).getImmediate({identifier:e}),r=Jd("storage");return r&&d5(i,...r),i}function d5(t,e,n,i={}){l5(t,e,n,i)}function h5(t,{instanceIdentifier:e}){let n=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),r=t.getProvider("app-check-internal");return new vl(n,i,r,e,ji)}function f5(){Wi(new Cn(bD,h5,"PUBLIC").setMultipleInstances(!0)),Dt(oD,aD,""),Dt(oD,aD,"esm2017")}f5();var AD=(()=>{let e=class e{constructor(){this.storage=ID()}uploadVideo(i,r){return new Promise((s,o)=>{let a=TD(this.storage,r);xD(a,i).then(u=>SD(u.ref)).then(u=>{console.log("File available at",u),s(u)}).catch(u=>{console.error("Upload failed",u),o(u)})})}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var MD=(()=>{let e=class e{constructor(i){this.firebaseStorageService=i,this._mediaStream=new fn,this._blob=new fn}getMediaStream(){return this._mediaStream.asObservable()}getBlob(){return this._blob.asObservable()}startRecording(){if(this.recorder){console.error("Recording is already in progress.");return}this.handleRecording()}handleRecording(){return U(this,null,function*(){try{this.mediaStream=yield navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0}),this._mediaStream.next(this.mediaStream),this.recorder=new Sw.default(this.mediaStream,{type:"video"}),this.recorder.startRecording()}catch(i){console.error("Error initializing recording:",i)}})}stopRecording(){if(!this.recorder){console.error("Recorder not initialized.");return}this.recorder.stopRecording(()=>{console.log("Recording stopped, creating Blob."),this.blob=this.recorder.getBlob(),this.blob instanceof Blob?(console.log("Blob created successfully."),this._blob.next(URL.createObjectURL(this.blob))):console.error("Failed to create Blob."),this.mediaStream.stop(),this.recorder.destroy(),this.mediaStream=null,this.recorder=null})}downloadRecording(){Sw.default.invokeSaveAsDialog(this.blob,`${Date.now()}.webm`)}clearRecording(){this.blob=null,this.recorder=null,this.mediaStream=null}reviewRecording(){if(this.blob instanceof Blob){let i=URL.createObjectURL(this.blob);this._blob.next(i)}else console.error("No recording available to review."),this._blob.next(null)}redoRecording(){this.clearRecording(),this.startRecording()}confirmRecording(){return U(this,null,function*(){try{let i=yield this.firebaseStorageService.uploadVideo(this.blob,"videos/myvideo.webm");console.log("Confirmed, download URL:",i)}catch(i){console.error("Error uploading recording:",i)}})}};e.\u0275fac=function(r){return new(r||e)(He(AD))},e.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var g5=["videoElement"];function y5(t,e){if(t&1){let n=Zr();Zn(0,"button",13),Bi("click",function(){qr(n);let r=Jr();return Xr(r.startRecording())}),es(1," Start record "),Jn()}}function v5(t,e){if(t&1){let n=Zr();Zn(0,"button",14),Bi("click",function(){qr(n);let r=Jr();return Xr(r.stopRecording())}),es(1," Stop record "),Jn()}}function _5(t,e){if(t&1){let n=Zr();Zn(0,"button",15),Bi("click",function(){qr(n);let r=Jr();return Xr(r.downloadRecording())}),es(1," Download video "),Jn()}}function w5(t,e){if(t&1){let n=Zr();Zn(0,"button",16),Bi("click",function(){qr(n);let r=Jr();return Xr(r.clearRecording())}),es(1," Clear record "),Jn()}}function E5(t,e){if(t&1){let n=Zr();Zn(0,"button",17),Bi("click",function(){qr(n);let r=Jr();return Xr(r.redoRecording())}),es(1," Redo record "),Jn()}}function b5(t,e){if(t&1){let n=Zr();Zn(0,"button",18),Bi("click",function(){qr(n);let r=Jr();return Xr(r.reviewRecording())}),es(1," Review record "),Jn()}}function x5(t,e){if(t&1){let n=Zr();Zn(0,"button",19),Bi("click",function(){qr(n);let r=Jr();return Xr(r.confirmRecording())}),es(1," Confirm record "),Jn()}}var Lo=function(t){return t.NONE="NONE",t.RECORDING="RECORDING",t.STOPPED="STOPPED",t.CONFIRMED="CONFIRMED",t}(Lo||{}),CD=(()=>{let e=class e{constructor(i,r,s){this.RecordingService=i,this.ref=r,this.sanitizer=s,this.title="frontend",this.videoBlobUrl=null,this.state=Lo.NONE,this.subscriptions=new At,this.subscriptions.add(this.RecordingService.getMediaStream().subscribe(o=>{this.video.srcObject=o,this.ref.detectChanges()})),this.subscriptions.add(this.RecordingService.getBlob().subscribe(o=>{this.videoBlobUrl=this.sanitizer.bypassSecurityTrustUrl(o),this.video.srcObject=null,this.ref.detectChanges()}))}ngOnDestroy(){this.subscriptions.unsubscribe()}ngAfterViewInit(){this.video=this.videoElement?.nativeElement}startRecording(){this.RecordingService.startRecording(),this.state=Lo.RECORDING}stopRecording(){this.RecordingService.stopRecording(),this.state=Lo.STOPPED}downloadRecording(){this.RecordingService.downloadRecording()}clearRecording(){this.RecordingService.clearRecording(),this.video.srcObject=null,this.videoBlobUrl=null,this.state=Lo.NONE}reviewRecording(){this.state==="STOPPED"?this.RecordingService.reviewRecording():console.error("Recording not ready for review.")}redoRecording(){this.RecordingService.redoRecording(),this.state=Lo.RECORDING}confirmRecording(){this.RecordingService.confirmRecording(),this.state=Lo.CONFIRMED}};e.\u0275fac=function(r){return new(r||e)(yr(MD),yr(la),yr(Vg))},e.\u0275cmp=aa({type:e,selectors:[["app-root"]],viewQuery:function(r,s){if(r&1&&Md(g5,5),r&2){let o;jc(o=$c())&&(s.videoElement=o.first)}},standalone:!0,features:[da],decls:15,vars:8,consts:[[1,"container"],[1,"button-container"],["class","btn btn-primary",3,"click",4,"ngIf"],["class","btn btn-secondary",3,"click",4,"ngIf"],["class","btn btn-success",3,"click",4,"ngIf"],["class","btn btn-danger",3,"click",4,"ngIf"],["class","btn btn-warning",3,"click",4,"ngIf"],["class","btn btn-info",3,"click",4,"ngIf"],["class","btn btn-light",3,"click",4,"ngIf"],[1,"video-container"],["controls","","autoplay","","playsInline",""],["videoElement",""],["type","video/webm",3,"src"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-success",3,"click"],[1,"btn","btn-danger",3,"click"],[1,"btn","btn-warning",3,"click"],[1,"btn","btn-info",3,"click"],[1,"btn","btn-light",3,"click"]],template:function(r,s){r&1&&(Qr(0,"router-outlet")(1,"app-stars"),Zn(2,"div",0)(3,"div",1),xg(4,y5,2,0,"button",2)(5,v5,2,0,"button",3)(6,_5,2,0,"button",4)(7,w5,2,0,"button",5)(8,E5,2,0,"button",6)(9,b5,2,0,"button",7)(10,x5,2,0,"button",8),Jn(),Zn(11,"div",9)(12,"video",10,11),Qr(14,"source",12),Jn()()()),r&2&&(gr(4),Vi("ngIf",s.state==="NONE"),gr(),Vi("ngIf",s.state==="RECORDING"),gr(),Vi("ngIf",s.state==="CONFIRMED"),gr(),Vi("ngIf",s.state==="STOPPED"),gr(),Vi("ngIf",s.state==="STOPPED"),gr(),Vi("ngIf",s.state==="STOPPED"),gr(),Vi("ngIf",s.state==="STOPPED"),gr(4),Vi("src",s.videoBlobUrl,Sx))},dependencies:[Dg,wS,wy,XC],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh}.button-container[_ngcontent-%COMP%]{margin-bottom:20px}.btn[_ngcontent-%COMP%]{margin:0 10px;padding:10px 20px;border:none;border-radius:5px;font-size:16px;cursor:pointer;transition:background-color .3s}.btn-primary[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.btn-secondary[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.btn-success[_ngcontent-%COMP%]{background-color:#28a745;color:#fff}.btn-danger[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.btn-warning[_ngcontent-%COMP%]{background-color:#ffc107;color:#000}.btn-info[_ngcontent-%COMP%]{background-color:#17a2b8;color:#fff}.btn-light[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#000}.btn[_ngcontent-%COMP%]:hover{opacity:.8}.video-container[_ngcontent-%COMP%]{width:80%;max-width:800px}video[_ngcontent-%COMP%]{width:100%;border-radius:8px;box-shadow:0 4px 8px #0000001a}"]});let t=e;return t})();var pee=_u(JA.firebaseConfig);CS(CD,eM).catch(t=>console.error(t));
